\section{capmat Module Reference}
\label{namespacecapmat}\index{capmat@{capmat}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf impl\+\_\+euler\+\_\+np\+\_\+nondiag} (el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)
\begin{DoxyCompactList}\small\item\em implicit Euler for nonlinear problem and Picard iteration method, nondiagonal capacity matrix \end{DoxyCompactList}\item 
subroutine, public {\bf impl\+\_\+euler\+\_\+np\+\_\+diag} (el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)
\begin{DoxyCompactList}\small\item\em implicit euler method, nonlinear problem Picard iteration method -\/ diagonal capacity matrix \end{DoxyCompactList}\item 
subroutine, public {\bf steady\+\_\+state\+\_\+int} (el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)
\item 
subroutine, private {\bf diagonalizer} (a)
\begin{DoxyCompactList}\small\item\em routine that diagonalizes matrix -\/ it lumps consistent capacity matrices \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{capmat@{capmat}!diagonalizer@{diagonalizer}}
\index{diagonalizer@{diagonalizer}!capmat@{capmat}}
\subsubsection[{diagonalizer(a)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private capmat\+::diagonalizer (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:,\+:), intent(inout)}]{a}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacecapmat_a3e2778aaff3524d980ba919f1663b000}


routine that diagonalizes matrix -\/ it lumps consistent capacity matrices 



Definition at line 198 of file capmat.\+f90.



Referenced by impl\+\_\+euler\+\_\+np\+\_\+diag().


\begin{DoxyCode}
198       \textcolor{keywordtype}{use }typy
199       
200       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(in out)} :: a
201 
202       \textcolor{keywordtype}{integer(kind=ikind)} :: i,j
203       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
204 
205       \textcolor{keywordflow}{do} i=1, ubound(a,1)
206         tmp = 0.0\_rkind
207         \textcolor{keywordflow}{do} j=1, ubound(a,1)
208           tmp = tmp + a(i,j)
209 \textcolor{keywordflow}{        end do}
210         
211         a(i,i) = tmp
212 
213         \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
214           a(i,1:i-1) = 0
215 \textcolor{keywordflow}{        end if}
216 
217         \textcolor{keywordflow}{if} (i < ubound(a,1)) \textcolor{keywordflow}{then}
218           a(i, i+1:ubound(a,1)) = 0
219 \textcolor{keywordflow}{        end if}
220 \textcolor{keywordflow}{      end do}
221     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecapmat_a3e2778aaff3524d980ba919f1663b000_icgraph}
\end{center}
\end{figure}


\index{capmat@{capmat}!impl\+\_\+euler\+\_\+np\+\_\+diag@{impl\+\_\+euler\+\_\+np\+\_\+diag}}
\index{impl\+\_\+euler\+\_\+np\+\_\+diag@{impl\+\_\+euler\+\_\+np\+\_\+diag}!capmat@{capmat}}
\subsubsection[{impl\+\_\+euler\+\_\+np\+\_\+diag(el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public capmat\+::impl\+\_\+euler\+\_\+np\+\_\+diag (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in), optional}]{domain\+\_\+id, }
\item[{type({\bf integpnt\+\_\+str}), intent(inout), optional}]{quadpnt\+\_\+in}
\end{DoxyParamCaption}
)}\label{namespacecapmat_adc9967ebf2be8d086371968c94553c2b}


implicit euler method, nonlinear problem Picard iteration method -\/ diagonal capacity matrix 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em domain\+\_\+id} & subdomain number (inserted only if domain decomposition used and if only local data needed) \\
\hline
\end{DoxyParams}


Definition at line 98 of file capmat.\+f90.



References globals\+::base\+\_\+fnc, globals\+::bside, globals\+::cap\+\_\+mat, diagonalizer(), globals\+::elements, globals\+::elnode\+\_\+prev, globals\+::gauss\+\_\+points, and pde\+\_\+objs\+::pde.



Referenced by manage\+\_\+pointers\+::set\+\_\+pointers().


\begin{DoxyCode}
98       \textcolor{keywordtype}{use }typy
99       \textcolor{keywordtype}{use }globals
100       \textcolor{keywordtype}{use }global_objs
101       \textcolor{keywordtype}{use }pde_objs
102       \textcolor{keywordtype}{use }geom_tools
103       \textcolor{keywordtype}{use }feminittools
104       \textcolor{keywordtype}{use }linalg
105       \textcolor{keywordtype}{use }debug_tools
106 
107       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: el\_id
109       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: domain\_id
110       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in out)}, \textcolor{keywordtype}{optional} :: quadpnt\_in
111       
112       
113       \textcolor{keywordtype}{integer(kind=ikind)} :: i,j,l, m
114       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
115       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(2,2)} :: locmat
116       \textcolor{keywordtype}{integer(kind=ikind)} :: iproc, jproc, limits, ll, jj
117       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: layer
118       \textcolor{keywordtype}{type}(integpnt_str) :: quadpnt
119 
120       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(layer)) \textcolor{keywordflow}{then}
121         \textcolor{keyword}{allocate}(layer(ubound(pde,1), ubound(pde,1)))
122 \textcolor{keywordflow}{      end if}
123 
124       \textcolor{keywordflow}{do} iproc=1,ubound(pde,1)
125         \textcolor{keywordflow}{do} jproc=1,ubound(pde,1)
126             layer(iproc, jproc) = elements%material(el\_id, jproc)
127 \textcolor{keywordflow}{        end do}
128 \textcolor{keywordflow}{      end do}
129 
130       cap_mat = 0
131       locmat = 0
132       limits = ubound(cap_mat,1)/ubound(pde,1)     
133       quadpnt%column = 2
134       quadpnt%element = el\_id
135       quadpnt%type\_pnt = \textcolor{stringliteral}{"gqnd"}
136       
137       
138       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(domain\_id)) \textcolor{keywordflow}{then}
139         quadpnt%ddlocal = .true.
140         quadpnt%subdom = domain\_id
141 \textcolor{keywordflow}{      end if}
142 
143 
144 
145       \textcolor{keywordflow}{do} iproc=1, ubound(pde,1)
146         \textcolor{keywordflow}{do} jproc=1, ubound(pde,1)
147           \textcolor{keywordflow}{do} l=1,  limits
148             \textcolor{keywordflow}{do} j=1,  limits
149               \textcolor{keywordflow}{do} i=1, ubound(gauss_points%weight,1)
150                 quadpnt%order = i
151                 tmp =  -pde(iproc)%pde\_fnc(jproc)%elasticity(pde(iproc),\textcolor{comment}{ layer(iproc, jproc), &}
152 \textcolor{comment}{                quadpnt)*base_fnc(j,i)*base_fnc(l,i)*gauss_points%weight(i)}
153 \textcolor{comment}{                ll = l + limits*(iproc-1)}
154 \textcolor{comment}{                jj = j + limits*(jproc-1)}
155 \textcolor{comment}{                cap_mat(ll,jj) = cap_mat(ll,jj) + tmp}
156 \textcolor{comment}{}\textcolor{keywordflow}{              end do}
157 \textcolor{keywordflow}{            end do}
158 \textcolor{keywordflow}{          end do}
159 \textcolor{keywordflow}{        end do}
160 \textcolor{keywordflow}{      end do}
161 
162       
163      \textcolor{keywordflow}{do} iproc = 1, ubound(pde,1)
164        \textcolor{keywordflow}{do} jproc = 1, ubound(pde,1) 
165          ll = limits*(iproc-1)+1
166          jj = limits*(jproc-1)+1
167         \textcolor{keyword}{call }diagonalizer(cap_mat(ll:ll+limits-1, jj:jj+limits-1))
168 \textcolor{keywordflow}{      end do}
169 \textcolor{keywordflow}{    end do}
170 
171 
172     
173      cap_mat = cap_mat/gauss_points%area*elements%areas(el\_id)
174      
175 
176      bside = bside +   matmul(cap_mat, elnode_prev)
177      
178      
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{namespacecapmat_adc9967ebf2be8d086371968c94553c2b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecapmat_adc9967ebf2be8d086371968c94553c2b_icgraph}
\end{center}
\end{figure}


\index{capmat@{capmat}!impl\+\_\+euler\+\_\+np\+\_\+nondiag@{impl\+\_\+euler\+\_\+np\+\_\+nondiag}}
\index{impl\+\_\+euler\+\_\+np\+\_\+nondiag@{impl\+\_\+euler\+\_\+np\+\_\+nondiag}!capmat@{capmat}}
\subsubsection[{impl\+\_\+euler\+\_\+np\+\_\+nondiag(el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public capmat\+::impl\+\_\+euler\+\_\+np\+\_\+nondiag (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in), optional}]{domain\+\_\+id, }
\item[{type({\bf integpnt\+\_\+str}), intent(inout), optional}]{quadpnt\+\_\+in}
\end{DoxyParamCaption}
)}\label{namespacecapmat_a3fabe2603f1c7a6fbd9c4afabc26f3ae}


implicit Euler for nonlinear problem and Picard iteration method, nondiagonal capacity matrix 

implicit Euler for nonlinear problem and Picard iteration method, diagonal capacity matrix steady state -\/$>$ the capacity matrix is a zero matrix routine that diagonalizes matrix -\/ it lumps consistent capacity matrices implicit euler method, nonlinear problem Picard iteration method -\/ non-\/diagonal capacity matrix


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em domain\+\_\+id} & subdomain number (inserted only if domain decomposition used and if only local data needed) \\
\hline
\end{DoxyParams}


Definition at line 20 of file capmat.\+f90.



References globals\+::base\+\_\+fnc, globals\+::bside, globals\+::cap\+\_\+mat, globals\+::elements, globals\+::elnode\+\_\+prev, globals\+::gauss\+\_\+points, and pde\+\_\+objs\+::pde.



Referenced by manage\+\_\+pointers\+::set\+\_\+pointers().


\begin{DoxyCode}
20       \textcolor{keywordtype}{use }typy
21       \textcolor{keywordtype}{use }globals
22       \textcolor{keywordtype}{use }global_objs
23       \textcolor{keywordtype}{use }pde_objs
24       \textcolor{keywordtype}{use }geom_tools
25       \textcolor{keywordtype}{use }feminittools
26       \textcolor{keywordtype}{use }linalg
27       \textcolor{keywordtype}{use }debug_tools
28 
29       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: el\_id
31       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: domain\_id
32       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in out)}, \textcolor{keywordtype}{optional} :: quadpnt\_in
33       
34       \textcolor{keywordtype}{integer(kind=ikind)} :: i,j,l, m
35       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
36       \textcolor{keywordtype}{integer(kind=ikind)} :: iproc, jproc, limits, ll, jj
37       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: layer
38       \textcolor{keywordtype}{type}(integpnt_str) :: quadpnt
39 
40 
41       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(layer)) \textcolor{keywordflow}{then}
42         \textcolor{keyword}{allocate}(layer(ubound(pde,1), ubound(pde,1)))
43 \textcolor{keywordflow}{      end if}
44 
45       \textcolor{keywordflow}{do} iproc=1,ubound(pde,1)
46         \textcolor{keywordflow}{do} jproc=1,ubound(pde,1)
47             layer(iproc, jproc) = elements%material(el\_id, jproc)
48 \textcolor{keywordflow}{        end do}
49 \textcolor{keywordflow}{      end do}
50 
51 
52       cap_mat = 0
53       
54       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt\_in)) \textcolor{keywordflow}{then}
55         quadpnt=quadpnt\_in
56 \textcolor{keywordflow}{      end if}
57 
58       limits = ubound(cap_mat,1)/ubound(pde,1)
59       quadpnt%column = 2
60       quadpnt%element = el\_id
61       quadpnt%type\_pnt = \textcolor{stringliteral}{"gqnd"}
62       
63       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(domain\_id)) \textcolor{keywordflow}{then}
64         quadpnt%ddlocal = .true.
65         quadpnt%subdom = domain\_id
66 \textcolor{keywordflow}{      end if}
67       
68 
69       \textcolor{keywordflow}{do} iproc=1, ubound(pde,1)
70         \textcolor{keywordflow}{do} jproc=1, ubound(pde,1)
71           \textcolor{keywordflow}{do} l=1,  limits
72             \textcolor{keywordflow}{do} j=1,  limits
73               \textcolor{keywordflow}{do} i=1, ubound(gauss_points%weight,1)
74                 quadpnt%order = i
75                 tmp =  -pde(iproc)%pde\_fnc(jproc)%elasticity(pde(iproc),\textcolor{comment}{ layer(iproc, jproc), &}
76 \textcolor{comment}{                quadpnt)*base_fnc(j,i)*base_fnc(l,i)*gauss_points%weight(i)}
77 \textcolor{comment}{                ll = l + limits*(iproc-1)}
78 \textcolor{comment}{                jj = j + limits*(jproc-1)}
79 \textcolor{comment}{                cap_mat(ll,jj) = cap_mat(ll,jj) + tmp}
80 \textcolor{comment}{}\textcolor{keywordflow}{              end do}
81 \textcolor{keywordflow}{            end do}
82 \textcolor{keywordflow}{          end do}
83 \textcolor{keywordflow}{        end do}
84 \textcolor{keywordflow}{      end do}
85 
86       
87       cap_mat = cap_mat/gauss_points%area*elements%areas(el\_id)
88 
89       bside =  bside + matmul(cap_mat, elnode_prev)
90       
91 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecapmat_a3fabe2603f1c7a6fbd9c4afabc26f3ae_icgraph}
\end{center}
\end{figure}


\index{capmat@{capmat}!steady\+\_\+state\+\_\+int@{steady\+\_\+state\+\_\+int}}
\index{steady\+\_\+state\+\_\+int@{steady\+\_\+state\+\_\+int}!capmat@{capmat}}
\subsubsection[{steady\+\_\+state\+\_\+int(el\+\_\+id, domain\+\_\+id, quadpnt\+\_\+in)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public capmat\+::steady\+\_\+state\+\_\+int (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in), optional}]{domain\+\_\+id, }
\item[{type({\bf integpnt\+\_\+str}), intent(inout), optional}]{quadpnt\+\_\+in}
\end{DoxyParamCaption}
)}\label{namespacecapmat_afecac6837e09fc605aebc33c4f516259}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em domain\+\_\+id} & subdomain number (inserted only if domain decomposition used and if only local data needed) \\
\hline
\end{DoxyParams}


Definition at line 182 of file capmat.\+f90.



References globals\+::cap\+\_\+mat.



Referenced by manage\+\_\+pointers\+::set\+\_\+pointers().


\begin{DoxyCode}
182       \textcolor{keywordtype}{use }typy
183       \textcolor{keywordtype}{use }globals
184       \textcolor{keywordtype}{use }global_objs
185       \textcolor{keywordtype}{use }geom_tools
186 
187       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: el\_id
189       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: domain\_id
190       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in out)}, \textcolor{keywordtype}{optional} :: quadpnt\_in
191 
192       cap_mat = 0
193 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecapmat_afecac6837e09fc605aebc33c4f516259_icgraph}
\end{center}
\end{figure}


