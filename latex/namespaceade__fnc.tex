\section{ade\+\_\+fnc Module Reference}
\label{namespaceade__fnc}\index{ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf adedispersion} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\item 
subroutine, public {\bf ade\+\_\+convection} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+tder\+\_\+coef} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+tder\+\_\+cscl} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+tder\+\_\+cscs} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+mass} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+reaction} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+zerorder} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf ade\+\_\+dirichlet} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf ade\+\_\+neumann} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf ade\+\_\+null\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf ade\+\_\+flux} (pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)
\item 
subroutine, public {\bf ade\+\_\+icond} (pde\+\_\+loc)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+cscs\+\_\+react} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf ade\+\_\+cscl\+\_\+react} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf ade\+\_\+csbc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf adecs\+\_\+icond} (pde\+\_\+loc)
\item 
real(kind=rkind) function, public {\bf adecs\+\_\+mass} (pde\+\_\+loc, layer, quadpnt, x)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+convection@{ade\+\_\+convection}}
\index{ade\+\_\+convection@{ade\+\_\+convection}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+convection(pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+convection (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{vector\+\_\+in, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{vector\+\_\+out, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_adaaa677e01020a0c331940dd9e9bdb73}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\mbox{\tt in}  & {\em vector\+\_\+in} & input vector\\
\hline
\mbox{\tt out}  & {\em vector\+\_\+out} & output vector\\
\hline
\mbox{\tt out}  & {\em scalar} & relative scalar value of the nonlinear function \\
\hline
\end{DoxyParams}


Definition at line 77 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
77       \textcolor{keywordtype}{use }typy
78       \textcolor{keywordtype}{use }global_objs
79       \textcolor{keywordtype}{use }pde_objs
80       \textcolor{keywordtype}{use }ade_globals
81       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
83       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
85       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
87       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
89       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: vector\_in
91       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: vector\_out
93       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}               :: scalar
94       
95       
96       \textcolor{keywordflow}{if} (pde\_loc%order == 1) \textcolor{keywordflow}{then}
97         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(vector\_out)) \textcolor{keywordflow}{then}
98           vector\_out = adepar(layer)%convection
99 \textcolor{keywordflow}{        end if}
100         
101         
102         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(scalar)) \textcolor{keywordflow}{then}
103           scalar = abs(adepar(layer)%convection)
104 \textcolor{keywordflow}{        end if}
105       \textcolor{keywordflow}{else}
106         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(vector\_out)) \textcolor{keywordflow}{then}
107           \textcolor{keyword}{call }pde(1)%flux(layer, quadpnt, vector\_out=vector\_out)
108 \textcolor{keywordflow}{        end if}
109         
110         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(scalar)) \textcolor{keywordflow}{then}
111           \textcolor{keyword}{call }pde(1)%flux(layer, quadpnt, scalar=scalar)
112 \textcolor{keywordflow}{        end if}
113         
114 \textcolor{keywordflow}{      end if}
115       
116       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_adaaa677e01020a0c331940dd9e9bdb73_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+csbc@{ade\+\_\+csbc}}
\index{ade\+\_\+csbc@{ade\+\_\+csbc}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+csbc(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+csbc (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_aa964a237d991a84b7a0d3d07be25261a}


Definition at line 645 of file A\+D\+E\+\_\+fnc.\+f90.


\begin{DoxyCode}
645       \textcolor{keywordtype}{use }typy
646       \textcolor{keywordtype}{use }globals
647       \textcolor{keywordtype}{use }global_objs
648       \textcolor{keywordtype}{use }pde_objs
649       \textcolor{keywordtype}{use }debug_tools
650       
651       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
652       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
653       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
654       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
655       
656       \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j, proc
657       \textcolor{keywordtype}{real(kind=rkind)} :: tempval
658 
659      
660       
661       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
662         \textcolor{keywordtype}{value} = 0.0
663 \textcolor{keywordflow}{      end if}
664 
665 
666       
667       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
668         code = 0
669 \textcolor{keywordflow}{      end if}
670       
671 
\end{DoxyCode}
\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+cscl\+\_\+react@{ade\+\_\+cscl\+\_\+react}}
\index{ade\+\_\+cscl\+\_\+react@{ade\+\_\+cscl\+\_\+react}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+cscl\+\_\+react(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+cscl\+\_\+react (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a2c71f7220b5c27a9e33e744121d90c5f}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 608 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
608       \textcolor{keywordtype}{use }typy
609       \textcolor{keywordtype}{use }global_objs
610       \textcolor{keywordtype}{use }pde_objs
611       \textcolor{keywordtype}{use }ade_globals
612       
613       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
615       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
617       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
619       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
621       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
622       
623       \textcolor{keywordtype}{integer(kind=ikind)} :: proc\_cl
624       \textcolor{keywordtype}{real(kind=rkind)} :: cl 
625       
626 
627       
628       \textcolor{keywordflow}{select case}(adepar(layer)%sorption%name)
629         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"langmu"})
630           val = adepar(layer)%sorption%adsorb*adepar(layer)%sorption%third
631         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"freund"})
632           \textcolor{keywordflow}{if} (abs(adepar(layer)%sorption%third - 1.0\_rkind ) > 10*epsilon(1.0\_rkind\textcolor{comment}{)) }\textcolor{keywordflow}{then}
633             proc\_cl = pde\_loc%order - 1
634             cl = pde(proc\_cl)%getval(quadpnt)
635             val = adepar(layer)%sorption%adsorb*cl**(1-adepar(layer)%sorption%third\textcolor{comment}{)}
636 \textcolor{comment}{          }\textcolor{keywordflow}{else}
637             val = adepar(layer)%sorption%adsorb
638 \textcolor{keywordflow}{          end if}
639 \textcolor{keywordflow}{      end select}
640       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a2c71f7220b5c27a9e33e744121d90c5f_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+cscs\+\_\+react@{ade\+\_\+cscs\+\_\+react}}
\index{ade\+\_\+cscs\+\_\+react@{ade\+\_\+cscs\+\_\+react}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+cscs\+\_\+react(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+cscs\+\_\+react (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_afb034eeab56e8c889cd9adae76cf038c}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 574 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
574       \textcolor{keywordtype}{use }typy
575       \textcolor{keywordtype}{use }global_objs
576       \textcolor{keywordtype}{use }pde_objs
577       \textcolor{keywordtype}{use }ade_globals
578       
579       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
581       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
583       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
585       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
587       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
588       
589       \textcolor{keywordtype}{integer(kind=ikind)} :: proc\_cl
590       \textcolor{keywordtype}{real(kind=rkind)} :: cs, cl
591       
592       proc\_cl = pde\_loc%order - 1
593       
594       
595       \textcolor{keywordflow}{select case}(adepar(layer)%sorption%name)
596         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"langmu"})
597           cs = pde\_loc%getval(quadpnt) 
598           cl = pde(proc\_cl)%getval(quadpnt)
599           val = -adepar(layer)%sorption%adsorb*cl - adepar(layer)%sorption%desorb
600         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"freund"})
601           val = -adepar(layer)%sorption%desorb
602 \textcolor{keywordflow}{      end select}
603       
604       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_afb034eeab56e8c889cd9adae76cf038c_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+dirichlet@{ade\+\_\+dirichlet}}
\index{ade\+\_\+dirichlet@{ade\+\_\+dirichlet}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+dirichlet(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+dirichlet (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a5b91d20870b339e174fbd7c2e8bec184}


Definition at line 347 of file A\+D\+E\+\_\+fnc.\+f90.



References globals\+::elements, globals\+::nodes, and globals\+::time.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
347       \textcolor{keywordtype}{use }typy
348       \textcolor{keywordtype}{use }globals
349       \textcolor{keywordtype}{use }global_objs
350       \textcolor{keywordtype}{use }pde_objs
351       \textcolor{keywordtype}{use }debug_tools
352       
353       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
354       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
355       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
356       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
357       
358       \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j, proc
359       \textcolor{keywordtype}{real(kind=rkind)} :: tempval
360       
361       edge\_id = nodes%edge(elements%data(el\_id, node\_order))
362       
363       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
364         \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%file) \textcolor{keywordflow}{then}
365           \textcolor{keywordflow}{do} i=1, ubound(pde\_loc%bc(edge\_id)%series,1)
366             \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%series(i,1) > time) \textcolor{keywordflow}{then}
367               \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
368                 j = i-1
369               \textcolor{keywordflow}{else}
370                 j = i
371 \textcolor{keywordflow}{              end if}
372               tempval = pde\_loc%bc(edge\_id)%series(j,2)
373               \textcolor{keywordflow}{EXIT}
374 \textcolor{keywordflow}{            end if}
375 \textcolor{keywordflow}{          end do}
376         \textcolor{keywordflow}{else}
377           tempval =  pde\_loc%bc(edge\_id)%value
378 \textcolor{keywordflow}{        end if}
379         \textcolor{keywordtype}{value} = tempval 
380 \textcolor{keywordflow}{      end if}
381 
382 
383       
384       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
385         code = 1
386 \textcolor{keywordflow}{      end if}
387       
388 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a5b91d20870b339e174fbd7c2e8bec184_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+flux@{ade\+\_\+flux}}
\index{ade\+\_\+flux@{ade\+\_\+flux}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+flux(pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+flux (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{grad, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{flux, }
\item[{real(kind=rkind), intent(out), optional}]{flux\+\_\+length}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_aede22f790dd20203b407c41d5f4d6c7d}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em grad} & this value is optional, because it is required by the vector\+\_\+fnc procedure pointer global definition \\
\hline
\end{DoxyParams}


Definition at line 461 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
461       \textcolor{keywordtype}{use }typy
462       \textcolor{keywordtype}{use }pde_objs
463       \textcolor{keywordtype}{use }global_objs
464       \textcolor{keywordtype}{use }debug_tools
465       \textcolor{keywordtype}{use }ade_globals
466        
467       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
468       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}                          :: layer
469       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt    
470       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional}              \textcolor{comment}{     :: x}
472       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}     :: grad
473       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: flux
474       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}                  :: flux\_length
475     
476       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save}  :: dhm
477       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: q\_w, gradc
478       \textcolor{keywordtype}{real(kind=rkind)} :: c, cmax
479       
480       
481       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. (\textcolor{keyword}{present}(grad) .or. \textcolor{keyword}{present}(x))) \textcolor{keywordflow}{then}
482         print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition and
       gradient, not both of them"}
483         print *, \textcolor{stringliteral}{"exited from ADE\_fnc::ADE\_flux"}
484         error stop
485       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((.not. \textcolor{keyword}{present}(grad) .or. .not. \textcolor{keyword}{present}(x)) .and. .not. \textcolor{keyword}{present}\textcolor{comment}{(quadpnt)) }\textcolor{keywordflow}{then}
486         print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
487         print *, \textcolor{stringliteral}{"exited from ADE\_fnc::ADE\_flux"}
488         error stop
489 \textcolor{keywordflow}{      end if}
490       
491       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(q\_w)) \textcolor{keyword}{allocate}(q\_w(drutes_config%dimen))
492 
493       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(gradc)) \textcolor{keyword}{allocate}(gradc(drutes_config%dimen))
494       
495       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(dhm)) \textcolor{keyword}{allocate}(dhm(drutes_config%dimen, drutes_config%dimen\textcolor{comment}{))}
496 \textcolor{comment}{      }
497 \textcolor{comment}{      }\textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
498         c = pde\_loc%getval(quadpnt)
499         \textcolor{keyword}{call }pde\_loc%getgrad(quadpnt, gradc)
500       \textcolor{keywordflow}{else}
501         \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
502           print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
503           print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
504           print *, \textcolor{stringliteral}{"exited from ADE\_fnc::ADE\_flux"}
505           error stop
506 \textcolor{keywordflow}{        end if}
507         c = x(1)
508         gradc = grad
509 \textcolor{keywordflow}{      end if}
510       
511       
512       \textcolor{keyword}{call }pde\_loc%pde\_fnc(1)%dispersion(pde\_loc, layer, quadpnt, tensor\textcolor{comment}{=dhm)}
513 \textcolor{comment}{      }
514 \textcolor{comment}{      }\textcolor{keywordflow}{select case}(pde\_loc%order)
515         \textcolor{keywordflow}{case}(1)
516           q\_w = adepar(layer)%convection
517         \textcolor{keywordflow}{case}(2)
518           \textcolor{keyword}{call }pde(1)%flux(layer, quadpnt, vector\_out=q\_w)
519 \textcolor{keywordflow}{      end select}
520       
521       \textcolor{keywordflow}{select case}(adepar(layer)%icondtype)
522         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ca"})
523           cmax = 1.0\_rkind
524          \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"cr"})
525           cmax = adepar(layer)%cmax
526 \textcolor{keywordflow}{      end select}
527       
528       
529       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(flux)) \textcolor{keywordflow}{then}
530         flux = cmax*matmul(dhm, gradc) + cmax*q\_w*c
531 \textcolor{keywordflow}{      end if}
532     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_aede22f790dd20203b407c41d5f4d6c7d_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+icond@{ade\+\_\+icond}}
\index{ade\+\_\+icond@{ade\+\_\+icond}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+icond(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+icond (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a114f89bc8bfdca6b691d3e4afd2a7da7}


Definition at line 536 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, globals\+::drutes\+\_\+config, globals\+::elements, and globals\+::nodes.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
536       \textcolor{keywordtype}{use }typy
537       \textcolor{keywordtype}{use }globals
538       \textcolor{keywordtype}{use }global_objs
539       \textcolor{keywordtype}{use }pde_objs
540       \textcolor{keywordtype}{use }ade_globals
541 
542       
543       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
544       \textcolor{keywordtype}{integer(kind=ikind)} :: i, j, k,l, m, layer, d
545       \textcolor{keywordtype}{real(kind=rkind)} :: value
546       
547    
548       d = drutes_config%dimen
549       \textcolor{keywordflow}{do} i=1, elements%kolik
550         layer = elements%material(i,1)
551         \textcolor{keywordflow}{do} j=1, ubound(elements%data,2)
552           k = elements%data(i,j)
553           l = nodes%edge(k)
554           m = pde\_loc%permut(k)
555           \textcolor{keywordflow}{if} (m == 0) \textcolor{keywordflow}{then}
556             \textcolor{keyword}{call }pde\_loc%bc(l)%value\_fnc(pde\_loc, i, j, \textcolor{keywordtype}{value})
557             pde\_loc%solution(k) =  \textcolor{keywordtype}{value} 
558           \textcolor{keywordflow}{else}
559             \textcolor{keywordflow}{select case} (adepar(layer)%icondtype)
560               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ca"})
561                 pde\_loc%solution(k) = adepar(layer)%cinit
562               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"cr"})
563                 pde\_loc%solution(k) = adepar(layer)%cinit * adepar(layer)%cmax
564 \textcolor{keywordflow}{            end select}
565 \textcolor{keywordflow}{          end if}
566 \textcolor{keywordflow}{        end do}   
567 \textcolor{keywordflow}{      end do}
568 
569     
570     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a114f89bc8bfdca6b691d3e4afd2a7da7_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+mass@{ade\+\_\+mass}}
\index{ade\+\_\+mass@{ade\+\_\+mass}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+mass(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+mass (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_aa49487b68d46e5b95eef39bdb1ed4077}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 233 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
233       \textcolor{keywordtype}{use }typy
234       \textcolor{keywordtype}{use }global_objs
235       \textcolor{keywordtype}{use }pde_objs
236       \textcolor{keywordtype}{use }ade_globals
237       
238       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
240       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
242       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
244       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
246       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
247       \textcolor{keywordtype}{real(kind=rkind)}                :: theta
248       
249       \textcolor{keywordflow}{if} (pde\_loc%order == 1) \textcolor{keywordflow}{then}
250         theta = adepar(layer)%water\_cont
251       \textcolor{keywordflow}{else}
252         theta = pde(1)%mass(layer, quadpnt)
253 \textcolor{keywordflow}{      end if}
254       
255       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
256         val = theta*pde\_loc%getval(quadpnt)
257       \textcolor{keywordflow}{else}
258         val = theta * x(1)
259 \textcolor{keywordflow}{      end if}
260       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_aa49487b68d46e5b95eef39bdb1ed4077_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+neumann@{ade\+\_\+neumann}}
\index{ade\+\_\+neumann@{ade\+\_\+neumann}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+neumann(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+neumann (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_ae9d3681beeaa8b72726418a2b999aa44}


Definition at line 393 of file A\+D\+E\+\_\+fnc.\+f90.



References globals\+::elements, globals\+::nodes, and globals\+::time.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
393       \textcolor{keywordtype}{use }typy
394       \textcolor{keywordtype}{use }globals
395       \textcolor{keywordtype}{use }global_objs
396       \textcolor{keywordtype}{use }pde_objs
397       \textcolor{keywordtype}{use }debug_tools
398       
399       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
400       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
401       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
402       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
403       
404       \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j, proc
405       \textcolor{keywordtype}{real(kind=rkind)} :: tempval
406       
407       edge\_id = nodes%edge(elements%data(el\_id, node\_order))
408       
409       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
410         \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%file) \textcolor{keywordflow}{then}
411           \textcolor{keywordflow}{do} i=1, ubound(pde\_loc%bc(edge\_id)%series,1)
412             \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%series(i,1) > time) \textcolor{keywordflow}{then}
413               \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
414                 j = i-1
415               \textcolor{keywordflow}{else}
416                 j = i
417 \textcolor{keywordflow}{              end if}
418               tempval = pde\_loc%bc(edge\_id)%series(j,2)
419               \textcolor{keywordflow}{EXIT}
420 \textcolor{keywordflow}{            end if}
421 \textcolor{keywordflow}{          end do}
422         \textcolor{keywordflow}{else}
423           tempval =  pde\_loc%bc(edge\_id)%value
424 \textcolor{keywordflow}{        end if}
425         \textcolor{keywordtype}{value} = tempval 
426 \textcolor{keywordflow}{      end if}
427 
428 
429       
430       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
431         code = 2
432 \textcolor{keywordflow}{      end if}
433       
434 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_ae9d3681beeaa8b72726418a2b999aa44_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+null\+\_\+bc@{ade\+\_\+null\+\_\+bc}}
\index{ade\+\_\+null\+\_\+bc@{ade\+\_\+null\+\_\+bc}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+null\+\_\+bc(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::ade\+\_\+null\+\_\+bc (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a0b4f8cc5e0aff6715d720149a3f4529d}


Definition at line 439 of file A\+D\+E\+\_\+fnc.\+f90.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
439       \textcolor{keywordtype}{use }typy
440       \textcolor{keywordtype}{use }globals
441       \textcolor{keywordtype}{use }global_objs
442       \textcolor{keywordtype}{use }pde_objs
443       
444       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
445       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
446       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
447       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
448 
449       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
450         \textcolor{keywordtype}{value} = 0.0\_rkind
451 \textcolor{keywordflow}{      end if}
452 
453       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
454         code = 2
455 \textcolor{keywordflow}{      end if}
456         
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a0b4f8cc5e0aff6715d720149a3f4529d_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+reaction@{ade\+\_\+reaction}}
\index{ade\+\_\+reaction@{ade\+\_\+reaction}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+reaction(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+reaction (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a68093fda9691ff2d4e6095af69b410f3}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 264 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
264       \textcolor{keywordtype}{use }typy
265       \textcolor{keywordtype}{use }global_objs
266       \textcolor{keywordtype}{use }pde_objs
267       \textcolor{keywordtype}{use }ade_globals
268       
269       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
271       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
273       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
275       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
277       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
278       
279       \textcolor{keywordtype}{integer(kind=ikind)} :: n, i
280       \textcolor{keywordtype}{real(kind=rkind)} :: theta, cl
281       
282      
283       \textcolor{keywordflow}{if} (pde\_loc%order == 2) \textcolor{keywordflow}{then}
284         theta = pde(1)%mass(layer, quadpnt)
285       \textcolor{keywordflow}{else}
286         theta = adepar(layer)%water\_cont
287 \textcolor{keywordflow}{      end if}
288       
289       val = 0.0\_rkind
290       
291       \textcolor{keywordflow}{do} i=1, ubound(adepar(layer)%orders,1)
292         n = 10
293         \textcolor{keywordflow}{if} (abs(adepar(layer)%orders(i) - 1.0\_rkind) < 100*epsilon(1.0\_rkind)) n\textcolor{comment}{ = 1}
294 \textcolor{comment}{        }\textcolor{keywordflow}{if} (abs(adepar(layer)%orders(i)) < 100*epsilon(1.0\_rkind)) n = 0
295         \textcolor{keywordflow}{select case}(n)
296           \textcolor{keywordflow}{case}(0)
297             \textcolor{keywordflow}{CONTINUE}
298           \textcolor{keywordflow}{case}(1)
299             val = val + theta*adepar(layer)%lambda(i)
300 \textcolor{keywordflow}{          case default}
301             cl = pde\_loc%getval(quadpnt)
302             val = theta*adepar(layer)%lambda(i)*cl**(adepar(layer)%orders(i)-1)
303 \textcolor{keywordflow}{        end select}
304 \textcolor{keywordflow}{      end do}
305         
306           
307       
308       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a68093fda9691ff2d4e6095af69b410f3_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+tder\+\_\+coef@{ade\+\_\+tder\+\_\+coef}}
\index{ade\+\_\+tder\+\_\+coef@{ade\+\_\+tder\+\_\+coef}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+tder\+\_\+coef(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+tder\+\_\+coef (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a9955421b18edc5044b7fbe483890ff0a}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 121 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
121       \textcolor{keywordtype}{use }typy
122       \textcolor{keywordtype}{use }global_objs
123       \textcolor{keywordtype}{use }pde_objs
124       \textcolor{keywordtype}{use }ade_globals
125       
126       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
128       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
130       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
132       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
134       \textcolor{keywordtype}{real(kind=rkind)}                :: val
135       
136       \textcolor{keywordtype}{real(kind=rkind)} :: theta, n, ka, kd, csmax, cl
137       
138       
139       \textcolor{keywordflow}{if} (pde\_loc%order == 2) \textcolor{keywordflow}{then}
140         theta = pde(1)%mass(layer, quadpnt)
141       \textcolor{keywordflow}{else}
142         theta = adepar(layer)%water\_cont
143 \textcolor{keywordflow}{      end if}
144       
145       
146       \textcolor{keywordflow}{if} (.not. adepar(layer)%sorption%kinetic) \textcolor{keywordflow}{then}
147         ka = adepar(layer)%sorption%adsorb
148         kd = adepar(layer)%sorption%desorb
149         \textcolor{keywordflow}{if} (ka > 10*epsilon(ka) .and. kd > 10*epsilon(kd)) \textcolor{keywordflow}{then} 
150           \textcolor{keywordflow}{select case}(adepar(layer)%sorption%name)
151             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"freund"})
152               n = adepar(layer)%sorption%third
153               \textcolor{keywordflow}{if} (abs(n-1.0\_rkind)>10*epsilon(n)) \textcolor{keywordflow}{then}
154                 cl = pde\_loc%getval(quadpnt)
155                 val = theta+(1-theta)*ka/kd*adepar(layer)%bd*cl**(n-1)
156               \textcolor{keywordflow}{else}
157                 val = theta+(1-theta)*ka/kd*adepar(layer)%bd
158 \textcolor{keywordflow}{              end if}
159             
160             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"langmu"})
161               cl = pde\_loc%getval(quadpnt)
162               csmax = adepar(layer)%sorption%third
163               val = theta + (1-theta)*adepar(layer)%bd*(ka*csmax)/(kd+ka*cl)
164 \textcolor{keywordflow}{            case default}
165               print *, \textcolor{stringliteral}{"unsupported sorption type, runtime error, called from ADE\_fnc::ADE\_tder\_coef"}
166               error stop
167             
168 \textcolor{keywordflow}{          end select}
169         \textcolor{keywordflow}{else}
170           val = theta
171 \textcolor{keywordflow}{        end if}
172         
173       \textcolor{keywordflow}{else}
174         val = theta
175 \textcolor{keywordflow}{      end if}
176      
177       
178     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a9955421b18edc5044b7fbe483890ff0a_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+tder\+\_\+cscl@{ade\+\_\+tder\+\_\+cscl}}
\index{ade\+\_\+tder\+\_\+cscl@{ade\+\_\+tder\+\_\+cscl}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+tder\+\_\+cscl(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+tder\+\_\+cscl (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_afeaf3d25774abb287c3e3fc98b54b83a}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 183 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
183       \textcolor{keywordtype}{use }typy
184       \textcolor{keywordtype}{use }global_objs
185       \textcolor{keywordtype}{use }pde_objs
186       \textcolor{keywordtype}{use }ade_globals
187       
188       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
190       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
192       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
194       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
196       \textcolor{keywordtype}{real(kind=rkind)}                :: val
197       
198       \textcolor{keywordtype}{real(kind=rkind)} :: theta
199       
200       \textcolor{keywordflow}{if} (pde\_loc%order == 2) \textcolor{keywordflow}{then}
201         theta = pde(1)%mass(layer, quadpnt)
202       \textcolor{keywordflow}{else}
203         theta = adepar(layer)%water\_cont
204 \textcolor{keywordflow}{      end if}
205       
206       val = 1.0\_rkind-theta
207       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_afeaf3d25774abb287c3e3fc98b54b83a_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+tder\+\_\+cscs@{ade\+\_\+tder\+\_\+cscs}}
\index{ade\+\_\+tder\+\_\+cscs@{ade\+\_\+tder\+\_\+cscs}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+tder\+\_\+cscs(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+tder\+\_\+cscs (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a22f1baa0530346804607e15b6555855c}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 212 of file A\+D\+E\+\_\+fnc.\+f90.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
212       \textcolor{keywordtype}{use }typy
213       \textcolor{keywordtype}{use }global_objs
214       \textcolor{keywordtype}{use }pde_objs
215       \textcolor{keywordtype}{use }ade_globals
216       
217       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
219       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
221       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
223       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
225       \textcolor{keywordtype}{real(kind=rkind)}                :: val
226       
227       val = 1.0\_rkind
228     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a22f1baa0530346804607e15b6555855c_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!ade\+\_\+zerorder@{ade\+\_\+zerorder}}
\index{ade\+\_\+zerorder@{ade\+\_\+zerorder}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{ade\+\_\+zerorder(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::ade\+\_\+zerorder (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a2f3a5b22f5274dfbe645210420ce09aa}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 312 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
312       \textcolor{keywordtype}{use }typy
313       \textcolor{keywordtype}{use }global_objs
314       \textcolor{keywordtype}{use }pde_objs
315       \textcolor{keywordtype}{use }ade_globals
316       
317       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
319       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
321       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
323       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
325       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
326       
327       \textcolor{keywordtype}{integer(kind=ikind)} :: n, i
328       \textcolor{keywordtype}{real(kind=rkind)} :: theta
329       
330       \textcolor{keywordflow}{if} (pde\_loc%order == 2) \textcolor{keywordflow}{then}
331         theta = pde(1)%mass(layer, quadpnt)
332       \textcolor{keywordflow}{else}
333         theta = adepar(layer)%water\_cont
334 \textcolor{keywordflow}{      end if}
335       
336        val = 0.0\_rkind
337        \textcolor{keywordflow}{do} i=1, ubound(adepar(layer)%orders,1)
338         \textcolor{keywordflow}{if} (abs(adepar(layer)%orders(i)) < 100*epsilon(1.0\_rkind)) \textcolor{keywordflow}{then}
339           val =  val + theta*adepar(layer)%lambda(i)
340 \textcolor{keywordflow}{        end if}
341 \textcolor{keywordflow}{      end do}
342       
343       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a2f3a5b22f5274dfbe645210420ce09aa_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!adecs\+\_\+icond@{adecs\+\_\+icond}}
\index{adecs\+\_\+icond@{adecs\+\_\+icond}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{adecs\+\_\+icond(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::adecs\+\_\+icond (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a1ee351b59b533ac309638b109669dd06}


Definition at line 675 of file A\+D\+E\+\_\+fnc.\+f90.



Referenced by ade\+\_\+pointers\+::adekinsorb().


\begin{DoxyCode}
675       \textcolor{keywordtype}{use }typy
676       \textcolor{keywordtype}{use }pde_objs
677 
678       
679       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
680       
681       pde\_loc%solution = 0.0\_rkind
682     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a1ee351b59b533ac309638b109669dd06_icgraph}
\end{center}
\end{figure}


\index{ade\+\_\+fnc@{ade\+\_\+fnc}!adecs\+\_\+mass@{adecs\+\_\+mass}}
\index{adecs\+\_\+mass@{adecs\+\_\+mass}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{adecs\+\_\+mass(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public ade\+\_\+fnc\+::adecs\+\_\+mass (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a8838abef4e08fe8b063e441aa18708d4}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 687 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, and pde\+\_\+objs\+::pde.


\begin{DoxyCode}
687       \textcolor{keywordtype}{use }typy
688       \textcolor{keywordtype}{use }global_objs
689       \textcolor{keywordtype}{use }pde_objs
690       \textcolor{keywordtype}{use }ade_globals
691       
692       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
694       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
696       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
698       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
700       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
701       \textcolor{keywordtype}{real(kind=rkind)}                :: theta
702       
703       \textcolor{keywordflow}{if} (pde\_loc%order == 2) \textcolor{keywordflow}{then}
704         theta = adepar(layer)%water\_cont
705       \textcolor{keywordflow}{else} 
706         theta = pde(1)%mass(layer, quadpnt)
707 \textcolor{keywordflow}{      end if}
708       
709       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
710         val = pde\_loc%getval(quadpnt)*(1-theta)
711       \textcolor{keywordflow}{else}
712         print *, \textcolor{stringliteral}{"exited from ADE\_fnc::ADEcs\_mass"}
713         error stop
714 \textcolor{keywordflow}{      end if}
715     
\end{DoxyCode}
\index{ade\+\_\+fnc@{ade\+\_\+fnc}!adedispersion@{adedispersion}}
\index{adedispersion@{adedispersion}!ade\+\_\+fnc@{ade\+\_\+fnc}}
\subsubsection[{adedispersion(pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public ade\+\_\+fnc\+::adedispersion (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:,\+:), intent(out), optional}]{tensor, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceade__fnc_a41110eb40a739c1a15d966c122ab3b8b}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\mbox{\tt out}  & {\em tensor} & return tensor\\
\hline
\mbox{\tt out}  & {\em scalar} & relative scalar value of the nonlinear function \\
\hline
\end{DoxyParams}


Definition at line 13 of file A\+D\+E\+\_\+fnc.\+f90.



References ade\+\_\+globals\+::adepar, globals\+::drutes\+\_\+config, pde\+\_\+objs\+::pde, and re\+\_\+globals\+::vgset.



Referenced by ade\+\_\+pointers\+::ade().


\begin{DoxyCode}
13       \textcolor{keywordtype}{use }typy
14       \textcolor{keywordtype}{use }global_objs
15       \textcolor{keywordtype}{use }pde_objs
16       \textcolor{keywordtype}{use }globals
17       \textcolor{keywordtype}{use }ade_globals
18       \textcolor{keywordtype}{use }re_globals
19       \textcolor{keywordtype}{use }debug_tools
20       
21       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
23       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
25       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
27       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
29       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: tensor
31       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}                 :: scalar
32       
33       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3,3)} :: identity
34       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: q\_w
35       \textcolor{keywordtype}{real(kind=rkind)} :: theta, q\_abs, tortuo, ths
36       \textcolor{keywordtype}{integer(kind=ikind)} :: d, i
37       
38      
39       d = drutes_config%dimen
40       identity = 0.0
41       \textcolor{keywordflow}{do} i=1, d
42         identity(i,i) = 1.0
43 \textcolor{keywordflow}{      end do}
44       
45       \textcolor{keywordflow}{select case}(drutes_config%name)
46         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ADEstd"}, \textcolor{stringliteral}{"ADEstd\_kinsorb"})
47           q\_w = adepar(layer)%convection
48           theta = adepar(layer)%water\_cont
49           ths = adepar(layer)%water\_cont
50 \textcolor{keywordflow}{        case default}
51           theta = pde(1)%mass(layer, quadpnt)
52           \textcolor{keyword}{call }pde(1)%flux(layer, quadpnt, vector\_out = q\_w(1:d))
53           ths = vgset(layer)%ths
54 \textcolor{keywordflow}{      end select}
55       
56 
57       q\_abs = 0.0
58       \textcolor{keywordflow}{do} i=1, d
59         q\_abs =q\_abs + q\_w(i)*q\_w(i)
60 \textcolor{keywordflow}{      end do}
61       q\_abs = sqrt(q\_abs)
62       tortuo = theta**(10.0/3.0)/(ths*ths)
63       
64       
65       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tensor)) \textcolor{keywordflow}{then}
66         tensor = theta * (adepar(layer)%diff*q\_abs + adepar(layer)%difmol*identity\textcolor{comment}{(1:d, 1:d))   }
67 \textcolor{comment}{}\textcolor{keywordflow}{      end if}
68       
69 
70       
71       
72     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceade__fnc_a41110eb40a739c1a15d966c122ab3b8b_icgraph}
\end{center}
\end{figure}


