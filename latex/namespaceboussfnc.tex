\section{boussfnc Module Reference}
\label{namespaceboussfnc}\index{boussfnc@{boussfnc}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(kind=rkind) function, public {\bf bouss\+\_\+elast} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf bouss\+\_\+cond} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\item 
subroutine, public {\bf bouss\+\_\+adv} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\item 
real(kind=rkind) function, public {\bf boussreact} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf darcy4bouss} (pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)
\item 
subroutine, public {\bf boussicond} (pde\+\_\+loc)
\item 
subroutine, public {\bf bouss\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{boussfnc@{boussfnc}!bouss\+\_\+adv@{bouss\+\_\+adv}}
\index{bouss\+\_\+adv@{bouss\+\_\+adv}!boussfnc@{boussfnc}}
\subsubsection[{bouss\+\_\+adv(pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public boussfnc\+::bouss\+\_\+adv (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{vector\+\_\+in, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{vector\+\_\+out, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_a523c691f2d5d7b1448f21c108d496392}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & pressure head\\
\hline
\mbox{\tt in}  & {\em vector\+\_\+in} & this argument is required by the global vector\+\_\+fnc procedure pointer, unused in this procedure\\
\hline
\mbox{\tt out}  & {\em scalar} & relative unsaturated hydraulic conductivity derivative in respect to h, scalar value \\
\hline
\end{DoxyParams}


Definition at line 155 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+rain, boussglob\+::bouss\+\_\+slopes, geom\+\_\+tools\+::getcoor(), and globals\+::time.



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
155         \textcolor{keywordtype}{use }typy
156         \textcolor{keywordtype}{use }globals
157         \textcolor{keywordtype}{use }boussglob
158         \textcolor{keywordtype}{use }pde_objs
159         \textcolor{keywordtype}{use }geom_tools
160         \textcolor{keywordtype}{use }global_objs
161         \textcolor{keywordtype}{use }debug_tools
162 
163         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
164         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
165         \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt    
167         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: x
169         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: vector\_in
173         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: vector\_out
175         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: scalar
176         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1)} :: coord
177         \textcolor{keywordtype}{real(kind=rkind)} :: rain, h, slope
178         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1,1)} :: k
179         \textcolor{keywordtype}{integer(kind=ikind)} :: i
180 
181 
182         
183         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
184           print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition, not
       both of them"}
185           print *, \textcolor{stringliteral}{"exited from re\_constitutive::dmualem\_dh"}
186           error stop
187         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(quadpnt) .and. .not. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
188           print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
189           print *, \textcolor{stringliteral}{"exited from re\_constitutive::dmualem\_dh"}
190           error stop
191 \textcolor{keywordflow}{        end if}
192         
193         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
194           h = pde\_loc%getval(quadpnt)
195         \textcolor{keywordflow}{else}
196           \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
197             print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
198             print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
199             print *, \textcolor{stringliteral}{"exited from re\_constitutive::dmualem\_dh"}
200             error stop
201 \textcolor{keywordflow}{          end if}
202           h = x(1)
203 \textcolor{keywordflow}{        end if}
204         
205         
206         
207         
208         \textcolor{keywordflow}{do} i=1, ubound(bouss_rain,1)-1
209           \textcolor{keywordflow}{if} (i == 1 .and. time < bouss_rain(1)%data(i)) \textcolor{keywordflow}{then}
210             rain = bouss_rain(2)%data(i) 
211 \textcolor{keywordflow}{          end if}
212           \textcolor{keywordflow}{if} (bouss_rain(1)%data(i) <= time .and. bouss_rain(1)%data(i+1) > time) \textcolor{keywordflow}{then}
213             rain = bouss_rain(2)%data(i) 
214             \textcolor{keywordflow}{EXIT}
215 \textcolor{keywordflow}{          end if}
216           \textcolor{keywordflow}{if} (i == bouss_rain(1)%pos - 1 .and. time >= bouss_rain(1)%data(i+1)) \textcolor{keywordflow}{then}
217             rain = bouss_rain(2)%data(i+1)
218 \textcolor{keywordflow}{          end if}
219 \textcolor{keywordflow}{        end do}
220         
221         
222         \textcolor{keyword}{call }getcoor(quadpnt, coord)
223         
224         \textcolor{keywordflow}{do} i=1, bouss_slopes(1)%pos - 1
225           \textcolor{keywordflow}{if} (coord(1) >= bouss_slopes(1)%data(i) .and. coord(1) < bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
226             slope = bouss_slopes(2)%data(i)
227             \textcolor{keywordflow}{EXIT}
228 \textcolor{keywordflow}{          end if}
229           \textcolor{keywordflow}{if} (i == bouss_slopes(1)%pos - 1 .and. coord(1) >= bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
230             slope = bouss_slopes(2)%data(i+1)
231 \textcolor{keywordflow}{          end if}
232 \textcolor{keywordflow}{        end do}
233         
234         \textcolor{keyword}{call }pde\_loc%pde\_fnc(1)%dispersion(pde\_loc, layer, quadpnt, tensor=k)
235 
236         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(vector\_out)) \textcolor{keywordflow}{then}
237           \textcolor{comment}{! must be negative, because the commnon scheme of the CDE problem has negative convection, but RE
       has positive convection}
238           vector\_out = -(rain*slope - slope*k(1,1))
239 \textcolor{keywordflow}{        end if}
240 
241 \textcolor{comment}{! print *, vector\_out, rain, slope ; stop}
242 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a523c691f2d5d7b1448f21c108d496392_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a523c691f2d5d7b1448f21c108d496392_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!bouss\+\_\+bc@{bouss\+\_\+bc}}
\index{bouss\+\_\+bc@{bouss\+\_\+bc}!boussfnc@{boussfnc}}
\subsubsection[{bouss\+\_\+bc(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public boussfnc\+::bouss\+\_\+bc (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_a664047715b553e05dbdc2d14b481e6fa}


Definition at line 408 of file boussfnc.\+f90.



References globals\+::elements, globals\+::nodes, and globals\+::time.



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
408         \textcolor{keywordtype}{use }typy
409         \textcolor{keywordtype}{use }globals
410         \textcolor{keywordtype}{use }global_objs
411         \textcolor{keywordtype}{use }pde_objs
412         \textcolor{keywordtype}{use }geom_tools
413 
414         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
415         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
416         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}   :: value
417         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
418         
419         \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j
420         
421         edge\_id = nodes%edge(elements%data(el\_id, node\_order))
422         
423         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
424           \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%file) \textcolor{keywordflow}{then}
425             \textcolor{keywordflow}{do} i=1, ubound(pde\_loc%bc(edge\_id)%series,1)
426               \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%series(i,1) > time) \textcolor{keywordflow}{then}
427                 \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
428                   j = i-1
429                 \textcolor{keywordflow}{else}
430                   j = i
431 \textcolor{keywordflow}{                end if}
432                 \textcolor{keywordtype}{value} = pde\_loc%bc(edge\_id)%series(j,2)
433                 \textcolor{keywordflow}{EXIT}
434 \textcolor{keywordflow}{              end if}
435 \textcolor{keywordflow}{            end do}
436           \textcolor{keywordflow}{else}
437             \textcolor{keywordtype}{value} =  pde\_loc%bc(edge\_id)%value
438 \textcolor{keywordflow}{          end if}
439 \textcolor{keywordflow}{        end if}
440         
441         
442         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
443           code = pde\_loc%bc(edge\_id)%code
444 \textcolor{keywordflow}{        end if}
445         
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a664047715b553e05dbdc2d14b481e6fa_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!bouss\+\_\+cond@{bouss\+\_\+cond}}
\index{bouss\+\_\+cond@{bouss\+\_\+cond}!boussfnc@{boussfnc}}
\subsubsection[{bouss\+\_\+cond(pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public boussfnc\+::bouss\+\_\+cond (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:,\+:), intent(out), optional}]{tensor, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_a1eb4dcb6eb00362b392c983cf5cefb45}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & pressure head\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt out}  & {\em tensor} & second order tensor of the unsaturated hydraulic conductivity\\
\hline
\mbox{\tt out}  & {\em scalar} & relative hydraulic conductivity, (scalar value) \\
\hline
\end{DoxyParams}


Definition at line 79 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+k, and geom\+\_\+tools\+::getcoor().



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
79         \textcolor{keywordtype}{use }typy
80         \textcolor{keywordtype}{use }boussglob
81         \textcolor{keywordtype}{use }pde_objs
82         \textcolor{keywordtype}{use }geom_tools
83         \textcolor{keywordtype}{use }debug_tools
84 
85         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
86         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
88         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: x
90         \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt      
92         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: tensor
93         \textcolor{keywordtype}{real(kind=rkind)} :: h
95         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: scalar
96 
97         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1)} :: coord
98         \textcolor{keywordtype}{integer(kind=ikind)} :: i
99 
100         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
101           print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition, not
       both of them"}
102           print *, \textcolor{stringliteral}{"exited from re\_constitutive::mualem"}
103           error stop
104         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(quadpnt) .and. .not. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
105           print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
106           print *, \textcolor{stringliteral}{"exited from re\_constitutive::mualem"}
107           error stop
108 \textcolor{keywordflow}{        end if}
109         
110         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
111           h = pde\_loc%getval(quadpnt)
112         \textcolor{keywordflow}{else}
113           \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
114             print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
115             print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
116             print *, \textcolor{stringliteral}{"exited from re\_constitutive::mualem"}
117             error stop
118 \textcolor{keywordflow}{          end if}
119           h = x(1)
120 \textcolor{keywordflow}{        end if}
121         
122         \textcolor{keyword}{call }getcoor(quadpnt, coord)
123         
124 
125         
126         \textcolor{keywordflow}{do} i=1, bouss_k(1)%pos - 1
127           \textcolor{keywordflow}{if} (coord(1) >= bouss_k(1)%data(i) .and. coord(1) < bouss_k(1)%data(i+1)) \textcolor{keywordflow}{then}
128             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tensor)) \textcolor{keywordflow}{then}
129 
130               tensor =  bouss_k(2)%data(i) * h
131 
132 \textcolor{keywordflow}{            end if}
133             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(scalar)) \textcolor{keywordflow}{then}
134               scalar =  bouss_k(2)%data(i) * h
135 \textcolor{keywordflow}{            end if}
136             \textcolor{keywordflow}{EXIT}
137 \textcolor{keywordflow}{          end if}
138           \textcolor{keywordflow}{if} (i == bouss_k(1)%pos - 1 .and. coord(1) >= bouss_k(1)%data(i+1)) \textcolor{keywordflow}{then}
139             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tensor)) \textcolor{keywordflow}{then}
140               tensor =  bouss_k(2)%data(i+1) * h
141 \textcolor{keywordflow}{            end if}
142             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(scalar)) \textcolor{keywordflow}{then}
143               scalar =  bouss_k(2)%data(i+1) * h
144 \textcolor{keywordflow}{            end if}
145 \textcolor{keywordflow}{          end if}
146           
147 \textcolor{keywordflow}{        end do}
148         
149         
150       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a1eb4dcb6eb00362b392c983cf5cefb45_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a1eb4dcb6eb00362b392c983cf5cefb45_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!bouss\+\_\+elast@{bouss\+\_\+elast}}
\index{bouss\+\_\+elast@{bouss\+\_\+elast}!boussfnc@{boussfnc}}
\subsubsection[{bouss\+\_\+elast(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public boussfnc\+::bouss\+\_\+elast (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_a071d2eeb5f983e31d4495bb68a137e76}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & pressure head\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
resulting system elasticity 
\end{DoxyReturn}


Definition at line 14 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+por, boussglob\+::bouss\+\_\+slopes, and geom\+\_\+tools\+::getcoor().



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
14         \textcolor{keywordtype}{use }typy
15         \textcolor{keywordtype}{use }boussglob
16         \textcolor{keywordtype}{use }pde_objs
17         \textcolor{keywordtype}{use }geom_tools
18 
19         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc 
20         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
22         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)},  \textcolor{keywordtype}{optional} :: x
24         \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
25         \textcolor{keywordtype}{real(kind=rkind)} :: h
27         \textcolor{keywordtype}{real(kind=rkind)} :: e
28         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1)} :: coord
29         \textcolor{keywordtype}{real(kind=rkind)} :: cos\_slope, slope
30         \textcolor{keywordtype}{integer(kind=ikind)} :: i
31 
32         
33         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
34           print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition, not
       both of them"}
35           print *, \textcolor{stringliteral}{"exited from re\_constitutive::vangen\_elast"}
36           error stop
37         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(quadpnt) .and. .not. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
38           print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
39           print *, \textcolor{stringliteral}{"exited from re\_constitutive::vangen\_elast"}
40           error stop
41 \textcolor{keywordflow}{        end if}
42         
43         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
44           h = pde\_loc%getval(quadpnt)
45         \textcolor{keywordflow}{else}
46           \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
47             print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
48             print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
49             error stop
50 \textcolor{keywordflow}{          end if}
51           \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
52             print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
53             print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
54             print *, \textcolor{stringliteral}{"exited from re\_constitutive::vangen\_elast"}
55             error stop
56 \textcolor{keywordflow}{          end if}
57           h = x(1)
58 \textcolor{keywordflow}{        end if}
59 
60         \textcolor{keyword}{call }getcoor(quadpnt, coord)
61         
62         \textcolor{keywordflow}{do} i=1, bouss_slopes(1)%pos - 1
63           \textcolor{keywordflow}{if} (coord(1) >= bouss_slopes(1)%data(i) .and. coord(1) < bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
64             slope = bouss_slopes(2)%data(i)
65             \textcolor{keywordflow}{EXIT}
66 \textcolor{keywordflow}{          end if}
67           \textcolor{keywordflow}{if} (i == bouss_slopes(1)%pos - 1 .and. coord(1) >= bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
68             slope = bouss_slopes(2)%data(i+1)
69 \textcolor{keywordflow}{          end if}
70 \textcolor{keywordflow}{        end do}
71         cos\_slope = cos(atan(slope))
72         e = bouss_por/cos\_slope 
73         
74 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a071d2eeb5f983e31d4495bb68a137e76_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_a071d2eeb5f983e31d4495bb68a137e76_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!boussicond@{boussicond}}
\index{boussicond@{boussicond}!boussfnc@{boussfnc}}
\subsubsection[{boussicond(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public boussfnc\+::boussicond (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_afed12ab38bd77f437f94217611a6cca1}


Definition at line 380 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+icond, globals\+::elements, globals\+::nodes, and pde\+\_\+objs\+::pde.



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
380         \textcolor{keywordtype}{use }typy
381         \textcolor{keywordtype}{use }globals
382         \textcolor{keywordtype}{use }boussglob
383         \textcolor{keywordtype}{use }global_objs
384         \textcolor{keywordtype}{use }pde_objs
385         
386         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
387         \textcolor{keywordtype}{integer(kind=ikind)} :: i, j, k, l, m, layer
388         \textcolor{keywordtype}{real(kind=rkind)} :: value
389         
390        \textcolor{keywordflow}{do} i=1, elements%kolik
391           layer = elements%material(i,1)
392           \textcolor{keywordflow}{do} j=1, ubound(elements%data,2)
393             k = elements%data(i,j)
394             l = nodes%edge(k)
395             m = pde(1)%permut(k)
396             \textcolor{keywordflow}{if} (m == 0) \textcolor{keywordflow}{then}
397               \textcolor{keyword}{call }pde\_loc%bc(l)%value\_fnc(pde\_loc, i, j, \textcolor{keywordtype}{value})
398               pde\_loc%solution(k) =  \textcolor{keywordtype}{value}
399             \textcolor{keywordflow}{else}
400               pde\_loc%solution(k) = bouss_icond
401 \textcolor{keywordflow}{            end if}
402 \textcolor{keywordflow}{          end do}   
403 \textcolor{keywordflow}{        end do}
404       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_afed12ab38bd77f437f94217611a6cca1_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!boussreact@{boussreact}}
\index{boussreact@{boussreact}!boussfnc@{boussfnc}}
\subsubsection[{boussreact(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public boussfnc\+::boussreact (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_aa942b39df59c308dadcfa69b1256ed09}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & pressure head\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
resulting reaction 
\end{DoxyReturn}


Definition at line 246 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+rain.



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
246         \textcolor{keywordtype}{use }typy
247         \textcolor{keywordtype}{use }re_globals
248         \textcolor{keywordtype}{use }pde_objs
249         \textcolor{keywordtype}{use }geom_tools
250         \textcolor{keywordtype}{use }boussglob
251 
252 
253         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc 
254         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
256         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)},  \textcolor{keywordtype}{optional} :: x
258         \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
259 
261         \textcolor{keywordtype}{real(kind=rkind)} :: react
262         
263         \textcolor{keywordtype}{real(kind=rkind)} :: rain
264         \textcolor{keywordtype}{integer(kind=ikind)} :: i
265         
266         \textcolor{keywordflow}{do} i=1, ubound(bouss_rain,1)-1
267           \textcolor{keywordflow}{if} (i == 1 .and. time < bouss_rain(1)%data(i)) \textcolor{keywordflow}{then}
268             rain = bouss_rain(2)%data(i) 
269 \textcolor{keywordflow}{          end if}
270           \textcolor{keywordflow}{if} (bouss_rain(1)%data(i) <= time .and. bouss_rain(1)%data(i+1) > time) \textcolor{keywordflow}{then}
271             rain = bouss_rain(2)%data(i) 
272             \textcolor{keywordflow}{EXIT}
273 \textcolor{keywordflow}{          end if}
274           \textcolor{keywordflow}{if} (i == bouss_rain(1)%pos - 1 .and. time >= bouss_rain(1)%data(i+1)) \textcolor{keywordflow}{then}
275             rain = bouss_rain(2)%data(i+1)
276 \textcolor{keywordflow}{          end if}
277 \textcolor{keywordflow}{        end do}  
278         
279         react = -rain
280          
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_aa942b39df59c308dadcfa69b1256ed09_icgraph}
\end{center}
\end{figure}


\index{boussfnc@{boussfnc}!darcy4bouss@{darcy4bouss}}
\index{darcy4bouss@{darcy4bouss}!boussfnc@{boussfnc}}
\subsubsection[{darcy4bouss(pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public boussfnc\+::darcy4bouss (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{grad, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{flux, }
\item[{real(kind=rkind), intent(out), optional}]{flux\+\_\+length}
\end{DoxyParamCaption}
)}\label{namespaceboussfnc_afa3ac635ca94f53b4d31b74e208d1ee8}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em grad} & this value is optional, because it is required by the vector\+\_\+fnc procedure pointer global definition \\
\hline
\end{DoxyParams}


Definition at line 286 of file boussfnc.\+f90.



References boussglob\+::bouss\+\_\+slopes, and geom\+\_\+tools\+::getcoor().



Referenced by bousspointers\+::boussi().


\begin{DoxyCode}
286         \textcolor{keywordtype}{use }typy
287         \textcolor{keywordtype}{use }pde_objs
288         \textcolor{keywordtype}{use }global_objs
289         \textcolor{keywordtype}{use }geom_tools
290         \textcolor{keywordtype}{use }boussglob
291         
292         \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
293         \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}                          :: layer
294         \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt    
295         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional}                   :: x
297         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}     :: grad
298         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: flux
299         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}                  :: flux\_length
300 
301         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1,1)}  :: k
302         \textcolor{keywordtype}{integer}                           :: d
303         \textcolor{keywordtype}{integer(kind=ikind)}               :: i
304         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save}  :: gradh
305         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save}  :: vct
306         \textcolor{keywordtype}{real(kind=rkind)} :: h, slope
307         \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(1)} :: coord
308         
309 
310         d = drutes_config%dimen
311           
312         \textcolor{keywordflow}{if} (.not.(\textcolor{keyword}{allocated}(gradh))) \textcolor{keywordflow}{then}
313           \textcolor{keyword}{allocate}(gradh(1:d))
314           \textcolor{keyword}{allocate}(vct(1:d))
315 \textcolor{keywordflow}{        end if}
316 
317         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. (\textcolor{keyword}{present}(grad) .or. \textcolor{keyword}{present}(x))) \textcolor{keywordflow}{then}
318           print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition and
       gradient, not both of them"}
319           error stop
320         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((.not. \textcolor{keyword}{present}(grad) .or. .not. \textcolor{keyword}{present}(x)) .and. .not. \textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
321           print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
322           print *, \textcolor{stringliteral}{"exited from re\_constitutive::darcy\_law"}
323           error stop
324 \textcolor{keywordflow}{        end if}
325         
326         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
327           h = pde\_loc%getval(quadpnt)
328           \textcolor{keyword}{call }pde\_loc%getgrad(quadpnt, gradh)
329         \textcolor{keywordflow}{else}
330           \textcolor{keywordflow}{if} (ubound(x,1) /=1) \textcolor{keywordflow}{then}
331             print *, \textcolor{stringliteral}{"ERROR: van Genuchten function is a function of a single variable h"}
332             print *, \textcolor{stringliteral}{"       your input data has:"}, ubound(x,1), \textcolor{stringliteral}{"variables"}
333             print *, \textcolor{stringliteral}{"exited from re\_constitutive::darcy\_law"}
334             error stop
335 \textcolor{keywordflow}{          end if}
336           h = x(1)
337           gradh(1:d) = grad
338 \textcolor{keywordflow}{        end if}
339         
340        \textcolor{keyword}{call }getcoor(quadpnt, coord)
341         
342         \textcolor{keywordflow}{do} i=1, bouss_slopes(1)%pos - 1
343           \textcolor{keywordflow}{if} (coord(1) >= bouss_slopes(1)%data(i) .and. coord(1) < bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
344             slope = bouss_slopes(2)%data(i)
345             \textcolor{keywordflow}{EXIT}
346 \textcolor{keywordflow}{          end if}
347           \textcolor{keywordflow}{if} (i == bouss_slopes(1)%pos - 1 .and. coord(1) >= bouss_slopes(1)%data(i+1)) \textcolor{keywordflow}{then}
348             slope = bouss_slopes(2)%data(i+1)
349 \textcolor{keywordflow}{          end if}
350 \textcolor{keywordflow}{        end do}
351         
352         
353         gradh = gradh + slope
354         
355         \textcolor{keyword}{call }pde\_loc%pde\_fnc(1)%dispersion(pde\_loc, layer, quadpnt, tensor=k(1:d, 1:d))
356       
357         
358         vct(1:d) =  matmul(-k(1:d,1:d), gradh(1:d))
359 
360 
361         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(flux\_length)) \textcolor{keywordflow}{then}
362           \textcolor{keywordflow}{select case}(d)
363             \textcolor{keywordflow}{case}(1)
364                   flux\_length = abs(vct(1))
365             \textcolor{keywordflow}{case}(2)
366                   flux\_length = sqrt(vct(1)*vct(1) + vct(2)*vct(2))
367             \textcolor{keywordflow}{case}(3)
368                   flux\_length = sqrt(vct(1)*vct(1) + vct(2)*vct(2) + vct(3)*vct(3))
369 \textcolor{keywordflow}{          end select}
370 \textcolor{keywordflow}{        end if}
371 
372 
373         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(flux)) \textcolor{keywordflow}{then}
374           flux(1:d) = vct(1:d)
375 \textcolor{keywordflow}{        end if}
376 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_afa3ac635ca94f53b4d31b74e208d1ee8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceboussfnc_afa3ac635ca94f53b4d31b74e208d1ee8_icgraph}
\end{center}
\end{figure}


