\section{heat\+\_\+fnc Module Reference}
\label{namespaceheat__fnc}\index{heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf heat\+\_\+conduct} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\item 
subroutine, public {\bf heat\+\_\+convect} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\item 
real(kind=rkind) function, public {\bf heat\+\_\+elast} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf heat\+\_\+source} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf heat\+\_\+dirichlet} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf heat\+\_\+neumann} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf heat\+\_\+flux} (pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)
\item 
subroutine, public {\bf heat\+\_\+icond} (pde\+\_\+loc)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+conduct@{heat\+\_\+conduct}}
\index{heat\+\_\+conduct@{heat\+\_\+conduct}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+conduct(pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+conduct (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:,\+:), intent(out), optional}]{tensor, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_a06bff0d21859a3ff3f1ccf9f890a133c}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\mbox{\tt out}  & {\em tensor} & return tensor\\
\hline
\mbox{\tt out}  & {\em scalar} & relative scalar value of the nonlinear function \\
\hline
\end{DoxyParams}


Definition at line 12 of file heat\+\_\+fnc.\+f90.



References globals\+::drutes\+\_\+config, and heat\+\_\+globals\+::heatpar.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
12       \textcolor{keywordtype}{use }typy
13       \textcolor{keywordtype}{use }global_objs
14       \textcolor{keywordtype}{use }pde_objs
15       \textcolor{keywordtype}{use }globals
16       \textcolor{keywordtype}{use }heat_globals
17       \textcolor{keywordtype}{use }debug_tools
18       
19       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
21       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
23       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
25       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
27       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: tensor
29       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}                 :: scalar
30 
31       \textcolor{keywordtype}{integer(kind=ikind)} :: d, i
32       
33      
34       d = drutes_config%dimen
35 
36       
37       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tensor)) \textcolor{keywordflow}{then}
38         tensor =  heatpar(layer)%lambda
39 \textcolor{keywordflow}{      end if}
40       
41     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_a06bff0d21859a3ff3f1ccf9f890a133c_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+convect@{heat\+\_\+convect}}
\index{heat\+\_\+convect@{heat\+\_\+convect}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+convect(pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+convect (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{vector\+\_\+in, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{vector\+\_\+out, }
\item[{real(kind=rkind), intent(out), optional}]{scalar}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_a78d9b0142d4b3c80c78e16137bd531c7}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\mbox{\tt in}  & {\em vector\+\_\+in} & input vector\\
\hline
\mbox{\tt out}  & {\em vector\+\_\+out} & output vector\\
\hline
\mbox{\tt out}  & {\em scalar} & relative scalar value of the nonlinear function \\
\hline
\end{DoxyParams}


Definition at line 46 of file heat\+\_\+fnc.\+f90.



References heat\+\_\+globals\+::heatpar, and typy\+::norm2().



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
46       \textcolor{keywordtype}{use }typy
47       \textcolor{keywordtype}{use }global_objs
48       \textcolor{keywordtype}{use }pde_objs
49       \textcolor{keywordtype}{use }heat_globals
50       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
52       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
54       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
56       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
58       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: vector\_in
60       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: vector\_out
62       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}               :: scalar
63       
64       
65         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(vector\_out)) \textcolor{keywordflow}{then}
66           vector\_out = heatpar(layer)%C\_w*heatpar(layer)%convection
67 \textcolor{keywordflow}{        end if}
68         
69         
70         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(scalar)) \textcolor{keywordflow}{then}
71           scalar = norm2(heatpar(layer)%C\_w*heatpar(layer)%convection)
72 \textcolor{keywordflow}{        end if}
73    
74       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=267pt]{namespaceheat__fnc_a78d9b0142d4b3c80c78e16137bd531c7_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_a78d9b0142d4b3c80c78e16137bd531c7_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+dirichlet@{heat\+\_\+dirichlet}}
\index{heat\+\_\+dirichlet@{heat\+\_\+dirichlet}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+dirichlet(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+dirichlet (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_a43be05f9337467723d91383df8383544}


Definition at line 134 of file heat\+\_\+fnc.\+f90.



References globals\+::elements, globals\+::nodes, and globals\+::time.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
134       \textcolor{keywordtype}{use }typy
135       \textcolor{keywordtype}{use }globals
136       \textcolor{keywordtype}{use }global_objs
137       \textcolor{keywordtype}{use }pde_objs
138       \textcolor{keywordtype}{use }debug_tools
139       
140       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
141       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
142       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
143       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
144       
145       \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j, proc
146       \textcolor{keywordtype}{real(kind=rkind)} :: tempval
147       
148       edge\_id = nodes%edge(elements%data(el\_id, node\_order))
149       
150       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
151         \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%file) \textcolor{keywordflow}{then}
152           \textcolor{keywordflow}{do} i=1, ubound(pde\_loc%bc(edge\_id)%series,1)
153             \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%series(i,1) > time) \textcolor{keywordflow}{then}
154               \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
155                 j = i-1
156               \textcolor{keywordflow}{else}
157                 j = i
158 \textcolor{keywordflow}{              end if}
159               tempval = pde\_loc%bc(edge\_id)%series(j,2)
160               \textcolor{keywordflow}{EXIT}
161 \textcolor{keywordflow}{            end if}
162 \textcolor{keywordflow}{          end do}
163         \textcolor{keywordflow}{else}
164           tempval =  pde\_loc%bc(edge\_id)%value
165 \textcolor{keywordflow}{        end if}
166         \textcolor{keywordtype}{value} = tempval 
167 \textcolor{keywordflow}{      end if}
168 
169 
170       
171       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
172         code = 1
173 \textcolor{keywordflow}{      end if}
174       
175 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_a43be05f9337467723d91383df8383544_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+elast@{heat\+\_\+elast}}
\index{heat\+\_\+elast@{heat\+\_\+elast}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+elast(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public heat\+\_\+fnc\+::heat\+\_\+elast (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_ac8c55750f6db4f746c249dfdc9391936}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & pressure head\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
resulting system elasticity 
\end{DoxyReturn}


Definition at line 78 of file heat\+\_\+fnc.\+f90.



References heat\+\_\+globals\+::heatpar.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
78       \textcolor{keywordtype}{use }typy
79       \textcolor{keywordtype}{use }heat_globals
80       \textcolor{keywordtype}{use }pde_objs
81       \textcolor{keywordtype}{use }core_tools
82 
83       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc 
84       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
86       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)},  \textcolor{keywordtype}{optional} :: x
88       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
89       \textcolor{keywordtype}{real(kind=rkind)} :: h
91       \textcolor{keywordtype}{real(kind=rkind)} :: e
92 
93        
94       
95       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
96         print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition, not both
       of them"}
97         print *, \textcolor{stringliteral}{"exited from re\_constitutive::vangen\_elast"}
98         error stop
99       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(quadpnt) .and. .not. \textcolor{keyword}{present}(x)) \textcolor{keywordflow}{then}
100         print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
101         print *, \textcolor{stringliteral}{"exited from re\_constitutive::vangen\_elast"}
102         error stop
103 \textcolor{keywordflow}{      end if}
104 
105 
106       e = heatpar(layer)%C
107       
108 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_ac8c55750f6db4f746c249dfdc9391936_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+flux@{heat\+\_\+flux}}
\index{heat\+\_\+flux@{heat\+\_\+flux}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+flux(pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+flux (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{grad, }
\item[{real(kind=rkind), dimension(\+:), intent(out), optional}]{flux, }
\item[{real(kind=rkind), intent(out), optional}]{flux\+\_\+length}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_a293fde2075c4013103b26a443aa41a98}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em grad} & this value is optional, because it is required by the vector\+\_\+fnc procedure pointer global definition \\
\hline
\end{DoxyParams}


Definition at line 228 of file heat\+\_\+fnc.\+f90.



References heat\+\_\+globals\+::heatpar, and typy\+::norm2().



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
228       \textcolor{keywordtype}{use }typy
229       \textcolor{keywordtype}{use }pde_objs
230       \textcolor{keywordtype}{use }global_objs
231       \textcolor{keywordtype}{use }debug_tools
232       \textcolor{keywordtype}{use }heat_globals
233        
234       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
235       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}                          :: layer
236       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt    
237       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional}              \textcolor{comment}{     :: x}
239       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}     :: grad
240       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: flux
241       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}                  :: flux\_length
242     
243 
244       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: gradt
245 
246       
247       
248       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt) .and. (\textcolor{keyword}{present}(grad) .or. \textcolor{keyword}{present}(x))) \textcolor{keywordflow}{then}
249         print *, \textcolor{stringliteral}{"ERROR: the function can be called either with integ point or x value definition and
       gradient, not both of them"}
250         print *, \textcolor{stringliteral}{"exited from heat\_fnc::heat\_flux"}
251         error stop
252       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((.not. \textcolor{keyword}{present}(grad) .or. .not. \textcolor{keyword}{present}(x)) .and. .not. \textcolor{keyword}{present}\textcolor{comment}{(quadpnt)) }\textcolor{keywordflow}{then}
253         print *, \textcolor{stringliteral}{"ERROR: you have not specified either integ point or x value"}
254         print *, \textcolor{stringliteral}{"exited from heat\_fnc::heat\_flux"}
255         error stop
256 \textcolor{keywordflow}{      end if}   
257 
258       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(gradt)) \textcolor{keyword}{allocate}(gradt(drutes_config%dimen))
259 
260       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(quadpnt)) \textcolor{keywordflow}{then}
261         \textcolor{keyword}{call }pde\_loc%getgrad(quadpnt, gradt)
262       \textcolor{keywordflow}{else}
263         gradt = grad
264 \textcolor{keywordflow}{      end if}
265       
266       
267       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(flux)) \textcolor{keywordflow}{then}
268         flux = matmul(heatpar(layer)%lambda, gradt) 
269 \textcolor{keywordflow}{      end if}
270       
271       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(flux\_length)) \textcolor{keywordflow}{then}
272         flux\_length = norm2(matmul(heatpar(layer)%lambda, gradt))
273 \textcolor{keywordflow}{      end if}
274     
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{namespaceheat__fnc_a293fde2075c4013103b26a443aa41a98_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_a293fde2075c4013103b26a443aa41a98_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+icond@{heat\+\_\+icond}}
\index{heat\+\_\+icond@{heat\+\_\+icond}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+icond(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+icond (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_ad72ac4afafcfc39183bd8b087a92bb6d}


Definition at line 278 of file heat\+\_\+fnc.\+f90.



References globals\+::elements, heat\+\_\+globals\+::heatpar, and globals\+::nodes.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
278       \textcolor{keywordtype}{use }typy
279       \textcolor{keywordtype}{use }globals
280       \textcolor{keywordtype}{use }global_objs
281       \textcolor{keywordtype}{use }pde_objs
282       \textcolor{keywordtype}{use }heat_globals
283 
284       
285       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
286       \textcolor{keywordtype}{integer(kind=ikind)} :: i, j, k,l, m, layer, d
287       \textcolor{keywordtype}{real(kind=rkind)} :: value
288       
289    
290       \textcolor{keywordflow}{do} i=1, elements%kolik
291         layer = elements%material(i,1)
292         \textcolor{keywordflow}{do} j=1, ubound(elements%data,2)
293           k = elements%data(i,j)
294           l = nodes%edge(k)
295           m = pde\_loc%permut(k)
296           \textcolor{keywordflow}{if} (m == 0) \textcolor{keywordflow}{then}
297             \textcolor{keyword}{call }pde\_loc%bc(l)%value\_fnc(pde\_loc, i, j, \textcolor{keywordtype}{value})
298             pde\_loc%solution(k) =  \textcolor{keywordtype}{value} 
299           \textcolor{keywordflow}{else}
300             pde\_loc%solution(k) = heatpar(layer)%Tinit
301 \textcolor{keywordflow}{          end if}
302 \textcolor{keywordflow}{        end do}   
303 \textcolor{keywordflow}{      end do}
304 
305     
306     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_ad72ac4afafcfc39183bd8b087a92bb6d_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+neumann@{heat\+\_\+neumann}}
\index{heat\+\_\+neumann@{heat\+\_\+neumann}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+neumann(pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+fnc\+::heat\+\_\+neumann (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{el\+\_\+id, }
\item[{integer(kind=ikind), intent(in)}]{node\+\_\+order, }
\item[{real(kind=rkind), intent(out), optional}]{value, }
\item[{integer(kind=ikind), intent(out), optional}]{code}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_aa6d2b31a7d81e956bcc14f955b6ca95f}


Definition at line 180 of file heat\+\_\+fnc.\+f90.



References globals\+::elements, globals\+::nodes, and globals\+::time.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
180       \textcolor{keywordtype}{use }typy
181       \textcolor{keywordtype}{use }globals
182       \textcolor{keywordtype}{use }global_objs
183       \textcolor{keywordtype}{use }pde_objs
184       \textcolor{keywordtype}{use }debug_tools
185       
186       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
187       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: el\_id, node\_order
188       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}    :: value
189       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: code
190       
191       \textcolor{keywordtype}{integer(kind=ikind)} :: edge\_id, i, j, proc
192       \textcolor{keywordtype}{real(kind=rkind)} :: tempval
193       
194       edge\_id = nodes%edge(elements%data(el\_id, node\_order))
195       
196       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(\textcolor{keywordtype}{value})) \textcolor{keywordflow}{then}
197         \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%file) \textcolor{keywordflow}{then}
198           \textcolor{keywordflow}{do} i=1, ubound(pde\_loc%bc(edge\_id)%series,1)
199             \textcolor{keywordflow}{if} (pde\_loc%bc(edge\_id)%series(i,1) > time) \textcolor{keywordflow}{then}
200               \textcolor{keywordflow}{if} (i > 1) \textcolor{keywordflow}{then}
201                 j = i-1
202               \textcolor{keywordflow}{else}
203                 j = i
204 \textcolor{keywordflow}{              end if}
205               tempval = pde\_loc%bc(edge\_id)%series(j,2)
206               \textcolor{keywordflow}{EXIT}
207 \textcolor{keywordflow}{            end if}
208 \textcolor{keywordflow}{          end do}
209         \textcolor{keywordflow}{else}
210           tempval =  pde\_loc%bc(edge\_id)%value
211 \textcolor{keywordflow}{        end if}
212         \textcolor{keywordtype}{value} = tempval 
213 \textcolor{keywordflow}{      end if}
214 
215 
216       
217       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(code)) \textcolor{keywordflow}{then}
218         code = 2
219 \textcolor{keywordflow}{      end if}
220       
221 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_aa6d2b31a7d81e956bcc14f955b6ca95f_icgraph}
\end{center}
\end{figure}


\index{heat\+\_\+fnc@{heat\+\_\+fnc}!heat\+\_\+source@{heat\+\_\+source}}
\index{heat\+\_\+source@{heat\+\_\+source}!heat\+\_\+fnc@{heat\+\_\+fnc}}
\subsubsection[{heat\+\_\+source(pde\+\_\+loc, layer, quadpnt, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public heat\+\_\+fnc\+::heat\+\_\+source (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{integer(kind=ikind), intent(in)}]{layer, }
\item[{type({\bf integpnt\+\_\+str}), intent(in), optional}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(in), optional}]{x}
\end{DoxyParamCaption}
)}\label{namespaceheat__fnc_aa028ca3e4b6d819e67f85b5b4fe49ea4}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & value of the nonlinear function\\
\hline
\mbox{\tt in}  & {\em quadpnt} & Gauss quadrature point structure (element number and rank of Gauss quadrature point)\\
\hline
\mbox{\tt in}  & {\em layer} & material ID\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return value 
\end{DoxyReturn}


Definition at line 112 of file heat\+\_\+fnc.\+f90.



References heat\+\_\+globals\+::heatpar.



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
112       \textcolor{keywordtype}{use }typy
113       \textcolor{keywordtype}{use }global_objs
114       \textcolor{keywordtype}{use }pde_objs
115       \textcolor{keywordtype}{use }heat_globals
116       
117       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
119       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}    :: x
121       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: quadpnt
123       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: layer
125       \textcolor{keywordtype}{real(kind=rkind)}                :: val 
126       
127       
128       val = heatpar(layer)%source
129       
130       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__fnc_aa028ca3e4b6d819e67f85b5b4fe49ea4_icgraph}
\end{center}
\end{figure}


