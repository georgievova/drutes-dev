\section{integral Module Reference}
\label{namespaceintegral}\index{integral@{integral}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type {\bf formulka}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf init\+\_\+integration\+\_\+formulas} (n, ierr)
\item 
pure subroutine, public {\bf getform} (n, a, h, ierr)
\item 
real(kind=rkind) function, public {\bf integ1} (a, b, f, n)
\item 
pure real(kind=rkind) function, private {\bf integ2} (a, b, f, n)
\item 
pure recursive subroutine, public {\bf integs} (a, b, f, n, rel\+\_\+chyba, i\+\_\+err, counter, hloubka, ilvl, cislo)
\item 
real(kind=rkind) function, public {\bf integ} (a, b, f, n, rel\+\_\+chyba, counter, hloubka, ilvl)
\item 
pure subroutine, private {\bf setup} (n, a, h, ierr)
\item 
pure real(kind=rkind) function, private {\bf dohledej} (xl, xp, p)
\item 
real(kind=rkind) function, private {\bf horner} (p, x)
\begin{DoxyCompactList}\small\item\em simple horner\textquotesingle{}s scheme (zero derivatives only) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
type({\bf formulka}), dimension(\+:), pointer, private {\bf group} =$>$ null()
\item 
integer, private {\bf prep\+\_\+forms} = 0
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{integral@{integral}!dohledej@{dohledej}}
\index{dohledej@{dohledej}!integral@{integral}}
\subsubsection[{dohledej(xl, xp, p)}]{\setlength{\rightskip}{0pt plus 5cm}pure real(kind=rkind) function, private integral\+::dohledej (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(in)}]{xl, }
\item[{real(kind=rkind), intent(in)}]{xp, }
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a55a8ad85782fea037b50024f88628b90}


Definition at line 570 of file integral.\+f90.



References horner().



Referenced by setup().


\begin{DoxyCode}
570       \textcolor{keywordtype}{use }typy
571 
572       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!111111111111111111111111111}
573       \textcolor{comment}{!parametry}
574       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!111111111111111111111111111}
575       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)} :: xl,xp
576       \textcolor{keywordtype}{real(kind=rkind)},\textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: p
577       \textcolor{keywordtype}{real(kind=rkind)} :: x
578       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
579       \textcolor{comment}{! xl ... levy krajni bod intervalu s korenem}
580       \textcolor{comment}{! xp ... pravy krajni bod intervalu s korenem}
581       \textcolor{comment}{! p  ... polynom}
582       \textcolor{comment}{! }
583       \textcolor{comment}{! x ... navratova hodnota - nalezeny koren }
584       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
585       \textcolor{keywordtype}{real(kind=rkind)} :: x1,x2,x3,y1,y2,y3,y4,y5
586 
587       x1 = xl
588       x2 = xp
589       y1 = horner(p,x1)
590       y2 = horner(p,x2)
591       y4 = x2-x1
592       do
593         x  = (x2+x1)/2
594         y3 = horner(p,x)
595         \textcolor{keywordflow}{if} (y3*y1< 0) then
596           x2 = x
597           y2 = y3
598         else
599           x1 = x
600           y1 = y3
601 \textcolor{keyword}{        end }if
602         y5 = y4
603         y4 = x2-x1
604         \textcolor{keywordflow}{if} (y5==y4) then
605           exit
606 \textcolor{keyword}{        end }if
607 \textcolor{keyword}{      end }do
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{namespaceintegral_a55a8ad85782fea037b50024f88628b90_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a55a8ad85782fea037b50024f88628b90_icgraph}
\end{center}
\end{figure}


\index{integral@{integral}!getform@{getform}}
\index{getform@{getform}!integral@{integral}}
\subsubsection[{getform(n, a, h, ierr)}]{\setlength{\rightskip}{0pt plus 5cm}pure subroutine, public integral\+::getform (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{n, }
\item[{real(kind=rkind), dimension(\+:), intent(out)}]{a, }
\item[{real(kind=rkind), dimension(\+:), intent(out)}]{h, }
\item[{integer(kind=ikind), intent(out), optional}]{ierr}
\end{DoxyParamCaption}
)}\label{namespaceintegral_a0201981d5a57be0c8ce2d83b2307f2ee}


Definition at line 70 of file integral.\+f90.



References group, prep\+\_\+forms, and setup().



Referenced by feminittools\+::init\+\_\+integ(), integ1(), integ2(), and integs().


\begin{DoxyCode}
70       \textcolor{keywordtype}{use }typy
71       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
72       \textcolor{comment}{!   parametery }
73       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
74       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: a,h
75       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: n
76       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: ierr
77       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! }
78       \textcolor{comment}{! n ... pocet bodu kvadr. vzorce - vstupni parametr }
79       \textcolor{comment}{! a ... uzly kvadraturniho vzorce}
80       \textcolor{comment}{! h ... vahy kvdraturniho vzorce}
81       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
82       
83       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
84       \textcolor{comment}{! lokalni promenne}
85       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
86       \textcolor{keywordtype}{integer(kind=ikind)} :: ierr1
87       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{pointer} :: a1,h1
88       
89       \textcolor{keywordflow}{if} ((n>=1) .and. (n<=prep_forms)) then
90         a = group(n)%a
91         h = group(n)%h
92         ierr1 = 0
93       else
94         \textcolor{keyword}{call }setup(n,a1,h1,ierr1)
95         a = a1
96         h = h1
97         \textcolor{keyword}{deallocate}(a1,h1)
98 \textcolor{keywordflow}{      end if}            
99       \textcolor{keywordflow}{if} ( \textcolor{keyword}{present}(ierr) ) then
100         ierr = ierr1
101 \textcolor{keyword}{      end }if
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a0201981d5a57be0c8ce2d83b2307f2ee_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a0201981d5a57be0c8ce2d83b2307f2ee_icgraph}
\end{center}
\end{figure}


\index{integral@{integral}!horner@{horner}}
\index{horner@{horner}!integral@{integral}}
\subsubsection[{horner(p, x)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, private integral\+::horner (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{p, }
\item[{real(kind=rkind), intent(in)}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a705235ccaf73af9c9c0c1040d433e52d}


simple horner\textquotesingle{}s scheme (zero derivatives only) 



Definition at line 613 of file integral.\+f90.



Referenced by dohledej(), and setup().


\begin{DoxyCode}
613       \textcolor{keywordtype}{use }typy
614       \textcolor{keywordtype}{integer(kind=ikind)} :: i
615       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)} :: x
616       \textcolor{keywordtype}{real(kind=rkind)} :: px
617       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: p
618 
619       px=0
620 
621       \textcolor{keywordflow}{do} i=ubound(p,1), 1, -1
622         px=px*x+p(i)
623 \textcolor{keyword}{      end }do
624 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a705235ccaf73af9c9c0c1040d433e52d_icgraph}
\end{center}
\end{figure}


\index{integral@{integral}!init\+\_\+integration\+\_\+formulas@{init\+\_\+integration\+\_\+formulas}}
\index{init\+\_\+integration\+\_\+formulas@{init\+\_\+integration\+\_\+formulas}!integral@{integral}}
\subsubsection[{init\+\_\+integration\+\_\+formulas(n, ierr)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public integral\+::init\+\_\+integration\+\_\+formulas (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{n, }
\item[{integer(kind=ikind), intent(out), optional}]{ierr}
\end{DoxyParamCaption}
)}\label{namespaceintegral_a68d4493444bb3e0032f10353bdfebbaf}


Definition at line 34 of file integral.\+f90.



References group, prep\+\_\+forms, and setup().


\begin{DoxyCode}
34       \textcolor{keywordtype}{use }typy
35       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
36       \textcolor{comment}{!   parametry}
37       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! }
38       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)}  :: n
39       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: ierr 
40       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
41       \textcolor{comment}{! n ... naximalni rad generovane formule}
42       \textcolor{comment}{! ierr .. chybove hlaseni}
43       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!    }
44       
45       
46       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
47       \textcolor{comment}{! lokalni promenne}
48       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
49       \textcolor{keywordtype}{integer(kind=ikind)}  :: i, ierr1
50       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{pointer} :: wrk
51       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
52       \textcolor{comment}{! vypocet}
53       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
54       \textcolor{keyword}{allocate}(group(1:n))
55       \textcolor{keywordflow}{do} i=1,n
56         \textcolor{keyword}{call }setup(i,group(i)%a, group(i)%h, ierr1)
57         \textcolor{keywordflow}{if} (ierr1 > 0 )then
58           exit
59 \textcolor{keyword}{        end }if
60 \textcolor{keyword}{      end }do
61       prep_forms = n
62       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ierr)) then
63         ierr = ierr1
64 \textcolor{keyword}{      end }if
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a68d4493444bb3e0032f10353bdfebbaf_cgraph}
\end{center}
\end{figure}


\index{integral@{integral}!integ@{integ}}
\index{integ@{integ}!integral@{integral}}
\subsubsection[{integ(a, b, f, n, rel\+\_\+chyba, counter, hloubka, ilvl)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public integral\+::integ (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(in)}]{a, }
\item[{real(kind=rkind), intent(in)}]{b, }
\item[{}]{f, }
\item[{integer(kind=ikind), intent(in), optional}]{n, }
\item[{real(kind=rkind), intent(in), optional}]{rel\+\_\+chyba, }
\item[{integer(kind=ikind), intent(in), optional}]{counter, }
\item[{integer(kind=ikind), intent(in), optional}]{hloubka, }
\item[{integer(kind=ikind), intent(in), optional}]{ilvl}
\end{DoxyParamCaption}
)}\label{namespaceintegral_ad2ba767444a71ee43a98ebdd6709e012}


Definition at line 354 of file integral.\+f90.



References integs().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_ad2ba767444a71ee43a98ebdd6709e012_cgraph}
\end{center}
\end{figure}


\index{integral@{integral}!integ1@{integ1}}
\index{integ1@{integ1}!integral@{integral}}
\subsubsection[{integ1(a, b, f, n)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public integral\+::integ1 (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(in)}]{a, }
\item[{real(kind=rkind), intent(in)}]{b, }
\item[{}]{f, }
\item[{integer(kind=ikind), intent(in)}]{n}
\end{DoxyParamCaption}
)}\label{namespaceintegral_a42d45c31cbfe77ffd095e78ae74d13bb}


Definition at line 107 of file integral.\+f90.



References getform().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a42d45c31cbfe77ffd095e78ae74d13bb_cgraph}
\end{center}
\end{figure}


\index{integral@{integral}!integ2@{integ2}}
\index{integ2@{integ2}!integral@{integral}}
\subsubsection[{integ2(a, b, f, n)}]{\setlength{\rightskip}{0pt plus 5cm}pure real(kind=rkind) function, private integral\+::integ2 (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(in)}]{a, }
\item[{real(kind=rkind), intent(in)}]{b, }
\item[{}]{f, }
\item[{integer(kind=ikind), intent(in)}]{n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a3c16947e0508bb58f89ba4e0039fb0d2}


Definition at line 160 of file integral.\+f90.



References getform().



Referenced by integs().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a3c16947e0508bb58f89ba4e0039fb0d2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a3c16947e0508bb58f89ba4e0039fb0d2_icgraph}
\end{center}
\end{figure}


\index{integral@{integral}!integs@{integs}}
\index{integs@{integs}!integral@{integral}}
\subsubsection[{integs(a, b, f, n, rel\+\_\+chyba, i\+\_\+err, counter, hloubka, ilvl, cislo)}]{\setlength{\rightskip}{0pt plus 5cm}pure recursive subroutine, public integral\+::integs (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(in)}]{a, }
\item[{real(kind=rkind), intent(in)}]{b, }
\item[{}]{f, }
\item[{integer(kind=ikind), intent(in), optional}]{n, }
\item[{real(kind=rkind), intent(in), optional}]{rel\+\_\+chyba, }
\item[{integer(kind=ikind), intent(out), optional}]{i\+\_\+err, }
\item[{integer(kind=ikind), intent(in), optional}]{counter, }
\item[{integer(kind=ikind), intent(in), optional}]{hloubka, }
\item[{integer(kind=ikind), intent(in), optional}]{ilvl, }
\item[{real(kind=rkind), intent(out)}]{cislo}
\end{DoxyParamCaption}
)}\label{namespaceintegral_a19c564e607776455a57985c601147236}


Definition at line 208 of file integral.\+f90.



References getform(), and integ2().



Referenced by integ().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a19c564e607776455a57985c601147236_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{namespaceintegral_a19c564e607776455a57985c601147236_icgraph}
\end{center}
\end{figure}


\index{integral@{integral}!setup@{setup}}
\index{setup@{setup}!integral@{integral}}
\subsubsection[{setup(n, a, h, ierr)}]{\setlength{\rightskip}{0pt plus 5cm}pure subroutine, private integral\+::setup (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(in)}]{n, }
\item[{real(kind=rkind), dimension(\+:), pointer}]{a, }
\item[{real(kind=rkind), dimension(\+:), pointer}]{h, }
\item[{integer(kind=ikind), intent(out), optional}]{ierr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a24274aecb38e46145fb771f116b452ba}


Definition at line 411 of file integral.\+f90.



References dohledej(), linalg\+::gem(), and horner().



Referenced by getform(), and init\+\_\+integration\+\_\+formulas().


\begin{DoxyCode}
411     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
412     \textcolor{comment}{!  slouzi k vytvorenu uzlu a koeficientu  pro }
413     \textcolor{comment}{!  Gaussovu kvadraturu}
414       \textcolor{keywordtype}{use }typy
415       \textcolor{keywordtype}{use }linalg
416 
417 
418       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
419       \textcolor{comment}{! parrametry}
420       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
421       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{pointer} :: a,h
422       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: n 
423       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: ierr 
424       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
425       \textcolor{comment}{!    n ... pocet bodu kvadr. vzorce}
426       \textcolor{comment}{!    a ... uzly kvadraturniho}
427       \textcolor{comment}{!    h ... vahy kbadraturniho vzorce}
428       \textcolor{comment}{! ierr ... chybova zprava - nepovinna}
429 
430       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
431       \textcolor{comment}{! lokalni promenne}
432       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
433       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)} ::  p, b 
434       \textcolor{comment}{! p ... n-ty ortogonalni polynom,}
435       \textcolor{comment}{! b ... prava strany soustavy, kterou budeme vyrabet}
436       \textcolor{keywordtype}{real(kind=rkind)} :: x,y, x0, y0, x1, y1, step
437       \textcolor{keywordtype}{integer(kind=ikind)} :: i,k, ik,ik1, m, nn
438       \textcolor{comment}{!indexy, m=n/2}
439       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:,:)} :: matice
440       \textcolor{comment}{! matice ... matice soustavy, pro polynom a vahy}
441       \textcolor{keywordtype}{logical} :: sud
442       \textcolor{comment}{! sud ... sudost/lichost n}
443       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:,:)} :: intervaly
444       \textcolor{keywordtype}{integer(kind=ikind)} :: pocet, ierr1
445 
446 
447       ierr1 = 0
448       \textcolor{comment}{! najdu n-ty ortogonalni polynom}
449       \textcolor{comment}{! tvorim jen nenulove koeficienty}
450       \textcolor{keywordflow}{if} (modulo(n,2\_ikind)==0) \textcolor{keywordflow}{then} \textcolor{comment}{! je to sude}
451         sud=.true.
452         m=n/2+1
453         \textcolor{keyword}{allocate}(matice(n/2,n/2), b(n/2), p(n/2+1)) 
454         \textcolor{comment}{!print *, "jsme v sude casti"}
455         \textcolor{keywordflow}{do} k=1,n/2
456           \textcolor{keywordflow}{do} i=1,n/2
457             matice(k,i)=2.0\_rkind/(2*(i+k)-3)
458 \textcolor{keyword}{          end }do
459           b(k)=-2.0\_rkind/(n+2*k-1)
460 \textcolor{keyword}{        end }do
461         \textcolor{keyword}{call }gem(matice,b,p(1:n/2))
462         p(n/2+1)=1.0\_rkind
463         \textcolor{keyword}{deallocate}(matice,b)
464       \textcolor{keywordflow}{else} 
465         sud=.false.
466         m=n/2+1
467         \textcolor{keywordflow}{if} (n>1\_ikind) \textcolor{keywordflow}{then}             
468           \textcolor{keyword}{allocate}(matice(n/2,n/2), b(n/2), p(n/2+1))
469           \textcolor{comment}{! n/2 se rizne o pulku dolu}
470           \textcolor{keywordflow}{do} k=1,n/2
471             \textcolor{keywordflow}{do} i=1,n/2
472               matice(k,i)=2.0\_rkind/(2*(i+k)-1)
473 \textcolor{keyword}{            end }do
474             b(k)=-2.0\_rkind/(n+2*k)
475 \textcolor{keyword}{          end }do
476           \textcolor{keyword}{call }gem(matice,b,p(1:n/2))
477           p(n/2+1)=1.0\_rkind
478           \textcolor{keyword}{deallocate}(matice,b)
479             \textcolor{keywordflow}{else} \textcolor{comment}{!tim vyresime problem je-li p stupne jedna}
480           \textcolor{keyword}{allocate}(p(1))
481           p(1)=1.0\_rkind
482 \textcolor{keyword}{        end }if
483 \textcolor{keyword}{      end }if
484       \textcolor{comment}{! mam ortogonalni polynom}
485 
486       \textcolor{comment}{!jdu hledat koereny}
487       \textcolor{keywordflow}{if} (sud) then
488         \textcolor{keyword}{allocate}(a(m-1))
489       else
490         \textcolor{keyword}{allocate}(a(m))
491         a(m)=0 \textcolor{comment}{! v lichem pripade je 0 vzdy korenem}
492 \textcolor{keyword}{      end }if
493       \textcolor{comment}{!je naolokovano jdeme na koreny, najdu jejich ctverce}
494       \textcolor{keywordflow}{select case}(m)
495         \textcolor{keywordflow}{case}(1)
496           \textcolor{keywordflow}{continue} \textcolor{comment}{!je to nula a to uz je dano vyse}
497         \textcolor{keywordflow}{case}(2)
498           a(1) = -p(1) \textcolor{comment}{!ve skutecnosti to je -p(1)/p(2) }
499         \textcolor{keywordflow}{case}(3)
500           a(1) = (-p(2)+sqrt(p(2)*p(2)-4*p(1)*p(3)))/(2*p(3))
501           a(2) = p(1)/p(3)/a(1)
502 \textcolor{keywordflow}{        case default}
503           \textcolor{keyword}{allocate}(intervaly(2,m-1))
504           nn=10*m
505           \textcolor{keywordflow}{do} 
506             step = 1.0\_rkind/nn
507             pocet = 0
508             x0 = step
509             y0 = horner(p,x0)
510             \textcolor{keywordflow}{do} i=1, nn
511               x1 = x0
512               y1 = y0
513               x0 = x0+step
514               y0 = horner(p,x0)
515               \textcolor{keywordflow}{if} (y0*y1 <= 0) then
516                 pocet = pocet + 1
517                 intervaly(:,(m-pocet))= (/ x1, x0 /)
518 \textcolor{keyword}{              end }if
519 \textcolor{keywordflow}{            end do}      
520             \textcolor{keywordflow}{if} (pocet == m-1) \textcolor{keywordflow}{then} 
521               \textcolor{keywordflow}{exit}              
522             else
523               nn=5*nn
524 \textcolor{keyword}{            end }if
525 \textcolor{keywordflow}{          end do}        
526           \textcolor{keywordflow}{do} i=1,m-1
527             a(i)=dohledej(intervaly(1,i),intervaly(2,i),p)
528 \textcolor{keyword}{          end }do
529 \textcolor{keyword}{      end }select
530       \textcolor{comment}{! ted to odmocnime}
531       a = sqrt(a)
532       \textcolor{comment}{! a ted spocitam vahy}
533       \textcolor{keywordflow}{if} (modulo(n,2\_ikind)==0) \textcolor{keywordflow}{then} \textcolor{comment}{!suda vetev}
534         \textcolor{keyword}{allocate}(matice(n/2,n/2))
535         \textcolor{keyword}{allocate}(b(n/2))
536         \textcolor{keyword}{allocate}(h(n/2))
537         matice(1,:) = 1.0\_rkind
538         b = a*a
539         \textcolor{keywordflow}{do} i=2, n/2
540           matice(i,:) = matice(i-1,:)*b
541 \textcolor{keyword}{        end }do
542         \textcolor{keywordflow}{do} i=1, n/2
543           b(i) = 1.0\_rkind/(2*i-1)
544 \textcolor{keyword}{        end }do
545         \textcolor{keyword}{call }gem(matice,b,h)
546       \textcolor{keywordflow}{else}  \textcolor{comment}{!licha vetev}
547         \textcolor{keyword}{allocate}(matice(n/2+1, n/2+1))
548         \textcolor{keyword}{allocate}(b(n/2+1))
549         \textcolor{keyword}{allocate}(h(n/2+1))
550         matice(1,:) = 2.0\_rkind
551         matice(1,ubound(matice,2)) = 1.0\_rkind
552         b = a*a
553         \textcolor{keywordflow}{do} i=2, ubound(matice,1)
554           matice(i,:) = matice(i-1,:)*b
555 \textcolor{keyword}{        end }do
556         \textcolor{keywordflow}{do} i=1, ubound(b,1)
557           b(i) = 2.0\_rkind/(2*i-1)
558 \textcolor{keyword}{        end }do
559         \textcolor{keyword}{call }gem(matice,b,h)
560 \textcolor{keyword}{      end }if
561       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ierr) ) then
562         ierr = ierr1
563 \textcolor{keyword}{      end }if
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a24274aecb38e46145fb771f116b452ba_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceintegral_a24274aecb38e46145fb771f116b452ba_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{integral@{integral}!group@{group}}
\index{group@{group}!integral@{integral}}
\subsubsection[{group}]{\setlength{\rightskip}{0pt plus 5cm}type({\bf formulka}), dimension(\+:), pointer, private integral\+::group =$>$ null()\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a9c872ca13e366bf47647fadfff816216}


Definition at line 12 of file integral.\+f90.



Referenced by getform(), and init\+\_\+integration\+\_\+formulas().


\begin{DoxyCode}
12   \textcolor{keywordtype}{type}(formulka), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{pointer}, \textcolor{keywordtype}{private} :: group => null()
\end{DoxyCode}
\index{integral@{integral}!prep\+\_\+forms@{prep\+\_\+forms}}
\index{prep\+\_\+forms@{prep\+\_\+forms}!integral@{integral}}
\subsubsection[{prep\+\_\+forms}]{\setlength{\rightskip}{0pt plus 5cm}integer, private integral\+::prep\+\_\+forms = 0\hspace{0.3cm}{\ttfamily [private]}}\label{namespaceintegral_a50885313c2eb530ba1d15bfabb12a941}


Definition at line 29 of file integral.\+f90.



Referenced by getform(), and init\+\_\+integration\+\_\+formulas().


\begin{DoxyCode}
29   \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{private} :: prep_forms = 0
\end{DoxyCode}
