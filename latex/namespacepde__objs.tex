\section{pde\+\_\+objs Module Reference}
\label{namespacepde__objs}\index{pde\+\_\+objs@{pde\+\_\+objs}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface {\bf basic\+\_\+subrt}
\item 
interface {\bf bc\+\_\+fnc}
\begin{DoxyCompactList}\small\item\em abstract interface for boundary value function \end{DoxyCompactList}\item 
type {\bf boundary\+\_\+vals}
\begin{DoxyCompactList}\small\item\em data structure to carry boundary value problem setup, allocation starts at 100 \end{DoxyCompactList}\item 
interface {\bf getval\+\_\+str}
\item 
interface {\bf icond\+\_\+fnc}
\item 
interface {\bf logical\+\_\+fnc}
\item 
interface {\bf matrix\+\_\+solver}
\item 
type {\bf pde\+\_\+common\+\_\+str}
\item 
type {\bf pde\+\_\+fnc}
\item 
type {\bf pde\+\_\+str}
\begin{DoxyCompactList}\small\item\em type definition for common quasilinear partial diferential equation in a format \[ E(u)\frac{\partial u}{\partial t} = \nabla . D(u) \nabla u - \nabla . (c(u) u) + r(u) u \] \end{DoxyCompactList}\item 
interface {\bf scalar\+\_\+fnc}
\begin{DoxyCompactList}\small\item\em abstract interface for scalar function \end{DoxyCompactList}\item 
interface {\bf tensor\+\_\+fnc}
\begin{DoxyCompactList}\small\item\em abstract interface for vector function \end{DoxyCompactList}\item 
interface {\bf time\+\_\+check}
\item 
interface {\bf timeint\+\_\+fnc}
\item 
interface {\bf treat\+\_\+pde\+\_\+subrt}
\item 
interface {\bf vector\+\_\+fnc}
\begin{DoxyCompactList}\small\item\em abstract interface for vector function \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf getgradp1} (pde\+\_\+loc, quadpnt, grad)
\begin{DoxyCompactList}\small\item\em returns solution gradient for p1 approximation \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf getvalp1} (pde\+\_\+loc, quadpnt)
\begin{DoxyCompactList}\small\item\em returns solution value for p1 approximation \end{DoxyCompactList}\item 
real(kind=rkind) function, private {\bf getvalp1loc} (pde\+\_\+loc, quadpnt, stopme)
\begin{DoxyCompactList}\small\item\em in case of asynchronyous temporal integration this function is separated from getvalp1, if standard temporal integration used, then this function is called from the first line of getvalp1 \end{DoxyCompactList}\item 
subroutine {\bf get2dderivative} (a, b, c, xder, yder)
\item 
subroutine, public {\bf do\+\_\+nothing} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
type({\bf pde\+\_\+str}), dimension(\+:), allocatable, public {\bf pde}
\item 
type({\bf pde\+\_\+common\+\_\+str}), public {\bf pde\+\_\+common}
\item 
procedure({\bf matrix\+\_\+solver}), pointer, public {\bf solve\+\_\+matrix}
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{pde\+\_\+objs@{pde\+\_\+objs}!do\+\_\+nothing@{do\+\_\+nothing}}
\index{do\+\_\+nothing@{do\+\_\+nothing}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{do\+\_\+nothing()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public pde\+\_\+objs\+::do\+\_\+nothing (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepde__objs_a08f1c824ed37d9ff3bfb557ddeb1b4c1}


Definition at line 650 of file pde\+\_\+objs.\+f90.



Referenced by drutes\+\_\+init\+::pde\+\_\+constructor(), and pde\+\_\+objs\+::treat\+\_\+pde\+\_\+subrt\+::treat\+\_\+pde\+\_\+subrt().


\begin{DoxyCode}
650     
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_a08f1c824ed37d9ff3bfb557ddeb1b4c1_icgraph}
\end{center}
\end{figure}


\index{pde\+\_\+objs@{pde\+\_\+objs}!get2dderivative@{get2dderivative}}
\index{get2dderivative@{get2dderivative}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{get2dderivative(a, b, c, xder, yder)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pde\+\_\+objs\+::get2dderivative (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{a, }
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{b, }
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{c, }
\item[{real(kind=rkind), intent(out)}]{xder, }
\item[{real(kind=rkind), intent(out)}]{yder}
\end{DoxyParamCaption}
)}\label{namespacepde__objs_aafa68686beee7a3cff07efb9febdfae0}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & 1st point of the plane\\
\hline
\mbox{\tt in}  & {\em b} & 2nd point of the plane\\
\hline
\mbox{\tt in}  & {\em c} & 3rd point of the plane\\
\hline
\mbox{\tt out}  & {\em xder} & resulting x derivate\\
\hline
\mbox{\tt out}  & {\em yder} & resulting y derivate \\
\hline
\end{DoxyParams}


Definition at line 593 of file pde\+\_\+objs.\+f90.



Referenced by getgradp1(), and getvalp1loc().


\begin{DoxyCode}
593       \textcolor{keywordtype}{use }typy
595       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: a
597       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: b
599       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c
601       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)} :: xder
603       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)} :: yder
604       \textcolor{comment}{!-------local variables--------------}
605       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: u
606       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: v
607       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: n
608       \textcolor{keywordtype}{integer(kind=ikind)} :: i
609       \textcolor{keywordtype}{real(kind=rkind)} :: reps
610 
611 
612       reps = epsilon(reps)
613 
614 
615       \textcolor{comment}{!check if the plane is not horizontal}
616       \textcolor{keywordflow}{if} (abs(a(3) - b(3)) < reps*(abs(a(3))-abs(b(3)))  .and.  &
617           abs(a(3) - c(3)) < reps*(abs(a(3))-abs(c(3)))  .and.  &
618           abs(b(3) - c(3)) < reps*(abs(b(3))-abs(c(3)))) \textcolor{keywordflow}{then}
619         xder = 0.0\_rkind
620         yder = 0.0\_rkind
621         \textcolor{keywordflow}{RETURN}
622       \textcolor{keywordflow}{else}
623         \textcolor{keywordflow}{CONTINUE}
624 \textcolor{keywordflow}{      end if}
625 
626       \textcolor{comment}{!creates the plane vectors }
627       \textcolor{keywordflow}{do} i=1,3
628         u(i) = a(i) - b(i)
629         v(i) = a(i) - c(i)
630 \textcolor{keywordflow}{      end do}
631 
632       \textcolor{comment}{! the normal plane vector is defined as}
633       n(1) = u(2)*v(3) - v(2)*u(3)
634       n(2) = u(3)*v(1) - v(3)*u(1)
635       n(3) = u(1)*v(2) - v(1)*u(2)
636 
637       \textcolor{comment}{! finally the derivate is as follows, the horizontality has been already checked}
638       \textcolor{comment}{! the verticality check}
639       \textcolor{keywordflow}{if} (abs(n(3)) < 1e2*reps) \textcolor{keywordflow}{then}
640         print *, \textcolor{stringliteral}{"the mesh is wrong, base function can't be vertical"}
641         error stop
642 \textcolor{keywordflow}{      end if} 
643       xder = -n(1)/n(3)
644       yder = -n(2)/n(3)
645 
646       
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_aafa68686beee7a3cff07efb9febdfae0_icgraph}
\end{center}
\end{figure}


\index{pde\+\_\+objs@{pde\+\_\+objs}!getgradp1@{getgradp1}}
\index{getgradp1@{getgradp1}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{getgradp1(pde\+\_\+loc, quadpnt, grad)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public pde\+\_\+objs\+::getgradp1 (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{type({\bf integpnt\+\_\+str}), intent(in)}]{quadpnt, }
\item[{real(kind=rkind), dimension(\+:), intent(out), allocatable}]{grad}
\end{DoxyParamCaption}
)}\label{namespacepde__objs_aefc287211136e7fb40bb45ccb11886b2}


returns solution gradient for p1 approximation 



Definition at line 307 of file pde\+\_\+objs.\+f90.



References globals\+::drutes\+\_\+config, globals\+::elements, get2dderivative(), getvalp1(), globals\+::nodes, and globals\+::observation\+\_\+array.



Referenced by pde\+\_\+objs\+::treat\+\_\+pde\+\_\+subrt\+::treat\+\_\+pde\+\_\+subrt().


\begin{DoxyCode}
307       \textcolor{keywordtype}{use }typy
308       \textcolor{keywordtype}{use }decomp_vars
309 
310       
311       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
312       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)} :: quadpnt
313       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: quadpntloc
314       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: grad
315       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: gradloc
316       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: pts
317       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)}    :: a,b,c
318       \textcolor{keywordtype}{real(kind=rkind)} :: dx
319       \textcolor{keywordtype}{integer(kind=ikind)} :: i, el, top, j
320 
321       
322       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(grad)) \textcolor{keywordflow}{then}
323         \textcolor{keyword}{allocate}(grad(drutes_config%dimen))
324       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ubound(grad,1) /= drutes_config%dimen ) \textcolor{keywordflow}{then}
325         \textcolor{keyword}{deallocate}(grad)
326         \textcolor{keyword}{allocate}(grad(drutes_config%dimen))
327 \textcolor{keywordflow}{      end if}
328       
329       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(pts)) \textcolor{keywordflow}{then}
330         \textcolor{keyword}{allocate}(pts(ubound(elements%data,2)))
331         \textcolor{keyword}{allocate}(quadpntloc(ubound(elements%data,2)))
332 \textcolor{keywordflow}{      end if}
333       
334       \textcolor{keywordflow}{select case}(quadpnt%type\_pnt)
335         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"gqnd"}, \textcolor{stringliteral}{"obpt"})
336           top = 1
337         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ndpt"})
338           \textcolor{comment}{!in case of ndpt the gradient is assumed as an average value of gradients at neighbourhood points}
339           top = nodes%element(quadpnt%order)%pos
340 \textcolor{keywordflow}{        case default}
341           print *, \textcolor{stringliteral}{"RUNTIME ERROR: incorrect quadpnt type definition (value quadpnt%type\_pnt)"}
342           print *, \textcolor{stringliteral}{"the value specified in code was:"}, quadpnt%type\_pnt
343           print *, \textcolor{stringliteral}{"exited from pde\_objs::getgradp1"}
344           error stop
345           
346           
347 \textcolor{keywordflow}{      end select}
348       
349       gradloc = 0
350       \textcolor{keywordflow}{do} i=1, top  
351         \textcolor{keywordflow}{select case}(quadpnt%type\_pnt)
352           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"gqnd"})
353             el = quadpnt%element
354           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"obpt"})
355             el = observation_array(quadpnt%order)%element
356           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ndpt"})
357             el = nodes%element(quadpnt%order)%data(i)
358 \textcolor{keywordflow}{        end select}
359         
360         pts = elements%data(el,:)
361         
362         quadpntloc(:) = quadpnt
363         quadpntloc(:)%type\_pnt = \textcolor{stringliteral}{"ndpt"}
364         \textcolor{keywordflow}{select case}(drutes_config%dimen)
365           \textcolor{keywordflow}{case}(1)
366             dx = nodes%data(pts(2),1) - nodes%data(pts(1),1)
367             quadpntloc(1)%order = pts(1)
368             quadpntloc(2)%order = pts(2)
369             gradloc(1) = gradloc(1) + (getvalp1(pde\_loc,quadpntloc(2)) - 
      getvalp1\textcolor{comment}{(pde\_loc, quadpntloc(1)))/dx}
370 \textcolor{comment}{          }\textcolor{keywordflow}{case}(2)
371             a(1:2) = nodes%data(pts(1),:)
372             b(1:2) = nodes%data(pts(2),:)
373             c(1:2) = nodes%data(pts(3),:)
374             
375             
376             quadpntloc(1)%order = pts(1)
377             quadpntloc(2)%order = pts(2)
378             quadpntloc(3)%order = pts(3)
379             
380             
381             
382             a(3) = getvalp1(pde\_loc, quadpntloc(1))
383             b(3) = getvalp1(pde\_loc, quadpntloc(2))
384             c(3) = getvalp1(pde\_loc, quadpntloc(3))
385             \textcolor{keyword}{call }get2dderivative(a,b,c,grad(1), grad(2))
386 
387             gradloc(1:2) = gradloc(1:2) + grad
388           \textcolor{keywordflow}{case}(3)
389 \textcolor{keywordflow}{        end select}
390 \textcolor{keywordflow}{      end do}
391       
392       grad = gradloc(1:drutes_config%dimen)/top
393     
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_aefc287211136e7fb40bb45ccb11886b2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=301pt]{namespacepde__objs_aefc287211136e7fb40bb45ccb11886b2_icgraph}
\end{center}
\end{figure}


\index{pde\+\_\+objs@{pde\+\_\+objs}!getvalp1@{getvalp1}}
\index{getvalp1@{getvalp1}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{getvalp1(pde\+\_\+loc, quadpnt)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, public pde\+\_\+objs\+::getvalp1 (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{type({\bf integpnt\+\_\+str}), intent(in)}]{quadpnt}
\end{DoxyParamCaption}
)}\label{namespacepde__objs_aece3def127980c03c455456068cb3e48}


returns solution value for p1 approximation 



Definition at line 398 of file pde\+\_\+objs.\+f90.



References getvalp1loc(), decomp\+\_\+vars\+::subdomain, globals\+::time, and globals\+::time\+\_\+step.



Referenced by getgradp1(), re\+\_\+total\+::getval\+\_\+retot(), dual\+\_\+por\+::getval\+\_\+retot\+\_\+dual(), drutes\+\_\+init\+::pde\+\_\+constructor(), re\+\_\+pointers\+::re\+\_\+std(), and pde\+\_\+objs\+::treat\+\_\+pde\+\_\+subrt\+::treat\+\_\+pde\+\_\+subrt().


\begin{DoxyCode}
398       \textcolor{keywordtype}{use }typy
399       \textcolor{keywordtype}{use }decomp_vars
400       
401       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
402       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)} :: quadpnt
403       \textcolor{keywordtype}{real(kind=rkind)} :: val
404       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
405       
406       \textcolor{keywordtype}{type}(integpnt_str) :: quadpntloc
407       \textcolor{keywordtype}{real(kind=rkind)} :: valprev, timeprev, timeglob
408       \textcolor{keywordtype}{logical} :: stopper=.false.
409 
410    
411        val = getvalp1loc(pde\_loc, quadpnt)
412 
413 
414       \textcolor{keywordflow}{if} (quadpnt%globtime .or. quadpnt%column==1) \textcolor{keywordflow}{then}
415         \textcolor{keywordflow}{RETURN}
416       \textcolor{keywordflow}{else}
417         quadpntloc = quadpnt
418         quadpntloc%column = 4
419         \textcolor{keywordflow}{if} (quadpnt%ddlocal) \textcolor{keywordflow}{then}
420           timeglob = subdomain(quadpnt%subdom)%time
421           timeprev = subdomain(quadpnt%subdom)%time - subdomain(quadpnt%subdom)%time\_step
422         \textcolor{keywordflow}{else}
423           timeglob = time
424           timeprev = time-time_step
425 \textcolor{keywordflow}{        end if}
426 
427         valprev = getvalp1loc(pde\_loc, quadpntloc)
428         tmp=val
429         val = (val-valprev)/(timeglob-timeprev)*(quadpnt%time4eval-timeprev)+valprev
430 
431 \textcolor{keywordflow}{      end if}
432         
433     
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_aece3def127980c03c455456068cb3e48_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_aece3def127980c03c455456068cb3e48_icgraph}
\end{center}
\end{figure}


\index{pde\+\_\+objs@{pde\+\_\+objs}!getvalp1loc@{getvalp1loc}}
\index{getvalp1loc@{getvalp1loc}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{getvalp1loc(pde\+\_\+loc, quadpnt, stopme)}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=rkind) function, private pde\+\_\+objs\+::getvalp1loc (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(in)}]{pde\+\_\+loc, }
\item[{type({\bf integpnt\+\_\+str}), intent(in)}]{quadpnt, }
\item[{logical, intent(in), optional}]{stopme}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacepde__objs_ad649cdb29899f292c7702c48fa9a6cf0}


in case of asynchronyous temporal integration this function is separated from getvalp1, if standard temporal integration used, then this function is called from the first line of getvalp1 



Definition at line 439 of file pde\+\_\+objs.\+f90.



References globals\+::drutes\+\_\+config, globals\+::elements, globals\+::gauss\+\_\+points, get2dderivative(), globals\+::nodes, globals\+::observation\+\_\+array, pde\+\_\+common, and decomp\+\_\+vars\+::subdomain.



Referenced by getvalp1(), and pde\+\_\+objs\+::treat\+\_\+pde\+\_\+subrt\+::treat\+\_\+pde\+\_\+subrt().


\begin{DoxyCode}
439       \textcolor{keywordtype}{use }typy
440       \textcolor{keywordtype}{use }decomp_vars
441 
442       
443       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in)} :: pde\_loc
444       \textcolor{keywordtype}{type}(integpnt_str), \textcolor{keywordtype}{intent(in)} :: quadpnt
445       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: stopme
446       \textcolor{keywordtype}{real(kind=rkind)} :: val
447       
448       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: pts, ppts
449       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{save} :: ndvals
450       \textcolor{keywordtype}{integer(kind=ikind)} :: i, edge, el, j, order
451       \textcolor{keywordtype}{real(kind=rkind)} :: xder, yder
452       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3,3)} :: a
453       
454       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(pde_common%xvect)) \textcolor{keywordflow}{then}
455         print *, \textcolor{stringliteral}{"runtime error, you are probably calling getval function too early, vector with solution
       is not yet allocated"}
456         print *, \textcolor{stringliteral}{"contact Michal -> michalkuraz@gmail.com"}
457         error stop
458 \textcolor{keywordflow}{      end if}
459       
460             
461       
462      \textcolor{keywordflow}{select case}(quadpnt%type\_pnt)
463         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"gqnd"}, \textcolor{stringliteral}{"obpt"})
464             \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(pts) ) \textcolor{keywordflow}{then}
465               \textcolor{keyword}{allocate}(pts(ubound(elements%data,2)))
466               \textcolor{keyword}{allocate}(ppts(ubound(elements%data,2)))
467               \textcolor{keyword}{allocate}(ndvals(ubound(elements%data,2)))
468 \textcolor{keywordflow}{            end if}
469             
470             
471             \textcolor{keywordflow}{select case}(quadpnt%type\_pnt)
472               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"gqnd"})
473                 el = quadpnt%element
474               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"obpt"})
475                 el = observation_array(quadpnt%order)%element
476 \textcolor{keywordflow}{            end select}
477               
478             pts = elements%data(el,:)
479             ppts = pde\_loc%permut(pts)
480             
481                 
482             \textcolor{keywordflow}{if} (quadpnt%ddlocal) \textcolor{keywordflow}{then}
483               \textcolor{keywordflow}{if} (.not. quadpnt%extended) \textcolor{keywordflow}{then}
484                 \textcolor{keywordflow}{where} (ppts /= 0)
485                   ppts = subdomain(quadpnt%subdom)%invpermut(ppts)
486 \textcolor{keywordflow}{                end where}
487               \textcolor{keywordflow}{else} 
488                 \textcolor{keywordflow}{where} (ppts /= 0)
489                   ppts = subdomain(quadpnt%subdom)%extinvpermut(ppts)
490 \textcolor{keywordflow}{                end where}
491 \textcolor{keywordflow}{              end if}
492 \textcolor{keywordflow}{            end if}
493 
494 
495             
496             \textcolor{keywordflow}{do} i=1, ubound(elements%data,2)
497         
498               \textcolor{keywordflow}{if} (ppts(i) > 0) \textcolor{keywordflow}{then}
499 
500                 \textcolor{keywordflow}{if} (.not. quadpnt%ddlocal) \textcolor{keywordflow}{then}
501                   ndvals(i) = pde_common%xvect(ppts(i), quadpnt%column)
502                 \textcolor{keywordflow}{else}
503                   \textcolor{keywordflow}{if} (.not. quadpnt%extended) \textcolor{keywordflow}{then}
504                     ndvals(i) = subdomain(quadpnt%subdom)%xvect(ppts(i), quadpnt%column\textcolor{comment}{)}
505 \textcolor{comment}{                  }\textcolor{keywordflow}{else}
506                     ndvals(i) = subdomain(quadpnt%subdom)%extxvect(ppts(i), quadpnt%column\textcolor{comment}{)}
507 \textcolor{comment}{}\textcolor{keywordflow}{                  end if}
508 \textcolor{keywordflow}{                end if}
509               \textcolor{keywordflow}{else}
510 
511                 edge = nodes%edge(pts(i))
512 
513                 
514                 \textcolor{keyword}{call }pde\_loc%bc(edge)%value\_fnc(pde\_loc, el, i, ndvals(i))
515                 
516 \textcolor{keywordflow}{              end if}
517 \textcolor{keywordflow}{            end do}
518 
519        
520             \textcolor{keywordflow}{select case}(quadpnt%type\_pnt)
521               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"gqnd"})
522                 \textcolor{keywordflow}{select case}(drutes_config%dimen)
523                   \textcolor{keywordflow}{case}(1)
524                     val = (ndvals(2) - ndvals(1))*gauss_points%point(quadpnt%order,1) \textcolor{comment}{+ ndvals(1)}
525 \textcolor{comment}{                  }\textcolor{keywordflow}{case}(2)
526                     \textcolor{keyword}{call }get2dderivative((/0.0\_rkind, 0.0\_rkind, ndvals(1)/), (/1.0\_rkind\textcolor{comment}{, 0.0\_rkind, 
      ndvals(2)/), (/0.0\_rkind, &}
527 \textcolor{comment}{                                   1.0\_rkind, ndvals(3)/), xder, yder)}
528 \textcolor{comment}{                    val = ndvals(1) + xder*gauss_points%point(quadpnt%order,1) + yder*
      gauss_points%point(quadpnt%order,2)}
529 \textcolor{comment}{}\textcolor{keywordflow}{                end select}
530               \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"obpt"})
531                 \textcolor{keywordflow}{select case}(drutes_config%dimen)
532                   \textcolor{keywordflow}{case}(1)
533                      val = (ndvals(2) - ndvals(1))/(nodes%data(pts(2),1) - nodes%data(pts\textcolor{comment}{(1),1))*(
      observation_array(quadpnt%order)%xyz(1) - &}
534 \textcolor{comment}{                           nodes%data(pts(1),1)) + ndvals(1)}
535 \textcolor{comment}{                  }\textcolor{keywordflow}{case}(2)
536                     \textcolor{keywordflow}{do} i=1,3
537                       \textcolor{keywordflow}{do} j=1,2
538                         a(i,j) = nodes%data(pts(i),j)
539 \textcolor{keywordflow}{                      end do}
540                       a(i,3) = ndvals(i)
541 \textcolor{keywordflow}{                    end do}
542                             
543                     \textcolor{keyword}{call }get2dderivative(a(1,:), a(2,:), a(3,:), xder, yder)
544                     
545                     val = ndvals(1) + xder*(observation_array(quadpnt%order)%xyz(1) - a\textcolor{comment}{(1,1)) + &}
546 \textcolor{comment}{                          yder * (observation_array(quadpnt%order)%xyz(2) - a(1,2))}
547 \textcolor{comment}{}\textcolor{keywordflow}{                end select}
548 \textcolor{keywordflow}{          end select}
549                     
550         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"ndpt"})
551             i = pde\_loc%permut(quadpnt%order)
552 
553             \textcolor{keywordflow}{if} (i > 0) \textcolor{keywordflow}{then}
554               \textcolor{keywordflow}{if} (.not. quadpnt%ddlocal) \textcolor{keywordflow}{then}
555                 val = pde_common%xvect(i, quadpnt%column)
556               \textcolor{keywordflow}{else}
557               
558                 \textcolor{keywordflow}{if} (.not. quadpnt%extended) \textcolor{keywordflow}{then}
559 
560                   i = subdomain(quadpnt%subdom)%invpermut(i)
561 
562                   val = subdomain(quadpnt%subdom)%xvect(i, quadpnt%column)
563 
564                 \textcolor{keywordflow}{else}
565                   i = subdomain(quadpnt%subdom)%extinvpermut(i)
566                   val = subdomain(quadpnt%subdom)%extxvect(i, quadpnt%column)
567 \textcolor{keywordflow}{                end if}
568 \textcolor{keywordflow}{              end if}
569             \textcolor{keywordflow}{else}
570               edge = nodes%edge(quadpnt%order)
571               el = nodes%element(quadpnt%order)%data(1)
572               \textcolor{keywordflow}{do} i=1, ubound(elements%data,2)
573                 \textcolor{keywordflow}{if} (elements%data(el,i) == quadpnt%order) \textcolor{keywordflow}{then}
574                   order = i
575                   \textcolor{keywordflow}{EXIT}
576 \textcolor{keywordflow}{                end if}
577 \textcolor{keywordflow}{              end do}
578               \textcolor{keyword}{call }pde\_loc%bc(edge)%value\_fnc(pde\_loc, el, order, val)
579 \textcolor{keywordflow}{            end if}
580 
581 \textcolor{keywordflow}{        case default}
582             print *, \textcolor{stringliteral}{"RUNTIME ERROR: incorrect quadpnt type definition (value quadpnt%type\_pnt)"}
583             print *, \textcolor{stringliteral}{"the value specified in code was:"}, quadpnt%type\_pnt
584             print *, \textcolor{stringliteral}{"exited from pde\_objs::getvalp1"}
585             error stop
586 \textcolor{keywordflow}{      end select}
587           
588 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{namespacepde__objs_ad649cdb29899f292c7702c48fa9a6cf0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacepde__objs_ad649cdb29899f292c7702c48fa9a6cf0_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{pde\+\_\+objs@{pde\+\_\+objs}!pde@{pde}}
\index{pde@{pde}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{pde}]{\setlength{\rightskip}{0pt plus 5cm}type({\bf pde\+\_\+str}), dimension(\+:), allocatable, public pde\+\_\+objs\+::pde}\label{namespacepde__objs_ac7f502a66d87d5e3abad1d8c94022aca}


Definition at line 297 of file pde\+\_\+objs.\+f90.



Referenced by decomp\+\_\+tools\+::addlevel(), ade\+\_\+fnc\+::ade\+\_\+convection(), ade\+\_\+fnc\+::ade\+\_\+cscl\+\_\+react(), ade\+\_\+fnc\+::ade\+\_\+cscs\+\_\+react(), ade\+\_\+fnc\+::ade\+\_\+flux(), ade\+\_\+fnc\+::ade\+\_\+mass(), ade\+\_\+fnc\+::ade\+\_\+reaction(), ade\+\_\+fnc\+::ade\+\_\+tder\+\_\+coef(), ade\+\_\+fnc\+::ade\+\_\+tder\+\_\+cscl(), ade\+\_\+fnc\+::ade\+\_\+zerorder(), ade\+\_\+fnc\+::adecs\+\_\+mass(), ade\+\_\+fnc\+::adedispersion(), ade\+\_\+pointers\+::adekinsorb(), femmat\+::assemble\+\_\+mat(), bousspointers\+::boussi(), boussfnc\+::boussicond(), stiffmat\+::build\+\_\+bvect(), decomp\+\_\+tools\+::build\+\_\+coarsemtx(), stiffmat\+::build\+\_\+stiff\+\_\+np(), fem\+::close\+\_\+all\+\_\+observe(), decomp\+\_\+tools\+::collect\+\_\+matrices(), dual\+\_\+coup\+::dual\+\_\+coup\+\_\+min(), dual\+\_\+coup\+::dual\+\_\+coupling(), dual\+\_\+tab\+::dual\+\_\+coupling\+\_\+tab(), re\+\_\+dual\+\_\+bc\+::dual\+\_\+freedrainage(), feminittools\+::feminit(), heat\+\_\+pointers\+::heat\+\_\+source(), fem\+\_\+tools\+::icond4neumann(), capmat\+::impl\+\_\+euler\+\_\+np\+\_\+diag(), capmat\+::impl\+\_\+euler\+\_\+np\+\_\+nondiag(), fem\+\_\+tools\+::in2global(), decomposer\+::init\+\_\+decomp(), feminittools\+::init\+\_\+integ(), drutes\+\_\+init\+::init\+\_\+observe(), decomposer\+::init\+\_\+subdomain(), schwarz\+\_\+dd\+::locmat\+\_\+assembler(), schwarz\+\_\+dd2subcyc\+::locmat\+\_\+assembler(), postpro\+::make\+\_\+print(), geom\+\_\+tools\+::map1d2d(), geom\+\_\+tools\+::map1d2dj(), drutes\+\_\+init\+::pde\+\_\+constructor(), decomp\+\_\+tools\+::print\+\_\+domains(), postpro\+::print\+\_\+gmsh(), postpro\+::print\+\_\+pure(), postpro\+::print\+\_\+scilab(), re\+\_\+constitutive\+::rcza\+\_\+check\+\_\+old(), re\+\_\+dual\+\_\+pointers\+::re\+\_\+fracture(), re\+\_\+dual\+\_\+pointers\+::re\+\_\+matrix(), read\+\_\+inputs\+::read\+\_\+scilab(), objfnc\+::reader(), feminittools\+::reorder(), femmat\+::results\+\_\+extractor(), subcycling\+::results\+\_\+extractor(), schwarz\+\_\+dd\+::results\+\_\+extractor(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::results\+\_\+extractor(), schwarz\+\_\+dd\+::schwarz\+\_\+picard(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::schwarz\+\_\+picard\+\_\+tt(), schwarz\+\_\+dd2subcyc\+::schwarz\+\_\+subcyc(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::schwarzloc(), subcycling\+::search\+\_\+error\+\_\+cluster(), schwarz\+\_\+dd\+::search\+\_\+error\+\_\+cluster(), schwarz\+\_\+dd2subcyc\+::search\+\_\+error\+\_\+cluster(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::search\+\_\+error\+\_\+cluster\+\_\+tt(), manage\+\_\+pointers\+::set\+\_\+pointers(), decomposer\+::set\+\_\+subdomains(), femmat\+::solve\+\_\+picard(), subcycling\+::subcyc\+\_\+schwarz(), postpro\+::write\+\_\+obs(), and re\+\_\+constitutive\+::zone\+\_\+error\+\_\+val().


\begin{DoxyCode}
297   \textcolor{keywordtype}{type}(pde_str), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable},  \textcolor{keywordtype}{public} :: pde
\end{DoxyCode}
\index{pde\+\_\+objs@{pde\+\_\+objs}!pde\+\_\+common@{pde\+\_\+common}}
\index{pde\+\_\+common@{pde\+\_\+common}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{pde\+\_\+common}]{\setlength{\rightskip}{0pt plus 5cm}type({\bf pde\+\_\+common\+\_\+str}), public pde\+\_\+objs\+::pde\+\_\+common}\label{namespacepde__objs_a177df2f43aeb5ecde4cca531ecfbf4a1}


Definition at line 298 of file pde\+\_\+objs.\+f90.



Referenced by re\+\_\+pointers\+::allrepointers(), femmat\+::assemble\+\_\+mat(), boussread\+::boussreader(), subcycling\+::build\+\_\+xvect(), schwarz\+\_\+dd\+::build\+\_\+xvect(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::build\+\_\+xvect(), schwarz\+\_\+dd2subcyc\+::build\+\_\+xvect\+\_\+loc(), decomp\+\_\+tools\+::collect\+\_\+matrices(), schwarz\+\_\+dd2subcyc\+::combinevals(), feminittools\+::feminit(), decomp\+\_\+tools\+::get\+\_\+residual(), decomp\+\_\+tools\+::get\+\_\+residual\+\_\+old(), getvalp1loc(), heat\+\_\+pointers\+::heat(), fem\+\_\+tools\+::icond4neumann(), decomposer\+::init\+\_\+subdomain(), schwarz\+\_\+dd\+::locmat\+\_\+assembler(), schwarz\+\_\+dd2subcyc\+::locmat\+\_\+assembler(), core\+\_\+tools\+::mesh\+\_\+allocater(), drutes\+\_\+init\+::parse\+\_\+globals(), decomp\+\_\+tools\+::print\+\_\+domains(), re\+\_\+constitutive\+::rcza\+\_\+check\+\_\+old(), re\+\_\+constitutive\+::re\+\_\+atmospheric(), re\+\_\+constitutive\+::re\+\_\+neumann\+\_\+bc(), read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+gmsh(), read\+\_\+inputs\+::read\+\_\+global(), feminittools\+::reorder(), femmat\+::results\+\_\+extractor(), subcycling\+::results\+\_\+extractor(), schwarz\+\_\+dd\+::results\+\_\+extractor(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::results\+\_\+extractor(), re\+\_\+total\+::retot\+\_\+seepage(), schwarz\+\_\+dd\+::schwarz\+\_\+picard(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::schwarz\+\_\+picard\+\_\+tt(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::schwarzloc(), drutes\+\_\+init\+::set\+\_\+global\+\_\+vars(), manage\+\_\+pointers\+::set\+\_\+pointers(), fem\+::solve\+\_\+pde(), femmat\+::solve\+\_\+picard(), schwarz\+\_\+dd2subcyc\+::solve\+\_\+subdomain(), and subcycling\+::subcyc\+\_\+schwarz().


\begin{DoxyCode}
298   \textcolor{keywordtype}{type}(pde_common_str), \textcolor{keywordtype}{public} :: pde_common
\end{DoxyCode}
\index{pde\+\_\+objs@{pde\+\_\+objs}!solve\+\_\+matrix@{solve\+\_\+matrix}}
\index{solve\+\_\+matrix@{solve\+\_\+matrix}!pde\+\_\+objs@{pde\+\_\+objs}}
\subsubsection[{solve\+\_\+matrix}]{\setlength{\rightskip}{0pt plus 5cm}procedure({\bf matrix\+\_\+solver}), pointer, public pde\+\_\+objs\+::solve\+\_\+matrix}\label{namespacepde__objs_a351dcbad99541c9c3f9b6fd83c9b07c3}


Definition at line 299 of file pde\+\_\+objs.\+f90.



Referenced by schwarz\+\_\+dd\+::schwarz\+\_\+picard(), schwarz\+\_\+dd\+\_\+time\+\_\+test\+::schwarzloc(), manage\+\_\+pointers\+::set\+\_\+pointers(), femmat\+::solve\+\_\+picard(), schwarz\+\_\+dd2subcyc\+::solve\+\_\+subdomain(), and subcycling\+::subcyc\+\_\+schwarz().


\begin{DoxyCode}
299   \textcolor{keywordtype}{procedure}(matrix_solver), \textcolor{keywordtype}{pointer}, \textcolor{keywordtype}{public} :: solve_matrix
\end{DoxyCode}
