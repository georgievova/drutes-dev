\section{fem Module Reference}
\label{namespacefem}\index{fem@{fem}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf solve\+\_\+pde} (success)
\begin{DoxyCompactList}\small\item\em solves the nonstationary pde problem in time \end{DoxyCompactList}\item 
subroutine, private {\bf close\+\_\+all\+\_\+observe} ()
\item 
subroutine {\bf evol\+\_\+dt} (ierr, {\bf itcount})
\item 
subroutine, private {\bf terminal\+\_\+info} (ierr)
\item 
subroutine, private {\bf exitme} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer(kind=ikind), private {\bf itcount}
\item 
integer(kind=ikind), private {\bf obs\+\_\+pos}
\item 
integer(kind=ikind), private {\bf obs\+\_\+count}
\item 
integer(kind=ikind), private {\bf nptimes}
\item 
logical, private {\bf go\+\_\+clusters}
\item 
logical, private {\bf printtime}
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{fem@{fem}!close\+\_\+all\+\_\+observe@{close\+\_\+all\+\_\+observe}}
\index{close\+\_\+all\+\_\+observe@{close\+\_\+all\+\_\+observe}!fem@{fem}}
\subsubsection[{close\+\_\+all\+\_\+observe()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private fem\+::close\+\_\+all\+\_\+observe (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_aa9749d78a6ab9335ad16cb04595eac04}


Definition at line 136 of file fem.\+f90.



References pde\+\_\+objs\+::pde.



Referenced by solve\+\_\+pde().


\begin{DoxyCode}
136       \textcolor{keywordtype}{use }typy
137       \textcolor{keywordtype}{use }pde_objs
138       
139       \textcolor{keywordtype}{integer(kind=ikind)} :: i, name
140 
141       \textcolor{keywordflow}{do} i=1, ubound(pde,1)
142         \textcolor{keywordflow}{do} name=1, ubound(pde(i)%obspt\_unit,1)
143           \textcolor{keyword}{close}(pde(i)%obspt\_unit(name))
144 \textcolor{keywordflow}{        end do}
145 \textcolor{keywordflow}{      end do}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_aa9749d78a6ab9335ad16cb04595eac04_icgraph}
\end{center}
\end{figure}


\index{fem@{fem}!evol\+\_\+dt@{evol\+\_\+dt}}
\index{evol\+\_\+dt@{evol\+\_\+dt}!fem@{fem}}
\subsubsection[{evol\+\_\+dt(ierr, itcount)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine fem\+::evol\+\_\+dt (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{ierr, }
\item[{integer(kind=ikind), intent(in)}]{itcount}
\end{DoxyParamCaption}
)}\label{namespacefem_af582706106c3f9c9118b6730da771c2b}


Definition at line 150 of file fem.\+f90.



References globals\+::dtmax, globals\+::dtmin, globals\+::dtprev, exitme(), globals\+::max\+\_\+itcount, nptimes, obs\+\_\+count, obs\+\_\+pos, globals\+::observe\+\_\+info, globals\+::observe\+\_\+time, printtime, globals\+::time, globals\+::time\+\_\+step, and core\+\_\+tools\+::write\+\_\+log().



Referenced by solve\+\_\+pde().


\begin{DoxyCode}
150       \textcolor{keywordtype}{use }typy
151       \textcolor{keywordtype}{use }globals
152       \textcolor{keywordtype}{use }feminittools
153       \textcolor{keywordtype}{use }core_tools
154       \textcolor{keywordtype}{use }debug_tools
155       \textcolor{keywordtype}{use }pde_objs
156       
157       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: ierr
158       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: itcount
159       \textcolor{keywordtype}{logical} :: success\_it
160 
161 
162       \textcolor{keywordflow}{select case}(ierr)
163         \textcolor{keywordflow}{case}(-1, 0)
164           dtprev = time_step
165           \textcolor{keywordflow}{if} (itcount < 0.25*max_itcount) \textcolor{keywordflow}{then}
166             time_step = min(dtmax, 1.06*time_step) 
167           \textcolor{keywordflow}{else}
168             time_step = time_step
169 \textcolor{keywordflow}{          end if}
170           
171           \textcolor{keywordflow}{if} (itcount >0.45*max_itcount .or. ierr==-1) \textcolor{keywordflow}{then}
172             time_step = max(dtmin, 0.9*time_step)
173 \textcolor{keywordflow}{          end if}
174             
175           success\_it = .true.
176         \textcolor{keywordflow}{case}(1,2)
177           dtprev = time_step
178           time_step = max(dtmin, 0.8*time_step)
179           success\_it = .false.
180           \textcolor{keywordflow}{if} (abs(time_step - dtmin) < epsilon(dtmin)) \textcolor{keywordflow}{then}
181             \textcolor{keyword}{call }exitme()
182 \textcolor{keywordflow}{          end if}
183 \textcolor{keywordflow}{      end select}
184       
185   
186 
187       \textcolor{keywordflow}{if} (success\_it) \textcolor{keywordflow}{then}      
188         \textcolor{keywordflow}{if} (obs\_pos <= obs\_count) \textcolor{keywordflow}{then}
189           \textcolor{keywordflow}{if} (time + time_step >= observe_time(obs\_pos)%value) \textcolor{keywordflow}{then}
190             \textcolor{keywordflow}{select case}(observe_info%method)
191               \textcolor{keywordflow}{case}(1)
192                 printtime = .true.
193                 nptimes = 1
194                 \textcolor{keywordflow}{if} (observe_time(obs\_pos)%value - time > dtmin) \textcolor{keywordflow}{then}
195                   time_step = observe_time(obs\_pos)%value - time
196                 \textcolor{keywordflow}{else}
197                   time_step = dtmin
198                   \textcolor{keyword}{call }write_log(text=&
199                     \textcolor{stringliteral}{"Warning: Observation time adjusted due to print times, but the required time step
       seems to short:"}\textcolor{comment}{, &}
200 \textcolor{comment}{                      real1=time_step)}
201 \textcolor{comment}{}\textcolor{keywordflow}{                end if}
202                 \textcolor{keyword}{call }write_log(text=\textcolor{stringliteral}{"Observation time adjusted due to print times, current time step is:"}\textcolor{comment}{, 
      real1=time_step)}
203 \textcolor{comment}{              }\textcolor{keywordflow}{case}(2)
204                 printtime = .true.
205                 nptimes = 1
206                 \textcolor{keywordflow}{do} 
207                   \textcolor{keywordflow}{if} (obs\_pos+nptimes > ubound(observe_time,1)) \textcolor{keywordflow}{then}
208                     \textcolor{keywordflow}{EXIT}
209                   \textcolor{keywordflow}{else}
210                     \textcolor{keywordflow}{if} (time + time_step >= observe_time(obs\_pos+nptimes)%value) \textcolor{keywordflow}{then}
211                       nptimes = nptimes+1
212                     \textcolor{keywordflow}{else}
213                       \textcolor{keywordflow}{EXIT}
214 \textcolor{keywordflow}{                    end if}
215 \textcolor{keywordflow}{                  end if}
216 \textcolor{keywordflow}{                end do}
217 \textcolor{keywordflow}{            end select}
218 \textcolor{keywordflow}{          end if}
219 \textcolor{keywordflow}{        end if}
220 \textcolor{keywordflow}{      end if}
221 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_af582706106c3f9c9118b6730da771c2b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{namespacefem_af582706106c3f9c9118b6730da771c2b_icgraph}
\end{center}
\end{figure}


\index{fem@{fem}!exitme@{exitme}}
\index{exitme@{exitme}!fem@{fem}}
\subsubsection[{exitme()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private fem\+::exitme (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_ab14ae3c1eca7662249464059ea9e8a76}


Definition at line 291 of file fem.\+f90.



References globals\+::dtmax, globals\+::dtmin, globals\+::iter\+\_\+criterion, postpro\+::make\+\_\+print(), globals\+::max\+\_\+itcount, globals\+::optim, globals\+::time\+\_\+step, core\+\_\+tools\+::write\+\_\+log(), and globals\+::www.



Referenced by evol\+\_\+dt().


\begin{DoxyCode}
291       \textcolor{keywordtype}{use }typy
292       \textcolor{keywordtype}{use }globals
293       \textcolor{keywordtype}{use }feminittools
294       \textcolor{keywordtype}{use }core_tools
295       \textcolor{keywordtype}{use }postpro
296       
297       \textcolor{keywordtype}{integer(kind=ikind)} :: selection, i, ii, itold
298       \textcolor{keywordtype}{real(kind=rkind)} :: valold
299     
300       
301       \textcolor{keywordflow}{if} (www) \textcolor{keywordflow}{then}
302         \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"failed to converge, you can run the code again with different setup, &}
303 \textcolor{stringliteral}{}\textcolor{stringliteral}{        the last output file can be used to relaunch your computation"})
304         error stop
305       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (optim) \textcolor{keywordflow}{then}
306         \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"failed to converged, changing to semiexplicit scheme, results are unreliable since
       now"}\textcolor{comment}{)}
307 \textcolor{comment}{        iter_criterion = huge(iter_criterion)}
308 \textcolor{comment}{        time_step = dtmax}
309 \textcolor{comment}{      }\textcolor{keywordflow}{else}
310         \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"failed to converge, user can change some values now"})
311         print *, \textcolor{stringliteral}{"select the following:"}
312         print *, \textcolor{stringliteral}{"                     1 - update number of iterations"}
313         print *, \textcolor{stringliteral}{"                     2 - update minimal time step"}
314         print *, \textcolor{stringliteral}{"                     3 - update Picard iteration threshold"}
315         print *, \textcolor{stringliteral}{"                     4 - exit the code and write your solution into file"}
316         print *, \textcolor{stringliteral}{"                     5 - exit the code don't save anything"}
317 
318         i = 0
319         \textcolor{keyword}{read}(*,*) selection
320         \textcolor{keywordflow}{if} (i == 0) \textcolor{keywordflow}{then}
321           \textcolor{keywordflow}{select case}(selection)
322             \textcolor{keywordflow}{case}(1)
323               print *, \textcolor{stringliteral}{"the number of maximal number of iterations is:"}, 
      max_itcount\textcolor{comment}{, }\textcolor{stringliteral}{"type new value now"}
324               itold = max_itcount
325               \textcolor{keywordflow}{do}
326 
327                 ii = 0
328                 \textcolor{keyword}{read}(*, *) max_itcount
329                 \textcolor{keywordflow}{if} (ii /= 0) \textcolor{keywordflow}{then}
330                   print *, \textcolor{stringliteral}{"that wasn't well done, try over again"}
331                 \textcolor{keywordflow}{else}
332                   \textcolor{keywordflow}{exit}
333 \textcolor{keywordflow}{                end if}
334 \textcolor{keywordflow}{              end do}
335               
336               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"the number of maximal number of iterations was updated for"}\textcolor{comment}{, int1=
      max_itcount,&}
337 \textcolor{comment}{              text2=}\textcolor{stringliteral}{"the previous number of iterations was"}, int2 = itold)
338               
339               
340             \textcolor{keywordflow}{case}(2)
341               print *, \textcolor{stringliteral}{"the minimal time step is:"}, dtmin, \textcolor{stringliteral}{"type new value now"}
342               valold = dtmin
343               \textcolor{keywordflow}{do}
344 
345                 ii = 0
346                 \textcolor{keyword}{read}(*, *) dtmin
347                 \textcolor{keywordflow}{if} (ii /= 0) \textcolor{keywordflow}{then}
348                   print *, \textcolor{stringliteral}{"that wasn't well done, try over again"}
349                 \textcolor{keywordflow}{else}
350                   \textcolor{keywordflow}{exit}
351 \textcolor{keywordflow}{                end if}
352 \textcolor{keywordflow}{              end do}
353                                   
354               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"the minimal time step was updated for"}, real1=
      dtmin\textcolor{comment}{,&}
355 \textcolor{comment}{              text2=}\textcolor{stringliteral}{"the previous time step was"}, real2 = valold)
356             
357             \textcolor{keywordflow}{case}(3)
358               print *, \textcolor{stringliteral}{"the Picard iteration criterion is:"}, iter_criterion, \textcolor{stringliteral}{"type new value now"}
359               valold = iter_criterion
360               \textcolor{keywordflow}{do}
361 
362                 ii = 0
363                 \textcolor{keyword}{read}(*, *) iter_criterion
364                 \textcolor{keywordflow}{if} (ii /= 0) \textcolor{keywordflow}{then}
365                   print *, \textcolor{stringliteral}{"that wasn't well done, try over again"}
366                 \textcolor{keywordflow}{else}
367                   \textcolor{keywordflow}{exit}
368 \textcolor{keywordflow}{                end if}
369 \textcolor{keywordflow}{              end do}
370               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"the iteration criterion for the Picard method was updated for"}\textcolor{comment}{, &}
371 \textcolor{comment}{              real1=iter_criterion,&}
372 \textcolor{comment}{              text2=}\textcolor{stringliteral}{"the previous value was"}, real2 = valold)
373             \textcolor{keywordflow}{case}(4)
374             
375               \textcolor{keyword}{call }make_print(\textcolor{stringliteral}{"separately"})
376               
377               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"You have decided to EXIT this unstable and tormented computation. BYE!, Your
       last solution values saved."}\textcolor{comment}{)}
378 \textcolor{comment}{              stop}
379 \textcolor{comment}{            }
380 \textcolor{comment}{            }\textcolor{keywordflow}{case}(5)
381               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"You have decided to EXIT this unstable and tormented computation. BYE!"}\textcolor{comment}{)}
382 \textcolor{comment}{              stop}
383 \textcolor{comment}{              }
384 \textcolor{comment}{            }
385 \textcolor{comment}{}\textcolor{keywordflow}{            case default}
386               print *, \textcolor{stringliteral}{"You have typed an unsupported keyword here, I'll see you here probably over again
       :)"}
387               \textcolor{keywordflow}{CONTINUE}
388 \textcolor{keywordflow}{          end select}
389         \textcolor{keywordflow}{else}
390           print *, \textcolor{stringliteral}{"You have typed an unsupported keyword here, I'll see you here probably over again :)"}
391           \textcolor{keywordflow}{CONTINUE}
392 \textcolor{keywordflow}{        end if}
393 \textcolor{keywordflow}{      end if}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_ab14ae3c1eca7662249464059ea9e8a76_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_ab14ae3c1eca7662249464059ea9e8a76_icgraph}
\end{center}
\end{figure}


\index{fem@{fem}!solve\+\_\+pde@{solve\+\_\+pde}}
\index{solve\+\_\+pde@{solve\+\_\+pde}!fem@{fem}}
\subsubsection[{solve\+\_\+pde(success)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public fem\+::solve\+\_\+pde (
\begin{DoxyParamCaption}
\item[{logical, intent(out)}]{success}
\end{DoxyParamCaption}
)}\label{namespacefem_a7c82bbee50c3ee9cdb4fdcd0f6272932}


solves the nonstationary pde problem in time 



Definition at line 14 of file fem.\+f90.



References close\+\_\+all\+\_\+observe(), globals\+::cpu\+\_\+max\+\_\+time, globals\+::cpu\+\_\+time\+\_\+limit, globals\+::drutes\+\_\+config, globals\+::dtmax, globals\+::end\+\_\+time, evol\+\_\+dt(), decomp\+\_\+vars\+::file\+\_\+dt, core\+\_\+tools\+::find\+\_\+unit(), globals\+::init\+\_\+dt, itcount, globals\+::itcum, postpro\+::make\+\_\+print(), globals\+::minimal\+\_\+dt, nptimes, obs\+\_\+count, obs\+\_\+pos, globals\+::observe\+\_\+time, pde\+\_\+objs\+::pde\+\_\+common, decomp\+\_\+tools\+::print\+\_\+domains(), decomp\+\_\+tools\+::print\+\_\+elements\+\_\+dd(), printtime, globals\+::terminal, terminal\+\_\+info(), globals\+::time, globals\+::time\+\_\+step, core\+\_\+tools\+::write\+\_\+log(), and postpro\+::write\+\_\+obs().



Referenced by main().


\begin{DoxyCode}
14       \textcolor{keywordtype}{use }typy
15       \textcolor{keywordtype}{use }globals
16       \textcolor{keywordtype}{use }global_objs
17       \textcolor{keywordtype}{use }pde_objs
18       \textcolor{keywordtype}{use }femmat
19       \textcolor{keywordtype}{use }feminittools
20       \textcolor{keywordtype}{use }postpro
21       \textcolor{keywordtype}{use }decomposer
22       \textcolor{keywordtype}{use }decomp_tools
23       \textcolor{keywordtype}{use }decomp_vars
24       \textcolor{keywordtype}{use }core_tools
25       \textcolor{keywordtype}{use }debug_tools
26 
27       
28       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: success
29       \textcolor{keywordtype}{integer} :: ierr
30       \textcolor{keywordtype}{integer} :: file\_itcounts
31       \textcolor{keywordtype}{integer(kind=ikind)} :: i
32       \textcolor{keywordtype}{integer} :: fileid
33       \textcolor{keywordtype}{real(4)}, \textcolor{keywordtype}{dimension(3)} :: act\_time
34       \textcolor{keywordtype}{real(4)} :: logtime=0.0, logtime\_dt=900
35       
36 
37       minimal_dt = dtmax
38       time_step = init_dt
39       \textcolor{keywordflow}{if} (.not. drutes_config%run\_from\_backup) time = 0
40       itcum = 0
41       printtime = .false.
42       obs\_count = ubound(observe_time,1)
43       
44       \textcolor{keywordflow}{if} (.not. drutes_config%run\_from\_backup) \textcolor{keywordflow}{then}
45         obs\_pos = 1
46       \textcolor{keywordflow}{else}
47         obs\_pos = 0
48         \textcolor{keywordflow}{do} i=1, ubound(observe_time,1)
49           \textcolor{keywordflow}{if} (observe_time(i)%value > time) \textcolor{keywordflow}{then}
50             obs\_pos = i
51             \textcolor{keywordflow}{EXIT}
52 \textcolor{keywordflow}{          end if}
53 \textcolor{keywordflow}{        end do}
54         \textcolor{keywordflow}{if} (obs\_pos == 0) \textcolor{keywordflow}{then}
55           obs\_pos = ubound(observe_time,1) + 1
56 \textcolor{keywordflow}{        end if}
57 \textcolor{keywordflow}{      end if}
58 
59 
60       \textcolor{keyword}{call }find_unit(file\_itcounts)
61       \textcolor{keyword}{open}(unit=file\_itcounts, file=\textcolor{stringliteral}{"out/itcounts"}, action=\textcolor{stringliteral}{"write"}, status\textcolor{comment}{=}\textcolor{stringliteral}{"replace"}\textcolor{comment}{)}
62 \textcolor{comment}{}
63 \textcolor{comment}{      }\textcolor{keyword}{call }find_unit(file_dt)
64       \textcolor{keyword}{open}(unit=file_dt, file=\textcolor{stringliteral}{"out/dt"}, action=\textcolor{stringliteral}{"write"}, status=\textcolor{stringliteral}{"replace"}\textcolor{comment}{)}
65 \textcolor{comment}{      }
66 \textcolor{comment}{     }\textcolor{keyword}{call }make_print(\textcolor{stringliteral}{"separately"})
67      \textcolor{keyword}{call }write_obs()
68      
69 
70      \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"go 4 solving"})
71       
72       \textcolor{keywordflow}{do}
73 
74         \textcolor{keywordflow}{if} (minimal_dt > time_step) \textcolor{keywordflow}{then}
75           minimal_dt = time_step
76 \textcolor{keywordflow}{        end if}
77 
78         \textcolor{keyword}{call }pde_common%treat\_pde(ierr, itcount, success)
79         
80         itcum = itcum + itcount
81 
82         \textcolor{keywordflow}{if} (success) \textcolor{keywordflow}{then}
83           \textcolor{keyword}{write}(unit=file\_itcounts, fmt=*) time, itcount
84           \textcolor{keyword}{call }flush(file\_itcounts)
85           \textcolor{keyword}{write}(unit=file_dt, fmt=*) time, time_step
86           \textcolor{keyword}{call }flush(file_dt)
87           
88 
89           time = time + time_step
90 
91           \textcolor{keyword}{call }write_obs()
92           \textcolor{keywordflow}{if} (printtime) \textcolor{keywordflow}{then}
93             \textcolor{keywordflow}{do} i=1, nptimes
94                       
95               \textcolor{keyword}{call }make_print(\textcolor{stringliteral}{"separately"}, observe_time(obs\_pos)%value, 
      observe_time\textcolor{comment}{(obs\_pos)%name)}
96 \textcolor{comment}{              }
97 \textcolor{comment}{              obs\_pos = obs\_pos + 1}
98 \textcolor{comment}{              }\textcolor{keyword}{write}(unit=terminal, fmt=*)  \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[97m'},\textcolor{stringliteral}{"I: print time was reached, making
       output files..."}\textcolor{comment}{&}
99 \textcolor{comment}{                                            //achar(27)//}\textcolor{stringliteral}{'[0m'}
100         
101 \textcolor{keywordflow}{            end do}
102             \textcolor{keywordflow}{if} (drutes_config%it\_method > 0) \textcolor{keywordflow}{then}
103               \textcolor{keyword}{call }print_domains(\textcolor{stringliteral}{"separately"})
104               \textcolor{keyword}{call }print_elements_dd(\textcolor{stringliteral}{"separately"})
105 \textcolor{keywordflow}{            end if}
106             printtime = .false.
107 \textcolor{keywordflow}{          end if}
108 \textcolor{keywordflow}{        end if}
109 
110         \textcolor{keyword}{call }evol\_dt(ierr, itcount)
111 
112         \textcolor{keyword}{call }terminal\_info(ierr)
113         
114         \textcolor{keywordflow}{if} (time >= end_time) \textcolor{keywordflow}{then}
115           \textcolor{keyword}{call }make_print()
116           \textcolor{keyword}{call }close\_all\_observe()
117           success = .true.
118           \textcolor{keywordflow}{RETURN}
119 \textcolor{keywordflow}{        end if}
120         \textcolor{keyword}{call }etime(act\_time(1:2), act\_time(3))
121         \textcolor{keywordflow}{if} (act\_time(3) > logtime) \textcolor{keywordflow}{then}
122           \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"current simulation time:"}, real1=time, text2=\textcolor{stringliteral}{"total iteration count:"}\textcolor{comment}{, int2=
      itcum, hidden=.true.)}
123 \textcolor{comment}{          logtime = logtime + logtime\_dt}
124 \textcolor{comment}{}\textcolor{keywordflow}{        end if}
125         \textcolor{keywordflow}{if} (cpu_time_limit .and. act\_time(3) >= cpu_max_time) \textcolor{keywordflow}{then}
126           \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"maximal allowed CPU time reached, exiting...."})
127           success = .false.
128           \textcolor{keywordflow}{RETURN}
129 \textcolor{keywordflow}{        end if}
130 \textcolor{keywordflow}{      end do}
131 
132           
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_a7c82bbee50c3ee9cdb4fdcd0f6272932_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=201pt]{namespacefem_a7c82bbee50c3ee9cdb4fdcd0f6272932_icgraph}
\end{center}
\end{figure}


\index{fem@{fem}!terminal\+\_\+info@{terminal\+\_\+info}}
\index{terminal\+\_\+info@{terminal\+\_\+info}!fem@{fem}}
\subsubsection[{terminal\+\_\+info(ierr)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private fem\+::terminal\+\_\+info (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{ierr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_a9e77b74c31cc713c381da60bfd60b5ed}


Definition at line 225 of file fem.\+f90.



References globals\+::dir\+\_\+name, globals\+::dtprev, itcount, globals\+::itcum, obs\+\_\+count, obs\+\_\+pos, globals\+::terminal, globals\+::time, printtools\+::time2finish(), globals\+::time\+\_\+step, and globals\+::www.



Referenced by solve\+\_\+pde().


\begin{DoxyCode}
225       \textcolor{keywordtype}{use }globals
226       \textcolor{keywordtype}{use }printtools
227 
228       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: ierr
229 
230       \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "}
231       \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "}
232       \textcolor{keywordflow}{if} (.not. www) \textcolor{keywordflow}{then}
233         \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"current working directory is: "} //achar(27\textcolor{comment}{)//}\textcolor{stringliteral}{'[101m'}\textcolor{comment}{, trim(
      dir_name) //achar(27)//}\textcolor{stringliteral}{'[0m'}
234 \textcolor{keywordflow}{      end if}
235       \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "}
236 
237 
238       \textcolor{keywordflow}{select case}(ierr)
239         \textcolor{keywordflow}{case}(0)
240           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[93m'},  \textcolor{stringliteral}{
      "--------------------OK-------------------------------------"}\textcolor{comment}{ &}
241 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
242           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[92m'}, \textcolor{stringliteral}{"actual simulation time: "}\textcolor{comment}{ //achar(27)//}\textcolor{stringliteral}{
      '[0m'}\textcolor{comment}{, time, }\textcolor{stringliteral}{"  | "}\textcolor{comment}{, &}
243 \textcolor{comment}{                                      }\textcolor{stringliteral}{"previous time step: "}, dtprev
244           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"       \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_
       \_ \_ \_ \_ \_ \_ \_"}
245           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"  "}
246           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"total iteration count: "}, itcum,\textcolor{stringliteral}{"         | "}\textcolor{comment}{, }\textcolor{stringliteral}{"current iteration
       count: "}\textcolor{comment}{, itcount}
247 \textcolor{comment}{          }\textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"  "}
248           \textcolor{keyword}{write}(unit=terminal, fmt=\textcolor{stringliteral}{"(a, I4, a, I4, a)"}) \textcolor{stringliteral}{" observation time files written: "}\textcolor{comment}{, obs\_pos-1, }\textcolor{stringliteral}{"/"}\textcolor{comment}{
      , obs\_count}
249 \textcolor{comment}{          }\textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"  "}
250           \textcolor{keyword}{call }time2finish()
251           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[93m'},  \textcolor{stringliteral}{
      "-----------------------------------------------------------"}\textcolor{comment}{ &}
252 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
253         \textcolor{keywordflow}{case}(-1)
254           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[93m'},  \textcolor{stringliteral}{
      "--------------------OK-------------------------------------"}\textcolor{comment}{ &}
255 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
256           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[92m'}, \textcolor{stringliteral}{"actual simulation time: "}\textcolor{comment}{ //achar(27)//}\textcolor{stringliteral}{
      '[0m'}\textcolor{comment}{, time, }\textcolor{stringliteral}{"  | "}\textcolor{comment}{, &}
257 \textcolor{comment}{                                      }\textcolor{stringliteral}{"previous time step: "}, dtprev
258           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"       \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ \_
       \_ \_ \_ \_ \_ \_ \_"}
259           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"  "}
260           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"total iteration count: "}, itcum,\textcolor{stringliteral}{"         | "}\textcolor{comment}{, }\textcolor{stringliteral}{"current iteration
       count: "}\textcolor{comment}{, itcount}
261 \textcolor{comment}{          }\textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"W: time step decreased due slower convergence of conjugate gradient
       method...  "}
262           \textcolor{keyword}{write}(unit=terminal, fmt=\textcolor{stringliteral}{"(a, I4, a, I4, a)"}) \textcolor{stringliteral}{" observation time files written: "}\textcolor{comment}{, obs\_pos-1, }\textcolor{stringliteral}{"/"}\textcolor{comment}{
      , obs\_count}
263 \textcolor{comment}{          }\textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"  "}
264           \textcolor{keyword}{call }time2finish()
265           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[93m'},  \textcolor{stringliteral}{
      "-----------------------------------------------------------"}\textcolor{comment}{ &}
266 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
267         \textcolor{keywordflow}{case}(1)
268           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'},  \textcolor{stringliteral}{
      "--------------------WARNING!-------------------------------"}\textcolor{comment}{ &}
269 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
270           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"slow convergence of the Picard method, time
       step decreased: "}\textcolor{comment}{ &}
271 \textcolor{comment}{                                      //achar(27)//}\textcolor{stringliteral}{'[0m'}, time_step
272 
273           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"current simulation time:"}, time
274           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"total iteration count:"}, itcum
275           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'},  \textcolor{stringliteral}{
      "------------------------------------------------------------"}\textcolor{comment}{ &}
276 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
277         \textcolor{keywordflow}{case}(2)
278           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'},  \textcolor{stringliteral}{
      "--------------------INFO!-------------------------------"}\textcolor{comment}{ &}
279 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
280           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"RCZA method forced time step decrease: "}\textcolor{comment}{ &}
281 \textcolor{comment}{                                      //achar(27)//}\textcolor{stringliteral}{'[0m'}, time_step
282 
283           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"current simulation time:"}, time
284           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"total iteration count:"}, itcum
285           \textcolor{keyword}{write}(unit=terminal, fmt=*)\textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'},  \textcolor{stringliteral}{
      "------------------------------------------------------------"}\textcolor{comment}{ &}
286 \textcolor{comment}{                                          //achar(27)//}\textcolor{stringliteral}{'[0m'}
287 \textcolor{keywordflow}{      end select}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefem_a9e77b74c31cc713c381da60bfd60b5ed_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{namespacefem_a9e77b74c31cc713c381da60bfd60b5ed_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{fem@{fem}!go\+\_\+clusters@{go\+\_\+clusters}}
\index{go\+\_\+clusters@{go\+\_\+clusters}!fem@{fem}}
\subsubsection[{go\+\_\+clusters}]{\setlength{\rightskip}{0pt plus 5cm}logical, private fem\+::go\+\_\+clusters\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_af7b5250bf4204fa74229da3d3e59551e}


Definition at line 6 of file fem.\+f90.


\begin{DoxyCode}
6   \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{private} :: go\_clusters
\end{DoxyCode}
\index{fem@{fem}!itcount@{itcount}}
\index{itcount@{itcount}!fem@{fem}}
\subsubsection[{itcount}]{\setlength{\rightskip}{0pt plus 5cm}integer(kind=ikind), private fem\+::itcount\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_a9fcd75e8e6ac205b26a35e505ad201fd}


Definition at line 5 of file fem.\+f90.



Referenced by solve\+\_\+pde(), and terminal\+\_\+info().


\begin{DoxyCode}
5   \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{private} :: itcount, obs\_pos, obs\_count, nptimes
\end{DoxyCode}
\index{fem@{fem}!nptimes@{nptimes}}
\index{nptimes@{nptimes}!fem@{fem}}
\subsubsection[{nptimes}]{\setlength{\rightskip}{0pt plus 5cm}integer(kind=ikind), private fem\+::nptimes\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_a227231170b93a2d5d8e051b311f83ee2}


Definition at line 5 of file fem.\+f90.



Referenced by evol\+\_\+dt(), and solve\+\_\+pde().

\index{fem@{fem}!obs\+\_\+count@{obs\+\_\+count}}
\index{obs\+\_\+count@{obs\+\_\+count}!fem@{fem}}
\subsubsection[{obs\+\_\+count}]{\setlength{\rightskip}{0pt plus 5cm}integer(kind=ikind), private fem\+::obs\+\_\+count\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_a77462461fd7030fdceb0433c9daf566e}


Definition at line 5 of file fem.\+f90.



Referenced by evol\+\_\+dt(), solve\+\_\+pde(), and terminal\+\_\+info().

\index{fem@{fem}!obs\+\_\+pos@{obs\+\_\+pos}}
\index{obs\+\_\+pos@{obs\+\_\+pos}!fem@{fem}}
\subsubsection[{obs\+\_\+pos}]{\setlength{\rightskip}{0pt plus 5cm}integer(kind=ikind), private fem\+::obs\+\_\+pos\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_af40fab50b476783ac7bda3c73f56ad19}


Definition at line 5 of file fem.\+f90.



Referenced by evol\+\_\+dt(), solve\+\_\+pde(), and terminal\+\_\+info().

\index{fem@{fem}!printtime@{printtime}}
\index{printtime@{printtime}!fem@{fem}}
\subsubsection[{printtime}]{\setlength{\rightskip}{0pt plus 5cm}logical, private fem\+::printtime\hspace{0.3cm}{\ttfamily [private]}}\label{namespacefem_aabdb7c5964d7949329ceab976150a6cc}


Definition at line 7 of file fem.\+f90.



Referenced by evol\+\_\+dt(), and solve\+\_\+pde().


\begin{DoxyCode}
7   \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{private} :: printtime
\end{DoxyCode}
