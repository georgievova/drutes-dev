\section{src/models/\+R\+E/re\+\_\+constitutive.f90 File Reference}
\label{re__constitutive_8f90}\index{src/models/\+R\+E/re\+\_\+constitutive.\+f90@{src/models/\+R\+E/re\+\_\+constitutive.\+f90}}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module {\bf re\+\_\+constitutive}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private {\bf re\+\_\+constitutive\+::intoverflow} ()
\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::vangen} (pde\+\_\+loc, layer, quadpnt, x)
\begin{DoxyCompactList}\small\item\em Van Genuchten relation \[ \theta = f(pressure) \] \[ \theta_e = \frac{1}{(1+(\alpha*h)^n)^m} \] water content is considered as absolute value not the relative one ~\newline
 see \[ \theta_e = \frac{\theta - \theta_r}{\theta_s-\theta_r} \]. \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::gardner\+\_\+wc} (pde\+\_\+loc, layer, quadpnt, x)
\begin{DoxyCompactList}\small\item\em Gardner relation \[ \theta = f(pressure) \] \[ \theta = \frac{1}{(1+(\alpha*h)^n)^m} \]. \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::inverse\+\_\+vangen} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::vangen\+\_\+tab} (pde\+\_\+loc, layer, quadpnt, x)
\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::vangen\+\_\+elast} (pde\+\_\+loc, layer, quadpnt, x)
\begin{DoxyCompactList}\small\item\em so-\/called retention water capacity, it is a derivative to retention curve function  E(h) = C(h) + \{(h)\}\{\}S\+\_\+s ] where \[ C(h) = \left\{ \begin{array}{l l}\frac{m n \alpha (-h \alpha )^{-1+n}}{\left(1+(-h \alpha )^n\right)^{1+m}}(\theta_s - \theta_r) , & \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, & \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \] and \[ \theta(h) = \left\{ \begin{array}{l l} \frac{\theta_s -\theta_r}{(1+(-\alpha h)^n_{vg})^m_{vg}} + \theta_r, & \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ \theta_S, & \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \] \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::gardner\+\_\+elast} (pde\+\_\+loc, layer, quadpnt, x)
\begin{DoxyCompactList}\small\item\em so-\/called retention water capacity, it is a derivative to retention curve function \[ E(h) = \left\{ \begin{array}{l l} \alpha (\theta_s - \theta_r) exp(\alpha h) , & \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, & \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \] \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::vangen\+\_\+elast\+\_\+tab} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::mualem} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\begin{DoxyCompactList}\small\item\em Mualem\textquotesingle{}s fucntion for unsaturated hydraulic conductivity with van Genuchten\textquotesingle{}s water content substitution \[ K(h) = \left\{ \begin{array}{l l} K_s\frac{\left( 1- (-\alpha h)^{n_{vg}m_{vg}} \left( 1+ (-\alpha h)^{n_{vg}} \right)^{-m_{vg}} \right)^2}{\left(1+(-\alpha h)^{n_{vg}} \right)^{\frac{m_{vg}}{2}}}, & \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \]. \end{DoxyCompactList}\item 
subroutine, public {\bf re\+\_\+constitutive\+::gardner\+\_\+ks} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\begin{DoxyCompactList}\small\item\em Gardner\textquotesingle{}s fucntion for unsaturated hydraulic conductivity \[ K(h) = K_s exp(\alpha h), \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}. \]. \end{DoxyCompactList}\item 
subroutine, public {\bf re\+\_\+constitutive\+::mualem\+\_\+tab} (pde\+\_\+loc, layer, quadpnt, x, tensor, scalar)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::dmualem\+\_\+dh} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\begin{DoxyCompactList}\small\item\em derivative of Mualem\textquotesingle{}s function with van Genuchten\textquotesingle{}s substitution for water content function \[ \frac{\textrm{d} K(h)}{\textrm{d} h} = \left\{ \begin{array}{l l} K_s \frac{1}{2} \alpha (-\alpha h)^{(-1 + n)} (1 + (-\alpha h)^n)^{(-1 - m/ 2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m})^2 m n + 2 (1 + (-\alpha h)^n)^{(-m/2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m}) (-\alpha (-\alpha h)^{(-1 + n + m n)} (1 + (-\alpha h)^n)^{(-1 - m)} m n + \alpha (-\alpha h)^{(-1 + m n)} (1 + (-a h)^n)^{-m} m n), \quad \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ 0, \quad \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \] \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::derkz} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::convection\+\_\+rerot} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\begin{DoxyCompactList}\small\item\em convection term for the Richards equation for axisymmetric problems the vertical convection is equal as for the Richards equatio in standard coordinates, the horizontal convection equals [\textbackslash{} \{1\}\{r\}K(h) \end{DoxyCompactList}\item 
real(kind=rkind) function, public {\bf re\+\_\+constitutive\+::sinkterm} (pde\+\_\+loc, layer, quadpnt, x)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::dmualem\+\_\+dh\+\_\+tab} (pde\+\_\+loc, layer, quadpnt, x, vector\+\_\+in, vector\+\_\+out, scalar)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::darcy\+\_\+law} (pde\+\_\+loc, layer, quadpnt, x, grad, flux, flux\+\_\+length)
\item 
subroutine {\bf re\+\_\+constitutive\+::tabvalues} (pde\+\_\+loc, Kfnc, d\+Kdhfnc, Cfnc, thetafnc)
\begin{DoxyCompactList}\small\item\em creates a table of values of constitutive functions for the Richards equation to be linearly approximated \end{DoxyCompactList}\item 
subroutine, public {\bf re\+\_\+constitutive\+::domainswitch} (domain)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::init\+\_\+zones} (vg)
\item 
real(kind=rkind) function, private {\bf re\+\_\+constitutive\+::zone\+\_\+error\+\_\+val} (h, htest, taylor\+\_\+max)
\item 
pure real(kind=rkind) function, private {\bf re\+\_\+constitutive\+::secondder\+\_\+retc} (h)
\item 
logical function, private {\bf re\+\_\+constitutive\+::rcza\+\_\+check\+\_\+old} ()
\item 
logical function, public {\bf re\+\_\+constitutive\+::rcza\+\_\+check} (pde\+\_\+loc)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::re\+\_\+dirichlet\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::re\+\_\+null\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::re\+\_\+dirichlet\+\_\+height\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::re\+\_\+neumann\+\_\+bc} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine {\bf re\+\_\+constitutive\+::re\+\_\+atmospheric} (pde\+\_\+loc, el\+\_\+id, node\+\_\+order, value, code)
\item 
subroutine, public {\bf re\+\_\+constitutive\+::re\+\_\+initcond} (pde\+\_\+loc)
\item 
subroutine, private {\bf re\+\_\+constitutive\+::setmatflux} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(kind=rkind), dimension(\+:,\+:), pointer, public {\bf re\+\_\+constitutive\+::ktab}
\item 
real(kind=rkind), dimension(\+:,\+:), pointer, public {\bf re\+\_\+constitutive\+::dkdhtab}
\item 
real(kind=rkind), dimension(\+:,\+:), pointer, public {\bf re\+\_\+constitutive\+::warecatab}
\item 
real(kind=rkind), dimension(\+:,\+:), pointer, public {\bf re\+\_\+constitutive\+::watcontab}
\item 
real(kind=rkind), dimension(\+:,\+:,\+:), allocatable, target, public {\bf re\+\_\+constitutive\+::ktab\+\_\+all}
\item 
real(kind=rkind), dimension(\+:,\+:,\+:), allocatable, target, public {\bf re\+\_\+constitutive\+::dkdhtab\+\_\+all}
\item 
real(kind=rkind), dimension(\+:,\+:,\+:), allocatable, target, public {\bf re\+\_\+constitutive\+::warecatab\+\_\+all}
\item 
real(kind=rkind), dimension(\+:,\+:,\+:), allocatable, target, public {\bf re\+\_\+constitutive\+::watcontab\+\_\+all}
\item 
type({\bf soilpar}), private {\bf re\+\_\+constitutive\+::van\+\_\+gen\+\_\+coeff}
\item 
integer(kind=ikind), private {\bf re\+\_\+constitutive\+::this\+\_\+layer}
\item 
logical, private {\bf re\+\_\+constitutive\+::tabwarning} = .false.
\item 
character(len=4096), private {\bf re\+\_\+constitutive\+::tabmsg} = \char`\"{}D\+R\+Ut\+ES requested values of the constitutive functions out of the range of your precalculated table, the function will be evaluated directly, it will slow down your computation, is everything ok? If yes, increase the length of interval for precaculating the constitutive functions in your config files\char`\"{}
\item 
logical, private {\bf re\+\_\+constitutive\+::intwarning} = .false.
\end{DoxyCompactItemize}
