\section{readtools Module Reference}
\label{namespacereadtools}\index{readtools@{readtools}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface {\bf fileread}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private {\bf read\+\_\+int} (i, fileid, errmsg, ranges, minimal, maximal, noexit)
\item 
subroutine, private {\bf read\+\_\+int\+\_\+std} (i, fileid, errmsg, ranges, noexit)
\item 
subroutine, private {\bf read\+\_\+int\+\_\+array} (r, fileid, ranges, errmsg, checklen, noexit)
\item 
subroutine, private {\bf read\+\_\+real} (r, fileid, ranges, errmsg, noexit)
\item 
subroutine, private {\bf read\+\_\+real\+\_\+array} (r, fileid, ranges, errmsg, checklen, noexit)
\item 
subroutine, private {\bf read\+\_\+char} (ch, fileid, errmsg, options, noexit)
\item 
subroutine {\bf read\+\_\+logical} (l, fileid, errmsg, noexit)
\item 
subroutine, public {\bf file\+\_\+error} (iunit, message)
\item 
subroutine, public {\bf comment} (Unit)
\item 
subroutine, public {\bf set\+\_\+tensor} (values, angle, tensor)
\begin{DoxyCompactList}\small\item\em this procedure set up an anisothropy tensor, the local anisothrophy values are supllied in values array, angle is the angle between the local and global system, tensor is the resulting secodn order tensor \end{DoxyCompactList}\item 
subroutine, public {\bf readbcvals} (unitW, struct, dimen, dirname)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{readtools@{readtools}!comment@{comment}}
\index{comment@{comment}!readtools@{readtools}}
\subsubsection[{comment(\+Unit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public readtools\+::comment (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{Unit}
\end{DoxyParamCaption}
)}\label{namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a}


Definition at line 526 of file readtools.\+f90.



Referenced by ade\+\_\+reader\+::ade\+\_\+read(), boussread\+::boussreader(), geom\+\_\+tools\+::map1d2d(), geom\+\_\+tools\+::map1d2dj(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readf(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readm(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+var(), read\+\_\+inputs\+::read\+\_\+1dmesh\+\_\+int(), read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+int(), read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+t3d(), read\+\_\+char(), decomposer\+::read\+\_\+coarse\+\_\+mesh(), read\+\_\+int(), read\+\_\+int\+\_\+array(), read\+\_\+int\+\_\+std(), read\+\_\+logical(), read\+\_\+real(), read\+\_\+real\+\_\+array(), readbcvals(), objfnc\+::reader(), and re\+\_\+reader\+::res\+\_\+read().


\begin{DoxyCode}
526           
527       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: unit
528       \textcolor{comment}{!character(len=1), intent(in), optional :: mark}
529       \textcolor{keywordtype}{character(len=1)} :: symbol
530       \textcolor{keywordtype}{character(len=1)} :: string
531       \textcolor{keywordtype}{integer} :: i\_err
532       
533           
534       \textcolor{comment}{!if (present(mark)) then}
535       \textcolor{comment}{!   symbol = mark}
536       \textcolor{comment}{!else}
537         symbol = \textcolor{stringliteral}{"#"}
538     \textcolor{comment}{! end if}
539         
540       \textcolor{keywordflow}{do}
541         \textcolor{keyword}{read}(unit=unit,fmt = *, iostat = i\_err ) string
542         \textcolor{keywordflow}{if} (i\_err < 0) \textcolor{keywordflow}{then}
543           \textcolor{keywordflow}{RETURN}
544 \textcolor{keywordflow}{        end if}
545         \textcolor{keywordflow}{if} (string == symbol) \textcolor{keywordflow}{then}
546           \textcolor{keywordflow}{CONTINUE}
547         \textcolor{keywordflow}{else}
548           backspace unit
549           \textcolor{keywordflow}{RETURN}
550 \textcolor{keywordflow}{        endif}
551 \textcolor{keywordflow}{      end do}
552           
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a_icgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!file\+\_\+error@{file\+\_\+error}}
\index{file\+\_\+error@{file\+\_\+error}!readtools@{readtools}}
\subsubsection[{file\+\_\+error(iunit, message)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public readtools\+::file\+\_\+error (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{iunit, }
\item[{character(len=$\ast$), intent(in), optional}]{message}
\end{DoxyParamCaption}
)}\label{namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c}


Definition at line 461 of file readtools.\+f90.



References globals\+::terminal.



Referenced by ade\+\_\+reader\+::ade\+\_\+read(), decomposer\+::init\+\_\+decomp(), geom\+\_\+tools\+::map1d2d(), geom\+\_\+tools\+::map1d2dj(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+var(), read\+\_\+inputs\+::read\+\_\+1dmesh\+\_\+int(), read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+int(), read\+\_\+char(), read\+\_\+inputs\+::read\+\_\+global(), read\+\_\+int(), read\+\_\+int\+\_\+array(), read\+\_\+int\+\_\+std(), read\+\_\+logical(), read\+\_\+real(), read\+\_\+real\+\_\+array(), readbcvals(), objfnc\+::reader(), re\+\_\+reader\+::res\+\_\+read(), and simegen\+::simegen1d().


\begin{DoxyCode}
461       \textcolor{keywordtype}{use }core_tools
462       \textcolor{keywordtype}{use }globals
463 
464       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: iunit
465       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: message
466 
467       \textcolor{keywordtype}{character(len=512)} :: filename
468       \textcolor{keywordtype}{character(len=256)} :: iaction, numero
469       \textcolor{keywordtype}{integer} :: line, i, i\_err, i3, i4, i5, fileid, err\_read
470       \textcolor{keywordtype}{integer(4)} :: i1, i2
471       \textcolor{keywordtype}{character(len=4096)} :: string 
472 
473       string = \textcolor{stringliteral}{"last value"}
474       i1=-100
475       i2=-100
476       \textcolor{keyword}{inquire}(unit=iunit, name=filename, action=iaction) 
477       line = 1
478       backspace(unit=iunit, iostat = i\_err)
479 
480       \textcolor{keyword}{read}(unit=iunit, fmt=*, iostat = err\_read) string
481       
482       
483       \textcolor{keywordflow}{do}
484         i1 = ftell(iunit)
485         backspace(unit=iunit, iostat=i\_err)
486         line = line + 1
487         i2 = ftell(iunit)
488         \textcolor{keywordflow}{if} (i1 == i2) \textcolor{keywordflow}{then}
489           \textcolor{keywordflow}{EXIT}
490 \textcolor{keywordflow}{        end if}
491 \textcolor{keywordflow}{      end do}
492 
493       \textcolor{keywordflow}{if} (line <= 2) \textcolor{keywordflow}{then}
494         print *, \textcolor{stringliteral}{"-------------------------------------------------------------------"}
495         print *, \textcolor{stringliteral}{"WARNING: the line number was identified incorrectly, "}
496         print *, \textcolor{stringliteral}{"likely it is a compiler error in ftell function, "}
497         print *, \textcolor{stringliteral}{"find the input error on your own. :("}
498 \textcolor{keywordflow}{      end if}
499 
500       print *, \textcolor{stringliteral}{"-------------------------------------------------------------------"}
501 
502       print *, \textcolor{stringliteral}{"  "}
503       print *, \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"!!ERROR!!"} //achar(27)//\textcolor{stringliteral}{'[0m'}, \textcolor{comment}{&}
504 \textcolor{comment}{                  }\textcolor{stringliteral}{"  in reading from file: "}, trim(filename), \textcolor{stringliteral}{" near line: "}\textcolor{comment}{, line-1, &}
505 \textcolor{comment}{                      }\textcolor{stringliteral}{" opened with status: "}, trim(iaction),  \textcolor{stringliteral}{" -> exiting DRUtES"}
506       print *, \textcolor{stringliteral}{"  "}
507       
508 
509 \textcolor{comment}{!       if (i\_err == 0) then }
510         \textcolor{keywordflow}{if} (err\_read == 0) \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"the value you have typed is: "}\textcolor{comment}{, trim(string)}
511 \textcolor{comment}{        }\textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{"--------------------------------"}
512 \textcolor{comment}{!       end if}
513       
514       
515       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(message)) \textcolor{keywordflow}{then}
516         \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, trim(message) //achar\textcolor{comment}{(27)//}\textcolor{stringliteral}{'[0m'}
517 \textcolor{keywordflow}{      end if}
518         
519       
520       error stop
521 
522 
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c_icgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+char@{read\+\_\+char}}
\index{read\+\_\+char@{read\+\_\+char}!readtools@{readtools}}
\subsubsection[{read\+\_\+char(ch, fileid, errmsg, options, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+char (
\begin{DoxyParamCaption}
\item[{character(len=$\ast$), intent(out)}]{ch, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{options, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909}


Definition at line 369 of file readtools.\+f90.



References comment(), and file\+\_\+error().


\begin{DoxyCode}
369       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(out)} :: ch
370       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
371       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
372       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: options
373       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
374 
375       \textcolor{keywordtype}{integer} :: ierr, i
376       \textcolor{keywordtype}{logical} :: ok
377       
378       \textcolor{keyword}{call }comment(fileid)
379       
380       \textcolor{keyword}{read}(unit=fileid, fmt=\textcolor{stringliteral}{"(a)"}, iostat=ierr) ch
381       
382       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(options)) \textcolor{keywordflow}{then}
383         ok = .false.
384         \textcolor{keywordflow}{do} i=1, ubound(options, 1)
385           \textcolor{keywordflow}{if} (adjustl(trim(ch)) == adjustl(trim(options(i)))) \textcolor{keywordflow}{then}
386             ok = .true.
387             \textcolor{keywordflow}{EXIT}
388 \textcolor{keywordflow}{          end if}
389 \textcolor{keywordflow}{        end do}
390       \textcolor{keywordflow}{else}
391         ok = .true.     
392 \textcolor{keywordflow}{      end if}
393       
394       \textcolor{keywordflow}{if} (ierr /= 0 .or. .not.(ok) .and. (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit)) \textcolor{keywordflow}{then}
395         \textcolor{keywordflow}{if} (.not. ok) \textcolor{keywordflow}{then}
396           print *, \textcolor{stringliteral}{"the value in your input file was: "}, trim(ch)
397           print *, \textcolor{stringliteral}{"however the allowed options for this field are:"}
398           \textcolor{keywordflow}{do} i=1, ubound(options,1)
399             print *, \textcolor{stringliteral}{"-  "}, adjustl(trim(options(i)))
400 \textcolor{keywordflow}{          end do}
401 \textcolor{keywordflow}{        end if}
402         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
403           \textcolor{keyword}{call }file_error(fileid,errmsg)
404 \textcolor{keywordflow}{        end if}
405         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
406           \textcolor{keyword}{call }file_error(fileid,errmsg)
407         \textcolor{keywordflow}{else}
408           \textcolor{keyword}{call }file_error(fileid)
409 \textcolor{keywordflow}{        end if}
410 \textcolor{keywordflow}{      end if}
411       
412       
413       
414       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+int@{read\+\_\+int}}
\index{read\+\_\+int@{read\+\_\+int}!readtools@{readtools}}
\subsubsection[{read\+\_\+int(i, fileid, errmsg, ranges, minimal, maximal, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+int (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(out)}]{i, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{integer(kind=ikind), dimension(\+:), intent(in), optional}]{ranges, }
\item[{integer, intent(in), optional}]{minimal, }
\item[{integer, intent(in), optional}]{maximal, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575}


Definition at line 22 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
22       \textcolor{keywordtype}{use }typy
23       \textcolor{keywordtype}{use }globals
24       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)} :: i
25       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
26       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
27       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)},  \textcolor{keywordtype}{optional} :: ranges
28       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: minimal, maximal
29       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
30 
31       \textcolor{comment}{!local vars}
32       \textcolor{keywordtype}{integer} :: ierr
33 
34       \textcolor{keyword}{call }comment(fileid)
35 
36       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) i
37 
38       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
39         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
40           \textcolor{keyword}{call }file_error(fileid, errmsg)
41 \textcolor{keywordflow}{        end if}
42         \textcolor{keyword}{call }file_error(fileid)
43 \textcolor{keywordflow}{      end if}
44 
45       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
46         \textcolor{keywordflow}{if} (i<ranges(1) .or. i> ranges(2)) \textcolor{keywordflow}{then}
47           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
48           \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
49             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
50               \textcolor{keyword}{call }file_error(fileid,errmsg)
51             \textcolor{keywordflow}{else}
52               \textcolor{keyword}{call }file_error(fileid)
53 \textcolor{keywordflow}{            end if}
54 \textcolor{keywordflow}{          end if}
55 \textcolor{keywordflow}{        end if}
56 \textcolor{keywordflow}{      end if}
57 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+int\+\_\+array@{read\+\_\+int\+\_\+array}}
\index{read\+\_\+int\+\_\+array@{read\+\_\+int\+\_\+array}!readtools@{readtools}}
\subsubsection[{read\+\_\+int\+\_\+array(r, fileid, ranges, errmsg, checklen, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+int\+\_\+array (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), dimension(\+:), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{integer(kind=ikind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{checklen, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em checklen} & checks if the array length is equal to the length of line in file \\
\hline
\end{DoxyParams}


Definition at line 109 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
109       \textcolor{keywordtype}{use }typy
110       \textcolor{keywordtype}{use }globals
111       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: r
112       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
113       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
114       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
116       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: checklen
117       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
118       
119             \textcolor{comment}{!logical vars}
120       \textcolor{keywordtype}{integer} :: ierr, ierr2
121       \textcolor{keywordtype}{integer(kind=ikind)} :: i, i1, i2, arraybound, current\_pos, chpos
122       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmpdata
123       
124       \textcolor{keyword}{call }comment(fileid)
125       
126       arraybound=1
127       
128       \textcolor{keyword}{allocate}(tmpdata(arraybound))
129       
130       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(checklen)) \textcolor{keywordflow}{then}
131         \textcolor{keywordflow}{if} (checklen) \textcolor{keywordflow}{then}
132           current\_pos = ftell(fileid)
133           \textcolor{keywordflow}{do} 
134             \textcolor{keyword}{call }comment(fileid)
135             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1\textcolor{comment}{)}
136 \textcolor{comment}{            i1=ftell(fileid)}
137 \textcolor{comment}{            backspace fileid}
138 \textcolor{comment}{            }\textcolor{keyword}{call }comment(fileid)
139             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)
140             i2 = ftell(fileid)
141             backspace fileid
142            
143             \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
144               arraybound = arraybound - 1
145               \textcolor{keywordflow}{do}
146                 chpos = ftell(fileid)
147                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
148                   \textcolor{keywordflow}{EXIT}
149                 \textcolor{keywordflow}{else}
150                   backspace(unit=fileid, iostat=ierr2)
151 \textcolor{keywordflow}{                end if}
152 \textcolor{keywordflow}{              end do}
153               \textcolor{keyword}{deallocate}(tmpdata)
154               \textcolor{keywordflow}{EXIT}
155 \textcolor{keywordflow}{            end if}
156             
157             \textcolor{keywordflow}{if} (i1 == i2) \textcolor{keywordflow}{then}
158               arraybound = arraybound + 1
159               \textcolor{keywordflow}{if} (ubound(tmpdata,1) < arraybound) \textcolor{keywordflow}{then}
160                 \textcolor{keyword}{deallocate}(tmpdata)
161                 \textcolor{keyword}{allocate}(tmpdata(2*arraybound))
162 \textcolor{keywordflow}{              end if}    
163             \textcolor{keywordflow}{else} 
164               arraybound = arraybound - 1
165               \textcolor{keywordflow}{do}
166                 chpos = ftell(fileid)
167                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
168                   \textcolor{keywordflow}{EXIT}
169                 \textcolor{keywordflow}{else}
170                   backspace(unit=fileid, iostat=ierr2)
171 \textcolor{keywordflow}{                end if}
172 \textcolor{keywordflow}{              end do}
173               \textcolor{keyword}{deallocate}(tmpdata)
174               \textcolor{keywordflow}{EXIT}
175 \textcolor{keywordflow}{            end if}
176 \textcolor{keywordflow}{          end do}
177   
178           \textcolor{keywordflow}{if} (arraybound /= ubound(r,1)) \textcolor{keywordflow}{then}
179             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"the line in your input file has &}
180 \textcolor{stringliteral}{}\textcolor{stringliteral}{               incorrect number of values, check your inputs"} //achar(27\textcolor{comment}{)//}\textcolor{stringliteral}{'[0m'}
181             \textcolor{keyword}{call }file_error(fileid, errmsg)
182 \textcolor{keywordflow}{         end if}
183 \textcolor{keywordflow}{        end if}
184 \textcolor{keywordflow}{      end if}
185       
186       \textcolor{keyword}{call }comment(fileid)
187       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
188     
189       
190       
191       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
192         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
193           \textcolor{keyword}{call }file_error(fileid,errmsg)
194 \textcolor{keywordflow}{        end if}
195         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
196           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
197             \textcolor{keyword}{call }file_error(fileid,errmsg)
198           \textcolor{keywordflow}{else}
199             \textcolor{keyword}{call }file_error(fileid)
200 \textcolor{keywordflow}{          end if}
201 \textcolor{keywordflow}{        end if}
202 \textcolor{keywordflow}{      end if}
203       
204       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
205         \textcolor{keywordflow}{do} i=1, ubound(r,1)
206           \textcolor{keywordflow}{if} (r(i) < ranges(1) .or. r(i) > ranges(2)) \textcolor{keywordflow}{then}
207             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ /
      /achar(27)//}\textcolor{stringliteral}{'[0m'}
208             \textcolor{keyword}{call }file_error(fileid, errmsg)
209 \textcolor{keywordflow}{          end if}
210 \textcolor{keywordflow}{        end do}
211 \textcolor{keywordflow}{      end if}
212       
213       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+int\+\_\+std@{read\+\_\+int\+\_\+std}}
\index{read\+\_\+int\+\_\+std@{read\+\_\+int\+\_\+std}!readtools@{readtools}}
\subsubsection[{read\+\_\+int\+\_\+std(i, fileid, errmsg, ranges, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+int\+\_\+std (
\begin{DoxyParamCaption}
\item[{integer(kind=lowikind), intent(out)}]{i, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{integer(kind=ikind), dimension(\+:), intent(in), optional}]{ranges, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d}


Definition at line 62 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
62       \textcolor{keywordtype}{use }typy
63       \textcolor{keywordtype}{use }globals
64       \textcolor{keywordtype}{integer(kind=lowikind)}, \textcolor{keywordtype}{intent(out)} :: i
65       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
66       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
67       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)},  \textcolor{keywordtype}{optional} :: ranges
68       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
69 
70 
71       \textcolor{comment}{!local vars}
72       \textcolor{keywordtype}{integer} :: ierr
73 
74       \textcolor{keyword}{call }comment(fileid)
75 
76       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) i
77 
78       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
79         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
80           \textcolor{keyword}{call }file_error(fileid,errmsg)
81 \textcolor{keywordflow}{        end if}
82         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
83           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
84             \textcolor{keyword}{call }file_error(fileid,errmsg)
85           \textcolor{keywordflow}{else}
86             \textcolor{keyword}{call }file_error(fileid)
87 \textcolor{keywordflow}{          end if}
88 \textcolor{keywordflow}{        end if}
89 \textcolor{keywordflow}{      end if}
90       
91       
92        \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
93         \textcolor{keywordflow}{if} (i<ranges(1) .or. i> ranges(2)) \textcolor{keywordflow}{then}
94           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
95           \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
96             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
97               \textcolor{keyword}{call }file_error(fileid,errmsg)
98             \textcolor{keywordflow}{else}
99               \textcolor{keyword}{call }file_error(fileid)
100 \textcolor{keywordflow}{            end if}
101 \textcolor{keywordflow}{          end if}
102 \textcolor{keywordflow}{        end if}
103 \textcolor{keywordflow}{      end if}
104 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=299pt]{namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+logical@{read\+\_\+logical}}
\index{read\+\_\+logical@{read\+\_\+logical}!readtools@{readtools}}
\subsubsection[{read\+\_\+logical(l, fileid, errmsg, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::read\+\_\+logical (
\begin{DoxyParamCaption}
\item[{logical, intent(out)}]{l, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7}


Definition at line 418 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
418       \textcolor{keywordtype}{use }globals
419       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: l
420       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
421       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
422       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
423 
424       \textcolor{keywordtype}{integer} :: ierr
425       \textcolor{keywordtype}{character(len=1)} :: ch
426       
427       \textcolor{keyword}{call }comment(fileid)
428       
429       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) ch
430 
431       \textcolor{keywordflow}{if} (ierr == 0) \textcolor{keywordflow}{then} 
432         \textcolor{keywordflow}{select case}(ch)
433           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"y"})
434             l = .true.
435           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"n"})
436             l = .false.
437 \textcolor{keywordflow}{          case default}
438             ierr = -1
439             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"You have defined incorrect value for
       logical parameter)"}\textcolor{comment}{ &}
440 \textcolor{comment}{             //achar(27)//}\textcolor{stringliteral}{'[0m'}
441 \textcolor{keywordflow}{         end select}
442 \textcolor{keywordflow}{       end if}
443       
444       \textcolor{keywordflow}{if} (ierr /= 0 .and. (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit)) \textcolor{keywordflow}{then}
445         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
446           \textcolor{keyword}{call }file_error(fileid,errmsg)
447 \textcolor{keywordflow}{        end if}
448         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
449           \textcolor{keyword}{call }file_error(fileid,errmsg)
450         \textcolor{keywordflow}{else}
451           \textcolor{keyword}{call }file_error(fileid)
452 \textcolor{keywordflow}{        end if}
453 \textcolor{keywordflow}{      end if}
454       
455       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+real@{read\+\_\+real}}
\index{read\+\_\+real@{read\+\_\+real}!readtools@{readtools}}
\subsubsection[{read\+\_\+real(r, fileid, ranges, errmsg, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+real (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{real(kind=rkind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_a8cf69cd43a457ddd1b29072139f19772}


Definition at line 219 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
219       \textcolor{keywordtype}{use }typy
220       \textcolor{keywordtype}{use }globals
221       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)} :: r
222       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
223       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
224       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
225       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
226       
227       \textcolor{comment}{!logical vars}
228       \textcolor{keywordtype}{integer} :: ierr
229       
230       \textcolor{keyword}{call }comment(fileid)
231       
232       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
233       
234       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
235         \textcolor{keywordflow}{if} (r < ranges(1) .or. r > ranges(2)) \textcolor{keywordflow}{then}
236           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
237           ierr = -1
238 \textcolor{keywordflow}{        end if}
239 \textcolor{keywordflow}{      end if}
240       
241       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
242         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
243           \textcolor{keyword}{call }file_error(fileid,errmsg)
244 \textcolor{keywordflow}{        end if}
245         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
246           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
247             \textcolor{keyword}{call }file_error(fileid,errmsg)
248           \textcolor{keywordflow}{else}
249             \textcolor{keyword}{call }file_error(fileid)
250 \textcolor{keywordflow}{          end if}
251 \textcolor{keywordflow}{        end if}
252 \textcolor{keywordflow}{      end if}
253 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{namespacereadtools_a8cf69cd43a457ddd1b29072139f19772_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!read\+\_\+real\+\_\+array@{read\+\_\+real\+\_\+array}}
\index{read\+\_\+real\+\_\+array@{read\+\_\+real\+\_\+array}!readtools@{readtools}}
\subsubsection[{read\+\_\+real\+\_\+array(r, fileid, ranges, errmsg, checklen, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, private readtools\+::read\+\_\+real\+\_\+array (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{real(kind=rkind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{checklen, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em checklen} & checks if the array length is equal to the length of line in file \\
\hline
\end{DoxyParams}


Definition at line 259 of file readtools.\+f90.



References comment(), file\+\_\+error(), and globals\+::terminal.


\begin{DoxyCode}
259       \textcolor{keywordtype}{use }typy
260       \textcolor{keywordtype}{use }globals
261       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: r
262       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
263       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
264       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
266       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: checklen
267       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
268       
269             \textcolor{comment}{!logical vars}
270       \textcolor{keywordtype}{integer} :: ierr, ierr2
271       \textcolor{keywordtype}{integer(kind=ikind)} :: i, i1, i2, arraybound, current\_pos, chpos
272       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmpdata
273       
274       \textcolor{keyword}{call }comment(fileid)
275       
276       arraybound=1
277       
278       \textcolor{keyword}{allocate}(tmpdata(arraybound))
279       
280       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(checklen)) \textcolor{keywordflow}{then}
281         \textcolor{keywordflow}{if} (checklen) \textcolor{keywordflow}{then}
282           current\_pos = ftell(fileid)
283           \textcolor{keywordflow}{do} 
284             \textcolor{keyword}{call }comment(fileid)
285             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1\textcolor{comment}{)}
286 \textcolor{comment}{            i1=ftell(fileid)}
287 \textcolor{comment}{            backspace fileid}
288 \textcolor{comment}{            }\textcolor{keyword}{call }comment(fileid)
289             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)
290             i2 = ftell(fileid)
291             backspace fileid
292            
293             \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
294               arraybound = arraybound - 1
295               \textcolor{keywordflow}{do}
296                 chpos = ftell(fileid)
297                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
298                   \textcolor{keywordflow}{EXIT}
299                 \textcolor{keywordflow}{else}
300                   backspace(unit=fileid, iostat=ierr2)
301 \textcolor{keywordflow}{                end if}
302 \textcolor{keywordflow}{              end do}
303               \textcolor{keyword}{deallocate}(tmpdata)
304               \textcolor{keywordflow}{EXIT}
305 \textcolor{keywordflow}{            end if}
306             
307             \textcolor{keywordflow}{if} (i1 == i2) \textcolor{keywordflow}{then}
308               arraybound = arraybound + 1
309               \textcolor{keywordflow}{if} (ubound(tmpdata,1) < arraybound) \textcolor{keywordflow}{then}
310                 \textcolor{keyword}{deallocate}(tmpdata)
311                 \textcolor{keyword}{allocate}(tmpdata(2*arraybound))
312 \textcolor{keywordflow}{              end if}    
313             \textcolor{keywordflow}{else} 
314               arraybound = arraybound - 1
315               \textcolor{keywordflow}{do}
316                 chpos = ftell(fileid)
317                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
318                   \textcolor{keywordflow}{EXIT}
319                 \textcolor{keywordflow}{else}
320                   backspace(unit=fileid, iostat=ierr2)
321 \textcolor{keywordflow}{                end if}
322 \textcolor{keywordflow}{              end do}
323               \textcolor{keyword}{deallocate}(tmpdata)
324               \textcolor{keywordflow}{EXIT}
325 \textcolor{keywordflow}{            end if}
326 \textcolor{keywordflow}{          end do}
327   
328           \textcolor{keywordflow}{if} (arraybound /= ubound(r,1)) \textcolor{keywordflow}{then}
329             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"the line in your input file has &}
330 \textcolor{stringliteral}{}\textcolor{stringliteral}{               incorrect number of values, check your inputs"} //achar(27\textcolor{comment}{)//}\textcolor{stringliteral}{'[0m'}
331             \textcolor{keyword}{call }file_error(fileid, errmsg)
332 \textcolor{keywordflow}{         end if}
333 \textcolor{keywordflow}{        end if}
334 \textcolor{keywordflow}{      end if}
335       
336       \textcolor{keyword}{call }comment(fileid)
337       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
338     
339       
340       
341       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
342         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
343           \textcolor{keyword}{call }file_error(fileid,errmsg)
344 \textcolor{keywordflow}{        end if}
345         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
346           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
347             \textcolor{keyword}{call }file_error(fileid,errmsg)
348           \textcolor{keywordflow}{else}
349             \textcolor{keyword}{call }file_error(fileid)
350 \textcolor{keywordflow}{          end if}
351 \textcolor{keywordflow}{        end if}
352 \textcolor{keywordflow}{      end if}
353       
354       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
355         \textcolor{keywordflow}{do} i=1, ubound(r,1)
356           \textcolor{keywordflow}{if} (r(i) < ranges(1) .or. r(i) > ranges(2)) \textcolor{keywordflow}{then}
357             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ /
      /achar(27)//}\textcolor{stringliteral}{'[0m'}
358             \textcolor{keyword}{call }file_error(fileid, errmsg)
359 \textcolor{keywordflow}{          end if}
360 \textcolor{keywordflow}{        end do}
361 \textcolor{keywordflow}{      end if}
362       
363       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c_cgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!readbcvals@{readbcvals}}
\index{readbcvals@{readbcvals}!readtools@{readtools}}
\subsubsection[{readbcvals(unit\+W, struct, dimen, dirname)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public readtools\+::readbcvals (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{unitW, }
\item[{type({\bf boundary\+\_\+vals}), dimension(\+:), intent(out), allocatable}]{struct, }
\item[{integer(kind=ikind), intent(in)}]{dimen, }
\item[{character(len=$\ast$), intent(in)}]{dirname}
\end{DoxyParamCaption}
)}\label{namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dirname} & directory name, where data with boundary condition are stored \\
\hline
\end{DoxyParams}


Definition at line 603 of file readtools.\+f90.



References comment(), globals\+::end\+\_\+time, file\+\_\+error(), core\+\_\+tools\+::find\+\_\+unit(), globals\+::measured\+\_\+pts, and globals\+::nodes.



Referenced by ade\+\_\+reader\+::ade\+\_\+read(), boussread\+::boussreader(), heat\+\_\+reader\+::heat\+\_\+read(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readf(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readm(), and re\+\_\+reader\+::res\+\_\+read().


\begin{DoxyCode}
603       \textcolor{keywordtype}{use }typy
604       \textcolor{keywordtype}{use }globals
605       \textcolor{keywordtype}{use }global_objs
606       \textcolor{keywordtype}{use }pde_objs
607       \textcolor{keywordtype}{use }core_tools
608       \textcolor{keywordtype}{use }debug_tools
609 
610 
611       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: unitw
612       \textcolor{keywordtype}{type}(boundary_vals), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: struct
613       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: dimen
615       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: dirname
616       \textcolor{keywordtype}{integer(kind=ikind)} :: i, j, n
617       \textcolor{keywordtype}{character(len=3)} :: ch
618       \textcolor{keywordtype}{character(len=1)} :: y\_file, y\_cond
619       \textcolor{keywordtype}{integer} :: ierr, fileid
620       \textcolor{keywordtype}{integer(kind=ikind)} :: counter, counter2
621       \textcolor{keywordtype}{character(len=256)} :: filename
622       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
623       \textcolor{keywordtype}{character(len=1024)} :: msg
624       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tester
625       
626       
627       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(struct)) \textcolor{keywordflow}{then}
628         \textcolor{keyword}{allocate}(struct(101:101+dimen-1))
629       \textcolor{keywordflow}{else}
630         print *, \textcolor{stringliteral}{"W: strange bc struct already allocated with bounds:"}, lbound(struct\textcolor{comment}{,1), }\textcolor{stringliteral}{":"}\textcolor{comment}{, ubound(
      struct,1)}
631 \textcolor{comment}{}\textcolor{keywordflow}{      end if}
632       
633       \textcolor{keywordflow}{if} (maxval(nodes%edge) /= ubound(struct,1)) \textcolor{keywordflow}{then}
634         \textcolor{keyword}{inquire}(unit=unitw, name=filename)
635         \textcolor{keywordflow}{if} (maxval(nodes%edge)-100 - dimen == ubound(measured_pts,1) ) \textcolor{keywordflow}{then}
636           \textcolor{keyword}{write}(unit=msg, fmt=\textcolor{stringliteral}{"(a)"}) \textcolor{stringliteral}{"There is an inconsistent boundary description, it seems like you have
       forgot & }
637 \textcolor{stringliteral}{}\textcolor{stringliteral}{               to include the points with measurement into boundary definition"}
638         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (maxval(nodes%edge) < 100) \textcolor{keywordflow}{then}
639           \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"Your mesh does not define any boundaries, you are completely wrong!!"}
640         \textcolor{keywordflow}{else}                    \textcolor{comment}{!a,I3,a,I3,a,I3,a,I3,a,I3,a}
641           \textcolor{keyword}{write}(unit=msg, fmt=\textcolor{stringliteral}{"(a,I3,a,I3,a,I3,a,a,a,I3,a)"})  \textcolor{stringliteral}{"There is an inconsistent boundary
       description, &}
642 \textcolor{stringliteral}{}\textcolor{stringliteral}{                                                                  the mesh configuration defines "}& 
643           , maxval(nodes%edge)-100 - ubound(measured_pts,1) , \textcolor{stringliteral}{" boundary(ies), your measurement points
       define an extra"}\textcolor{comment}{, &}
644 \textcolor{comment}{          ubound(measured_pts,1), }\textcolor{stringliteral}{" boundary(ies), thus in total you need:"}, &
645           maxval(nodes%edge)-100, \textcolor{stringliteral}{" boundary(ies), however the input model file: "}\textcolor{comment}{, &}
646 \textcolor{comment}{          trim(filename), }\textcolor{stringliteral}{" defines "}, dimen, \textcolor{stringliteral}{" boundary(ies)."}
647 
648 \textcolor{keywordflow}{        end if}
649         \textcolor{keyword}{call }file_error(unitw, trim(msg))
650 \textcolor{keywordflow}{      end if}
651 
652 
653       \textcolor{keywordflow}{do} i = lbound(struct,1), ubound(struct,1)
654         \textcolor{keyword}{call }comment(unitw)
655         \textcolor{keyword}{read}(unit=unitw, fmt=*, iostat=ierr) struct(i)%ID, struct(i)%code\textcolor{comment}{, y\_file, struct(i)%value, struct(
      i)%layer}
656 \textcolor{comment}{        }\textcolor{keywordflow}{select case}(y\_file)
657           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"y"})
658             struct(i)%file = .true.
659           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"n"})
660             struct(i)%file = .false.
661 \textcolor{keywordflow}{          case default}
662             \textcolor{keyword}{call }file_error(unitw, &
663             \textcolor{stringliteral}{"set [y/n] value for file in boundary condition description, see file info bellow"}\textcolor{comment}{)}
664 \textcolor{comment}{}\textcolor{keywordflow}{        end select}
665 
666         struct(i)%icond4neumann = .false.
667 
668         \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
669           \textcolor{keyword}{inquire}(unit=unitw, name=filename)
670           \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"HINT: check number of boundary records in file: "}\textcolor{comment}{, trim(filename)}
671 \textcolor{comment}{          }\textcolor{keyword}{call }file_error(unitw, trim(msg))
672 \textcolor{keywordflow}{        end if}
673 
674         \textcolor{keywordflow}{if} (struct(i)%file) \textcolor{keywordflow}{then}
675           \textcolor{keyword}{call }find_unit(fileid)
676           \textcolor{keyword}{write}(unit=filename, fmt=\textcolor{stringliteral}{"(a, I3, a)"}) trim(dirname), i, \textcolor{stringliteral}{".bc"}
677           \textcolor{keyword}{open}(unit=fileid, file=trim(filename), action=\textcolor{stringliteral}{"read"}, status=\textcolor{stringliteral}{"old"}\textcolor{comment}{,  iostat=ierr)}
678 \textcolor{comment}{          }\textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
679             \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"ERROR: if using unsteady boundary value data, you must supply the file
       with data!"}\textcolor{comment}{, &}
680 \textcolor{comment}{            }\textcolor{stringliteral}{"ERROR: file required:"}, trim(filename)
681             \textcolor{keyword}{call }file_error(unitw, msg)
682 \textcolor{keywordflow}{          end if}
683           counter = 0
684           \textcolor{keywordflow}{do} 
685             counter = counter + 1
686             \textcolor{keyword}{call }comment(fileid)
687             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmp
688             \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
689               \textcolor{keywordflow}{EXIT}
690 \textcolor{keywordflow}{            end if}
691 \textcolor{keywordflow}{          end do}
692 
693           
694           \textcolor{keyword}{close}(fileid)
695 
696           counter = counter - 1
697  
698           \textcolor{keyword}{open}(unit=fileid, file=trim(filename), action=\textcolor{stringliteral}{"read"}, status=\textcolor{stringliteral}{"old"}\textcolor{comment}{,  iostat=ierr)}
699 \textcolor{comment}{   }
700 \textcolor{comment}{          }\textcolor{keyword}{allocate}(struct(i)%series(counter,2))
701 
702           \textcolor{keywordflow}{do} j=1, counter
703             \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"Incorrect data in file:  "}, trim(filename), \textcolor{stringliteral}{"    at line:"}\textcolor{comment}{, j}
704 \textcolor{comment}{            }\textcolor{keyword}{call }fileread(struct(i)%series(j,:), fileid, checklen=.true.\textcolor{comment}{, errmsg=msg)}
705 \textcolor{comment}{}\textcolor{keywordflow}{          end do}
706 
707           struct(i)%series\_pos = 1
708        
709           \textcolor{keywordflow}{if} (struct(i)%series(counter,1) < end_time) \textcolor{keywordflow}{then}
710             \textcolor{keyword}{call }file_error(fileid, &
711             \textcolor{stringliteral}{"ERROR: end time in unsteady boundary data must be equal or higher than the simulation end
       time"}\textcolor{comment}{ )}
712 \textcolor{comment}{}\textcolor{keywordflow}{          end if}
713 
714 
715           \textcolor{keyword}{close}(fileid)
716 \textcolor{keywordflow}{        end if}
717 
718 \textcolor{keywordflow}{      end do}
719 
720       
721 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_icgraph}
\end{center}
\end{figure}


\index{readtools@{readtools}!set\+\_\+tensor@{set\+\_\+tensor}}
\index{set\+\_\+tensor@{set\+\_\+tensor}!readtools@{readtools}}
\subsubsection[{set\+\_\+tensor(values, angle, tensor)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public readtools\+::set\+\_\+tensor (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{values, }
\item[{real(kind=rkind), dimension(\+:), intent(in)}]{angle, }
\item[{real(kind=rkind), dimension(\+:,\+:), intent(out)}]{tensor}
\end{DoxyParamCaption}
)}\label{namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029}


this procedure set up an anisothropy tensor, the local anisothrophy values are supllied in values array, angle is the angle between the local and global system, tensor is the resulting secodn order tensor 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em values} & local anisothoropy values with respect to local x, local y and local z\\
\hline
\mbox{\tt in}  & {\em angle} & angle between the local and global system of coordinates\\
\hline
\mbox{\tt out}  & {\em tensor} & resulting second order tensor with respect to the global system of coordinates \\
\hline
\end{DoxyParams}


Definition at line 558 of file readtools.\+f90.



References globals\+::drutes\+\_\+config.



Referenced by ade\+\_\+reader\+::ade\+\_\+read(), heat\+\_\+reader\+::heat\+\_\+read(), re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+var(), and re\+\_\+reader\+::res\+\_\+read().


\begin{DoxyCode}
558       \textcolor{keywordtype}{use }typy
559       \textcolor{keywordtype}{use }globals
560       \textcolor{keywordtype}{use }global_objs
562       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: values
564       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: angle
566       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(out)} :: tensor
567       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: t
568       \textcolor{keywordtype}{integer(kind=ikind)} :: i,j
569 
570 
571       \textcolor{keyword}{allocate}(t(drutes_config%dimen, drutes_config%dimen))
572 
573 
574       \textcolor{keywordflow}{select case}(drutes_config%dimen)
575         \textcolor{keywordflow}{case}(1)
576           tensor(1,1) = values(1)
577           \textcolor{keywordflow}{RETURN}
578         \textcolor{keywordflow}{case}(2)
579 
580           t(1,1) = cos(4.0\_dprec*atan(1.0\_dprec)/180.0\_rkind*angle(1))
581           t(1,2) = cos(4.0\_dprec*atan(1.0\_dprec)/180.0\_rkind*(90-angle(1\textcolor{comment}{)))}
582 \textcolor{comment}{          t(2,1) = cos(4.0\_dprec*atan(1.0\_dprec)/180.0\_rkind*(90+angle(1)))}
583 \textcolor{comment}{          t(2,2) = cos(4.0\_dprec*atan(1.0\_dprec)/180.0\_rkind*(angle(1)))}
584 \textcolor{comment}{}
585 \textcolor{comment}{        }\textcolor{keywordflow}{case}(3)
586           print *, \textcolor{stringliteral}{"tensors not implemented in 3D"}
587           error stop
588 \textcolor{keywordflow}{      end select}            
589 
590       tensor = 0
591       \textcolor{keywordflow}{do} i=1, ubound(tensor,1)
592         tensor(i,i) = values(i)
593 \textcolor{keywordflow}{      end do}
594 
595       tensor = matmul(matmul(t, tensor), transpose(t))
596 
597       \textcolor{keyword}{deallocate}(t)
598 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029_icgraph}
\end{center}
\end{figure}


