\section{read\+\_\+inputs Module Reference}
\label{namespaceread__inputs}\index{read\+\_\+inputs@{read\+\_\+inputs}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf read\+\_\+global} ()
\item 
subroutine, public {\bf read\+\_\+1dmesh\+\_\+int} ()
\item 
subroutine, public {\bf read\+\_\+2dmesh\+\_\+int} ()
\item 
subroutine, public {\bf read\+\_\+2dmesh\+\_\+t3d} ()
\begin{DoxyCompactList}\small\item\em loads mesh data files from external mesh generator and allocate required mesh structures \end{DoxyCompactList}\item 
subroutine, public {\bf read\+\_\+2dmesh\+\_\+gmsh} ()
\item 
subroutine, public {\bf read\+\_\+scilab} (name, proc)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+1dmesh\+\_\+int@{read\+\_\+1dmesh\+\_\+int}}
\index{read\+\_\+1dmesh\+\_\+int@{read\+\_\+1dmesh\+\_\+int}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+1dmesh\+\_\+int()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+1dmesh\+\_\+int (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_adaa82a67c86871d224f9ad95b8b93b3f}


Definition at line 272 of file read\+\_\+inputs.\+f90.



References readtools\+::comment(), globals1d\+::deltax\+\_\+1d, readtools\+::file\+\_\+error(), globals\+::file\+\_\+mesh, globals1d\+::length\+\_\+1d, globals1d\+::materials\+\_\+1d, and simegen\+::simegen1d().



Referenced by drutes\+\_\+init\+::parse\+\_\+globals().


\begin{DoxyCode}
272       \textcolor{keywordtype}{use }typy
273       \textcolor{keywordtype}{use }globals
274       \textcolor{keywordtype}{use }globals1d
275       \textcolor{keywordtype}{use }core_tools
276       \textcolor{keywordtype}{use }simegen
277       \textcolor{keywordtype}{use }readtools
278 
279       \textcolor{keywordtype}{integer} :: ierr
280       \textcolor{keywordtype}{integer} :: n, i, j
281       \textcolor{keywordtype}{character(len=1)} :: ch
282       \textcolor{keywordtype}{character(len=4096)} :: msg
283 
284       \textcolor{keyword}{call }comment(file_mesh)
285       \textcolor{keyword}{read}(unit=file_mesh, fmt = *, iostat = ierr) length_1d ; \textcolor{keywordflow}{if} (ierr \textcolor{comment}{/= 0) }\textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
286 \textcolor{comment}{}
287 \textcolor{comment}{}
288 \textcolor{comment}{}
289 \textcolor{comment}{      }\textcolor{keyword}{call }comment(file_mesh)
290       \textcolor{keyword}{read}(unit=file_mesh, fmt = *, iostat = ierr) n; \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
291 \textcolor{comment}{}
292 \textcolor{comment}{}
293 \textcolor{comment}{      }\textcolor{keyword}{allocate}(deltax_1d(0:n, 3))
294 
295       \textcolor{keywordflow}{do} i=1, n
296         \textcolor{keyword}{call }comment(file_mesh)
297         \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) deltax_1d(i,1), deltax_1d(i,\textcolor{comment}{2), 
      deltax_1d(i,3)}
298 \textcolor{comment}{          }\textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keyword}{call }file_error(file_mesh)
299 \textcolor{keywordflow}{      end do}
300       
301       
302      \textcolor{keywordflow}{if} (abs(length_1d-(deltax_1d(ubound(deltax_1d,1), 3)-deltax_1d(1,2)\textcolor{comment}{)) > 10*epsilon(
      deltax_1d(1,2))) }\textcolor{keywordflow}{then}
303 
304         \textcolor{keyword}{write}(unit=msg, fmt=*)\textcolor{stringliteral}{"incorrect definition in either:"} , new\_line\textcolor{comment}{(}\textcolor{stringliteral}{"a"}\textcolor{comment}{),  &}
305 \textcolor{comment}{        }\textcolor{stringliteral}{"                          - domain length definition"} ,  new\_line\textcolor{comment}{(}\textcolor{stringliteral}{"a"}\textcolor{comment}{) ,&}
306 \textcolor{comment}{       }\textcolor{stringliteral}{"or"} , new\_line(\textcolor{stringliteral}{"a"}),  &
307         \textcolor{stringliteral}{"                          - the mesh description values"} ,  new\_line\textcolor{comment}{(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
308 \textcolor{comment}{        }\textcolor{stringliteral}{" "} ,  new\_line(\textcolor{stringliteral}{"a"}) ,&
309         \textcolor{stringliteral}{"in file drutes.conf/mesh/drumesh1d.conf"} ,  new\_line(\textcolor{stringliteral}{"a"}) ,&
310         \textcolor{stringliteral}{" "} , new\_line(\textcolor{stringliteral}{"a"}) , &
311        \textcolor{stringliteral}{"the mesh description must cover (and cannot overlap) the entire domain length"}\textcolor{comment}{,  new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
312 \textcolor{comment}{        }\textcolor{stringliteral}{"-----------------------------------------------------------------------------"}
313         \textcolor{keyword}{call }file_error(file_mesh)
314 \textcolor{keywordflow}{      end if}
315       
316       \textcolor{keyword}{call }comment(file_mesh)
317 
318       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat=ierr) n ; \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
319 \textcolor{comment}{}
320 \textcolor{comment}{      }\textcolor{keyword}{allocate}(materials_1d(n,3))
321 
322       \textcolor{keywordflow}{do} i=1,n
323          \textcolor{keyword}{call }comment(file_mesh)
324          \textcolor{keyword}{read}(unit=file_mesh, fmt=* , iostat=ierr)  materials_1d(i,:) ; \textcolor{keywordflow}{if} (ierr\textcolor{comment}{ /= 0) }\textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
325 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
326       
327 
328       \textcolor{keywordflow}{do} i=1, ubound(materials_1d,1)-1
329         \textcolor{keywordflow}{if} (abs(materials_1d(i,3)-materials_1d(i+1,2)) > epsilon(materials_1d\textcolor{comment}{(i+1,1))) }\textcolor{keywordflow}{then}
330           \textcolor{keyword}{write}(msg,*) \textcolor{stringliteral}{"ERROR! material description does not cover the entire domain, check material id:"}\textcolor{comment}{, 
      int(materials_1d(i+1,1))}
331 \textcolor{comment}{          }\textcolor{keyword}{call }file_error(file_mesh, msg)
332 \textcolor{keywordflow}{        end if}
333 \textcolor{keywordflow}{      end do}
334       
335       
336       \textcolor{keywordflow}{if} (maxval(abs(materials_1d)) < length_1d) \textcolor{keywordflow}{then}
337         msg = \textcolor{stringliteral}{"ERROR! material description does not cover the entire domain, check 1D domain length value"}
338         \textcolor{keyword}{call }file_error(file_mesh, msg)
339 \textcolor{keywordflow}{      end if}
340         
341       \textcolor{keyword}{call }simegen1d()
342 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_adaa82a67c86871d224f9ad95b8b93b3f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_adaa82a67c86871d224f9ad95b8b93b3f_icgraph}
\end{center}
\end{figure}


\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+2dmesh\+\_\+gmsh@{read\+\_\+2dmesh\+\_\+gmsh}}
\index{read\+\_\+2dmesh\+\_\+gmsh@{read\+\_\+2dmesh\+\_\+gmsh}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+2dmesh\+\_\+gmsh()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+gmsh (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_a29f942f0f7f893e5e5cf1c53fc3ef61f}


Definition at line 442 of file read\+\_\+inputs.\+f90.



References globals\+::elements, globals\+::file\+\_\+mesh, core\+\_\+tools\+::find\+\_\+unit(), geom\+\_\+tools\+::gravity\+\_\+center(), geom\+\_\+tools\+::inside(), core\+\_\+tools\+::mesh\+\_\+allocater(), globals\+::nodes, pde\+\_\+objs\+::pde\+\_\+common, and core\+\_\+tools\+::write\+\_\+log().



Referenced by drutes\+\_\+init\+::parse\+\_\+globals().


\begin{DoxyCode}
442       \textcolor{keywordtype}{use }typy
443       \textcolor{keywordtype}{use }globals
444       \textcolor{keywordtype}{use }globals2d
445       \textcolor{keywordtype}{use }core_tools
446       \textcolor{keywordtype}{use }readtools
447       \textcolor{keywordtype}{use }pde_objs
448       \textcolor{keywordtype}{use }debug_tools
449       \textcolor{keywordtype}{use }geom_tools
450       
451       \textcolor{keywordtype}{character(len=256)} :: ch
452       \textcolor{keywordtype}{integer(kind=ikind)} :: i, itmp, jtmp, itmp2, edge, nd1, nd2, i\_err\textcolor{comment}{, k, l, j, n, id, el}
453 \textcolor{comment}{      }\textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmp\_array
454       \textcolor{keywordtype}{logical} :: use\_filemat=.false., update
455       \textcolor{keywordtype}{integer} :: file\_mat
456       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: domain, smalldom
457       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(2)} :: point
458       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: excl\_ids
459       
460       
461       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat=i\_err) ch
462 \textcolor{comment}{!       }
463       \textcolor{keywordflow}{if} (i\_err == 0) \textcolor{keywordflow}{then}
464         \textcolor{keywordflow}{if} (adjustl(trim(ch)) == \textcolor{stringliteral}{"materials.conf"}) \textcolor{keywordflow}{then}
465           use\_filemat=.true.
466 \textcolor{keywordflow}{        end if}
467 \textcolor{keywordflow}{      end if}
468       
469       \textcolor{keywordflow}{do}
470         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
471         \textcolor{keywordflow}{if} (trim(ch) == \textcolor{stringliteral}{"$Nodes"}) \textcolor{keywordflow}{EXIT}
472 \textcolor{keywordflow}{      end do}
473       
474       \textcolor{keyword}{read}(unit=file_mesh, fmt=*) nodes%kolik
475 
476       \textcolor{keywordflow}{do} 
477         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
478         \textcolor{keywordflow}{if} (trim(ch) == \textcolor{stringliteral}{"$Elements"}) \textcolor{keywordflow}{EXIT}
479 \textcolor{keywordflow}{      end do}
480 
481       \textcolor{keyword}{read}(unit=file_mesh, fmt=*) itmp
482       
483       elements%kolik = 0
484       
485       \textcolor{keywordflow}{do} i=1, itmp
486         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch, itmp2
487         \textcolor{keywordflow}{if} (itmp2 == 2) \textcolor{keywordflow}{then}
488           elements%kolik = elements%kolik + 1
489 \textcolor{keywordflow}{        end if}
490 \textcolor{keywordflow}{      end do}
491       
492       \textcolor{keyword}{call }mesh_allocater()
493 
494             
495       \textcolor{keywordflow}{do} 
496         itmp = ftell(file_mesh)
497         backspace(unit=file_mesh, iostat=i\_err)
498         jtmp = ftell(file_mesh)
499         \textcolor{keywordflow}{if}(itmp == jtmp) \textcolor{keywordflow}{EXIT}
500 \textcolor{keywordflow}{      end do}
501   
502   
503       \textcolor{keywordflow}{do}
504         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
505         \textcolor{keywordflow}{if} (trim(ch) == \textcolor{stringliteral}{"$Nodes"}) \textcolor{keywordflow}{then}
506           \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
507           \textcolor{keywordflow}{EXIT}
508 \textcolor{keywordflow}{        end if}
509 \textcolor{keywordflow}{      end do}
510       
511       \textcolor{keywordflow}{do} i=1, nodes%kolik
512         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) itmp,  nodes%data(i,:)
513 \textcolor{keywordflow}{      end do}
514       
515       \textcolor{keywordflow}{do} 
516         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
517         \textcolor{keywordflow}{if} (trim(ch) == \textcolor{stringliteral}{"$Elements"}) \textcolor{keywordflow}{then}
518           \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
519           \textcolor{keywordflow}{EXIT}
520 \textcolor{keywordflow}{        end if}
521 \textcolor{keywordflow}{      end do}
522       
523       jtmp = 0
524       
525       nodes%edge = 0
526       
527       \textcolor{keywordflow}{do} 
528         \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat=i\_err) ch, itmp
529         \textcolor{keywordflow}{if} (ch == \textcolor{stringliteral}{"$EndElements"}) \textcolor{keywordflow}{then}
530           \textcolor{keywordflow}{EXIT}
531 \textcolor{keywordflow}{        end if}
532         backspace(file_mesh, iostat = i\_err)
533         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
534           print *, \textcolor{stringliteral}{"Something wrong with your GMSH input file"}
535           print *, \textcolor{stringliteral}{"called from read\_inputs::read\_2dmesh\_gmsh"}
536           stop
537 \textcolor{keywordflow}{        end if}
538 
539         
540         \textcolor{keywordflow}{select case}(itmp)
541           \textcolor{keywordflow}{case}(1)
542             \textcolor{keyword}{read}(unit=file_mesh, fmt=*) k, l, i, edge, j,  nd1, nd2
543             \textcolor{keywordflow}{if} (i > 2) \textcolor{keywordflow}{then}
544               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"number of tags for edge must be equal 1, in mesh file it equals"}\textcolor{comment}{, int1=i)}
545 \textcolor{comment}{              }\textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"update your GMSH input file!"})
546               \textcolor{keyword}{allocate}(tmp\_array(i-1))
547               backspace(file_mesh)
548               \textcolor{keyword}{read}(unit=file_mesh, fmt=*) k, l, i, edge,  tmp\_array,  nd1, nd2
549               edge = tmp\_array(1)
550               \textcolor{keyword}{call }write_log(text=\textcolor{stringliteral}{"tags with positions greater than 1 were ignored"}\textcolor{comment}{)}
551 \textcolor{comment}{              }\textcolor{keyword}{deallocate}(tmp\_array)
552 \textcolor{keywordflow}{            end if}
553             
554 \textcolor{comment}{!           print *, tmp\_array, nd1, nd2 ; stop}
555 \textcolor{comment}{!           print *, itmp, jtmp, i, tmp\_array,  nd1, nd2}
556             
557             nodes%edge(nd1) = edge 
558             nodes%edge(nd2) = edge 
559             
560           \textcolor{keywordflow}{case}(2)
561             jtmp = jtmp + 1
562             \textcolor{keyword}{read}(unit=file_mesh, fmt=*) k, l, i, elements%material(jtmp,1), j, \textcolor{comment}{ 
      elements%data(jtmp,:)}
563 \textcolor{comment}{            }\textcolor{keywordflow}{if} (i /= 2) \textcolor{keywordflow}{then}
564               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"number of tags for element must be equal 2"})
565               \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"update your GMSH input file!"})
566               \textcolor{keywordflow}{if} (i > pde_common%processes + 1) \textcolor{keywordflow}{then}
567                 
568                 \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"the number of tags is greater than the number of solution components"}\textcolor{comment}{)}
569 \textcolor{comment}{                }
570 \textcolor{comment}{                }\textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(tmp\_array)) \textcolor{keyword}{deallocate}(tmp\_array)
571                 
572                 \textcolor{keyword}{allocate}(tmp\_array(i-1))
573                 
574                 backspace(file_mesh)
575                 \textcolor{keyword}{read}(unit=file_mesh, fmt=*) k, l, i, elements%material(jtmp,:), tmp\_array\textcolor{comment}{, 
      elements%data(jtmp,:)}
576 \textcolor{comment}{                elements%material(jtmp,:) = tmp\_array(1:ubound(elements%material,2))}
577 \textcolor{comment}{                }\textcolor{keyword}{call }write_log(text=\textcolor{stringliteral}{"tags with position"}, int1=1\_ikind*(ubound(
      elements%material\textcolor{comment}{,2)+1), &}
578 \textcolor{comment}{                    text2=}\textcolor{stringliteral}{"were ignored"})
579                 \textcolor{keyword}{deallocate}(tmp\_array)
580               \textcolor{keywordflow}{else}
581                 \textcolor{keyword}{call }write_log(\textcolor{stringliteral}{"the number of tags is lower than the number of solution components, I don't
       know what to do :("}\textcolor{comment}{)}
582 \textcolor{comment}{                print *, }\textcolor{stringliteral}{"called from read\_inputs::read\_2dmesh\_gmsh"}
583                 error stop
584 \textcolor{keywordflow}{              end if}
585 \textcolor{keywordflow}{            end if}
586               
587 \textcolor{keywordflow}{          case default}
588             print *, \textcolor{stringliteral}{"your GMSH input file contains unsupported element type"}
589             print *, \textcolor{stringliteral}{"called from read\_inputs::read\_2dmesh\_gmsh"}
590             stop
591 \textcolor{keywordflow}{         end select}
592          
593 \textcolor{keywordflow}{      end do}
594       
595       \textcolor{keywordflow}{if} (pde_common%processes > 1) \textcolor{keywordflow}{then}
596         \textcolor{keywordflow}{do} i=2, pde_common%processes
597           elements%material(:,i) = elements%material(:,1)
598 \textcolor{keywordflow}{        end do}
599 \textcolor{keywordflow}{      end if}
600 
601       
602       \textcolor{keywordflow}{if} (use\_filemat) \textcolor{keywordflow}{then}
603         \textcolor{keyword}{allocate}(smalldom(3,2))
604         \textcolor{keyword}{call }find_unit(file\_mat)
605         \textcolor{keyword}{open}(unit=file\_mat, file=\textcolor{stringliteral}{"drutes.conf/mesh/materials.conf"}, action=\textcolor{stringliteral}{"read"}\textcolor{comment}{, iostat=i\_err)}
606 \textcolor{comment}{        }\textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
607           print *, \textcolor{stringliteral}{"unable to open drutes.conf/mesh/materials.conf"}
608           print *, \textcolor{stringliteral}{"exited from read\_inputs::read\_2dmesh\_gmsh"}
609           error stop
610 \textcolor{keywordflow}{        end if}
611         \textcolor{keyword}{call }fileread(n, file\_mat)
612         \textcolor{keyword}{allocate}(excl\_ids(n))
613         \textcolor{keywordflow}{do} i=1, n
614           \textcolor{keyword}{call }fileread(excl\_ids(i), file\_mat)
615 \textcolor{keywordflow}{        end do}
616         
617         \textcolor{keyword}{call }fileread(n, file\_mat)
618         \textcolor{keywordflow}{do} i=1, n
619           \textcolor{keyword}{call }fileread(id, file\_mat)
620           \textcolor{keyword}{call }fileread(j, file\_mat)
621           
622           \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(domain)) \textcolor{keywordflow}{then}
623             \textcolor{keyword}{deallocate}(domain)
624 \textcolor{keywordflow}{          end if}
625           
626           \textcolor{keyword}{allocate}(domain(j,2))
627           \textcolor{keywordflow}{do} k=1,j
628             \textcolor{keyword}{call }fileread(domain(k,:), file\_mat)
629 \textcolor{keywordflow}{          end do}
630           
631           
632           \textcolor{keywordflow}{do} el=1, elements%kolik
633 
634             \textcolor{keywordflow}{do} l=1, ubound(elements%data,2)
635               smalldom(l,:)=nodes%data(elements%data(el,l),:)
636 \textcolor{keywordflow}{            end do}
637 
638             point=gravity_center(smalldom(1,:), smalldom(2,:), smalldom(3,:))
639 
640             
641             \textcolor{keywordflow}{if} (inside(domain, point)) \textcolor{keywordflow}{then}
642               update=.true.
643               \textcolor{keywordflow}{do} l=1, ubound(excl\_ids,1)
644                 \textcolor{keywordflow}{if} (elements%material(el,1) == excl\_ids(l)) \textcolor{keywordflow}{then}
645                   update=.false.
646                   \textcolor{keywordflow}{exit}
647 \textcolor{keywordflow}{                end if}
648 \textcolor{keywordflow}{              end do}
649               \textcolor{keywordflow}{if} (update) \textcolor{keywordflow}{then}
650                 elements%material(el,:) = id
651 \textcolor{keywordflow}{              end if}
652 \textcolor{keywordflow}{            end if}
653 \textcolor{keywordflow}{          end do}
654 \textcolor{keywordflow}{        end do}
655 \textcolor{keywordflow}{      end if}
656         
657         
658      
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a29f942f0f7f893e5e5cf1c53fc3ef61f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a29f942f0f7f893e5e5cf1c53fc3ef61f_icgraph}
\end{center}
\end{figure}


\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+2dmesh\+\_\+int@{read\+\_\+2dmesh\+\_\+int}}
\index{read\+\_\+2dmesh\+\_\+int@{read\+\_\+2dmesh\+\_\+int}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+2dmesh\+\_\+int()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+int (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_a16c9c0b91377d9e1ab81e838c6244ada}


Definition at line 347 of file read\+\_\+inputs.\+f90.



References readtools\+::comment(), readtools\+::file\+\_\+error(), globals\+::file\+\_\+mesh, and simegen\+::simegen2d().



Referenced by drutes\+\_\+init\+::parse\+\_\+globals().


\begin{DoxyCode}
347       \textcolor{keywordtype}{use }typy
348       \textcolor{keywordtype}{use }globals
349       \textcolor{keywordtype}{use }globals2d
350       \textcolor{keywordtype}{use }core_tools
351       \textcolor{keywordtype}{use }simegen
352       \textcolor{keywordtype}{use }readtools
353 
354       \textcolor{keywordtype}{integer} :: ierr
355       \textcolor{keywordtype}{real(kind=rkind)} :: width, length, density
356       \textcolor{keywordtype}{integer(kind=ikind)} :: edges, i, proc
357       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:,:,:)}, \textcolor{keywordtype}{allocatable} :: xy
358       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(2)} :: center\_coor
359       
360 
361       \textcolor{keyword}{call }comment(file_mesh)
362       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) width; \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
363 \textcolor{comment}{}
364 \textcolor{comment}{      }\textcolor{keyword}{call }comment(file_mesh)
365       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) length; \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
366 \textcolor{comment}{      }\textcolor{keyword}{call }comment(file_mesh)
367 
368       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) density; \textcolor{keywordflow}{if} (ierr /= 0)\textcolor{comment}{ }\textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
369 \textcolor{comment}{}
370 \textcolor{comment}{      }\textcolor{keyword}{call }comment(file_mesh)
371       
372       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) center\_coor; \textcolor{keywordflow}{if} (ierr /\textcolor{comment}{= 0) }\textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)    }
373 \textcolor{comment}{      }
374 \textcolor{comment}{      }\textcolor{keyword}{call }comment(file_mesh)
375             
376       \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat=ierr) edges; \textcolor{keywordflow}{if}(ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
377 \textcolor{comment}{}
378 \textcolor{comment}{      }\textcolor{keyword}{allocate}(xy(edges,2,2))
379       
380       
381 
382       \textcolor{keywordflow}{do} i=1, edges
383         \textcolor{keyword}{call }comment(file_mesh)
384         \textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) xy(i,1,:); \textcolor{keywordflow}{if}(ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
385 \textcolor{comment}{        }\textcolor{keyword}{read}(unit=file_mesh, fmt=*, iostat = ierr) xy(i,2,:); \textcolor{keywordflow}{if}(ierr /= 0) \textcolor{keyword}{call }
      file_error\textcolor{comment}{(file_mesh)}
386 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
387         
388       \textcolor{keyword}{call }simegen2d(width, length, density, xy, center\_coor)
389 
390 
391       \textcolor{keyword}{deallocate}(xy)
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a16c9c0b91377d9e1ab81e838c6244ada_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a16c9c0b91377d9e1ab81e838c6244ada_icgraph}
\end{center}
\end{figure}


\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+2dmesh\+\_\+t3d@{read\+\_\+2dmesh\+\_\+t3d}}
\index{read\+\_\+2dmesh\+\_\+t3d@{read\+\_\+2dmesh\+\_\+t3d}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+2dmesh\+\_\+t3d()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+2dmesh\+\_\+t3d (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_a013c60909c14ff644c9ed8e1c0b49279}


loads mesh data files from external mesh generator and allocate required mesh structures 



Definition at line 396 of file read\+\_\+inputs.\+f90.



References readtools\+::comment(), globals\+::elements, globals\+::file\+\_\+mesh, core\+\_\+tools\+::mesh\+\_\+allocater(), and globals\+::nodes.



Referenced by drutes\+\_\+init\+::parse\+\_\+globals().


\begin{DoxyCode}
396       \textcolor{keywordtype}{use }typy
397       \textcolor{keywordtype}{use }globals
398       \textcolor{keywordtype}{use }globals2d
399       \textcolor{keywordtype}{use }core_tools
400       \textcolor{keywordtype}{use }readtools
401       \textcolor{keywordtype}{use }debug_tools
402 
403 
404       \textcolor{keywordtype}{integer(kind=ikind)} :: i, okro, l
405       \textcolor{keywordtype}{real} :: ch
406 
407  
408   
409       \textcolor{keyword}{call }comment(file_mesh)
410       \textcolor{keyword}{read}(unit=file_mesh, fmt=*) ch
411       \textcolor{keyword}{call }comment(file_mesh)
412       \textcolor{keyword}{read}(unit=file_mesh, fmt=*) nodes%kolik, ch, elements%kolik
413       \textcolor{keyword}{call }comment(file_mesh) 
414 
415       \textcolor{keyword}{call }mesh_allocater()
416 
417       \textcolor{keywordflow}{do} i=1, nodes%kolik
418         \textcolor{keyword}{call }comment(file_mesh)
419         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) nodes%id(i), nodes%data(i,:), ch, ch, ch, 
      nodes%edge\textcolor{comment}{(i) }
420 \textcolor{comment}{        }\textcolor{keywordflow}{if} (nodes%edge(i) > 100) \textcolor{keywordflow}{then}
421           \textcolor{keywordflow}{CONTINUE}
422         \textcolor{keywordflow}{else}
423           nodes%edge(i) = 0
424 \textcolor{keywordflow}{        end if}
425 \textcolor{keywordflow}{      end do}
426       
427    
428     
429       \textcolor{keywordflow}{do} i=1, elements%kolik
430         \textcolor{keyword}{call }comment(file_mesh)
431         \textcolor{keyword}{read}(unit=file_mesh, fmt=*) elements%id(i), elements%data(i,:), ch, ch,\textcolor{comment}{ 
      elements%material(i,1)}
432 \textcolor{comment}{        elements%material(i,1) = elements%material(i,1) ! - 10000}
433 \textcolor{keywordflow}{      end do}
434      
435 
436       \textcolor{keyword}{close}(file_mesh)
437 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a013c60909c14ff644c9ed8e1c0b49279_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a013c60909c14ff644c9ed8e1c0b49279_icgraph}
\end{center}
\end{figure}


\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+global@{read\+\_\+global}}
\index{read\+\_\+global@{read\+\_\+global}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+global()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+global (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_a9b0f9c757631596bdead541938506c2c}


Definition at line 11 of file read\+\_\+inputs.\+f90.



References globals\+::backup\+\_\+file, globals\+::debugmode, globals\+::drutes\+\_\+config, globals\+::dtmax, globals\+::dtmin, globals\+::end\+\_\+time, readtools\+::file\+\_\+error(), globals\+::file\+\_\+global, globals\+::file\+\_\+wwwglob, globals\+::init\+\_\+dt, globals\+::integ\+\_\+method, globals\+::iter\+\_\+criterion, globals\+::max\+\_\+itcount, globals\+::measured\+\_\+pts, globals\+::observation\+\_\+array, globals\+::observe\+\_\+info, globals\+::observe\+\_\+time, pde\+\_\+objs\+::pde\+\_\+common, globals\+::print\+\_\+level, globals\+::time\+\_\+units, and globals\+::www.



Referenced by drutes\+\_\+init\+::parse\+\_\+globals().


\begin{DoxyCode}
11       \textcolor{keywordtype}{use }globals
12       \textcolor{keywordtype}{use }globals1d
13       \textcolor{keywordtype}{use }globals2d
14       \textcolor{keywordtype}{use }typy
15       \textcolor{keywordtype}{use }core_tools
16       \textcolor{keywordtype}{use }readtools
17       \textcolor{keywordtype}{use }pde_objs
18 
19       \textcolor{keywordtype}{integer(kind=ikind)} :: i, j, n, ierr
20       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3)} :: tmp
21       \textcolor{keywordtype}{character(len=4096)} :: filename
22       \textcolor{keywordtype}{character(len=8192)} :: msg
23       \textcolor{keywordtype}{integer} :: local, global
24       \textcolor{keywordtype}{character(len=256)}, \textcolor{keywordtype}{dimension(19)} :: probnames
25       
26       \textcolor{keywordflow}{if} (.not. www) \textcolor{keywordflow}{then}
27         local = file_global
28         global = file_global
29       \textcolor{keywordflow}{else}
30         local = file_global
31         global = file_wwwglob
32 \textcolor{keywordflow}{      end if}
33 
34       
35       \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"Incorrect option for problem type, the available options are:"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{),  
      new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{),&}
36 \textcolor{comment}{        }\textcolor{stringliteral}{"   RE\_std = standard Richards equation, primary solution is capillary pressure head h, matrix is
       nonsymmetric"}\textcolor{comment}{ , &}
37 \textcolor{comment}{         new\_line(}\textcolor{stringliteral}{"a"}), new\_line(\textcolor{stringliteral}{"a"}),  &
38         \textcolor{stringliteral}{"   RE\_rot = Richards equation in cylindric coordinates, primary solution is capillary pressure
       head h, matrix is nonsymmetric"}\textcolor{comment}{,& }
39 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{"a"}) ,  new\_line(\textcolor{stringliteral}{"a"}), &
40         \textcolor{stringliteral}{"   REstdH = Richards equation, primary solution is total hydraulic head H, matrix is symmetric"}\textcolor{comment}{,&}
41 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{"a"}), new\_line(\textcolor{stringliteral}{"a"}),  &
42         \textcolor{stringliteral}{"   RErotH =  Richards equation in cylindric coordinates,  primary solution is total hydraulic head
       H, matrix is symmetric"}\textcolor{comment}{, &}
43 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
44         \textcolor{stringliteral}{"   RE\_mod = modified Richards equation, see Noborio, et al. (1996)"}, &
45         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
46         \textcolor{stringliteral}{"   boussi = Boussinesq equation for sloping land (1877)"}, &
47         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
48         \textcolor{stringliteral}{"   ADE\_wR = advection dispersion reaction equation (transport of solutes), convection is computed
       from the Richards equation, "}\textcolor{comment}{, &}
49 \textcolor{comment}{        }\textcolor{stringliteral}{"equilibrium sorption"}, &
50         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
51         \textcolor{stringliteral}{"   ADEstd = advection dispersion reaction equation (transport of solutes),  convection is
       specified in config files,"}\textcolor{comment}{, &}
52 \textcolor{comment}{        }\textcolor{stringliteral}{" equilibrium sorption"}, &
53         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
54         \textcolor{stringliteral}{"   ADEstd\_kinsorb = advection dispersion reaction equation (transport of solutes),"}\textcolor{comment}{,&}
55 \textcolor{comment}{        }\textcolor{stringliteral}{" convection is specified in config files,"}, &
56         \textcolor{stringliteral}{" kinetic sorption"}, &
57         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
58         \textcolor{stringliteral}{"   ADE\_RE\_std = advection dispersion reaction equation (transport of solutes), convection is
       computed from"}\textcolor{comment}{, &}
59 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in pressure head form, equilibrium sorption "}, \textcolor{comment}{&}
60 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
61         \textcolor{stringliteral}{"   ADE\_REstdH = advection dispersion reaction equation (transport of solutes), convection is
       computed from"}\textcolor{comment}{, &}
62 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in total hydraulic head form, equilibrium sorption "}\textcolor{comment}{, &}
63 \textcolor{comment}{                new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
64         \textcolor{stringliteral}{"   ADE\_RE\_rot = advection dispersion reaction equation (transport of solutes), convection is
       computed from"}\textcolor{comment}{, &}
65 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in pressure hydraulic head form, cylindric coordinates (axisymmetric flow),
       equilibrium sorption "}\textcolor{comment}{, &}
66 \textcolor{comment}{                new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
67         \textcolor{stringliteral}{"   ADE\_RErotH = advection dispersion reaction equation (transport of solutes), convection is
       computed from"}\textcolor{comment}{, &}
68 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in total hydraulic head form, cylindric coordinates (axisymmetric flow),
       equilibrium sorption "}\textcolor{comment}{, &}
69 \textcolor{comment}{                }\textcolor{stringliteral}{"   ADE\_RE\_std\_kinsorb = advection dispersion reaction equation (transport of solutes),
       convection is computed from"}\textcolor{comment}{, &}
70 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in pressure head form, kinetic sorption "}, &
71         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
72         \textcolor{stringliteral}{"   ADE\_REstdH\_kinsorb = advection dispersion reaction equation (transport of solutes), convection
       is computed from"}\textcolor{comment}{, &}
73 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in total hydraulic head form, kinetic sorption "}\textcolor{comment}{, &}
74 \textcolor{comment}{                new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
75         \textcolor{stringliteral}{"   ADE\_RE\_rot\_kinsorb = advection dispersion reaction equation (transport of solutes), convection
       is computed from"}\textcolor{comment}{, &}
76 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in pressure hydraulic head form, cylindric coordinates (axisymmetric flow),
       kinetic sorption "}\textcolor{comment}{, &}
77 \textcolor{comment}{                new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
78         \textcolor{stringliteral}{"   ADE\_RErotH\_kinsorb = advection dispersion reaction equation (transport of solutes), convection
       is computed from"}\textcolor{comment}{, &}
79 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in total hydraulic head form, cylindric coordinates (axisymmetric flow),
       kinetic sorption "}\textcolor{comment}{, &}
80 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
81         \textcolor{stringliteral}{"   Re\_dual\_totH = Richards equation dual porosity with total hydraulic head"}\textcolor{comment}{, &}
82 \textcolor{comment}{        }\textcolor{stringliteral}{" the Richards equation in total hydraulic head form "}, &
83         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
84         \textcolor{stringliteral}{"   heat = Heat conduction equation (Sophoclea, 1979)"}, &
85         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), &
86         new\_line(\textcolor{stringliteral}{"a"}),  new\_line(\textcolor{stringliteral}{"a"}), new\_line(\textcolor{stringliteral}{"a"})
87         
88         probnames(1) = \textcolor{stringliteral}{"RE\_std"}
89         probnames(2) = \textcolor{stringliteral}{"RE\_mod"}
90         probnames(3) = \textcolor{stringliteral}{"REtest"}
91         probnames(4) = \textcolor{stringliteral}{"RE\_rot"}
92         probnames(5) = \textcolor{stringliteral}{"REstdH"}
93         probnames(6) = \textcolor{stringliteral}{"RErotH"}
94         probnames(7) = \textcolor{stringliteral}{"boussi"}
95         probnames(8) = \textcolor{stringliteral}{"ADEstd"}
96         probnames(9) = \textcolor{stringliteral}{"ADEstd\_kinsorb"}
97         probnames(10) = \textcolor{stringliteral}{"ADE\_RE\_std"}
98         probnames(11) = \textcolor{stringliteral}{"ADE\_REstdH"}
99         probnames(12) = \textcolor{stringliteral}{"ADE\_RE\_rot"}
100         probnames(13) = \textcolor{stringliteral}{"ADE\_RErotH"}
101         probnames(14) = \textcolor{stringliteral}{"ADE\_RE\_std\_kinsorb"}
102         probnames(15) = \textcolor{stringliteral}{"ADE\_REstdH\_kinsorb"}
103         probnames(16) = \textcolor{stringliteral}{"ADE\_RE\_rot\_kinsorb"}
104         probnames(17) = \textcolor{stringliteral}{"ADE\_RErotH\_kinsorb"}
105         probnames(18) = \textcolor{stringliteral}{"Re\_dual\_totH"} 
106         probnames(19) = \textcolor{stringliteral}{"heat"}
107         
108       \textcolor{keyword}{call }fileread(drutes_config%name, local, trim(msg), options=probnames\textcolor{comment}{)}
109 \textcolor{comment}{}
110 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(drutes_config%dimen, local, ranges=(/1\_ikind,2\_ikind\textcolor{comment}{/))}
111 \textcolor{comment}{      }
112 \textcolor{comment}{      }\textcolor{keywordflow}{if} (drutes_config%name == \textcolor{stringliteral}{"boussi"} .and. drutes_config%dimen > 1) \textcolor{keywordflow}{then}
113         \textcolor{keyword}{write}(msg, fmt=*) \textcolor{stringliteral}{'You have selected Boussinesq equation, Boussinesq equation originates from
       Dupuit &}
114 \textcolor{stringliteral}{}\textcolor{stringliteral}{                   approximation, and so it is assumed for 1D only!!! &}
115 \textcolor{stringliteral}{}\textcolor{stringliteral}{                   '}//new\_line(\textcolor{stringliteral}{'A'})//\textcolor{stringliteral}{'    But your domain was specified for: '}, 
      drutes_config%dimen\textcolor{comment}{, }\textcolor{stringliteral}{"D"}
116         \textcolor{keyword}{call }file_error(local, msg)
117 \textcolor{keywordflow}{      end if}
118 
119       \textcolor{keyword}{call }fileread(drutes_config%mesh\_type, local, ranges=(/1\_ikind,3\_ikind\textcolor{comment}{/))}
120 \textcolor{comment}{      }
121 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(max_itcount, local, ranges=(/1\_ikind, huge(1\_ikind)/\textcolor{comment}{), &}
122 \textcolor{comment}{      errmsg=}\textcolor{stringliteral}{"maximal number of iterations must be positive, greater than 1, &}
123 \textcolor{stringliteral}{}\textcolor{stringliteral}{              and smaller than the maximal number your computer can handle :)"})
124       
125       \textcolor{keyword}{call }fileread(iter_criterion, local, ranges=(/0.0\_rkind, huge(0.0\_rkind\textcolor{comment}{)/), &}
126 \textcolor{comment}{      errmsg=}\textcolor{stringliteral}{"iteration criterion must be positive, and smaller than the maximal number your computer can
       handle :)"}\textcolor{comment}{)}
127 \textcolor{comment}{}
128 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(integ_method, global)
129       
130       \textcolor{keywordflow}{if} (integ_method/10 < 1 .or. integ_method/10 > 12 .or. modulo(integ_method\textcolor{comment}{,10\_ikind)/=0  &}
131 \textcolor{comment}{          .or. integ_method == 100 .or. integ_method == 110) }\textcolor{keywordflow}{then}
132           \textcolor{keyword}{write}(msg, *)  \textcolor{stringliteral}{
      '!!!!!!!!!!!!!!!!!-------------------------------!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! &}
133 \textcolor{stringliteral}{}\textcolor{stringliteral}{        '}//new\_line(\textcolor{stringliteral}{'A'})// \textcolor{stringliteral}{'the proper integration method code names are : 10, 20, 30, 40, 50, 60, 70, 80,
       90, 120'}\textcolor{comment}{//new\_line(}\textcolor{stringliteral}{'A'}\textcolor{comment}{)//&}
134 \textcolor{comment}{         }\textcolor{stringliteral}{'your incorrect definition was:'}, integ_method
135         \textcolor{keyword}{call }file_error(global, msg)
136 \textcolor{keywordflow}{      end if}
137       
138       \textcolor{keyword}{call }fileread(time_units, local)
139       
140       \textcolor{keyword}{call }fileread(init_dt, local, ranges=(/tiny(0.0\_rkind), huge(0.0\_rkind\textcolor{comment}{)/),&}
141 \textcolor{comment}{      errmsg=}\textcolor{stringliteral}{"initial time step must be positive, and smaller than the maximal number your computer can
       handle :)"}\textcolor{comment}{)}
142 \textcolor{comment}{      }
143 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(end_time, local, ranges=(/init_dt, huge(tmp(1))/), &
144       errmsg=\textcolor{stringliteral}{"end time must be greater than the minimal time step, and smaller than the maximal number your
       computer can handle :)"}\textcolor{comment}{)}
145 \textcolor{comment}{      }
146 \textcolor{comment}{      }
147 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(dtmin, local, ranges=(/0.0\_rkind, init_dt/), &
148       errmsg=\textcolor{stringliteral}{"minimal time step must be positive, and smaller than the initial time step"}\textcolor{comment}{)}
149 \textcolor{comment}{      }
150 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(dtmax, local, ranges=(/dtmin, huge(tmp(1))/), &
151       errmsg=\textcolor{stringliteral}{"maximal time step must be greater than the minimal time step, &}
152 \textcolor{stringliteral}{}\textcolor{stringliteral}{                and smaller than the maximal number your computer can handle :)"})
153       
154       \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"set correct value for the terminal outputs"}, new\_line\textcolor{comment}{(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), }\textcolor{stringliteral}{"     0 - standard output"}\textcolor{comment}{
      , &}
155 \textcolor{comment}{        new\_line(}\textcolor{stringliteral}{'a'}),  \textcolor{stringliteral}{"     1 - everything goes to out/screen.log"}, new\_line(\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
156 \textcolor{comment}{        }\textcolor{stringliteral}{"    -1 - everything goes to /dev/null (use only on Linux based systems (I have no idea about MAC
       OS))"}
157       \textcolor{keyword}{call }fileread(print_level, global, ranges=(/-1\_ikind, 1\_ikind/), errmsg\textcolor{comment}{=msg)}
158 \textcolor{comment}{      }
159 \textcolor{comment}{      }\textcolor{keyword}{write}(msg, fmt=*) \textcolor{stringliteral}{"methods for observation time print could be only"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
160 \textcolor{comment}{        }\textcolor{stringliteral}{"       1 - adjust time stepping to observation time values"},  new\_line(\textcolor{stringliteral}{'a'}),\textcolor{comment}{ &}
161 \textcolor{comment}{        }\textcolor{stringliteral}{"       2 - linearly interpolate solution between two consecutive solutions (recommended)"}
162       
163       \textcolor{keyword}{call }fileread(observe_info%method, local, ranges=(/1\_ikind, 2\_ikind\textcolor{comment}{/), errmsg=msg)}
164 \textcolor{comment}{      }
165 \textcolor{comment}{      }\textcolor{keyword}{write}(msg, fmt=*) \textcolor{stringliteral}{"set correct name for the observation time outputs format"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
166 \textcolor{comment}{        }\textcolor{stringliteral}{"       scil - scilab output files"},  new\_line(\textcolor{stringliteral}{'a'}), &
167         \textcolor{stringliteral}{"       pure - just raw data with nodes IDs and FEM coefficients"}, new\_line(\textcolor{stringliteral}{'a'}\textcolor{comment}{), &  }
168 \textcolor{comment}{        }\textcolor{stringliteral}{"       gmsh - gmsh output files"}
169       
170       \textcolor{keyword}{call }fileread(observe_info%fmt, global, options=(/\textcolor{stringliteral}{"scil"}, \textcolor{stringliteral}{"pure"}, \textcolor{stringliteral}{"gmsh"}\textcolor{comment}{/))}
171 \textcolor{comment}{      }
172 \textcolor{comment}{      }
173 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(observe_info%anime, global)
174       
175       \textcolor{keywordflow}{if} (observe_info%anime) \textcolor{keywordflow}{then}
176         \textcolor{keyword}{call }fileread(observe_info%nframes, global, ranges=(/1\_ikind, huge(1\_ikind\textcolor{comment}{)/), &}
177 \textcolor{comment}{        errmsg=}\textcolor{stringliteral}{"number of frames for animation must be greater than zero &}
178 \textcolor{stringliteral}{}\textcolor{stringliteral}{        and smaller than the maximal number your computer can handle :)"})
179       \textcolor{keywordflow}{else}
180         observe_info%nframes = 0
181 \textcolor{keywordflow}{      end if}
182       
183       \textcolor{keyword}{call }fileread(n, local)
184 
185       \textcolor{keyword}{allocate}(observe_time(n + observe_info%nframes))
186       
187       \textcolor{keywordflow}{if} (.not. observe_info%anime) \textcolor{keywordflow}{then}
188         
189        \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"HINT 1: check number of the observation time values"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
190 \textcolor{comment}{        }\textcolor{stringliteral}{"HINT 2: You have selected [n] (not) to create animation frames, have you commented out the
       required number of frames?"}\textcolor{comment}{ , & }
191 \textcolor{comment}{          new\_line(}\textcolor{stringliteral}{'a'})
192       \textcolor{keywordflow}{else}
193         \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"HINT: check number of the observation time values"}
194 \textcolor{keywordflow}{      end if}
195       
196       
197       \textcolor{keywordflow}{do} i=1, n
198         \textcolor{keyword}{call }fileread(observe_time(i)%value, local, errmsg=msg)
199 \textcolor{keywordflow}{      end do}
200       
201 
202       \textcolor{comment}{! reads the observation points number}
203       \textcolor{keyword}{call }fileread(n, local,ranges=(/0\_ikind, huge(1\_ikind)/), &
204         errmsg=\textcolor{stringliteral}{"number of observation times cannot be negative :)"})
205       
206       \textcolor{keyword}{allocate}(observation_array(n))   
207       
208        \textcolor{keywordflow}{if} (.not. observe_info%anime) \textcolor{keywordflow}{then}
209         
210          \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"HINT 1: check number of the observation point values"}, new\_line\textcolor{comment}{(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
211 \textcolor{comment}{             }\textcolor{stringliteral}{"  HINT 2: check number of the observation points coordinates"} , new\_line\textcolor{comment}{(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
212 \textcolor{comment}{             }\textcolor{stringliteral}{"  HINT 3: You have selected [n] (not) to create animation frames, have you commented out the
       required number of frames?"}\textcolor{comment}{ , &}
213 \textcolor{comment}{                new\_line(}\textcolor{stringliteral}{'a'})
214       \textcolor{keywordflow}{else}
215         \textcolor{keyword}{write}(msg, *)  \textcolor{stringliteral}{"HINT 1: check number of the observation point values"}, new\_line\textcolor{comment}{(}\textcolor{stringliteral}{'a'}\textcolor{comment}{), &}
216 \textcolor{comment}{         }\textcolor{stringliteral}{"HINT 2: check number of the observation points coordinates"} , new\_line\textcolor{comment}{(}\textcolor{stringliteral}{'a'}\textcolor{comment}{)}
217 \textcolor{comment}{}\textcolor{keywordflow}{      end if}     
218       
219       \textcolor{keywordflow}{do} i=1,n
220         \textcolor{keyword}{allocate}(observation_array(i)%xyz(drutes_config%dimen))
221 \textcolor{keywordflow}{      end do}
222       
223       \textcolor{keywordflow}{do} i=1,n
224         \textcolor{keyword}{call }fileread(observation_array(i)%xyz(:), local, errmsg=msg)
225 \textcolor{keywordflow}{      end do}  
226       \textcolor{comment}{!----}
227       
228       \textcolor{comment}{! reads coordinates with measured points}
229       \textcolor{keyword}{call }fileread(n, global, errmsg=\textcolor{stringliteral}{"strange number of observation points"}\textcolor{comment}{)}
230 \textcolor{comment}{}
231 \textcolor{comment}{      }\textcolor{keyword}{allocate}(measured_pts(n))
232       \textcolor{keywordflow}{do} i=1, n
233         \textcolor{keyword}{allocate}(measured_pts(i)%xyz(drutes_config%dimen))
234 \textcolor{keywordflow}{      end do}
235       
236       \textcolor{keywordflow}{do} i=1, n
237         \textcolor{keyword}{call }fileread(measured_pts(i)%xyz(:), global, errmsg=\textcolor{stringliteral}{"HINT: check coordinates of the points with
       measurement data"}\textcolor{comment}{)}
238 \textcolor{comment}{}\textcolor{keywordflow}{      end do}  
239 
240       \textcolor{keyword}{call }fileread(i=drutes_config%it\_method, fileid=local, ranges=(/0\_ikind\textcolor{comment}{,2\_ikind/),&}
241 \textcolor{comment}{        errmsg=}\textcolor{stringliteral}{"you have selected an improper iteration method"})
242       
243       \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"Define method of time integration"}, new\_line(\textcolor{stringliteral}{"a"}), \textcolor{comment}{&}
244 \textcolor{comment}{      }\textcolor{stringliteral}{"   0 - steady state problem"}, &
245       new\_line(\textcolor{stringliteral}{"a"}), &
246       \textcolor{stringliteral}{"   1 - unsteady problem with lumped (diagonal) capacity matrix (recommended)"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
247 \textcolor{comment}{      }\textcolor{stringliteral}{"   2 - unsteady problem with consistent capacity matrix"}
248       
249       
250       \textcolor{keyword}{call }fileread(pde_common%timeint\_method, global, ranges=(/0\_ikind,\textcolor{comment}{2\_ikind/), errmsg=msg)}
251 \textcolor{comment}{      }
252 \textcolor{comment}{      }\textcolor{keyword}{call }fileread(drutes_config%compute\_objfnc, global)
253       
254       \textcolor{keyword}{call }fileread(drutes_config%run\_from\_backup, global, errmsg=\textcolor{stringliteral}{"specify [y/n] if you want to relaunch
       your computation"}\textcolor{comment}{)}
255 \textcolor{comment}{      }
256 \textcolor{comment}{      }
257 \textcolor{comment}{      }\textcolor{keywordflow}{if} (drutes_config%run\_from\_backup) \textcolor{keywordflow}{then}
258         \textcolor{keyword}{call }fileread(backup_file, global, errmsg=\textcolor{stringliteral}{"backup file not specified"})
259 \textcolor{keywordflow}{      end if}
260       
261       \textcolor{keyword}{call }fileread(debugmode, global,\textcolor{stringliteral}{"specify [y/n] for debugging (development option, not recommended)"}\textcolor{comment}{ )}
262 \textcolor{comment}{        }
263 \textcolor{comment}{}
\textcolor{comment}{\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{namespaceread__inputs_a9b0f9c757631596bdead541938506c2c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a9b0f9c757631596bdead541938506c2c_icgraph}
\end{center}
\end{figure}


\index{read\+\_\+inputs@{read\+\_\+inputs}!read\+\_\+scilab@{read\+\_\+scilab}}
\index{read\+\_\+scilab@{read\+\_\+scilab}!read\+\_\+inputs@{read\+\_\+inputs}}
\subsubsection[{read\+\_\+scilab(name, proc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public read\+\_\+inputs\+::read\+\_\+scilab (
\begin{DoxyParamCaption}
\item[{character(len=$\ast$), intent(in)}]{name, }
\item[{integer(kind=ikind), intent(in)}]{proc}
\end{DoxyParamCaption}
)}\label{namespaceread__inputs_a954a7e348edc1cfa2fd131955cf224a5}


Definition at line 662 of file read\+\_\+inputs.\+f90.



References globals\+::elements, core\+\_\+tools\+::find\+\_\+unit(), globals\+::nodes, typy\+::norm2(), pde\+\_\+objs\+::pde, and globals\+::time.



Referenced by feminittools\+::feminit().


\begin{DoxyCode}
662       \textcolor{keywordtype}{use }typy
663       \textcolor{keywordtype}{use }globals
664       \textcolor{keywordtype}{use }global_objs
665       \textcolor{keywordtype}{use }pde_objs
666       \textcolor{keywordtype}{use }core_tools
667       \textcolor{keywordtype}{use }debug_tools
668       
669       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}  :: name
670       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(in)} :: proc
671       \textcolor{keywordtype}{integer} :: fileid, ierr
672       \textcolor{keywordtype}{character(len=1)} :: ch
673       \textcolor{keywordtype}{integer(kind=ikind)} :: i,j,k,l
674       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
675       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(3,3)} :: elloc
676       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(3)} :: pmt
677       
678 
679 
680       \textcolor{keyword}{call }find_unit(fileid,20)
681       
682       \textcolor{keyword}{open}(unit=fileid, file=trim(name), action=\textcolor{stringliteral}{"read"}, status=\textcolor{stringliteral}{"old"}, iostat\textcolor{comment}{=ierr)}
683 \textcolor{comment}{      }
684 \textcolor{comment}{      }\textcolor{keywordflow}{if} (ierr /=0) \textcolor{keywordflow}{then}
685         print *, \textcolor{stringliteral}{"unable to open input file with scilab data, called from read\_inputs::read\_scilab"}
686         print *, \textcolor{stringliteral}{"the specified location was:"}, trim(name)
687         error stop
688 \textcolor{keywordflow}{      end if}
689       
690       \textcolor{keyword}{read}(unit=fileid, fmt=*) ch, time
691       
692       \textcolor{keyword}{read}(unit=fileid, fmt=*) ch, ch, i
693       
694       \textcolor{keywordflow}{if} (i/=elements%kolik) \textcolor{keywordflow}{then}
695         print *, \textcolor{stringliteral}{"the mesh in the scilab file has different number of elements then the mesh "}
696         print *, i, \textcolor{stringliteral}{"/="}, elements%kolik
697         print *, \textcolor{stringliteral}{"that is loaded or gerenerated from drutes config files"}
698         print *, \textcolor{stringliteral}{"called from read\_inputs::read\_scilab"}
699         error stop
700 \textcolor{keywordflow}{      end if}
701       
702 
703       
704       \textcolor{keyword}{read}(unit=fileid, fmt=*) ch
705       \textcolor{keyword}{read}(unit=fileid, fmt=*) ch
706       \textcolor{keyword}{read}(unit=fileid, fmt=*) ch
707       
708       \textcolor{keywordflow}{do} i=1,elements%kolik
709         \textcolor{keywordflow}{do} j=1,3
710           \textcolor{keyword}{read}(unit=fileid, fmt=*) ch, ch, ch, ch, elloc(j,1)
711 \textcolor{keywordflow}{        end do}
712         
713         \textcolor{keywordflow}{do} j=1,3
714           \textcolor{keyword}{read}(unit=fileid, fmt=*) ch, ch, ch, ch, elloc(j,2)
715 \textcolor{keywordflow}{        end do}
716         
717         \textcolor{keywordflow}{do} j=1,3
718           \textcolor{keyword}{read}(unit=fileid, fmt=*) ch, ch, ch, ch, elloc(j,3)
719 \textcolor{keywordflow}{        end do}
720         
721         pmt = 0
722         \textcolor{keywordflow}{do} j=1,3
723           l=elements%data(i,j)
724           \textcolor{keywordflow}{do} k=1,3
725             \textcolor{keywordflow}{if} (norm2(nodes%data(l,:)-elloc(k,1:2)) < 10*epsilon(tmp) ) \textcolor{keywordflow}{then}
726               pmt(k) = j
727 \textcolor{keywordflow}{            end if}
728 \textcolor{keywordflow}{          end do}
729 \textcolor{keywordflow}{        end do}
730         
731         \textcolor{keywordflow}{if} (minval(pmt) == 0) \textcolor{keywordflow}{then}
732           print *, \textcolor{stringliteral}{"the scilab file has a different mesh (probably boundary conditions)"}
733           print *, \textcolor{stringliteral}{"than the one defined from drutes config files"}
734           print *, \textcolor{stringliteral}{"called from read\_inputs::read\_scilab"}
735           error stop
736 \textcolor{keywordflow}{        end if}
737           
738         pde(proc)%solution(elements%data(i,:)) = elloc(pmt,3)  
739 \textcolor{comment}{!         print *, pmt ; stop}
740           
741 
742 \textcolor{keywordflow}{      end do}
743       
744       \textcolor{keywordflow}{do} i=1,4
745         \textcolor{keyword}{read}(unit=fileid, fmt=*) ch
746 \textcolor{keywordflow}{      end do}
747       
748 \textcolor{comment}{!       read(unit=fileid, fmt=*) ch, ch, time}
749 
750       \textcolor{keyword}{close}(fileid)    
751       
752     
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{namespaceread__inputs_a954a7e348edc1cfa2fd131955cf224a5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceread__inputs_a954a7e348edc1cfa2fd131955cf224a5_icgraph}
\end{center}
\end{figure}


