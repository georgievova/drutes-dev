\section{heat\+\_\+reader Module Reference}
\label{namespaceheat__reader}\index{heat\+\_\+reader@{heat\+\_\+reader}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf heat\+\_\+read} (pde\+\_\+loc)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{heat\+\_\+reader@{heat\+\_\+reader}!heat\+\_\+read@{heat\+\_\+read}}
\index{heat\+\_\+read@{heat\+\_\+read}!heat\+\_\+reader@{heat\+\_\+reader}}
\subsubsection[{heat\+\_\+read(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public heat\+\_\+reader\+::heat\+\_\+read (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespaceheat__reader_a9546371591bb68c6f89b2c9ef80cd42b}


Definition at line 7 of file heat\+\_\+reader.\+f90.



References globals\+::drutes\+\_\+config, globals\+::elements, heat\+\_\+globals\+::file\+\_\+heat, core\+\_\+tools\+::find\+\_\+unit(), heat\+\_\+globals\+::heatpar, globals\+::nodes, readtools\+::readbcvals(), and readtools\+::set\+\_\+tensor().



Referenced by heat\+\_\+pointers\+::heat().


\begin{DoxyCode}
7       \textcolor{keywordtype}{use }typy
8       \textcolor{keywordtype}{use }globals
9       \textcolor{keywordtype}{use }global_objs
10       \textcolor{keywordtype}{use }core_tools
11       \textcolor{keywordtype}{use }heat_globals
12       \textcolor{keywordtype}{use }readtools
13       \textcolor{keywordtype}{use }pde_objs
14 
15       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
16       \textcolor{keywordtype}{integer} :: i\_err
17       \textcolor{keywordtype}{integer(kind=ikind)} :: i, n
18       \textcolor{keywordtype}{real(kind=rkind)} :: tmp
19       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmp\_array
20       \textcolor{keywordtype}{character(len=4096)} :: msg
21 
22       
23       
24 
25       pde\_loc%problem\_name(1) = \textcolor{stringliteral}{"heat"}
26       pde\_loc%problem\_name(2) = \textcolor{stringliteral}{"Heat conduction equation with convection (Sophocleous, 1979)"}
27 
28       pde\_loc%solution\_name(1) = \textcolor{stringliteral}{"temperature"} \textcolor{comment}{!nazev vystupnich souboru}
29       pde\_loc%solution\_name(2) = \textcolor{stringliteral}{"T "} \textcolor{comment}{!popisek grafu}
30 
31       pde\_loc%flux\_name(1) = \textcolor{stringliteral}{"heat\_flux"}  
32       pde\_loc%flux\_name(2) = \textcolor{stringliteral}{"heat flux [W.L-2]"}
33 
34       pde\_loc%mass\_name(1) = \textcolor{stringliteral}{"skip\_this\_file"}
35       pde\_loc%mass\_name(2) = \textcolor{stringliteral}{"n/a"}
36       
37       
38 
39       \textcolor{keyword}{call }find_unit(file_heat, 200)
40       \textcolor{keyword}{open}(unit = file_heat, file=\textcolor{stringliteral}{"drutes.conf/heat/heat.conf"}, action=\textcolor{stringliteral}{"read"}\textcolor{comment}{, status=}\textcolor{stringliteral}{"old"}\textcolor{comment}{, iostat=i\_err)}
41 \textcolor{comment}{      }\textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
42         print *, \textcolor{stringliteral}{"missing drutes.conf/heat/heat.conf file"}
43         error stop
44 \textcolor{keywordflow}{      end if}
45      
46 
47       \textcolor{keyword}{allocate}(heatpar(maxval(elements%material)))
48       
49       \textcolor{keyword}{call }fileread(n, file_heat)
50       
51       backspace(file_heat)
52       
53       \textcolor{keyword}{write}(msg, fmt=*) \textcolor{stringliteral}{"ERROR!! incorrect number of materials in drutes.conf/heat/heat.conf  &}
54 \textcolor{stringliteral}{}\textcolor{stringliteral}{        the mesh defines"}, maxval(elements%material)  , \textcolor{stringliteral}{"materials, and your input file defines"}\textcolor{comment}{, n, }\textcolor{stringliteral}{
      "material(s)."}
55         
56      
57       \textcolor{keyword}{call }fileread(n, file_heat, ranges=(/1\_ikind*maxval(elements%material\textcolor{comment}{),1\_ikind*maxval(
      elements%material)/),&}
58 \textcolor{comment}{        errmsg=trim(msg))}
59 \textcolor{comment}{        }
60 \textcolor{comment}{      }\textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"HINT 1: Is the heat capacity (matrix/matrix) positive?"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
61 \textcolor{comment}{        }\textcolor{stringliteral}{"   HINT 2 : Is the number of heat capacity values corresponding to the amount of layers?"}
62         
63       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
64         \textcolor{keyword}{call }fileread(heatpar(i)%C, file_heat, ranges=(/0.0\_rkind,huge(0\textcolor{comment}{.0\_rkind)/),&}
65 \textcolor{comment}{        errmsg=trim(msg))}
66 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
67       
68       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"HINT 1: Is the heat capacity (matrix/water) positive?"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
69 \textcolor{comment}{        }\textcolor{stringliteral}{"   HINT 2 : Is the number of heat capacity values corresponding to the amount of layers?"}
70         
71       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
72         \textcolor{keyword}{call }fileread(heatpar(i)%C\_w, file_heat, ranges=(/0.0\_rkind,huge\textcolor{comment}{(0.0\_rkind)/),&}
73 \textcolor{comment}{        errmsg=trim(msg))}
74 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
75       
76       
77       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"HINT 1: Is the heat conductivity positive?"}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
78 \textcolor{comment}{        }\textcolor{stringliteral}{"   HINT 2 : Is the number of heat conductivity values corresponding to the amount of layers?"}
79                               
80 
81  
82       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"HINT 1: Are all values anisotropy defining anisotropical diffusivity
       positive? "}\textcolor{comment}{, new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{), &}
83 \textcolor{comment}{        }\textcolor{stringliteral}{"HINT 2 : Have you defined enough values for anisotropy &}
84 \textcolor{stringliteral}{}\textcolor{stringliteral}{        (e.g. for 2D define angle and the maximal and minimal value of diffusivity, in total 3 values)?"}\textcolor{comment}{, 
      new\_line(}\textcolor{stringliteral}{"a"}\textcolor{comment}{),&}
85 \textcolor{comment}{        }\textcolor{stringliteral}{"HINT 3: The number of lines with heat conductivity has to correspond to the number of materials & }
86 \textcolor{stringliteral}{}\textcolor{stringliteral}{        defined by your mesh"}
87       
88       
89       \textcolor{keyword}{allocate}(tmp\_array(drutes_config%dimen + 1))
90       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
91         \textcolor{keyword}{allocate}(heatpar(i)%lambda\_loc(drutes_config%dimen))
92         \textcolor{keyword}{call }fileread(r=tmp\_array, fileid=file_heat, ranges=(/0.0\_rkind, huge(tmp\textcolor{comment}{)/), errmsg=trim(msg))}
93 \textcolor{comment}{        heatpar(i)%anisoangle = tmp\_array(1)}
94 \textcolor{comment}{        heatpar(i)%lambda\_loc = tmp\_array(2:drutes_config%dimen + 1)}
95 \textcolor{comment}{        }\textcolor{keyword}{allocate}(heatpar(i)%lambda(drutes_config%dimen, drutes_config%dimen))
96         \textcolor{keyword}{call }set_tensor(heatpar(i)%lambda\_loc, (/heatpar(i)%anisoangle/), 
      heatpar\textcolor{comment}{(i)%lambda)}
97 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
98       
99       
100       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"Did you specify convection vector component for each coordinate (e.g. x,y,z)"}
101       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
102         \textcolor{keyword}{allocate}(heatpar(i)%convection(drutes_config%dimen))
103         \textcolor{keyword}{call }fileread(r=heatpar(i)%convection, fileid=file_heat, errmsg=trim\textcolor{comment}{(msg))}
104 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
105         
106       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"Hint: The number of lines for the initial temperature has to be equal to the
       number of materials."}
107       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
108        \textcolor{keyword}{call }fileread(r=heatpar(i)%Tinit, fileid=file_heat, errmsg=trim(msg\textcolor{comment}{))}
109 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
110        
111                     
112       
113       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"Hint: The number of lines for the heat source has to be equal to the number
       of materials."}
114       \textcolor{keywordflow}{do} i=1, ubound(heatpar,1)
115        \textcolor{keyword}{call }fileread(r=heatpar(i)%source, fileid=file_heat, errmsg=trim(msg\textcolor{comment}{))}
116 \textcolor{comment}{}\textcolor{keywordflow}{      end do}
117       
118       
119       \textcolor{keyword}{write}(unit=msg, fmt=*) \textcolor{stringliteral}{"The number of boundaries should be greater than zero and smaller or equal the
       number of nodes"}
120       \textcolor{keyword}{call }fileread(n, file_heat, ranges=(/1\_ikind, nodes%kolik/),&
121         errmsg=trim(msg))
122       
123       \textcolor{keyword}{call }readbcvals(unitw=file_heat, struct=pde\_loc%bc, dimen=n, &
124         dirname=\textcolor{stringliteral}{"drutes.conf/heat/"})
125       
126       
127       
128 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__reader_a9546371591bb68c6f89b2c9ef80cd42b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceheat__reader_a9546371591bb68c6f89b2c9ef80cd42b_icgraph}
\end{center}
\end{figure}


