\section{readtools\+:\+:fileread Interface Reference}
\label{interfacereadtools_1_1fileread}\index{readtools\+::fileread@{readtools\+::fileread}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine {\bf read\+\_\+int} (i, fileid, errmsg, ranges, minimal, maximal, noexit)
\item 
subroutine {\bf read\+\_\+int\+\_\+std} (i, fileid, errmsg, ranges, noexit)
\item 
subroutine {\bf read\+\_\+int\+\_\+array} (r, fileid, ranges, errmsg, checklen, noexit)
\item 
subroutine {\bf read\+\_\+real} (r, fileid, ranges, errmsg, noexit)
\item 
subroutine {\bf read\+\_\+real\+\_\+array} (r, fileid, ranges, errmsg, checklen, noexit)
\item 
subroutine {\bf read\+\_\+char} (ch, fileid, errmsg, options, noexit)
\item 
subroutine {\bf read\+\_\+logical} (l, fileid, errmsg, noexit)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 9 of file readtools.\+f90.



\subsection{Member Function/\+Subroutine Documentation}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+char@{read\+\_\+char}}
\index{read\+\_\+char@{read\+\_\+char}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+char(ch, fileid, errmsg, options, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+char (
\begin{DoxyParamCaption}
\item[{character(len=$\ast$), intent(out)}]{ch, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{options, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_a898c48365d4524e95bcb1eee4319e0cc}


Definition at line 369 of file readtools.\+f90.


\begin{DoxyCode}
369       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(out)} :: ch
370       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
371       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
372       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: options
373       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
374 
375       \textcolor{keywordtype}{integer} :: ierr, i
376       \textcolor{keywordtype}{logical} :: ok
377       
378       \textcolor{keyword}{call }comment(fileid)
379       
380       \textcolor{keyword}{read}(unit=fileid, fmt=\textcolor{stringliteral}{"(a)"}, iostat=ierr) ch
381       
382       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(options)) \textcolor{keywordflow}{then}
383         ok = .false.
384         \textcolor{keywordflow}{do} i=1, ubound(options, 1)
385           \textcolor{keywordflow}{if} (adjustl(trim(ch)) == adjustl(trim(options(i)))) \textcolor{keywordflow}{then}
386             ok = .true.
387             \textcolor{keywordflow}{EXIT}
388 \textcolor{keywordflow}{          end if}
389 \textcolor{keywordflow}{        end do}
390       \textcolor{keywordflow}{else}
391         ok = .true.     
392 \textcolor{keywordflow}{      end if}
393       
394       \textcolor{keywordflow}{if} (ierr /= 0 .or. .not.(ok) .and. (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit)) \textcolor{keywordflow}{then}
395         \textcolor{keywordflow}{if} (.not. ok) \textcolor{keywordflow}{then}
396           print *, \textcolor{stringliteral}{"the value in your input file was: "}, trim(ch)
397           print *, \textcolor{stringliteral}{"however the allowed options for this field are:"}
398           \textcolor{keywordflow}{do} i=1, ubound(options,1)
399             print *, \textcolor{stringliteral}{"-  "}, adjustl(trim(options(i)))
400 \textcolor{keywordflow}{          end do}
401 \textcolor{keywordflow}{        end if}
402         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
403           \textcolor{keyword}{call }file_error(fileid,errmsg)
404 \textcolor{keywordflow}{        end if}
405         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
406           \textcolor{keyword}{call }file_error(fileid,errmsg)
407         \textcolor{keywordflow}{else}
408           \textcolor{keyword}{call }file_error(fileid)
409 \textcolor{keywordflow}{        end if}
410 \textcolor{keywordflow}{      end if}
411       
412       
413       
414       
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+int@{read\+\_\+int}}
\index{read\+\_\+int@{read\+\_\+int}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+int(i, fileid, errmsg, ranges, minimal, maximal, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+int (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), intent(out)}]{i, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{integer(kind=ikind), dimension(\+:), intent(in), optional}]{ranges, }
\item[{integer, intent(in), optional}]{minimal, }
\item[{integer, intent(in), optional}]{maximal, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_a0dc1f64f42072f4b8f5f6c50ecd2c6f3}


Definition at line 22 of file readtools.\+f90.


\begin{DoxyCode}
22       \textcolor{keywordtype}{use }typy
23       \textcolor{keywordtype}{use }globals
24       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{intent(out)} :: i
25       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
26       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
27       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)},  \textcolor{keywordtype}{optional} :: ranges
28       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: minimal, maximal
29       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
30 
31       \textcolor{comment}{!local vars}
32       \textcolor{keywordtype}{integer} :: ierr
33 
34       \textcolor{keyword}{call }comment(fileid)
35 
36       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) i
37 
38       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
39         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
40           \textcolor{keyword}{call }file_error(fileid, errmsg)
41 \textcolor{keywordflow}{        end if}
42         \textcolor{keyword}{call }file_error(fileid)
43 \textcolor{keywordflow}{      end if}
44 
45       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
46         \textcolor{keywordflow}{if} (i<ranges(1) .or. i> ranges(2)) \textcolor{keywordflow}{then}
47           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
48           \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
49             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
50               \textcolor{keyword}{call }file_error(fileid,errmsg)
51             \textcolor{keywordflow}{else}
52               \textcolor{keyword}{call }file_error(fileid)
53 \textcolor{keywordflow}{            end if}
54 \textcolor{keywordflow}{          end if}
55 \textcolor{keywordflow}{        end if}
56 \textcolor{keywordflow}{      end if}
57 
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+int\+\_\+array@{read\+\_\+int\+\_\+array}}
\index{read\+\_\+int\+\_\+array@{read\+\_\+int\+\_\+array}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+int\+\_\+array(r, fileid, ranges, errmsg, checklen, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+int\+\_\+array (
\begin{DoxyParamCaption}
\item[{integer(kind=ikind), dimension(\+:), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{integer(kind=ikind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{checklen, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_a9ff5c0d18c538a48b4079d869e880b5b}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em checklen} & checks if the array length is equal to the length of line in file \\
\hline
\end{DoxyParams}


Definition at line 109 of file readtools.\+f90.


\begin{DoxyCode}
109       \textcolor{keywordtype}{use }typy
110       \textcolor{keywordtype}{use }globals
111       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: r
112       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
113       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
114       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
116       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: checklen
117       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
118       
119             \textcolor{comment}{!logical vars}
120       \textcolor{keywordtype}{integer} :: ierr, ierr2
121       \textcolor{keywordtype}{integer(kind=ikind)} :: i, i1, i2, arraybound, current\_pos, chpos
122       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmpdata
123       
124       \textcolor{keyword}{call }comment(fileid)
125       
126       arraybound=1
127       
128       \textcolor{keyword}{allocate}(tmpdata(arraybound))
129       
130       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(checklen)) \textcolor{keywordflow}{then}
131         \textcolor{keywordflow}{if} (checklen) \textcolor{keywordflow}{then}
132           current\_pos = ftell(fileid)
133           \textcolor{keywordflow}{do} 
134             \textcolor{keyword}{call }comment(fileid)
135             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1\textcolor{comment}{)}
136 \textcolor{comment}{            i1=ftell(fileid)}
137 \textcolor{comment}{            backspace fileid}
138 \textcolor{comment}{            }\textcolor{keyword}{call }comment(fileid)
139             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)
140             i2 = ftell(fileid)
141             backspace fileid
142            
143             \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
144               arraybound = arraybound - 1
145               \textcolor{keywordflow}{do}
146                 chpos = ftell(fileid)
147                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
148                   \textcolor{keywordflow}{EXIT}
149                 \textcolor{keywordflow}{else}
150                   backspace(unit=fileid, iostat=ierr2)
151 \textcolor{keywordflow}{                end if}
152 \textcolor{keywordflow}{              end do}
153               \textcolor{keyword}{deallocate}(tmpdata)
154               \textcolor{keywordflow}{EXIT}
155 \textcolor{keywordflow}{            end if}
156             
157             \textcolor{keywordflow}{if} (i1 == i2) \textcolor{keywordflow}{then}
158               arraybound = arraybound + 1
159               \textcolor{keywordflow}{if} (ubound(tmpdata,1) < arraybound) \textcolor{keywordflow}{then}
160                 \textcolor{keyword}{deallocate}(tmpdata)
161                 \textcolor{keyword}{allocate}(tmpdata(2*arraybound))
162 \textcolor{keywordflow}{              end if}    
163             \textcolor{keywordflow}{else} 
164               arraybound = arraybound - 1
165               \textcolor{keywordflow}{do}
166                 chpos = ftell(fileid)
167                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
168                   \textcolor{keywordflow}{EXIT}
169                 \textcolor{keywordflow}{else}
170                   backspace(unit=fileid, iostat=ierr2)
171 \textcolor{keywordflow}{                end if}
172 \textcolor{keywordflow}{              end do}
173               \textcolor{keyword}{deallocate}(tmpdata)
174               \textcolor{keywordflow}{EXIT}
175 \textcolor{keywordflow}{            end if}
176 \textcolor{keywordflow}{          end do}
177   
178           \textcolor{keywordflow}{if} (arraybound /= ubound(r,1)) \textcolor{keywordflow}{then}
179             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"the line in your input file has &}
180 \textcolor{stringliteral}{}\textcolor{stringliteral}{               incorrect number of values, check your inputs"} //achar(27\textcolor{comment}{)//}\textcolor{stringliteral}{'[0m'}
181             \textcolor{keyword}{call }file_error(fileid, errmsg)
182 \textcolor{keywordflow}{         end if}
183 \textcolor{keywordflow}{        end if}
184 \textcolor{keywordflow}{      end if}
185       
186       \textcolor{keyword}{call }comment(fileid)
187       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
188     
189       
190       
191       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
192         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
193           \textcolor{keyword}{call }file_error(fileid,errmsg)
194 \textcolor{keywordflow}{        end if}
195         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
196           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
197             \textcolor{keyword}{call }file_error(fileid,errmsg)
198           \textcolor{keywordflow}{else}
199             \textcolor{keyword}{call }file_error(fileid)
200 \textcolor{keywordflow}{          end if}
201 \textcolor{keywordflow}{        end if}
202 \textcolor{keywordflow}{      end if}
203       
204       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
205         \textcolor{keywordflow}{do} i=1, ubound(r,1)
206           \textcolor{keywordflow}{if} (r(i) < ranges(1) .or. r(i) > ranges(2)) \textcolor{keywordflow}{then}
207             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ /
      /achar(27)//}\textcolor{stringliteral}{'[0m'}
208             \textcolor{keyword}{call }file_error(fileid, errmsg)
209 \textcolor{keywordflow}{          end if}
210 \textcolor{keywordflow}{        end do}
211 \textcolor{keywordflow}{      end if}
212       
213       
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+int\+\_\+std@{read\+\_\+int\+\_\+std}}
\index{read\+\_\+int\+\_\+std@{read\+\_\+int\+\_\+std}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+int\+\_\+std(i, fileid, errmsg, ranges, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+int\+\_\+std (
\begin{DoxyParamCaption}
\item[{integer(kind=lowikind), intent(out)}]{i, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{integer(kind=ikind), dimension(\+:), intent(in), optional}]{ranges, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_a410360e9f8a4de40183d14d0820b62b0}


Definition at line 62 of file readtools.\+f90.


\begin{DoxyCode}
62       \textcolor{keywordtype}{use }typy
63       \textcolor{keywordtype}{use }globals
64       \textcolor{keywordtype}{integer(kind=lowikind)}, \textcolor{keywordtype}{intent(out)} :: i
65       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
66       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
67       \textcolor{keywordtype}{integer(kind=ikind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)},  \textcolor{keywordtype}{optional} :: ranges
68       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
69 
70 
71       \textcolor{comment}{!local vars}
72       \textcolor{keywordtype}{integer} :: ierr
73 
74       \textcolor{keyword}{call }comment(fileid)
75 
76       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) i
77 
78       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
79         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
80           \textcolor{keyword}{call }file_error(fileid,errmsg)
81 \textcolor{keywordflow}{        end if}
82         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
83           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
84             \textcolor{keyword}{call }file_error(fileid,errmsg)
85           \textcolor{keywordflow}{else}
86             \textcolor{keyword}{call }file_error(fileid)
87 \textcolor{keywordflow}{          end if}
88 \textcolor{keywordflow}{        end if}
89 \textcolor{keywordflow}{      end if}
90       
91       
92        \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
93         \textcolor{keywordflow}{if} (i<ranges(1) .or. i> ranges(2)) \textcolor{keywordflow}{then}
94           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
95           \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
96             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
97               \textcolor{keyword}{call }file_error(fileid,errmsg)
98             \textcolor{keywordflow}{else}
99               \textcolor{keyword}{call }file_error(fileid)
100 \textcolor{keywordflow}{            end if}
101 \textcolor{keywordflow}{          end if}
102 \textcolor{keywordflow}{        end if}
103 \textcolor{keywordflow}{      end if}
104 
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+logical@{read\+\_\+logical}}
\index{read\+\_\+logical@{read\+\_\+logical}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+logical(l, fileid, errmsg, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+logical (
\begin{DoxyParamCaption}
\item[{logical, intent(out)}]{l, }
\item[{integer, intent(in)}]{fileid, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_a8509750d04c0b4d46aefba5b52935a97}


Definition at line 418 of file readtools.\+f90.


\begin{DoxyCode}
418       \textcolor{keywordtype}{use }globals
419       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: l
420       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
421       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
422       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
423 
424       \textcolor{keywordtype}{integer} :: ierr
425       \textcolor{keywordtype}{character(len=1)} :: ch
426       
427       \textcolor{keyword}{call }comment(fileid)
428       
429       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) ch
430 
431       \textcolor{keywordflow}{if} (ierr == 0) \textcolor{keywordflow}{then} 
432         \textcolor{keywordflow}{select case}(ch)
433           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"y"})
434             l = .true.
435           \textcolor{keywordflow}{case}(\textcolor{stringliteral}{"n"})
436             l = .false.
437 \textcolor{keywordflow}{          case default}
438             ierr = -1
439             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"You have defined incorrect value for
       logical parameter)"}\textcolor{comment}{ &}
440 \textcolor{comment}{             //achar(27)//}\textcolor{stringliteral}{'[0m'}
441 \textcolor{keywordflow}{         end select}
442 \textcolor{keywordflow}{       end if}
443       
444       \textcolor{keywordflow}{if} (ierr /= 0 .and. (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit)) \textcolor{keywordflow}{then}
445         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
446           \textcolor{keyword}{call }file_error(fileid,errmsg)
447 \textcolor{keywordflow}{        end if}
448         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
449           \textcolor{keyword}{call }file_error(fileid,errmsg)
450         \textcolor{keywordflow}{else}
451           \textcolor{keyword}{call }file_error(fileid)
452 \textcolor{keywordflow}{        end if}
453 \textcolor{keywordflow}{      end if}
454       
455       
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+real@{read\+\_\+real}}
\index{read\+\_\+real@{read\+\_\+real}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+real(r, fileid, ranges, errmsg, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+real (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{real(kind=rkind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_adc72e3d8c1321901718abfeec7589179}


Definition at line 219 of file readtools.\+f90.


\begin{DoxyCode}
219       \textcolor{keywordtype}{use }typy
220       \textcolor{keywordtype}{use }globals
221       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{intent(out)} :: r
222       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
223       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
224       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
225       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
226       
227       \textcolor{comment}{!logical vars}
228       \textcolor{keywordtype}{integer} :: ierr
229       
230       \textcolor{keyword}{call }comment(fileid)
231       
232       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
233       
234       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
235         \textcolor{keywordflow}{if} (r < ranges(1) .or. r > ranges(2)) \textcolor{keywordflow}{then}
236           \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ //
      achar(27)//}\textcolor{stringliteral}{'[0m'}
237           ierr = -1
238 \textcolor{keywordflow}{        end if}
239 \textcolor{keywordflow}{      end if}
240       
241       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
242         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
243           \textcolor{keyword}{call }file_error(fileid,errmsg)
244 \textcolor{keywordflow}{        end if}
245         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
246           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
247             \textcolor{keyword}{call }file_error(fileid,errmsg)
248           \textcolor{keywordflow}{else}
249             \textcolor{keyword}{call }file_error(fileid)
250 \textcolor{keywordflow}{          end if}
251 \textcolor{keywordflow}{        end if}
252 \textcolor{keywordflow}{      end if}
253 
\end{DoxyCode}
\index{readtools\+::fileread@{readtools\+::fileread}!read\+\_\+real\+\_\+array@{read\+\_\+real\+\_\+array}}
\index{read\+\_\+real\+\_\+array@{read\+\_\+real\+\_\+array}!readtools\+::fileread@{readtools\+::fileread}}
\subsubsection[{read\+\_\+real\+\_\+array(r, fileid, ranges, errmsg, checklen, noexit)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine readtools\+::fileread\+::read\+\_\+real\+\_\+array (
\begin{DoxyParamCaption}
\item[{real(kind=rkind), dimension(\+:), intent(out)}]{r, }
\item[{integer, intent(in)}]{fileid, }
\item[{real(kind=rkind), dimension(\+:), optional}]{ranges, }
\item[{character(len=$\ast$), intent(in), optional}]{errmsg, }
\item[{logical, intent(in), optional}]{checklen, }
\item[{logical, intent(in), optional}]{noexit}
\end{DoxyParamCaption}
)}\label{interfacereadtools_1_1fileread_ac1f3a07ec07c929abeb213723c9172ca}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em checklen} & checks if the array length is equal to the length of line in file \\
\hline
\end{DoxyParams}


Definition at line 259 of file readtools.\+f90.


\begin{DoxyCode}
259       \textcolor{keywordtype}{use }typy
260       \textcolor{keywordtype}{use }globals
261       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: r
262       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fileid
263       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{optional} :: ranges
264       \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: errmsg
266       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: checklen
267       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: noexit
268       
269             \textcolor{comment}{!logical vars}
270       \textcolor{keywordtype}{integer} :: ierr, ierr2
271       \textcolor{keywordtype}{integer(kind=ikind)} :: i, i1, i2, arraybound, current\_pos, chpos
272       \textcolor{keywordtype}{real(kind=rkind)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: tmpdata
273       
274       \textcolor{keyword}{call }comment(fileid)
275       
276       arraybound=1
277       
278       \textcolor{keyword}{allocate}(tmpdata(arraybound))
279       
280       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(checklen)) \textcolor{keywordflow}{then}
281         \textcolor{keywordflow}{if} (checklen) \textcolor{keywordflow}{then}
282           current\_pos = ftell(fileid)
283           \textcolor{keywordflow}{do} 
284             \textcolor{keyword}{call }comment(fileid)
285             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1\textcolor{comment}{)}
286 \textcolor{comment}{            i1=ftell(fileid)}
287 \textcolor{comment}{            backspace fileid}
288 \textcolor{comment}{            }\textcolor{keyword}{call }comment(fileid)
289             \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)
290             i2 = ftell(fileid)
291             backspace fileid
292            
293             \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
294               arraybound = arraybound - 1
295               \textcolor{keywordflow}{do}
296                 chpos = ftell(fileid)
297                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
298                   \textcolor{keywordflow}{EXIT}
299                 \textcolor{keywordflow}{else}
300                   backspace(unit=fileid, iostat=ierr2)
301 \textcolor{keywordflow}{                end if}
302 \textcolor{keywordflow}{              end do}
303               \textcolor{keyword}{deallocate}(tmpdata)
304               \textcolor{keywordflow}{EXIT}
305 \textcolor{keywordflow}{            end if}
306             
307             \textcolor{keywordflow}{if} (i1 == i2) \textcolor{keywordflow}{then}
308               arraybound = arraybound + 1
309               \textcolor{keywordflow}{if} (ubound(tmpdata,1) < arraybound) \textcolor{keywordflow}{then}
310                 \textcolor{keyword}{deallocate}(tmpdata)
311                 \textcolor{keyword}{allocate}(tmpdata(2*arraybound))
312 \textcolor{keywordflow}{              end if}    
313             \textcolor{keywordflow}{else} 
314               arraybound = arraybound - 1
315               \textcolor{keywordflow}{do}
316                 chpos = ftell(fileid)
317                 \textcolor{keywordflow}{if} (chpos == current\_pos) \textcolor{keywordflow}{then}
318                   \textcolor{keywordflow}{EXIT}
319                 \textcolor{keywordflow}{else}
320                   backspace(unit=fileid, iostat=ierr2)
321 \textcolor{keywordflow}{                end if}
322 \textcolor{keywordflow}{              end do}
323               \textcolor{keyword}{deallocate}(tmpdata)
324               \textcolor{keywordflow}{EXIT}
325 \textcolor{keywordflow}{            end if}
326 \textcolor{keywordflow}{          end do}
327   
328           \textcolor{keywordflow}{if} (arraybound /= ubound(r,1)) \textcolor{keywordflow}{then}
329             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"the line in your input file has &}
330 \textcolor{stringliteral}{}\textcolor{stringliteral}{               incorrect number of values, check your inputs"} //achar(27\textcolor{comment}{)//}\textcolor{stringliteral}{'[0m'}
331             \textcolor{keyword}{call }file_error(fileid, errmsg)
332 \textcolor{keywordflow}{         end if}
333 \textcolor{keywordflow}{        end if}
334 \textcolor{keywordflow}{      end if}
335       
336       \textcolor{keyword}{call }comment(fileid)
337       \textcolor{keyword}{read}(unit=fileid, fmt=*, iostat=ierr) r
338     
339       
340       
341       \textcolor{keywordflow}{if} (ierr /= 0) \textcolor{keywordflow}{then}
342         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
343           \textcolor{keyword}{call }file_error(fileid,errmsg)
344 \textcolor{keywordflow}{        end if}
345         \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{present}(noexit) .or. .not. noexit) \textcolor{keywordflow}{then}
346           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(errmsg)) \textcolor{keywordflow}{then}
347             \textcolor{keyword}{call }file_error(fileid,errmsg)
348           \textcolor{keywordflow}{else}
349             \textcolor{keyword}{call }file_error(fileid)
350 \textcolor{keywordflow}{          end if}
351 \textcolor{keywordflow}{        end if}
352 \textcolor{keywordflow}{      end if}
353       
354       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(ranges)) \textcolor{keywordflow}{then}
355         \textcolor{keywordflow}{do} i=1, ubound(r,1)
356           \textcolor{keywordflow}{if} (r(i) < ranges(1) .or. r(i) > ranges(2)) \textcolor{keywordflow}{then}
357             \textcolor{keyword}{write}(unit=terminal, fmt=*) \textcolor{stringliteral}{" "} //achar(27)//\textcolor{stringliteral}{'[91m'}, \textcolor{stringliteral}{"incorrect ranges of input parameter(s)"}\textcolor{comment}{ /
      /achar(27)//}\textcolor{stringliteral}{'[0m'}
358             \textcolor{keyword}{call }file_error(fileid, errmsg)
359 \textcolor{keywordflow}{          end if}
360 \textcolor{keywordflow}{        end do}
361 \textcolor{keywordflow}{      end if}
362       
363       
\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/tools/{\bf readtools.\+f90}\end{DoxyCompactItemize}
