\section{re\+\_\+dual\+\_\+reader Module Reference}
\label{namespacere__dual__reader}\index{re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}}


This module contains subroutines that read input information from config files and additional input files.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public {\bf re\+\_\+dual\+\_\+var} ()
\item 
subroutine, public {\bf re\+\_\+dual\+\_\+readm} (pde\+\_\+loc)
\item 
subroutine, public {\bf re\+\_\+dual\+\_\+readf} (pde\+\_\+loc)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This module contains subroutines that read input information from config files and additional input files. 

\subsection{Function/\+Subroutine Documentation}
\index{re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}!re\+\_\+dual\+\_\+readf@{re\+\_\+dual\+\_\+readf}}
\index{re\+\_\+dual\+\_\+readf@{re\+\_\+dual\+\_\+readf}!re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}}
\subsubsection[{re\+\_\+dual\+\_\+readf(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readf (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespacere__dual__reader_a23cf85f4d1be812361380db52c0e7e33}


Definition at line 314 of file Re\+\_\+dual\+\_\+reader.\+f90.



References readtools\+::comment(), core\+\_\+tools\+::find\+\_\+unit(), dual\+\_\+globals\+::infweight, and readtools\+::readbcvals().



Referenced by re\+\_\+dual\+\_\+pointers\+::re\+\_\+fracture().


\begin{DoxyCode}
314       \textcolor{keywordtype}{use }typy
315       \textcolor{keywordtype}{use }globals
316       \textcolor{keywordtype}{use }global_objs
317       \textcolor{keywordtype}{use }core_tools
318       \textcolor{keywordtype}{use }dual_globals
319       \textcolor{keywordtype}{use }readtools
320       \textcolor{keywordtype}{use }pde_objs
321       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
322       \textcolor{keywordtype}{integer} :: i\_err, file\_bc
323       \textcolor{keywordtype}{integer(kind=ikind)} :: dim\_bc
324       pde\_loc%problem\_name(1) = \textcolor{stringliteral}{"Re\_dual\_totH\_f"}
325       pde\_loc%problem\_name(2) = \textcolor{stringliteral}{"Richards' equation"}
326 
327       pde\_loc%solution\_name(1) = \textcolor{stringliteral}{"pressure\_head\_f"} \textcolor{comment}{!file output name}
328       pde\_loc%solution\_name(2) = \textcolor{stringliteral}{"h  [L]"} \textcolor{comment}{! caption}
329 
330       pde\_loc%flux\_name(1) = \textcolor{stringliteral}{"flux\_f"}  
331       pde\_loc%flux\_name(2) = \textcolor{stringliteral}{"Darcian flow [L.T^\{-1\}]"}
332 
333       pde\_loc%mass\_name(1) = \textcolor{stringliteral}{"theta\_f"}
334       pde\_loc%mass\_name(2) = \textcolor{stringliteral}{"theta [-]"}
335       pde\_loc%mfswitch= \textcolor{stringliteral}{"f"}
336     \textcolor{comment}{! boundary values}
337       \textcolor{keyword}{call }find_unit(file\_bc, 400)
338       \textcolor{keyword}{open}(unit = file\_bc,file = \textcolor{stringliteral}{"drutes.conf/REdual/dual\_bc.conf"}, action\textcolor{comment}{ = }\textcolor{stringliteral}{"read"}\textcolor{comment}{, status = }\textcolor{stringliteral}{"old"}\textcolor{comment}{, iostat
       = i\_err)}
339 \textcolor{comment}{      }\textcolor{keywordflow}{if} (i\_err > 0) \textcolor{keywordflow}{then}
340         print *, \textcolor{stringliteral}{"something is wrong with your input"}
341       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i\_err < 0) \textcolor{keywordflow}{then}
342         print*, \textcolor{stringliteral}{"end of file reached"}
343 \textcolor{keywordflow}{      end if} 
344       \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
345         print *, \textcolor{stringliteral}{"missing boundary condition for dual permeability problem"}
346         error stop
347 \textcolor{keywordflow}{      end if}  
348       \textcolor{keyword}{call }fileread(dim\_bc, file\_bc, ranges=(/1\_ikind, huge(1\_ikind)/), \textcolor{comment}{&}
349 \textcolor{comment}{          errmsg=}\textcolor{stringliteral}{"at least one boundary must be specified (and no negative values here)"}\textcolor{comment}{)}
350 \textcolor{comment}{          }\textcolor{keyword}{call }comment(file\_bc)
351       \textcolor{keyword}{read}(unit=file\_bc, fmt= *, iostat=i\_err) infweight
352       \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
353         print *, \textcolor{stringliteral}{"missing infiltration weight. Needs to be there even if you're not using boundary type 5"}
354         error stop
355 \textcolor{keywordflow}{      end if} 
356       
357       \textcolor{keyword}{call }readbcvals(unitw=file\_bc,struct=pde\_loc%bc,dimen=dim\_bc,dirname\textcolor{comment}{ = }\textcolor{stringliteral}{"drutes.conf/REdual/"}\textcolor{comment}{)}
358 \textcolor{comment}{}
359 \textcolor{comment}{      }\textcolor{keyword}{close}(file\_bc)
360       
361       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacere__dual__reader_a23cf85f4d1be812361380db52c0e7e33_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacere__dual__reader_a23cf85f4d1be812361380db52c0e7e33_icgraph}
\end{center}
\end{figure}


\index{re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}!re\+\_\+dual\+\_\+readm@{re\+\_\+dual\+\_\+readm}}
\index{re\+\_\+dual\+\_\+readm@{re\+\_\+dual\+\_\+readm}!re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}}
\subsubsection[{re\+\_\+dual\+\_\+readm(pde\+\_\+loc)}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+readm (
\begin{DoxyParamCaption}
\item[{class({\bf pde\+\_\+str}), intent(inout)}]{pde\+\_\+loc}
\end{DoxyParamCaption}
)}\label{namespacere__dual__reader_a4f07052339a41711165f3d85d2b7eefc}


Definition at line 264 of file Re\+\_\+dual\+\_\+reader.\+f90.



References readtools\+::comment(), core\+\_\+tools\+::find\+\_\+unit(), dual\+\_\+globals\+::infweight, and readtools\+::readbcvals().



Referenced by re\+\_\+dual\+\_\+pointers\+::re\+\_\+matrix().


\begin{DoxyCode}
264       \textcolor{keywordtype}{use }typy
265       \textcolor{keywordtype}{use }globals
266       \textcolor{keywordtype}{use }global_objs
267       \textcolor{keywordtype}{use }core_tools
268       \textcolor{keywordtype}{use }dual_globals
269       \textcolor{keywordtype}{use }readtools
270       \textcolor{keywordtype}{use }pde_objs
271       \textcolor{keywordtype}{class}(pde_str), \textcolor{keywordtype}{intent(in out)} :: pde\_loc
272       \textcolor{keywordtype}{integer} :: i\_err, file\_bc
273       \textcolor{keywordtype}{integer(kind=ikind)} :: dim\_bc
274       pde\_loc%problem\_name(1) = \textcolor{stringliteral}{"Re\_dual\_totH\_m"}
275       pde\_loc%problem\_name(2) = \textcolor{stringliteral}{"Richards' equation"}
276 
277       pde\_loc%solution\_name(1) = \textcolor{stringliteral}{"pressure\_head\_m"} \textcolor{comment}{!file output name}
278       pde\_loc%solution\_name(2) = \textcolor{stringliteral}{"h  [L]"} \textcolor{comment}{! caption}
279 
280       pde\_loc%flux\_name(1) = \textcolor{stringliteral}{"flux\_m"}  
281       pde\_loc%flux\_name(2) = \textcolor{stringliteral}{"Darcian flow [L.T^\{-1\}]"}
282 
283       pde\_loc%mass\_name(1) = \textcolor{stringliteral}{"theta\_m"}
284       pde\_loc%mass\_name(2) = \textcolor{stringliteral}{"theta [-]"}
285       pde\_loc%mfswitch= \textcolor{stringliteral}{"m"}
286     \textcolor{comment}{! boundary values}
287     
288             \textcolor{keyword}{call }find_unit(file\_bc, 400)
289       \textcolor{keyword}{open}(unit = file\_bc,file = \textcolor{stringliteral}{"drutes.conf/REdual/dual\_bc.conf"}, action\textcolor{comment}{ = }\textcolor{stringliteral}{"read"}\textcolor{comment}{, status = }\textcolor{stringliteral}{"old"}\textcolor{comment}{, iostat
       = i\_err)}
290 \textcolor{comment}{      }\textcolor{keywordflow}{if} (i\_err > 0) \textcolor{keywordflow}{then}
291         print *, \textcolor{stringliteral}{"something is wrong with your input"}
292       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i\_err < 0) \textcolor{keywordflow}{then}
293         print*, \textcolor{stringliteral}{"end of file reached"}
294 \textcolor{keywordflow}{      end if} 
295       \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
296         print *, \textcolor{stringliteral}{"missing boundary condition for dual permeability problem"}
297         error stop
298 \textcolor{keywordflow}{      end if}  
299       \textcolor{keyword}{call }fileread(dim\_bc, file\_bc)
300       \textcolor{keyword}{call }comment(file\_bc)
301       \textcolor{keyword}{read}(unit=file\_bc, fmt= *, iostat=i\_err) infweight
302       \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
303         print *, \textcolor{stringliteral}{"missing infiltration weight. Needs to be there even if you're not using boundary type 5"}
304         error stop
305 \textcolor{keywordflow}{      end if} 
306       
307       \textcolor{keyword}{call }readbcvals(unitw=file\_bc,struct=pde\_loc%bc,dimen=dim\_bc,dirname\textcolor{comment}{ = }\textcolor{stringliteral}{"drutes.conf/REdual/"}\textcolor{comment}{)}
308 \textcolor{comment}{}
309 \textcolor{comment}{      }\textcolor{keyword}{close}(file\_bc)
310       
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacere__dual__reader_a4f07052339a41711165f3d85d2b7eefc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacere__dual__reader_a4f07052339a41711165f3d85d2b7eefc_icgraph}
\end{center}
\end{figure}


\index{re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}!re\+\_\+dual\+\_\+var@{re\+\_\+dual\+\_\+var}}
\index{re\+\_\+dual\+\_\+var@{re\+\_\+dual\+\_\+var}!re\+\_\+dual\+\_\+reader@{re\+\_\+dual\+\_\+reader}}
\subsubsection[{re\+\_\+dual\+\_\+var()}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public re\+\_\+dual\+\_\+reader\+::re\+\_\+dual\+\_\+var (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacere__dual__reader_a3ddb497789d4da4dea2afc55f283cf4b}


Definition at line 7 of file Re\+\_\+dual\+\_\+reader.\+f90.



References readtools\+::comment(), dual\+\_\+globals\+::coup\+\_\+model, dual\+\_\+globals\+::disttozero, globals\+::drutes\+\_\+config, dual\+\_\+globals\+::exchange, readtools\+::file\+\_\+error(), core\+\_\+tools\+::find\+\_\+unit(), globals\+::maxpress, readtools\+::set\+\_\+tensor(), dual\+\_\+globals\+::vgexchange, dual\+\_\+globals\+::vgfracture, and dual\+\_\+globals\+::vgmatrix.



Referenced by re\+\_\+dual\+\_\+pointers\+::re\+\_\+matrix().


\begin{DoxyCode}
7      \textcolor{keywordtype}{use }typy
8      \textcolor{keywordtype}{use }globals
9      \textcolor{keywordtype}{use }global_objs
10      \textcolor{keywordtype}{use }core_tools
11      \textcolor{keywordtype}{use }dual_globals
12      \textcolor{keywordtype}{use }readtools
13      \textcolor{keywordtype}{use }pde_objs
14      \textcolor{keywordtype}{use }debug_tools
15      
16       \textcolor{keywordtype}{integer} :: i\_err, i, j, file\_dual
17       \textcolor{keywordtype}{integer(kind=ikind)} :: layers
18           \textcolor{keywordtype}{real(kind=rkind)}::inicond
19           \textcolor{keywordtype}{character(len=4096)} :: msg    
20       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}
21       \textcolor{comment}{!input pars}
22       
23       \textcolor{comment}{! all materials in dual.conf}
24       \textcolor{keyword}{call }find_unit(file\_dual, 300)
25       \textcolor{keyword}{open}(unit=file\_dual, file=\textcolor{stringliteral}{"drutes.conf/REdual/dual.conf"}, action=\textcolor{stringliteral}{"read"}, status=\textcolor{stringliteral}{"old"}, iostat=i\_err)
26       \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
27         print *, \textcolor{stringliteral}{"missing dual.conf file in drutes.conf/REdual"}
28         error stop
29 \textcolor{keywordflow}{      end if} 
30       
31       \textcolor{keyword}{write}(msg, *) \textcolor{stringliteral}{"define method of evaluation of constitutive functions for the Richards equation"}, 
      new\_line(\textcolor{stringliteral}{"a"}), &
32         \textcolor{stringliteral}{"   0 - direct evaluation (not recommended, extremely resources consuming due to complicated
       exponential functions)"}, &
33         new\_line(\textcolor{stringliteral}{"a"}), &
34         \textcolor{stringliteral}{"   1 - function values are precalculated in program initialization and values between are linearly
       approximated"}
35 
36       
37       \textcolor{keyword}{call }fileread(drutes_config%fnc\_method, file\_dual, ranges=(/0\_ikind,1\_ikind/),errmsg=msg)
38       
39       \textcolor{keyword}{call }fileread(maxpress, file\_dual, ranges=(/-huge(0.0\_rkind), huge(0.0\_rkind)/), &
40                 errmsg=\textcolor{stringliteral}{"set some positive nonzero limit for maximal suction pressure (think in absolute
       values) "})
41                 maxpress = abs(maxpress)
42       
43       \textcolor{keyword}{call }fileread(drutes_config%fnc\_discr\_length, file\_dual, ranges=(/tiny(0.0\_rkind), 
      maxpress/),  &
44                 errmsg=\textcolor{stringliteral}{"the discretization step for precalculating constitutive functions must be positive
       and smaller &}
45 \textcolor{stringliteral}{}\textcolor{stringliteral}{                then the bc"})
46 
47       \textcolor{keyword}{call }fileread(disttozero,file\_dual,ranges=(/-huge(0.0\_rkind), huge(0.0\_rkind)/)&
48       , errmsg=\textcolor{stringliteral}{"specify distance to origin 0. This can be negative or positive"})
49       
50       \textcolor{comment}{!number of materials}
51       \textcolor{keyword}{call }fileread(layers,file\_dual,ranges=(/0\_ikind,huge(0\_ikind)/)&
52       , errmsg=\textcolor{stringliteral}{"At least one layer"})
53       
54 
55       \textcolor{comment}{! now that we know the number of layers/materials, let's allocate van genuchten matrices }
56       \textcolor{comment}{! vgmatrix, vgexchange and vgfracture all come from dual\_globals, exchange contains specific exchange
       parameters}
57       
58       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(vgmatrix)) \textcolor{keywordflow}{then}
59         \textcolor{keyword}{allocate} (vgmatrix(layers))
60         \textcolor{keywordflow}{do} i=1, layers
61             \textcolor{keyword}{allocate}(vgmatrix(i)%Ks\_local(drutes_config%dimen))
62             \textcolor{keyword}{allocate}(vgmatrix(i)%Ks(drutes_config%dimen, drutes_config%dimen))    
63             \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
64                 j = max(1,drutes_config%dimen-1)
65                 \textcolor{keyword}{allocate}(vgmatrix(i)%anisoangle(j))     
66             \textcolor{keywordflow}{else}
67                 \textcolor{keyword}{allocate}(vgmatrix(i)%anisoangle(1))
68 \textcolor{keywordflow}{            end if}              
69 \textcolor{keywordflow}{        end do}
70 \textcolor{keywordflow}{      end if}
71       
72       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(vgexchange)) \textcolor{keywordflow}{then}
73         \textcolor{keyword}{allocate} (vgexchange(layers))
74         \textcolor{keywordflow}{do} i=1, layers
75             \textcolor{keyword}{allocate}(vgexchange(i)%Ks\_local(drutes_config%dimen))
76             \textcolor{keyword}{allocate}(vgexchange(i)%Ks(drutes_config%dimen, drutes_config%dimen))          
77             \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
78                 j = max(1,drutes_config%dimen-1)
79                 \textcolor{keyword}{allocate}(vgexchange(i)%anisoangle(j))   
80             \textcolor{keywordflow}{else}
81                 \textcolor{keyword}{allocate}(vgexchange(i)%anisoangle(1))
82 \textcolor{keywordflow}{            end if}                      
83 \textcolor{keywordflow}{        end do}
84 \textcolor{keywordflow}{      end if}
85       
86       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(exchange)) \textcolor{keywordflow}{then}
87             \textcolor{keyword}{allocate}(exchange(layers))
88 \textcolor{keywordflow}{      end if}
89       
90       \textcolor{keywordflow}{if} (.not. \textcolor{keyword}{allocated}(vgfracture)) \textcolor{keywordflow}{then}
91         \textcolor{keyword}{allocate} (vgfracture(layers))
92         \textcolor{keywordflow}{do} i=1, layers
93             \textcolor{keyword}{allocate}(vgfracture(i)%Ks\_local(drutes_config%dimen))
94             \textcolor{keyword}{allocate}(vgfracture(i)%Ks(drutes_config%dimen, drutes_config%dimen))          
95             \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
96                 j = max(1,drutes_config%dimen-1)
97                 \textcolor{keyword}{allocate}(vgfracture(i)%anisoangle(j))   
98             \textcolor{keywordflow}{else}
99                 \textcolor{keyword}{allocate}(vgfracture(i)%anisoangle(1))
100 \textcolor{keywordflow}{            end if}                      
101 \textcolor{keywordflow}{        end do}
102 \textcolor{keywordflow}{      end if}
103       
104      
105       \textcolor{comment}{! Matrix}
106       \textcolor{keywordflow}{do} i=1,layers
107         \textcolor{keyword}{call }comment(file\_dual)
108         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgmatrix(i)%alpha, vgmatrix(i)%n, &
109                             vgmatrix(i)%Ths, vgmatrix(i)%Thr, vgmatrix(i)%Ss
110         vgmatrix(i)%m=1.0\_rkind-1.0/vgmatrix(i)%n
111         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
112           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
113           print *, \textcolor{stringliteral}{"HINT: You don't seem to have defined a sufficient number of van Genuchten &}
114 \textcolor{stringliteral}{}\textcolor{stringliteral}{           parameters for all >> matrix << layers!"}
115           print *, \textcolor{stringliteral}{"----------------------------------------"}
116           \textcolor{keyword}{call }file_error(file\_dual)
117 \textcolor{keywordflow}{        end if}
118 \textcolor{keywordflow}{      end do}
119       
120     
121       \textcolor{keywordflow}{do} i=1,layers
122         \textcolor{keyword}{call }comment(file\_dual)
123         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgmatrix(i)%anisoangle, 
      vgmatrix(i)%Ks\_local(:)
124         
125         \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
126             \textcolor{keyword}{call }set_tensor(vgmatrix(i)%Ks\_local(:), vgmatrix(i)%anisoangle(:),  
      vgmatrix(i)%Ks)
127                  
128         \textcolor{keywordflow}{else}
129             vgmatrix(i)%Ks(1,1)=vgmatrix(i)%Ks\_local(1)
130 \textcolor{keywordflow}{        end if}    
131 \textcolor{keywordflow}{      end do}
132 
133 
134       \textcolor{comment}{! Fracture}
135       \textcolor{keywordflow}{do} i=1,layers
136         \textcolor{keyword}{call }comment(file\_dual)
137         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgfracture(i)%alpha, 
      vgfracture(i)%n,  &
138                             vgfracture(i)%Ths, vgfracture(i)%Thr, vgfracture(i)%Ss
139         vgfracture(i)%m=1.0\_rkind-1.0/vgfracture(i)%n
140         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
141           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
142           print *, \textcolor{stringliteral}{"HINT: You don't seem to have defined a sufficient number of van Genuchten &}
143 \textcolor{stringliteral}{}\textcolor{stringliteral}{           parameters for all >> fracture << layers!"}
144           print *, \textcolor{stringliteral}{"----------------------------------------"}
145           \textcolor{keyword}{call }file_error(file\_dual)
146 \textcolor{keywordflow}{        end if}
147 \textcolor{keywordflow}{      end do}
148       
149       \textcolor{keywordflow}{do} i=1,layers
150         \textcolor{keyword}{call }comment(file\_dual)
151         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgfracture(i)%anisoangle, 
      vgfracture(i)%Ks\_local(:)
152         \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
153             \textcolor{keyword}{call }set_tensor(vgfracture(i)%Ks\_local(:), vgfracture(i)%anisoangle(:),  
      vgfracture(i)%Ks)
154         \textcolor{keywordflow}{else}
155             vgfracture(i)%Ks(1,1)=vgfracture(i)%Ks\_local(1)
156 \textcolor{keywordflow}{        end if}    
157 \textcolor{keywordflow}{      end do}
158       
159       \textcolor{comment}{! exchange}
160       \textcolor{keyword}{call }fileread(coup_model, file\_dual, ranges=(/1\_ikind, 5\_ikind/), &
161                 errmsg=\textcolor{stringliteral}{"Select model for exchange term, valid selections are (integer): 1,2,3,4,5 "})
162     
163       \textcolor{keywordflow}{do} i=1,layers
164         \textcolor{keyword}{call }comment(file\_dual)
165         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) exchange(i)%beta, exchange(i)%a,&
166         exchange(i)%gam\_par,exchange(i)%weightf
167             exchange(i)%weightm=1.0\_rkind-exchange(i)%weightf
168         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
169           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
170           print *, \textcolor{stringliteral}{"HINT: You don't seem to have defined a sufficient number of Exchange &}
171 \textcolor{stringliteral}{}\textcolor{stringliteral}{           parameters for all >> exchange << layers!"}
172           print *, \textcolor{stringliteral}{"----------------------------------------"}
173           \textcolor{keyword}{call }file_error(file\_dual)
174 \textcolor{keywordflow}{        end if}
175         \textcolor{keywordflow}{if}(exchange(i)%weightf>1.0\_rkind) \textcolor{keywordflow}{then}
176           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
177           print *, \textcolor{stringliteral}{"The fracture weight cannot be greater than 1!"}
178           print *, \textcolor{stringliteral}{"----------------------------------------"}
179           \textcolor{keyword}{call }file_error(file\_dual)
180 \textcolor{keywordflow}{        end if}
181         \textcolor{keywordflow}{if}(exchange(i)%weightf<0.0\_rkind) \textcolor{keywordflow}{then}
182           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
183           print *, \textcolor{stringliteral}{"The fracture weight cannot be negative!"}
184           print *, \textcolor{stringliteral}{"----------------------------------------"}
185           \textcolor{keyword}{call }file_error(file\_dual)
186 \textcolor{keywordflow}{        end if}
187 \textcolor{keywordflow}{      end do}
188       
189 
190 
191     \textcolor{keywordflow}{if}(coup_model<4) \textcolor{keywordflow}{then}
192 
193      \textcolor{keywordflow}{do} i=1,layers
194         \textcolor{keyword}{call }comment(file\_dual)
195         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgexchange(i)%Ks\_local(:)
196         vgexchange(i)%anisoangle=0.0\_rkind
197         \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
198             \textcolor{keyword}{call }set_tensor(vgexchange(i)%Ks\_local(:), vgexchange(i)%anisoangle(:),  
      vgexchange(i)%Ks)
199         \textcolor{keywordflow}{else}
200             vgexchange(i)%Ks(1,1)=vgexchange(i)%Ks\_local(1)
201 \textcolor{keywordflow}{        end if}
202 
203         vgexchange(i)%m=1.0\_rkind-1.0\_rkind/vgexchange(i)%n
204 
205         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
206           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
207           print *, \textcolor{stringliteral}{"HINT: You don't seem to have defined a sufficient number of van Genuchten &}
208 \textcolor{stringliteral}{}\textcolor{stringliteral}{           parameters for all >> exchange << layers!"}
209           print *, \textcolor{stringliteral}{"----------------------------------------"}
210           \textcolor{keyword}{call }file_error(file\_dual)
211 \textcolor{keywordflow}{        end if}
212 \textcolor{keywordflow}{      end do}
213     \textcolor{keywordflow}{else}
214     \textcolor{comment}{! assigning dummy variables}
215       \textcolor{keywordflow}{do} i=1,layers
216         vgexchange(i)%Ks\_local(:)=1.0\_rkind
217         vgexchange(i)%anisoangle=0.0\_rkind
218         \textcolor{keywordflow}{if}(drutes_config%dimen>1) \textcolor{keywordflow}{then}
219             \textcolor{keyword}{call }set_tensor(vgexchange(i)%Ks\_local(:), vgexchange(i)%anisoangle(:),  
      vgexchange(i)%Ks)
220         \textcolor{keywordflow}{else}
221             vgexchange(i)%Ks(1,1)=vgexchange(i)%Ks\_local(1)
222 \textcolor{keywordflow}{        end if}
223 \textcolor{keywordflow}{      end do}
224 \textcolor{keywordflow}{    end if}
225     
226     \textcolor{keywordflow}{if}(coup_model<3) \textcolor{keywordflow}{then}
227      \textcolor{keywordflow}{do} i=1,layers
228         \textcolor{keyword}{call }comment(file\_dual)
229         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgexchange(i)%alpha, 
      vgexchange(i)%n
230         vgexchange(i)%m=1.0\_rkind-1.0\_rkind/vgexchange(i)%n
231         \textcolor{keywordflow}{if} (i\_err /= 0) \textcolor{keywordflow}{then}
232           print *, \textcolor{stringliteral}{"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}
233           print *, \textcolor{stringliteral}{"HINT: You don't seem to have defined a sufficient number of van Genuchten &}
234 \textcolor{stringliteral}{}\textcolor{stringliteral}{           parameters for all >> exchange << layers!"}
235           print *, \textcolor{stringliteral}{"----------------------------------------"}
236           \textcolor{keyword}{call }file_error(file\_dual)
237 \textcolor{keywordflow}{        end if}
238 \textcolor{keywordflow}{      end do}
239      \textcolor{keywordflow}{else}
240     
241     \textcolor{comment}{! assigning dummy variables}
242       \textcolor{keywordflow}{do} i=1,layers
243         vgexchange(i)%alpha=1.0\_rkind
244         vgexchange(i)%n=1.0\_rkind
245         vgexchange(i)%m=1.0\_rkind-1.0\_rkind/vgexchange(i)%n
246 \textcolor{keywordflow}{      end do}
247 \textcolor{keywordflow}{    end if}
248 
249             
250       \textcolor{comment}{! initial conditions}
251       
252       \textcolor{keywordflow}{do} i=1,layers
253         \textcolor{keyword}{call }comment(file\_dual)
254         \textcolor{keyword}{read}(unit=file\_dual, fmt= *, iostat=i\_err) vgmatrix(i)%initcond, 
      vgmatrix(i)%icondtype
255         vgfracture(i)%initcond= vgmatrix(i)%initcond
256         vgfracture(i)%icondtype= vgmatrix(i)%icondtype
257 \textcolor{keywordflow}{      end do}
258       
259       \textcolor{keyword}{close}(file\_dual)
260 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=283pt]{namespacere__dual__reader_a3ddb497789d4da4dea2afc55f283cf4b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacere__dual__reader_a3ddb497789d4da4dea2afc55f283cf4b_icgraph}
\end{center}
\end{figure}


