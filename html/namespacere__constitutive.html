<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DRUtES: re_constitutive Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRUtES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacere__constitutive.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">re_constitutive Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aaab88fb88c11ce508ad8240a96275a6b"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">intoverflow</a> ()</td></tr>
<tr class="separator:aaab88fb88c11ce508ad8240a96275a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a331b5dac127bd2b449ffdecf9e3714"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a5a331b5dac127bd2b449ffdecf9e3714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Van Genuchten relation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = f(pressure) \]" src="form_4.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta_e = \frac{1}{(1+(\alpha*h)^n)^m} \]" src="form_5.png"/>
</p>
<p> water content is considered as absolute value not the relative one <br />
 see </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta_e = \frac{\theta - \theta_r}{\theta_s-\theta_r} \]" src="form_6.png"/>
</p>
<p>.  <a href="#a5a331b5dac127bd2b449ffdecf9e3714">More...</a><br /></td></tr>
<tr class="separator:a5a331b5dac127bd2b449ffdecf9e3714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab020b89b03d67d1e1689a79b2d8b387b"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#ab020b89b03d67d1e1689a79b2d8b387b">gardner_wc</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:ab020b89b03d67d1e1689a79b2d8b387b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gardner relation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = f(pressure) \]" src="form_4.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = \frac{1}{(1+(\alpha*h)^n)^m} \]" src="form_7.png"/>
</p>
<p>.  <a href="#ab020b89b03d67d1e1689a79b2d8b387b">More...</a><br /></td></tr>
<tr class="separator:ab020b89b03d67d1e1689a79b2d8b387b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc0f4bc06a19ad696d83967878a54fb"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a6cc0f4bc06a19ad696d83967878a54fb">inverse_vangen</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="separator:a6cc0f4bc06a19ad696d83967878a54fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d8dd738d02ef5a1501b79f7b80f50b"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a21d8dd738d02ef5a1501b79f7b80f50b">vangen_tab</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="separator:a21d8dd738d02ef5a1501b79f7b80f50b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b172485f285a7c37b92d738eb21029"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a36b172485f285a7c37b92d738eb21029"><td class="mdescLeft">&#160;</td><td class="mdescRight">so-called retention water capacity, it is a derivative to retention curve function  E(h) = C(h) + {(h)}{}S_s ] where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ C(h) = \left\{ \begin{array}{l l}\frac{m n \alpha (-h \alpha )^{-1+n}}{\left(1+(-h \alpha )^n\right)^{1+m}}(\theta_s - \theta_r) , &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_8.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta(h) = \left\{ \begin{array}{l l} \frac{\theta_s -\theta_r}{(1+(-\alpha h)^n_{vg})^m_{vg}} + \theta_r, &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ \theta_S, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_9.png"/>
</p>
  <a href="#a36b172485f285a7c37b92d738eb21029">More...</a><br /></td></tr>
<tr class="separator:a36b172485f285a7c37b92d738eb21029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb36bb0f05ceb1d2dba49663c5959d1"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aabb36bb0f05ceb1d2dba49663c5959d1">gardner_elast</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:aabb36bb0f05ceb1d2dba49663c5959d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">so-called retention water capacity, it is a derivative to retention curve function </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(h) = \left\{ \begin{array}{l l} \alpha (\theta_s - \theta_r) exp(\alpha h) , &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_10.png"/>
</p>
  <a href="#aabb36bb0f05ceb1d2dba49663c5959d1">More...</a><br /></td></tr>
<tr class="separator:aabb36bb0f05ceb1d2dba49663c5959d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39d302eed50bc490b34dd310caf7ed8"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aa39d302eed50bc490b34dd310caf7ed8">vangen_elast_tab</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="separator:aa39d302eed50bc490b34dd310caf7ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350f561bf6541e41a24b80a1dafdfad0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">mualem</a> (pde_loc, layer, quadpnt, x, tensor, scalar)</td></tr>
<tr class="memdesc:a350f561bf6541e41a24b80a1dafdfad0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mualem's fucntion for unsaturated hydraulic conductivity with van Genuchten's water content substitution </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ K(h) = \left\{ \begin{array}{l l} K_s\frac{\left( 1- (-\alpha h)^{n_{vg}m_{vg}} \left( 1+ (-\alpha h)^{n_{vg}} \right)^{-m_{vg}} \right)^2}{\left(1+(-\alpha h)^{n_{vg}} \right)^{\frac{m_{vg}}{2}}}, &amp; \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \]" src="form_11.png"/>
</p>
<p>.  <a href="#a350f561bf6541e41a24b80a1dafdfad0">More...</a><br /></td></tr>
<tr class="separator:a350f561bf6541e41a24b80a1dafdfad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833a9b8fca8180958235983135010424"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a833a9b8fca8180958235983135010424">gardner_ks</a> (pde_loc, layer, quadpnt, x, tensor, scalar)</td></tr>
<tr class="memdesc:a833a9b8fca8180958235983135010424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gardner's fucntion for unsaturated hydraulic conductivity </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ K(h) = K_s exp(\alpha h), \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}. \]" src="form_12.png"/>
</p>
<p>.  <a href="#a833a9b8fca8180958235983135010424">More...</a><br /></td></tr>
<tr class="separator:a833a9b8fca8180958235983135010424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8923c35fda157f8198854a3afadd1f99"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a8923c35fda157f8198854a3afadd1f99">mualem_tab</a> (pde_loc, layer, quadpnt, x, tensor, scalar)</td></tr>
<tr class="separator:a8923c35fda157f8198854a3afadd1f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e92c71f9859f011cbf34e28dc8922c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a> (pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</td></tr>
<tr class="memdesc:a69e92c71f9859f011cbf34e28dc8922c"><td class="mdescLeft">&#160;</td><td class="mdescRight">derivative of Mualem's function with van Genuchten's substitution for water content function </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\textrm{d} K(h)}{\textrm{d} h} = \left\{ \begin{array}{l l} K_s \frac{1}{2} \alpha (-\alpha h)^{(-1 + n)} (1 + (-\alpha h)^n)^{(-1 - m/ 2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m})^2 m n + 2 (1 + (-\alpha h)^n)^{(-m/2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m}) (-\alpha (-\alpha h)^{(-1 + n + m n)} (1 + (-\alpha h)^n)^{(-1 - m)} m n + \alpha (-\alpha h)^{(-1 + m n)} (1 + (-a h)^n)^{-m} m n), \quad \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ 0, \quad \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \]" src="form_13.png"/>
</p>
  <a href="#a69e92c71f9859f011cbf34e28dc8922c">More...</a><br /></td></tr>
<tr class="separator:a69e92c71f9859f011cbf34e28dc8922c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36094a3f7331f94d2c895ef3e442d39d"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a36094a3f7331f94d2c895ef3e442d39d">derkz</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="separator:a36094a3f7331f94d2c895ef3e442d39d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060c1f794f98499dd22932984f0b97e8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8">convection_rerot</a> (pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</td></tr>
<tr class="memdesc:a060c1f794f98499dd22932984f0b97e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">convection term for the Richards equation for axisymmetric problems the vertical convection is equal as for the Richards equatio in standard coordinates, the horizontal convection equals [\ {1}{r}K(h)  <a href="#a060c1f794f98499dd22932984f0b97e8">More...</a><br /></td></tr>
<tr class="separator:a060c1f794f98499dd22932984f0b97e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a509607909bb5e6b33c6d2ba2247e2"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a33a509607909bb5e6b33c6d2ba2247e2">sinkterm</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="separator:a33a509607909bb5e6b33c6d2ba2247e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f619b615de841ad748f42a738bb8ff4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4">dmualem_dh_tab</a> (pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</td></tr>
<tr class="separator:a3f619b615de841ad748f42a738bb8ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8629cd60bc0294376447af90a09dc2e3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a8629cd60bc0294376447af90a09dc2e3">darcy_law</a> (pde_loc, layer, quadpnt, x, grad, flux, flux_length)</td></tr>
<tr class="separator:a8629cd60bc0294376447af90a09dc2e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bfdd98c01994ec23b252bfb214199bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a6bfdd98c01994ec23b252bfb214199bd">tabvalues</a> (pde_loc, Kfnc, dKdhfnc, Cfnc, thetafnc)</td></tr>
<tr class="memdesc:a6bfdd98c01994ec23b252bfb214199bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">creates a table of values of constitutive functions for the Richards equation to be linearly approximated  <a href="#a6bfdd98c01994ec23b252bfb214199bd">More...</a><br /></td></tr>
<tr class="separator:a6bfdd98c01994ec23b252bfb214199bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4902efda05309f68b332f0ff35b701ac"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a4902efda05309f68b332f0ff35b701ac">domainswitch</a> (domain)</td></tr>
<tr class="separator:a4902efda05309f68b332f0ff35b701ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7de19cd5e93ba8f0f4bb821e87790c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c">init_zones</a> (vg)</td></tr>
<tr class="separator:a3c7de19cd5e93ba8f0f4bb821e87790c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c717771e468878eec01e1aa2a27ba7a"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a">zone_error_val</a> (h, htest, taylor_max)</td></tr>
<tr class="separator:a6c717771e468878eec01e1aa2a27ba7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7567448cbab0c91885d4d3f48e03a2"><td class="memItemLeft" align="right" valign="top">pure real(kind=rkind) function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#ade7567448cbab0c91885d4d3f48e03a2">secondder_retc</a> (h)</td></tr>
<tr class="separator:ade7567448cbab0c91885d4d3f48e03a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7a060b46a0b04f5e8a971a8a947d82"><td class="memItemLeft" align="right" valign="top">logical function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#abd7a060b46a0b04f5e8a971a8a947d82">rcza_check_old</a> ()</td></tr>
<tr class="separator:abd7a060b46a0b04f5e8a971a8a947d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9868257a176611d41d573f6fb131fc70"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a9868257a176611d41d573f6fb131fc70">rcza_check</a> (pde_loc)</td></tr>
<tr class="separator:a9868257a176611d41d573f6fb131fc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e6667a128b87ca0a7781209e30b1ac"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a95e6667a128b87ca0a7781209e30b1ac">re_dirichlet_bc</a> (pde_loc, el_id, node_order, value, code)</td></tr>
<tr class="separator:a95e6667a128b87ca0a7781209e30b1ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf76632a958340d25d948fafea6a16c9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aaf76632a958340d25d948fafea6a16c9">re_null_bc</a> (pde_loc, el_id, node_order, value, code)</td></tr>
<tr class="separator:aaf76632a958340d25d948fafea6a16c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3166c88db2634fc8fcc9d579358676d0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a3166c88db2634fc8fcc9d579358676d0">re_dirichlet_height_bc</a> (pde_loc, el_id, node_order, value, code)</td></tr>
<tr class="separator:a3166c88db2634fc8fcc9d579358676d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1067d48cafe8d4463ae78102b1e01b84"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a1067d48cafe8d4463ae78102b1e01b84">re_neumann_bc</a> (pde_loc, el_id, node_order, value, code)</td></tr>
<tr class="separator:a1067d48cafe8d4463ae78102b1e01b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166877d8a0dc103b834bbfdda11e5c0e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a166877d8a0dc103b834bbfdda11e5c0e">re_atmospheric</a> (pde_loc, el_id, node_order, value, code)</td></tr>
<tr class="separator:a166877d8a0dc103b834bbfdda11e5c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0c1ec8d57856234ae33b61eab450f2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a7a0c1ec8d57856234ae33b61eab450f2">re_initcond</a> (pde_loc)</td></tr>
<tr class="separator:a7a0c1ec8d57856234ae33b61eab450f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4dd7b9faf9bb8efaa4b60cfb5fc722"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aeb4dd7b9faf9bb8efaa4b60cfb5fc722">setmatflux</a> ()</td></tr>
<tr class="separator:aeb4dd7b9faf9bb8efaa4b60cfb5fc722"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a26f9eee4bd880098c0ac3bf055da68db"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a></td></tr>
<tr class="separator:a26f9eee4bd880098c0ac3bf055da68db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208992652d12a3b477dff42e9df5be7f"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a></td></tr>
<tr class="separator:a208992652d12a3b477dff42e9df5be7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97cae19740749808642dcd2fb326ddb1"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a></td></tr>
<tr class="separator:a97cae19740749808642dcd2fb326ddb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4ff1bd9e37d274bb888db1d630ddbb"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a></td></tr>
<tr class="separator:a3d4ff1bd9e37d274bb888db1d630ddbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe17d121c5500a37fef85872e51138ff"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:,:), allocatable, target, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">ktab_all</a></td></tr>
<tr class="separator:afe17d121c5500a37fef85872e51138ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef95ec1b86499eb41011942a9cf53ce8"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:,:), allocatable, target, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">dkdhtab_all</a></td></tr>
<tr class="separator:aef95ec1b86499eb41011942a9cf53ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b2162aa59a163afc487ea11d76326d5"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:,:), allocatable, target, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">warecatab_all</a></td></tr>
<tr class="separator:a5b2162aa59a163afc487ea11d76326d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3249b973baf1fa0d41eb4cd2784a384b"><td class="memItemLeft" align="right" valign="top">real(kind=rkind), dimension(:,:,:), allocatable, target, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">watcontab_all</a></td></tr>
<tr class="separator:a3249b973baf1fa0d41eb4cd2784a384b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e1df1932a050970ae8b9c032047ad7"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structre__globals_1_1soilpar.html">soilpar</a>), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#ac6e1df1932a050970ae8b9c032047ad7">van_gen_coeff</a></td></tr>
<tr class="separator:ac6e1df1932a050970ae8b9c032047ad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a957329345fdf54666f10d5a560c219db"><td class="memItemLeft" align="right" valign="top">integer(kind=ikind), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a></td></tr>
<tr class="separator:a957329345fdf54666f10d5a560c219db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732d67fdcdd4cdc0fb573d3c9e96ba85"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .false.</td></tr>
<tr class="separator:a732d67fdcdd4cdc0fb573d3c9e96ba85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ecaf75690494449561f9c55f1a142d"><td class="memItemLeft" align="right" valign="top">character(len=4096), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a> = &quot;DRUtES requested values of the constitutive functions out of the range of your precalculated table, the function will be evaluated directly, it will slow down your computation, is everything ok? If yes, increase the length of interval for precaculating the constitutive functions in your config files&quot;</td></tr>
<tr class="separator:a44ecaf75690494449561f9c55f1a142d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa375bb88f1a33731026e0fd7b7c195c6"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .false.</td></tr>
<tr class="separator:aa375bb88f1a33731026e0fd7b7c195c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a060c1f794f98499dd22932984f0b97e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::convection_rerot </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vector_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>vector_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>convection term for the Richards equation for axisymmetric problems the vertical convection is equal as for the Richards equatio in standard coordinates, the horizontal convection equals [\ {1}{r}K(h) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_in</td><td>this argument is required by the global vector_fnc procedure pointer, unused in this procedure</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative unsaturated hydraulic conductivity derivative in respect to h, scalar value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00963">963</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00783">dmualem_dh()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, and <a class="el" href="geom__tools_8f90_source.html#l00072">geom_tools::getcoor()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00030">re_pointers::re_rot()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00009">re_pointers::reroth()</a>.</p>
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacegeom__tools.html">geom_tools</a></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt    </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: vector_in</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: vector_out</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: coord</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: a,n,m, tmp, h, k, flux</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordtype">integer</span> :: proc</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc    </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      </div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        error stop</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        error stop</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          error stop</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        h = x(1)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">select case</span> (<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%name)</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&quot;RE_rot&quot;</span>)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_method == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a>(pde_loc, layer, x=(/h/), vector_out = vector_out)</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4">dmualem_dh_tab</a>(pde_loc, layer, x=(/h/), vector_out = vector_out<span class="comment">)</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment"></span><span class="keywordflow">          end if</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">case</span>(<span class="stringliteral">&quot;RErotH&quot;</span>)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          vector_out = 0</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordflow">      end select</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      tmp = vector_out(2)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a4c2336f6e1e7d512a9d81acb21c71456">getcoor</a>(quadpnt, coord)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keyword">call </span>pde_loc%flux(layer, quadpnt, vector_out=vector_out)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      </div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      vector_out(2) = tmp</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">!       if (abs(coord(2)) &lt; -12.5 ) then</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        vector_out(1) =  1.0_rkind/coord(1)*vector_out(1)       </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">!       else</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">!       vector_out(1) = 0</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!       end if</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="ttc" id="namespacere__constitutive_html_a3f619b615de841ad748f42a738bb8ff4"><div class="ttname"><a href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4">re_constitutive::dmualem_dh_tab</a></div><div class="ttdeci">subroutine, public dmualem_dh_tab(pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l01068">re_constitutive.f90:1068</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacegeom__tools_html"><div class="ttname"><a href="namespacegeom__tools.html">geom_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00015">geom_tools.f90:15</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a4c2336f6e1e7d512a9d81acb21c71456"><div class="ttname"><a href="namespacegeom__tools.html#a4c2336f6e1e7d512a9d81acb21c71456">geom_tools::getcoor</a></div><div class="ttdeci">subroutine, public getcoor(quadpnt, array)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00072">geom_tools.f90:72</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a69e92c71f9859f011cbf34e28dc8922c"><div class="ttname"><a href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">re_constitutive::dmualem_dh</a></div><div class="ttdeci">subroutine, public dmualem_dh(pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</div><div class="ttdoc">derivative of Mualem&amp;#39;s function with van Genuchten&amp;#39;s substitution for water content function  ...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00783">re_constitutive.f90:783</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_cgraph.png" border="0" usemap="#namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_cgraph" id="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c" title="derivative of Mualem&#39;s function with van Genuchten&#39;s substitution for water content function &#160;..." alt="" coords="448,5,637,32"/>
<area shape="rect" id="node3" href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4" title="re_constitutive::dmualem\l_dh_tab" alt="" coords="232,57,400,98"/>
<area shape="rect" id="node11" href="namespacegeom__tools.html#a4c2336f6e1e7d512a9d81acb21c71456" title="geom_tools::getcoor" alt="" coords="246,140,386,167"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="871,56,1013,83"/>
<area shape="rect" id="node5" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b" title="re_constitutive::intoverflow" alt="" coords="453,107,632,133"/>
<area shape="rect" id="node6" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="685,157,823,184"/>
<area shape="rect" id="node7" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="873,107,1011,133"/>
<area shape="rect" id="node8" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="873,157,1011,184"/>
<area shape="rect" id="node9" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="877,208,1007,235"/>
<area shape="rect" id="node10" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="873,259,1011,285"/>
<area shape="rect" id="node12" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="483,157,602,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_icgraph.png" border="0" usemap="#namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_icgraph" id="namespacere__constitutive_a060c1f794f98499dd22932984f0b97e8_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="232,5,359,32"/>
<area shape="rect" id="node5" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="232,56,359,83"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="407,23,553,65"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="601,31,652,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8629cd60bc0294376447af90a09dc2e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::darcy_law </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>flux_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grad</td><td>this value is optional, because it is required by the vector_fnc procedure pointer global definition </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01161">1161</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00030">re_pointers::re_rot()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00057">re_pointers::re_std()</a>.</p>
<div class="fragment"><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;       </div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>                          :: layer</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt    </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span>              <span class="comment">     :: x</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>     :: grad</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: flux</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>                  :: flux_length</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3,3)</span>  :: k</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordtype">integer</span>                           :: d</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>               :: i</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(3)</span> :: nablaz</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span>  :: gradh</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span>  :: vct</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: gradient</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. (<span class="keyword">present</span>(grad) .or. <span class="keyword">present</span>(x))) <span class="keywordflow">then</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition and gradient, not both of them&quot;</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        error stop</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((.not. <span class="keyword">present</span>(grad) .or. .not. <span class="keyword">present</span>(x)) .and. .not. <span class="keyword">present</span><span class="comment">(quadpnt)) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::darcy_law&quot;</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        error stop</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keyword">call </span>pde_loc%getgrad(quadpnt, gradient)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::darcy_law&quot;</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          error stop</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        h = x(1)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keyword">allocate</span>(gradient(ubound(grad,1)))</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        gradient = grad</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      </div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      d = <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      nablaz = 0</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      nablaz(d) = 1</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      gradh(1:d) = gradient(1:d) + nablaz(1:d)</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keyword">call </span>pde_loc%pde_fnc(1)%dispersion(pde_loc, layer, x=(/h/), tensor<span class="comment">=k(1:d, 1:d))</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">     </span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">      vct(1:d) = matmul(-k(1:d,1:d), gradh(1:d))</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">      </span><span class="keywordflow">if</span> (<span class="keyword">present</span>(flux_length)) <span class="keywordflow">then</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">select case</span>(d)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;          <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                flux_length = vct(1)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;          <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                flux_length = sqrt(vct(1)*vct(1) + vct(2)*vct(2))</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          <span class="keywordflow">case</span>(3)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                flux_length = sqrt(vct(1)*vct(1) + vct(2)*vct(2) + vct(3<span class="comment">)*vct(3))</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment"></span><span class="keywordflow">        end select</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(flux)) <span class="keywordflow">then</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        flux(1:d) = vct(1:d)</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a8629cd60bc0294376447af90a09dc2e3_icgraph.png" border="0" usemap="#namespacere__constitutive_a8629cd60bc0294376447af90a09dc2e3_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a8629cd60bc0294376447af90a09dc2e3_icgraph" id="namespacere__constitutive_a8629cd60bc0294376447af90a09dc2e3_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="230,5,357,32"/>
<area shape="rect" id="node5" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="228,56,359,83"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="407,23,553,65"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="601,31,652,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a36094a3f7331f94d2c895ef3e442d39d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::derkz </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting system elasticity </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00859">859</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00216">geom_tools::plane_derivative()</a>.</p>
<div class="fragment"><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacegeom__tools.html">geom_tools</a></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>,  <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: dkdz</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3,3)</span> :: ktmp</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      </div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: dkdx</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">save</span> :: pts</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: layer_loc, vecino, i, d   </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        error stop</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        error stop</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          error stop</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          error stop</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        h = x(1)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(pts) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keyword">allocate</span>(pts(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen+1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)))</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      quadpnt_loc%type_pnt = <span class="stringliteral">&quot;ndpt&quot;</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      quadpnt_loc%element = quadpnt%element</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      quadpnt_loc%column = 2</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      d = <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;     </div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">do</span> i=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        quadpnt_loc%order = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(quadpnt%element,i)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        vecino = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%neighbours(quadpnt%element,i)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">if</span> (vecino &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          layer_loc = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(vecino,1)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          layer_loc = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(quadpnt%element,1)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">        end if</span> </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        quadpnt_loc%order = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(quadpnt%element, i)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keyword">call </span>pde_loc%pde_fnc(1)%dispersion(pde_loc, layer_loc, quadpnt_loc, tensor<span class="comment">=ktmp(1:d, 1:d))</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">        pts(d+1, i) = ktmp(d,d)</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">        pts(1:d,i) = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(quadpnt%element,i),1:d)</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"></span><span class="keywordflow">      end do</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="keywordflow">if</span> (pts(1,2)-pts(1,1) &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            dkdz = (pts(2,2)-pts(2,1))/(pts(1,2)-pts(1,1))</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            dkdz = (pts(2,1)-pts(2,2))/(pts(1,1)-pts(1,2))</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef">plane_derivative</a>(pts(1,:), pts(2,:), pts(3,:), dkdx, dkdz)</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="keywordflow">      end select</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      dkdz = -dkdz</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    </div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a1e93d0ec91a9f2fcc7573e6347a9f9ef"><div class="ttname"><a href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef">geom_tools::plane_derivative</a></div><div class="ttdeci">subroutine, public plane_derivative(a, b, c, xder, yder)</div><div class="ttdoc">specify the x and y derivates of a plane defined by three points </div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00216">geom_tools.f90:216</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacegeom__tools_html"><div class="ttname"><a href="namespacegeom__tools.html">geom_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00015">geom_tools.f90:15</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a36094a3f7331f94d2c895ef3e442d39d_cgraph.png" border="0" usemap="#namespacere__constitutive_a36094a3f7331f94d2c895ef3e442d39d_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a36094a3f7331f94d2c895ef3e442d39d_cgraph" id="namespacere__constitutive_a36094a3f7331f94d2c895ef3e442d39d_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef" title="specify the x and y derivates of a plane defined by three points " alt="" coords="200,5,391,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a69e92c71f9859f011cbf34e28dc8922c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::dmualem_dh </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vector_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>vector_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>derivative of Mualem's function with van Genuchten's substitution for water content function </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\textrm{d} K(h)}{\textrm{d} h} = \left\{ \begin{array}{l l} K_s \frac{1}{2} \alpha (-\alpha h)^{(-1 + n)} (1 + (-\alpha h)^n)^{(-1 - m/ 2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m})^2 m n + 2 (1 + (-\alpha h)^n)^{(-m/2)} (1 - (-\alpha h)^{(m n)} (1 + (-\alpha h)^n)^{-m}) (-\alpha (-\alpha h)^{(-1 + n + m n)} (1 + (-\alpha h)^n)^{(-1 - m)} m n + \alpha (-\alpha h)^{(-1 + m n)} (1 + (-a h)^n)^{-m} m n), \quad \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ 0, \quad \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \]" src="form_13.png"/>
</p>
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_in</td><td>this argument is required by the global vector_fnc procedure pointer, unused in this procedure</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative unsaturated hydraulic conductivity derivative in respect to h, scalar value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00783">783</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00963">convection_rerot()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__pointers_8f90_source.html#l00030">re_pointers::re_rot()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00057">re_pointers::re_std()</a>.</p>
<div class="fragment"><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt    </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: vector_in</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: vector_out</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: a,n,m, tmp, h</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc     </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      </div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        error stop</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        error stop</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh&quot;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;          error stop</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        h = x(1)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      </div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (h &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%n</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%m</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        tmp = (    (a*(-(a*h))**(-1 + n)*(1 + (-(a*h))**n)**(-1 - m/2.0)* &amp;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            (1 - (-(a*h))**(m*n)/(1 + (-(a*h))**n)**m)**2*m*n)/2.0 + &amp;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;         (2*(1 - (-(a*h))**(m*n)/(1 + (-(a*h))**n)**m)* &amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            (-(a*(-(a*h))**(-1 + n + m*n)*(1 + (-(a*h))**n)**(-1 - m)*m*n) + &amp;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;              (a*(-(a*h))**(-1 + m*n)*m*n)/(1 + (-(a*h))**n)**m))/ &amp;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          (1 + (-(a*h))**n)**(m/2.0))</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        tmp = 0</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(vector_out)) <span class="keywordflow">then</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="comment">! must be negative, because the commnon scheme of the CDE problem has negative convection, but RE has positive convection</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        vector_out = -<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ks(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen,:) * tmp</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(scalar)) <span class="keywordflow">then</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        scalar = tmp</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a69e92c71f9859f011cbf34e28dc8922c_icgraph.png" border="0" usemap="#namespacere__constitutive_a69e92c71f9859f011cbf34e28dc8922c_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a69e92c71f9859f011cbf34e28dc8922c_icgraph" id="namespacere__constitutive_a69e92c71f9859f011cbf34e28dc8922c_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="466,5,630,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="687,113,814,140"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="685,193,816,220"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8" title="convection term for the Richards equation for axisymmetric problems the vertical convection is equal ..." alt="" coords="459,57,637,98"/>
<area shape="rect" id="node10" href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4" title="re_constitutive::dmualem\l_dh_tab" alt="" coords="243,174,411,215"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="687,63,814,89"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="685,8,816,35"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="864,81,1011,122"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1059,88,1109,115"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f619b615de841ad748f42a738bb8ff4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::dmualem_dh_tab </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vector_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out), optional&#160;</td>
          <td class="paramname"><em>vector_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_in</td><td>this argument is required by the global vector_fnc procedure pointer, unused in this procedure</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative unsaturated hydraulic conductivity derivative in respect to h </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01068">1068</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00021">dkdhtab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00783">dmualem_dh()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="re__constitutive_8f90_source.html#l00039">intoverflow()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00032">intwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00027">tabmsg</a>, <a class="el" href="re__constitutive_8f90_source.html#l00026">tabwarning</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l00963">convection_rerot()</a>, <a class="el" href="re__pointers_8f90_source.html#l00030">re_pointers::re_rot()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00057">re_pointers::re_std()</a>.</p>
<div class="fragment"><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt    </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: vector_in</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: vector_out</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: pos</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: res, <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>, tmp, h</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc     </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      </div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    </div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      </div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_tab&quot;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        error stop</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh_tab&quot;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        error stop</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::dmualem_dh_tab&quot;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          error stop</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        h = x(1)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">      end if</span>      </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keywordflow">if</span> (h&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length &lt; 0.1*huge(1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        </div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          pos = int(-h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;          <span class="keywordflow">if</span> (pos &lt;= ubound(<a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a>,2)-1) <span class="keywordflow">then</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> = -h - (pos - 1)*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            tmp = (<a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a>(layer,pos+1)-<a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a>(layer,pos))/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length<span class="comment">*<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> + <a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a>(layer,pos)</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">          </span><span class="keywordflow">else</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a>(pde_loc, layer, quadpnt, scalar<span class="comment">=tmp)</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">            </span><span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a>(pde_loc, layer, x=x, scalar=tmp)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(trim(<a class="code" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a>))</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .true.</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">intoverflow</a>()</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .true.</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt))<span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a>(pde_loc, layer, quadpnt_loc, scalar<span class="comment">=tmp)</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">          </span><span class="keywordflow">if</span> (<span class="keyword">present</span>(x))<span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">dmualem_dh</a>(pde_loc, layer, x=x, scalar=tmp)</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        tmp = 0</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      </div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(vector_out)) <span class="keywordflow">then</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="comment">! must be negative, because the commnon scheme of the CDE problem has negative convection, but RE has positive convection</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        vector_out = -<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ks(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen,:) * tmp</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(scalar)) <span class="keywordflow">then</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        scalar = tmp</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a208992652d12a3b477dff42e9df5be7f"><div class="ttname"><a href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">re_constitutive::dkdhtab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public dkdhtab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aaab88fb88c11ce508ad8240a96275a6b"><div class="ttname"><a href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">re_constitutive::intoverflow</a></div><div class="ttdeci">subroutine, private intoverflow()</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00039">re_constitutive.f90:39</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a732d67fdcdd4cdc0fb573d3c9e96ba85"><div class="ttname"><a href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">re_constitutive::tabwarning</a></div><div class="ttdeci">logical, private tabwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00026">re_constitutive.f90:26</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a44ecaf75690494449561f9c55f1a142d"><div class="ttname"><a href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">re_constitutive::tabmsg</a></div><div class="ttdeci">character(len=4096), private tabmsg</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00027">re_constitutive.f90:27</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aa375bb88f1a33731026e0fd7b7c195c6"><div class="ttname"><a href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">re_constitutive::intwarning</a></div><div class="ttdeci">logical, private intwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00032">re_constitutive.f90:32</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a69e92c71f9859f011cbf34e28dc8922c"><div class="ttname"><a href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c">re_constitutive::dmualem_dh</a></div><div class="ttdeci">subroutine, public dmualem_dh(pde_loc, layer, quadpnt, x, vector_in, vector_out, scalar)</div><div class="ttdoc">derivative of Mualem&amp;#39;s function with van Genuchten&amp;#39;s substitution for water content function  ...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00783">re_constitutive.f90:783</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_cgraph.png" border="0" usemap="#namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_cgraph" id="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a69e92c71f9859f011cbf34e28dc8922c" title="derivative of Mualem&#39;s function with van Genuchten&#39;s substitution for water content function &#160;..." alt="" coords="221,107,411,133"/>
<area shape="rect" id="node3" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b" title="re_constitutive::intoverflow" alt="" coords="227,157,405,184"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="644,208,787,235"/>
<area shape="rect" id="node5" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="459,107,596,133"/>
<area shape="rect" id="node6" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="646,56,785,83"/>
<area shape="rect" id="node7" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="647,107,784,133"/>
<area shape="rect" id="node8" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="650,157,781,184"/>
<area shape="rect" id="node9" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="646,5,785,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_icgraph.png" border="0" usemap="#namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_icgraph" id="namespacere__constitutive_a3f619b615de841ad748f42a738bb8ff4_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8" title="convection term for the Richards equation for axisymmetric problems the vertical convection is equal ..." alt="" coords="221,46,400,87"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="448,5,575,32"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="245,112,376,139"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="448,56,575,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="623,49,769,90"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="817,56,868,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4902efda05309f68b332f0ff35b701ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::domainswitch </td>
          <td>(</td>
          <td class="paramtype">character(len=1), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01367">1367</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00021">dkdhtab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">dkdhtab_all</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">ktab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">ktab_all</a>, <a class="el" href="re__globals_8f90_source.html#l00048">re_globals::vgfractures</a>, <a class="el" href="re__globals_8f90_source.html#l00033">re_globals::vgmatrix</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">warecatab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">warecatab_all</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">watcontab</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00022">watcontab_all</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>
<div class="fragment"><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordtype">character(len=1)</span>, <span class="keywordtype">intent(in)</span> :: domain</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">if</span> (domain == <span class="stringliteral">&quot;m&quot;</span>) <span class="keywordflow">then</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a> =&gt; <a class="code" href="namespacere__globals.html#ac218648bc51273025654afb2c7dbdc78">vgmatrix</a></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a> =&gt; <a class="code" href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">ktab_all</a>(1,:,:)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a> =&gt; <a class="code" href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">dkdhtab_all</a>(1,:,:)</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a> =&gt; <a class="code" href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">warecatab_all</a>(1,:,:)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a> =&gt; <a class="code" href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">watcontab_all</a>(1,:,:)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (domain == <span class="stringliteral">&quot;f&quot;</span>) <span class="keywordflow">then</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a> =&gt; <a class="code" href="namespacere__globals.html#ad6f10c7933dfd444cdff9577510ed21b">vgfractures</a></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a> =&gt; <a class="code" href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">ktab_all</a>(2,:,:)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a> =&gt; <a class="code" href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">dkdhtab_all</a>(2,:,:)</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a> =&gt; <a class="code" href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">warecatab_all</a>(2,:,:)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a> =&gt; <a class="code" href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">watcontab_all</a>(2,:,:)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        error stop <span class="stringliteral">&quot;runtime error, invalid argument in RE_constitutive::domainswitch() procedure&quot;</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        </div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="ttc" id="namespacere__constitutive_html_a3249b973baf1fa0d41eb4cd2784a384b"><div class="ttname"><a href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">re_constitutive::watcontab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public watcontab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__globals_html_ac218648bc51273025654afb2c7dbdc78"><div class="ttname"><a href="namespacere__globals.html#ac218648bc51273025654afb2c7dbdc78">re_globals::vgmatrix</a></div><div class="ttdeci">type(soilpar), dimension(:), allocatable, target, public vgmatrix</div><div class="ttdoc">soil and layer parameters </div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00033">re_globals.f90:33</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a208992652d12a3b477dff42e9df5be7f"><div class="ttname"><a href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">re_constitutive::dkdhtab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public dkdhtab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a5b2162aa59a163afc487ea11d76326d5"><div class="ttname"><a href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">re_constitutive::warecatab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public warecatab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a97cae19740749808642dcd2fb326ddb1"><div class="ttname"><a href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">re_constitutive::warecatab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public warecatab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_afe17d121c5500a37fef85872e51138ff"><div class="ttname"><a href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">re_constitutive::ktab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public ktab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aef95ec1b86499eb41011942a9cf53ce8"><div class="ttname"><a href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">re_constitutive::dkdhtab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public dkdhtab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a3d4ff1bd9e37d274bb888db1d630ddbb"><div class="ttname"><a href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">re_constitutive::watcontab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public watcontab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a26f9eee4bd880098c0ac3bf055da68db"><div class="ttname"><a href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">re_constitutive::ktab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public ktab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__globals_html_ad6f10c7933dfd444cdff9577510ed21b"><div class="ttname"><a href="namespacere__globals.html#ad6f10c7933dfd444cdff9577510ed21b">re_globals::vgfractures</a></div><div class="ttdeci">type(soilpar), dimension(:), allocatable, target, public vgfractures</div><div class="ttdoc">soil and layer parameters </div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00048">re_globals.f90:48</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a4902efda05309f68b332f0ff35b701ac_icgraph.png" border="0" usemap="#namespacere__constitutive_a4902efda05309f68b332f0ff35b701ac_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a4902efda05309f68b332f0ff35b701ac_icgraph" id="namespacere__constitutive_a4902efda05309f68b332f0ff35b701ac_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="467,81,631,108"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a6bfdd98c01994ec23b252bfb214199bd" title="creates a table of values of constitutive functions for the Richards equation to be linearly approxim..." alt="" coords="248,107,419,133"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="681,5,807,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="681,56,807,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="679,107,809,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="679,157,809,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="857,74,1004,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1052,81,1103,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aabb36bb0f05ceb1d2dba49663c5959d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::gardner_elast </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>so-called retention water capacity, it is a derivative to retention curve function </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(h) = \left\{ \begin{array}{l l} \alpha (\theta_s - \theta_r) exp(\alpha h) , &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_10.png"/>
</p>
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting system elasticity </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00408">408</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>,  <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: e</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: c, a,  tr, ts </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc      </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      </div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        error stop</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_elast&quot;</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        error stop</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: Gardner function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          error stop</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: Gardner function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_elast&quot;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          error stop</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        h = x(1)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">if</span> (h &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        tr = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        ts = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        e = a*(-tr + ts)*exp(a*h)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        e = 0</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a833a9b8fca8180958235983135010424"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::gardner_ks </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out), optional&#160;</td>
          <td class="paramname"><em>tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gardner's fucntion for unsaturated hydraulic conductivity </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ K(h) = K_s exp(\alpha h), \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}. \]" src="form_12.png"/>
</p>
<p>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tensor</td><td>second order tensor of the unsaturated hydraulic conductivity</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative hydraulic conductivity, (scalar value) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00623">623</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt      </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: tensor</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: tmp</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      </div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_ks&quot;</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        error stop</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_ks&quot;</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        error stop</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_ks&quot;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          error stop</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        h = x(1)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">if</span> (h &gt;= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        tmp = 1</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        tmp = exp(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha*h)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(tensor)) <span class="keywordflow">then</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        tensor = tmp* <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ks</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(scalar)) <span class="keywordflow">then</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        scalar = tmp</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordflow">      end if</span></div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab020b89b03d67d1e1689a79b2d8b387b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::gardner_wc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gardner relation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = f(pressure) \]" src="form_4.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = \frac{1}{(1+(\alpha*h)^n)^m} \]" src="form_7.png"/>
</p>
<p>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting water content </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00126">126</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_wc&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        error stop</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_wc&quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        error stop</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::gardner_wc&quot;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          error stop</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        h = x(1)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (h &gt;=0.0_rkind) <span class="keywordflow">then</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          theta = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          theta = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr+(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths - <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr)*exp(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a><span class="comment">(layer)%alpha*h)</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span><span class="keywordflow">      end if</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c7de19cd5e93ba8f0f4bb821e87790c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::init_zones </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structre__globals_1_1soilpar.html">soilpar</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>vg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01394">1394</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00055">globals::maxpress</a>, <a class="el" href="printtools_8f90_source.html#l00010">printtools::progressbar()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01595">secondder_retc()</a>, <a class="el" href="geom__tools_8f90_source.html#l00612">geom_tools::solve_bisect()</a>, <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>, <a class="el" href="re__constitutive_8f90_source.html#l00024">this_layer</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01570">zone_error_val()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacegeom__tools.html">geom_tools</a></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceprinttools.html">printtools</a></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      </div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      </div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      </div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structre__globals_1_1soilpar.html">soilpar</a>), <span class="keywordtype">intent(in out)</span>, <span class="keywordtype">dimension(:)</span> :: vg</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, j, k, l</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordtype">integer</span> :: i_err</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordtype">logical</span> :: increased, overzero</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta, htest, htest2, h, hprev, tmp1, tmp2, m,<span class="comment"> inflex_point</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">      </span><span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: images_run</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: cotable[:]</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordtype">character(len=7)</span> :: procentas</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: n</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordtype">logical</span> :: backward</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      n = int(<a class="code" href="namespaceglobals.html#af4312280ad8218c6bd8a99046af454aa">maxpress</a>/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1    </div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">do</span> i=1, ubound(vg,1)</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">if</span> (vg(i)%rcza_set%use) <span class="keywordflow">then</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;         <span class="keyword">allocate</span>(vg(i)%rcza_set%tab(n, 3))</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;         vg(i)%rcza_set%tab = 0</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      i_err = 0</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      htest = 0.0</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    </div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        </div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keyword">allocate</span>(images_run(num_images(),2))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      </div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      images_run(1,1) = 1</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      images_run(1,2) = int(ubound(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>,1)/num_images()) + modulo(ubound<span class="comment">(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>,1), num_images())</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">      </span><span class="keyword">allocate</span>(cotable(images_run(1,2), n, 3)[*])</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">!       do i=2, NUM_IMAGES()</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">!       images_run(i,1) = images_run(i-1,2) + 1</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">!       if (images_run(i,1) + int(ubound(vgset,1)/NUM_IMAGES()) &lt;= ubound(vgset,1) ) then</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">!         images_run(i,2) = images_run(i,1) + int(ubound(vgset,1)/NUM_IMAGES())</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">!       else</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">!         images_run(i,2) = images_run(i,1)</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">!       end if</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">!       end do</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    </div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      layers: <span class="keywordflow">do</span> j=images_run(this_image(),1), images_run(this_image(),2<span class="comment">)</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">                </span><span class="keywordflow">if</span> (<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(j)%rcza_set%use) <span class="keywordflow">then</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                  k = j - images_run(this_image(),1) + 1</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                  <span class="comment">!backward</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                  <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot;preparing layer:&quot;</span>, j</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                  <a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a> = j</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a2fde1713e8d912a2be95dfa7f6789bab">solve_bisect</a>(-epsilon(h), -<a class="code" href="namespaceglobals.html#af4312280ad8218c6bd8a99046af454aa">maxpress</a>, <a class="code" href="namespacere__constitutive.html#ade7567448cbab0c91885d4d3f48e03a2">secondder_retc</a>, 0.001_rkind<span class="comment">, i_err, inflex_point)</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">                  print *, </span><span class="stringliteral">&quot;inflex point of the layer:&quot;</span>, j, <span class="stringliteral">&quot;found at:&quot;</span>, inflex_point</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                  </div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                  levels: <span class="keywordflow">do</span> i=1, ubound(cotable,2)</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                            <span class="keywordflow">if</span> (this_image() == 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                              <span class="keyword">call </span><a class="code" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068">progressbar</a>(int(50*i/ubound(cotable,2)))</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                            h = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length*i</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                            <span class="keywordflow">if</span> (i &lt; 2) <span class="keywordflow">then</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                              htest = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                              hprev = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                              htest = cotable(k,i-1,2)[this_image()]</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                              hprev = htest</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                            rough: <span class="keywordflow">do</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a">zone_error_val</a>(h, htest, <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(j)%rcza_set%val) &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                                  cotable(k,i,1)[this_image()] = h</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                                  cotable(k,i,2)[this_image()] = htest</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                                  <span class="keywordflow">exit</span> rough</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                      htest = htest - <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                      <span class="keywordflow">if</span> (htest &lt; -2*<a class="code" href="namespaceglobals.html#af4312280ad8218c6bd8a99046af454aa">maxpress</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                        cotable(k,i:ubound(cotable,2),2)[this_image()] = htest</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                                        <span class="keywordflow">do</span> l= i, ubound(cotable,2)</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                          cotable(k,l,1)[this_image()] = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length*l</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="keywordflow">                                        end do</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                        <span class="keywordflow">exit</span> levels</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="keywordflow">                                      end if</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="keywordflow">                                    end if</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="keywordflow">                            end do</span> rough</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="keywordflow">                  end do</span> levels</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">!             !forward</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                  levels2: <span class="keywordflow">do</span> i=1, ubound(cotable,2)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                            <span class="keywordflow">if</span> (this_image() == 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                              <span class="keyword">call </span><a class="code" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068">progressbar</a>(int(50*i/ubound(cotable,2)+50))</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                            h = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length*i</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                            <span class="keywordflow">if</span> (i &lt; 2) <span class="keywordflow">then</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                              htest = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                              hprev = -<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                              backward = .false.</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                              <span class="keywordflow">if</span> (cotable(k,i-1,3)[this_image()] &gt; inflex_point-5*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length<span class="comment">) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                                htest = h</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                hprev = h</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                backward = .false.</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                htest = cotable(k,i-1,3)[this_image()]</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                hprev = htest</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                backward = .true.</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="keywordflow">                              end if</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                            rough2: <span class="keywordflow">do</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                      <span class="keywordflow">if</span> ((<a class="code" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a">zone_error_val</a>(h, htest, <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(j)%rcza_set%val) &gt; epsilon<span class="comment">(0.0_rkind) .and. .not.(backward)) .or. &amp;</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">                                        (<a class="code" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a">zone_error_val</a>(h, htest, <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(j)%rcza_set%val) &lt; 0 .and. backward))      </span><span class="keywordflow">then</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                      cotable(k,i,3)[this_image()] = htest</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                      <span class="keywordflow">exit</span> rough2</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                                        <span class="keywordflow">if</span> (htest &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                                          <span class="keywordflow">if</span> (backward) <span class="keywordflow">then</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                                            l = -1</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                          <span class="keywordflow">else</span> </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                            l = 1</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="keywordflow">                                          end if</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                                          htest = htest + l*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                                        <span class="keywordflow">else</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                          cotable(k,i,3)[this_image()] = huge(1.0_rkind)</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                          <span class="keywordflow">exit</span> rough2</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keywordflow">                                        end if</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="keywordflow">                                      end if</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="keywordflow">                                    end do</span> rough2</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="keywordflow">                  end do</span> levels2 </div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                  <span class="keywordflow">if</span> (this_image() == 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    print *, <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                    <span class="keyword">call </span>flush(6)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="keywordflow">                  end if</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keywordflow">        end do</span> layers</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="comment">! sync data</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        sync all</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(images_run,1)</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          <span class="keywordflow">do</span> j=images_run(i,1), images_run(i,2)</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            vg(j)%rcza_set%tab = cotable(j,:,:)[i]</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;         sync all </div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        </div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keyword">deallocate</span>(images_run)</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keyword">deallocate</span>(cotable)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="ttc" id="namespacegeom__tools_html_a2fde1713e8d912a2be95dfa7f6789bab"><div class="ttname"><a href="namespacegeom__tools.html#a2fde1713e8d912a2be95dfa7f6789bab">geom_tools::solve_bisect</a></div><div class="ttdeci">subroutine, public solve_bisect(xmin, xmax, f, reps, ierr, solution)</div><div class="ttdoc">bisecton method searching for a root of function f on defined intervals xmin and xmax ...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00612">geom_tools.f90:612</a></div></div>
<div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_ade7567448cbab0c91885d4d3f48e03a2"><div class="ttname"><a href="namespacere__constitutive.html#ade7567448cbab0c91885d4d3f48e03a2">re_constitutive::secondder_retc</a></div><div class="ttdeci">pure real(kind=rkind) function, private secondder_retc(h)</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l01595">re_constitutive.f90:1595</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a6c717771e468878eec01e1aa2a27ba7a"><div class="ttname"><a href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a">re_constitutive::zone_error_val</a></div><div class="ttdeci">real(kind=rkind) function, private zone_error_val(h, htest, taylor_max)</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l01570">re_constitutive.f90:1570</a></div></div>
<div class="ttc" id="namespaceprinttools_html"><div class="ttname"><a href="namespaceprinttools.html">printtools</a></div><div class="ttdef"><b>Definition:</b> <a href="printtools_8f90_source.html#l00001">printtools.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a957329345fdf54666f10d5a560c219db"><div class="ttname"><a href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">re_constitutive::this_layer</a></div><div class="ttdeci">integer(kind=ikind), private this_layer</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00024">re_constitutive.f90:24</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structre__globals_1_1soilpar_html"><div class="ttname"><a href="structre__globals_1_1soilpar.html">re_globals::soilpar</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00013">re_globals.f90:13</a></div></div>
<div class="ttc" id="namespacegeom__tools_html"><div class="ttname"><a href="namespacegeom__tools.html">geom_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00015">geom_tools.f90:15</a></div></div>
<div class="ttc" id="namespaceglobals_html_af4312280ad8218c6bd8a99046af454aa"><div class="ttname"><a href="namespaceglobals.html#af4312280ad8218c6bd8a99046af454aa">globals::maxpress</a></div><div class="ttdeci">real(kind=rkind), public maxpress</div><div class="ttdoc">maximal pressure to precalculate (tabelarise) the unsaturated hydraulic conductivity value ...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00055">globals.f90:55</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceprinttools_html_ac71e43f1627ed0239558720411181068"><div class="ttname"><a href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068">printtools::progressbar</a></div><div class="ttdeci">subroutine, public progressbar(j)</div><div class="ttdoc">if default output is stdout, then this procedure prints nice progress bar </div><div class="ttdef"><b>Definition:</b> <a href="printtools_8f90_source.html#l00010">printtools.f90:10</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_cgraph.png" border="0" usemap="#namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_cgraph" id="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_cgraph">
<area shape="rect" id="node2" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068" title="if default output is stdout, then this procedure prints nice progress bar " alt="" coords="212,5,363,32"/>
<area shape="rect" id="node3" href="namespacere__constitutive.html#ade7567448cbab0c91885d4d3f48e03a2" title="re_constitutive::secondder_retc" alt="" coords="185,56,389,83"/>
<area shape="rect" id="node4" href="namespacegeom__tools.html#a2fde1713e8d912a2be95dfa7f6789bab" title="bisecton method searching for a root of function f on defined intervals xmin and xmax ..." alt="" coords="202,107,373,133"/>
<area shape="rect" id="node6" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a" title="re_constitutive::zone\l_error_val" alt="" coords="216,158,359,199"/>
<area shape="rect" id="node5" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="445,107,587,133"/>
<area shape="rect" id="node7" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714" title="Van Genuchten relation &#160;&#160;water content is considered as absolute value not the relative one &#160;&#160;see ..." alt="" coords="643,191,800,217"/>
<area shape="rect" id="node8" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029" title="so&#45;called retention water capacity, it is a derivative to retention curve function &#160;E(h) = C(h) + {(h..." alt="" coords="437,213,595,254"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_icgraph.png" border="0" usemap="#namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_icgraph" id="namespacere__constitutive_a3c7de19cd5e93ba8f0f4bb821e87790c_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="185,81,349,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="399,5,526,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="399,56,526,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="397,107,528,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="397,157,528,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="576,74,723,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="771,81,821,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaab88fb88c11ce508ad8240a96275a6b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private re_constitutive::intoverflow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00039">39</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="postpro_8f90_source.html#l00029">postpro::make_print()</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepostpro.html">postpro</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordtype">character(len=4096)</span> :: msg</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keyword">write</span>(msg, fmt=*) <span class="stringliteral">&quot;You are probably experiencing oscilations&quot;</span>, &amp; </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;              <span class="stringliteral">&quot;(probably convective dominance), I will print your data. Your computation (just for a case) is not&quot;</span><span class="comment">, &amp;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">              </span><span class="stringliteral">&quot;interrupted, but the results are probably not reliable anymore.&quot;</span><span class="comment">,  &amp; </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">              </span><span class="stringliteral">&quot;We will probably experience a crash soon.:) Check your model configuration to avoid&quot;</span><span class="comment">, &amp;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">              </span><span class="stringliteral">&quot;convective dominant problems.&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;              </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(msg)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece">make_print</a>(<span class="stringliteral">&quot;separately&quot;</span>)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;              </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      </div><div class="ttc" id="namespacepostpro_html_a21af39d8fdc38e6b736346450f99fece"><div class="ttname"><a href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece">postpro::make_print</a></div><div class="ttdeci">subroutine, public make_print(behaviour, curtime, name)</div><div class="ttdef"><b>Definition:</b> <a href="postpro_8f90_source.html#l00029">postpro.f90:29</a></div></div>
<div class="ttc" id="namespacepostpro_html"><div class="ttname"><a href="namespacepostpro.html">postpro</a></div><div class="ttdoc">solver for the advection dispersion equation </div><div class="ttdef"><b>Definition:</b> <a href="postpro_8f90_source.html#l00016">postpro.f90:16</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_cgraph.png" border="0" usemap="#namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_cgraph" alt=""/></div>
<map name="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_cgraph" id="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_cgraph">
<area shape="rect" id="node2" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="232,120,369,147"/>
<area shape="rect" id="node7" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="417,208,560,235"/>
<area shape="rect" id="node3" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="419,5,558,32"/>
<area shape="rect" id="node4" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="420,56,557,83"/>
<area shape="rect" id="node5" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="423,107,554,133"/>
<area shape="rect" id="node6" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="419,157,558,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_icgraph.png" border="0" usemap="#namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_icgraph" alt=""/></div>
<map name="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_icgraph" id="namespacere__constitutive_aaab88fb88c11ce508ad8240a96275a6b_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a3f619b615de841ad748f42a738bb8ff4" title="re_constitutive::dmualem\l_dh_tab" alt="" coords="241,13,409,54"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a8923c35fda157f8198854a3afadd1f99" title="re_constitutive::mualem_tab" alt="" coords="232,195,419,222"/>
<area shape="rect" id="node12" href="namespacere__constitutive.html#aa39d302eed50bc490b34dd310caf7ed8" title="re_constitutive::vangen\l_elast_tab" alt="" coords="247,78,404,120"/>
<area shape="rect" id="node13" href="namespacere__constitutive.html#a21d8dd738d02ef5a1501b79f7b80f50b" title="re_constitutive::vangen_tab" alt="" coords="234,144,417,171"/>
<area shape="rect" id="node3" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8" title="convection term for the Richards equation for axisymmetric problems the vertical convection is equal ..." alt="" coords="467,21,645,62"/>
<area shape="rect" id="node4" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="695,7,822,34"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="693,108,824,135"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="695,58,822,84"/>
<area shape="rect" id="node5" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="872,76,1019,117"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1067,83,1117,110"/>
<area shape="rect" id="node10" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="474,138,638,164"/>
<area shape="rect" id="node11" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="693,159,824,186"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6cc0f4bc06a19ad696d83967878a54fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::inverse_vangen </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>water content</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting pressure head </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00182">182</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01976">re_initcond()</a>, and <a class="el" href="re__total_8f90_source.html#l00672">re_total::retot_initcond()</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: hpress</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: a,n,m</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      </div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        error stop</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        error stop</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        theta = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          error stop</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        theta = x(1)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%n</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%m</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">if</span> (abs(theta - <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths) &lt; epsilon(theta)) <span class="keywordflow">then</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        hpress = 0</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (theta &gt;  <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths + 10*epsilon(theta)) <span class="keywordflow">then</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(<span class="stringliteral">&quot;theta is greater then theta_s, exiting&quot;</span>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          print *, <span class="stringliteral">&quot;called from re_constitutive::inverse_vangen&quot;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          error stop</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theta &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(<span class="stringliteral">&quot;theta is negative strange, exiting&quot;</span>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          print *, <span class="stringliteral">&quot;called from re_constitutive::inverse_vangen&quot;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          error stop </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        hpress = ((((<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths - <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr)/(theta-<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr<span class="comment">))**(1.0_rkind/m)-1) &amp;  </span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">        **(1.0_rkind/n))/(-a)</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span><span class="keywordflow">      end if</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      </div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_cgraph.png" border="0" usemap="#namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_cgraph" id="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_cgraph">
<area shape="rect" id="node2" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="211,13,353,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_icgraph.png" border="0" usemap="#namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_icgraph" id="namespacere__constitutive_a6cc0f4bc06a19ad696d83967878a54fb_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a7a0c1ec8d57856234ae33b61eab450f2" title="re_constitutive::re\l_initcond" alt="" coords="223,45,349,86"/>
<area shape="rect" id="node7" href="namespacere__total.html#a5d572dd5f6da46314cdd0d5039c2db7c" title="re_total::retot_initcond" alt="" coords="211,111,361,137"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="411,5,538,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="409,56,540,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="588,74,735,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="783,81,833,108"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="411,107,538,133"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="409,157,540,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a350f561bf6541e41a24b80a1dafdfad0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::mualem </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out), optional&#160;</td>
          <td class="paramname"><em>tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mualem's fucntion for unsaturated hydraulic conductivity with van Genuchten's water content substitution </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ K(h) = \left\{ \begin{array}{l l} K_s\frac{\left( 1- (-\alpha h)^{n_{vg}m_{vg}} \left( 1+ (-\alpha h)^{n_{vg}} \right)^{-m_{vg}} \right)^2}{\left(1+(-\alpha h)^{n_{vg}} \right)^{\frac{m_{vg}}{2}}}, &amp; \mbox{$\forall$ $h \in$ $(-\infty,0)$}\\ K_s, \mbox{$\forall$ $h \in$ $\langle 0, +\infty)$}\\ \end{array} \right. \]" src="form_11.png"/>
</p>
<p>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tensor</td><td>second order tensor of the unsaturated hydraulic conductivity</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative hydraulic conductivity, (scalar value) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00552">552</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt      </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: tensor</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: a,n,m, tmp</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem&quot;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        error stop</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem&quot;</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        error stop</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem&quot;</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          error stop</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        h = x(1)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">if</span> (h &gt;= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        tmp = 1</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%n</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%m</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        tmp =  (1 - (-(a*h))**(m*n)/(1 + (-(a*h))**n)**m)**2/(1 + (-(a*h))**n)*<span class="comment">*(m/2.0_rkind)</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span><span class="keywordflow">      end if</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(tensor)) <span class="keywordflow">then</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        tensor = tmp* <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ks</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(scalar)) <span class="keywordflow">then</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        scalar = tmp</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordflow">      end if</span></div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a350f561bf6541e41a24b80a1dafdfad0_icgraph.png" border="0" usemap="#namespacere__constitutive_a350f561bf6541e41a24b80a1dafdfad0_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a350f561bf6541e41a24b80a1dafdfad0_icgraph" id="namespacere__constitutive_a350f561bf6541e41a24b80a1dafdfad0_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="449,81,613,108"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a8923c35fda157f8198854a3afadd1f99" title="re_constitutive::mualem_tab" alt="" coords="215,107,401,133"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="663,5,790,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="663,56,790,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="661,107,792,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="661,157,792,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="840,74,987,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1035,81,1085,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8923c35fda157f8198854a3afadd1f99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::mualem_tab </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out), optional&#160;</td>
          <td class="paramname"><em>tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>scalar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tensor</td><td>second order tensor of the unsaturated hydraulic conductivity</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalar</td><td>relative hydraulic conductivity, (scalar value) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00687">687</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00039">intoverflow()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00032">intwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">ktab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00552">mualem()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00027">tabmsg</a>, <a class="el" href="re__constitutive_8f90_source.html#l00026">tabwarning</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt      </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: tensor <span class="comment">        </span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: scalar</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: pos</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: res, <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>, tmp</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc      </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem_tab&quot;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        error stop</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem_tab&quot;</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        error stop</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      </div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::mualem_tab&quot;</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          error stop</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        h = x(1)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">if</span> (h&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> (-h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length &lt; 0.1*huge(1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          pos = int(-h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="keywordflow">if</span> (pos &lt;= ubound(<a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a>,2)-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> = -h - (pos - 1)*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            tmp = (<a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a>(layer,pos+1)-<a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a>(layer,pos))/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length<span class="comment">*<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> + <a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a>(layer,pos)</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">          </span><span class="keywordflow">else</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">mualem</a>(pde_loc, layer, quadpnt, scalar =<span class="comment"> tmp)</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">            </span><span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">mualem</a>(pde_loc, layer, x=x, scalar = tmp)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(trim(<a class="code" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a>))</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .true.</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">intoverflow</a>()</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .true.</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">mualem</a>(pde_loc, layer, quadpnt_loc, scalar<span class="comment"> = tmp)</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">          </span><span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">mualem</a>(pde_loc, layer, x=x, scalar = tmp)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keywordflow">        end if</span> </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;         </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        tmp = 1</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(tensor)) <span class="keywordflow">then</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        tensor = tmp* <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ks</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(scalar)) <span class="keywordflow">then</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        scalar = tmp</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="keywordflow">      end if</span></div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a350f561bf6541e41a24b80a1dafdfad0"><div class="ttname"><a href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0">re_constitutive::mualem</a></div><div class="ttdeci">subroutine, public mualem(pde_loc, layer, quadpnt, x, tensor, scalar)</div><div class="ttdoc">Mualem&amp;#39;s fucntion for unsaturated hydraulic conductivity with van Genuchten&amp;#39;s water content substitut...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00552">re_constitutive.f90:552</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aaab88fb88c11ce508ad8240a96275a6b"><div class="ttname"><a href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">re_constitutive::intoverflow</a></div><div class="ttdeci">subroutine, private intoverflow()</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00039">re_constitutive.f90:39</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a732d67fdcdd4cdc0fb573d3c9e96ba85"><div class="ttname"><a href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">re_constitutive::tabwarning</a></div><div class="ttdeci">logical, private tabwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00026">re_constitutive.f90:26</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a44ecaf75690494449561f9c55f1a142d"><div class="ttname"><a href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">re_constitutive::tabmsg</a></div><div class="ttdeci">character(len=4096), private tabmsg</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00027">re_constitutive.f90:27</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a26f9eee4bd880098c0ac3bf055da68db"><div class="ttname"><a href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">re_constitutive::ktab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public ktab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aa375bb88f1a33731026e0fd7b7c195c6"><div class="ttname"><a href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">re_constitutive::intwarning</a></div><div class="ttdeci">logical, private intwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00032">re_constitutive.f90:32</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_cgraph.png" border="0" usemap="#namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_cgraph" id="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b" title="re_constitutive::intoverflow" alt="" coords="240,157,419,184"/>
<area shape="rect" id="node8" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="652,208,795,235"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a350f561bf6541e41a24b80a1dafdfad0" title="Mualem&#39;s fucntion for unsaturated hydraulic conductivity with van Genuchten&#39;s water content substitut..." alt="" coords="249,259,410,285"/>
<area shape="rect" id="node3" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="467,107,604,133"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="654,5,793,32"/>
<area shape="rect" id="node5" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="655,56,792,83"/>
<area shape="rect" id="node6" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="658,107,789,133"/>
<area shape="rect" id="node7" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="654,157,793,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_icgraph.png" border="0" usemap="#namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_icgraph" id="namespacere__constitutive_a8923c35fda157f8198854a3afadd1f99_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="240,81,404,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="454,5,581,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="454,56,581,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="452,107,583,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="452,157,583,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="631,74,777,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="825,81,876,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9868257a176611d41d573f6fb131fc70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public re_constitutive::rcza_check </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01666">1666</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>),<span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: el, pos, mat</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordtype">logical</span> :: passed</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i, position, nd</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: low, high, hprev, h</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        </div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        quadpnt%type_pnt = <span class="stringliteral">&quot;ndpt&quot;</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;               </div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(pde_loc%solution,1)</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          el = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%element(i)%data(1)</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          mat = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el,1)</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            </div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          quadpnt%order = i</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;          quadpnt%column = 1</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;          quadpnt%preproc=.true.</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          hprev = pde_loc%getval(quadpnt)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;          quadpnt%column = 2</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;          h = pde_loc%getval(quadpnt)</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(mat)%rcza_set%use) <span class="keywordflow">then</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="keywordflow">if</span> ( hprev&lt;0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;              position = int(-hprev/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;              low = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(mat)%rcza_set%tab(position,2)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;              high = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(mat)%rcza_set%tab(position,3)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;              <span class="keywordflow">if</span> (h &lt; low .or. h &gt; high) <span class="keywordflow">then</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                passed = .false.</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="keywordflow">           end if</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="keywordflow">         end do</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        passed = .true.</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a9868257a176611d41d573f6fb131fc70_icgraph.png" border="0" usemap="#namespacere__constitutive_a9868257a176611d41d573f6fb131fc70_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a9868257a176611d41d573f6fb131fc70_icgraph" id="namespacere__constitutive_a9868257a176611d41d573f6fb131fc70_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="193,81,357,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="407,5,534,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="407,56,534,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="405,107,536,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="405,157,536,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="584,74,731,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="779,81,829,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abd7a060b46a0b04f5e8a971a8a947d82"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function, private re_constitutive::rcza_check_old </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01627">1627</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>, <a class="el" href="pde__objs_8f90_source.html#l00298">pde_objs::pde_common</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>
<div class="fragment"><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: process</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordtype">logical</span> :: passed</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i, j, position</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: low, high, hprev, h</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        process = <a class="code" href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_common</a>%current_proc</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>,1)</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(i)%rcza_set%use) <span class="keywordflow">then</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="keywordflow">do</span> j=<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(process)%procbase_fnc(1), <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(process)%procbase_fnc(2)</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;              hprev = <a class="code" href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_common</a>%xvect(j,1)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;              h = <a class="code" href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_common</a>%xvect(j,3)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;              <span class="keywordflow">if</span> ( h&lt;0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                position = int(-hprev/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                low = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(i)%rcza_set%tab(position,2)</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                high = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(i)%rcza_set%tab(position,3)</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">!                 print *, low, h, high</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                <span class="keywordflow">if</span> (h &lt; low .or. h &gt; high) <span class="keywordflow">then</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                  passed = .false.</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                  <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        passed = .true.</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacepde__objs_html_a177df2f43aeb5ecde4cca531ecfbf4a1"><div class="ttname"><a href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_objs::pde_common</a></div><div class="ttdeci">type(pde_common_str), public pde_common</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00298">pde_objs.f90:298</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a166877d8a0dc103b834bbfdda11e5c0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine re_constitutive::re_atmospheric </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>node_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01896">1896</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, <a class="el" href="pde__objs_8f90_source.html#l00298">pde_objs::pde_common</a>, and <a class="el" href="globals_8f90_source.html#l00137">globals::time</a>.</p>
<div class="fragment"><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>  :: el_id, node_order</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: value</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: code</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      </div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3,3)</span> :: k</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      </div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span> :: gravflux, bcflux</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      </div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: layer</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta, bcval</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, edge_id, j</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  </div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  </div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(code)) <span class="keywordflow">then</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        code = 2</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      </div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        edge_id = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        i = pde_loc%permut(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keyword">call </span>pde_loc%pde_fnc(1)%dispersion(pde_loc, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el_id,1),<span class="comment"> x=(/<a class="code" href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_common</a>%xvect(i,2)/), &amp;</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">                              tensor=k(1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen, 1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen))</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">        gravflux(1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen) = k(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen, 1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)*<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">        </span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">        </span><span class="keywordflow">if</span> (pde_loc%bc(edge_id)%file) <span class="keywordflow">then</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;          <span class="keywordflow">do</span> i=1, ubound(pde_loc%bc(edge_id)%series,1)</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%series(i,1) &gt; <a class="code" href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">time</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;              <span class="keywordflow">if</span> (i &gt; 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                j = i-1</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                j = i</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;              bcval = pde_loc%bc(edge_id)%series(j,2)</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;          bcval = pde_loc%bc(edge_id)%value</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        </div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">if</span> (bcval &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;          quadpnt%type_pnt = <span class="stringliteral">&quot;ndpt&quot;</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;          quadpnt%order = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id,node_order)</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;          layer = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el_id,1)</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;          theta =  pde_loc%mass(layer, quadpnt)</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;          bcval = bcval*(theta*theta)**(1.0_rkind/3.0_rkind)</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          </div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          </div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;         <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;              <span class="keywordtype">value</span> = bcval - gravflux(1)</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;              bcflux(1) = sqrt(1-<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)*<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z<span class="comment">(el_id, node_order))*bcval</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment">              bcflux(2) = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)*bcval</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">              bcflux = bcflux + gravflux</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">              </span><span class="keywordtype">value</span> = sqrt(bcflux(1)*bcflux(1) + bcflux(2)*bcflux(2))</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="comment">!         print *, value, gravflux, el_id, elements%data(el_id,:) ; stop </span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="keywordflow">          end select</span> </div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        </div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        </div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      </div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      </div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacepde__objs_html_a177df2f43aeb5ecde4cca531ecfbf4a1"><div class="ttname"><a href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_objs::pde_common</a></div><div class="ttdeci">type(pde_common_str), public pde_common</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00298">pde_objs.f90:298</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a2df3573bca73071127516bac8a69d587"><div class="ttname"><a href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">globals::time</a></div><div class="ttdeci">real(kind=rkind), public time</div><div class="ttdoc">the total time value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00137">globals.f90:137</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a95e6667a128b87ca0a7781209e30b1ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::re_dirichlet_bc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>node_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01712">1712</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="globals_8f90_source.html#l00137">globals::time</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00106">re_pointers::re_pressheadbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>  :: el_id, node_order</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: value</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: code</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: edge_id, i, j</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        </div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        edge_id = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;          <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%file) <span class="keywordflow">then</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="keywordflow">do</span> i=1, ubound(pde_loc%bc(edge_id)%series,1)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;              <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%series(i,1) &gt; <a class="code" href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">time</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                <span class="keywordflow">if</span> (i &gt; 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                  j = i-1</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                  j = i</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                <span class="keywordtype">value</span> = pde_loc%bc(edge_id)%series(j,2)</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordtype">value</span> = pde_loc%bc(edge_id)%value</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(code)) <span class="keywordflow">then</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          code = 1</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="keywordflow">        end if</span></div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a2df3573bca73071127516bac8a69d587"><div class="ttname"><a href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">globals::time</a></div><div class="ttdeci">real(kind=rkind), public time</div><div class="ttdoc">the total time value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00137">globals.f90:137</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a95e6667a128b87ca0a7781209e30b1ac_icgraph.png" border="0" usemap="#namespacere__constitutive_a95e6667a128b87ca0a7781209e30b1ac_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a95e6667a128b87ca0a7781209e30b1ac_icgraph" id="namespacere__constitutive_a95e6667a128b87ca0a7781209e30b1ac_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a660abf4ac431829386d63fa9f72a71cb" title="re_pointers::re_pressheadbc" alt="" coords="180,31,367,57"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="417,5,543,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="415,56,545,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="593,23,740,65"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="788,31,839,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3166c88db2634fc8fcc9d579358676d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::re_dirichlet_height_bc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>node_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01775">1775</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="globals_8f90_source.html#l00137">globals::time</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00106">re_pointers::re_pressheadbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        </div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>  :: el_id, node_order</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: value</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: code</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        </div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: edge_id, i, j</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: tempval, node_height</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        </div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;          edge_id = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;          node_height = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order), <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%file) <span class="keywordflow">then</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            <span class="keywordflow">do</span> i=1, ubound(pde_loc%bc(edge_id)%series,1)</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;              <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%series(i,1) &gt; <a class="code" href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">time</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                <span class="keywordflow">if</span> (i &gt; 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                  j = i-1</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                  j = i</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                tempval = pde_loc%bc(edge_id)%series(j,2)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            tempval =  pde_loc%bc(edge_id)%value</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;          </div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;          <span class="keywordtype">value</span> = tempval - node_height</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        </div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(code)) <span class="keywordflow">then</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;          code = 1</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        </div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a2df3573bca73071127516bac8a69d587"><div class="ttname"><a href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">globals::time</a></div><div class="ttdeci">real(kind=rkind), public time</div><div class="ttdoc">the total time value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00137">globals.f90:137</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a3166c88db2634fc8fcc9d579358676d0_icgraph.png" border="0" usemap="#namespacere__constitutive_a3166c88db2634fc8fcc9d579358676d0_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a3166c88db2634fc8fcc9d579358676d0_icgraph" id="namespacere__constitutive_a3166c88db2634fc8fcc9d579358676d0_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a660abf4ac431829386d63fa9f72a71cb" title="re_pointers::re_pressheadbc" alt="" coords="191,31,377,57"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="427,5,554,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="425,56,556,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="604,23,751,65"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="799,31,849,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7a0c1ec8d57856234ae33b61eab450f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::re_initcond </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>pde_loc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01976">1976</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="re__constitutive_8f90_source.html#l00182">inverse_vangen()</a>, <a class="el" href="geom__tools_8f90_source.html#l01122">geom_tools::map1d2dj()</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00030">re_pointers::re_rot()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00057">re_pointers::re_std()</a>.</p>
<div class="fragment"><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacegeom__tools.html">geom_tools</a></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        </div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in out)</span> :: pde_loc</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i, j, k,l, m, layer, d</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: value</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        </div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        d = <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordflow">select case</span> (<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(1_ikind)%icondtype)</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&quot;input&quot;</span>)</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845">map1d2dj</a>(pde_loc,<span class="stringliteral">&quot;drutes.conf/water.conf/hini.in&quot;</span>)</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keywordflow">        end select</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        </div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">do</span> i=1, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;          layer = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(i,1)</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          <span class="keywordflow">do</span> j=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            k = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(i,j)</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            l = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(k)</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            m = pde_loc%permut(k)</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;              <span class="keyword">call </span>pde_loc%bc(l)%value_fnc(pde_loc, i, j, <span class="keywordtype">value</span>)</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;              pde_loc%solution(k) =  <span class="keywordtype">value</span> </div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;              <span class="keywordflow">select case</span> (<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%icondtype)</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                <span class="keywordflow">case</span>(<span class="stringliteral">&quot;H_tot&quot;</span>)</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                  pde_loc%solution(k) = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%initcond - <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d)</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                <span class="keywordflow">case</span>(<span class="stringliteral">&quot;hpres&quot;</span>)</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                  pde_loc%solution(k) = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%initcond </div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                <span class="keywordflow">case</span>(<span class="stringliteral">&quot;theta&quot;</span>)</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                  <span class="keywordtype">value</span> = <a class="code" href="namespacere__constitutive.html#a6cc0f4bc06a19ad696d83967878a54fb">inverse_vangen</a>(pde_loc, layer, x=(/<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%initcond/))</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                  pde_loc%solution(k) = <span class="keywordtype">value</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="keywordflow">              end select</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="keywordflow">          end do</span>   </div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        </div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        </div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacegeom__tools_html"><div class="ttname"><a href="namespacegeom__tools.html">geom_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00015">geom_tools.f90:15</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a6cc0f4bc06a19ad696d83967878a54fb"><div class="ttname"><a href="namespacere__constitutive.html#a6cc0f4bc06a19ad696d83967878a54fb">re_constitutive::inverse_vangen</a></div><div class="ttdeci">real(kind=rkind) function, public inverse_vangen(pde_loc, layer, quadpnt, x)</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00182">re_constitutive.f90:182</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a5a6548d90c258b44ecc6d58dd159b845"><div class="ttname"><a href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845">geom_tools::map1d2dj</a></div><div class="ttdeci">subroutine, public map1d2dj(pde_loc, filename)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l01122">geom_tools.f90:1122</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_cgraph.png" border="0" usemap="#namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_cgraph" id="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a6cc0f4bc06a19ad696d83967878a54fb" title="re_constitutive::inverse\l_vangen" alt="" coords="180,19,337,61"/>
<area shape="rect" id="node4" href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845" title="geom_tools::map1d2dj" alt="" coords="182,107,335,133"/>
<area shape="rect" id="node3" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="385,5,528,32"/>
<area shape="rect" id="node5" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="388,56,525,83"/>
<area shape="rect" id="node6" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e" title="dummy functions, the pointer procedure is set to this function in case if not being considered ..." alt="" coords="403,107,511,133"/>
<area shape="rect" id="node7" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="390,157,523,184"/>
<area shape="rect" id="node8" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="387,208,526,235"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_icgraph.png" border="0" usemap="#namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_icgraph" id="namespacere__constitutive_a7a0c1ec8d57856234ae33b61eab450f2_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="182,5,309,32"/>
<area shape="rect" id="node5" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="180,56,311,83"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="359,23,505,65"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="553,31,604,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1067d48cafe8d4463ae78102b1e01b84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::re_neumann_bc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>node_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01827">1827</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, <a class="el" href="pde__objs_8f90_source.html#l00298">pde_objs::pde_common</a>, and <a class="el" href="globals_8f90_source.html#l00137">globals::time</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00106">re_pointers::re_pressheadbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>  :: el_id, node_order</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: value</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: code</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        </div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3,3)</span> :: k</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i, edge_id, j</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span> :: gravflux, bcflux</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: bcval, gfluxval</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordtype">integer</span> :: i1</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      </div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;          edge_id = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;          i = pde_loc%permut(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, node_order))</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          <span class="keyword">call </span>pde_loc%pde_fnc(1)%dispersion(pde_loc, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el_id,1), x=(/<a class="code" href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_common</a>%xvect(i,2)/), &amp;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                              tensor=k(1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen, 1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen))</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;          gravflux(1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen) = k(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen, 1:<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)*<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          </div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;          <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%file) <span class="keywordflow">then</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <span class="keywordflow">do</span> i=1, ubound(pde_loc%bc(edge_id)%series,1)</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;              <span class="keywordflow">if</span> (pde_loc%bc(edge_id)%series(i,1) &gt; <a class="code" href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">time</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                <span class="keywordflow">if</span> (i &gt; 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                  j = i-1</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                  j = i</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                bcval = pde_loc%bc(edge_id)%series(j,2)</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            bcval = pde_loc%bc(edge_id)%value</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          </div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;          </div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;              <span class="keywordtype">value</span> = bcval - gravflux(1)</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;              bcflux(1) = sqrt(1-<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)*<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order))*bcval</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;              bcflux(2) = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%nvect_z(el_id, node_order)*bcval</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;              bcflux = bcflux + gravflux</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;              <span class="keywordtype">value</span> = sqrt(bcflux(1)*bcflux(1) + bcflux(2)*bcflux(2))</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="comment">!         print *, value, gravflux, el_id, elements%data(el_id,:) ; stop </span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="keywordflow">          end select</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        </div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;       <span class="keywordflow">if</span> (<span class="keyword">present</span>(code)) <span class="keywordflow">then</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;          code = 2</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacepde__objs_html_a177df2f43aeb5ecde4cca531ecfbf4a1"><div class="ttname"><a href="namespacepde__objs.html#a177df2f43aeb5ecde4cca531ecfbf4a1">pde_objs::pde_common</a></div><div class="ttdeci">type(pde_common_str), public pde_common</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00298">pde_objs.f90:298</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a2df3573bca73071127516bac8a69d587"><div class="ttname"><a href="namespaceglobals.html#a2df3573bca73071127516bac8a69d587">globals::time</a></div><div class="ttdeci">real(kind=rkind), public time</div><div class="ttdoc">the total time value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00137">globals.f90:137</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a1067d48cafe8d4463ae78102b1e01b84_icgraph.png" border="0" usemap="#namespacere__constitutive_a1067d48cafe8d4463ae78102b1e01b84_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a1067d48cafe8d4463ae78102b1e01b84_icgraph" id="namespacere__constitutive_a1067d48cafe8d4463ae78102b1e01b84_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a660abf4ac431829386d63fa9f72a71cb" title="re_pointers::re_pressheadbc" alt="" coords="180,31,367,57"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="417,5,543,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="415,56,545,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="593,23,740,65"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="788,31,839,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf76632a958340d25d948fafea6a16c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public re_constitutive::re_null_bc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>node_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01752">1752</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>, <a class="el" href="re__pointers_8f90_source.html#l00106">re_pointers::re_pressheadbc()</a>, and <a class="el" href="re__pointers_8f90_source.html#l00141">re_pointers::re_totheadbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        </div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>  :: el_id, node_order</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>    :: value</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: code</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;          <span class="keywordtype">value</span> = 0.0_rkind</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(code)) <span class="keywordflow">then</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;          code = 2</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        </div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_aaf76632a958340d25d948fafea6a16c9_icgraph.png" border="0" usemap="#namespacere__constitutive_aaf76632a958340d25d948fafea6a16c9_icgraph" alt=""/></div>
<map name="namespacere__constitutive_aaf76632a958340d25d948fafea6a16c9_icgraph" id="namespacere__constitutive_aaf76632a958340d25d948fafea6a16c9_icgraph">
<area shape="rect" id="node2" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="205,5,341,47"/>
<area shape="rect" id="node5" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="205,71,341,112"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a660abf4ac431829386d63fa9f72a71cb" title="re_pointers::re_pressheadbc" alt="" coords="180,137,367,163"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#ad0da880edec99cec0e70b76e0819172d" title="re_pointers::re_totheadbc" alt="" coords="189,215,358,242"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="593,132,740,173"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="788,139,839,166"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="417,114,543,141"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="415,165,545,191"/>
<area shape="rect" id="node10" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="417,215,543,242"/>
<area shape="rect" id="node11" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="415,266,545,293"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade7567448cbab0c91885d4d3f48e03a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=rkind) function, private re_constitutive::secondder_retc </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>input pressure head, van genuchten's parameters are obtained from variable van_gen_coeff</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting curvature </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01595">1595</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00024">this_layer</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01394">init_zones()</a>.</p>
<div class="fragment"><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: h</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: curvature</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="comment">!!!!--local variables------</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: a, n, m, tr, ts</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(<a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>)%alpha</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(<a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>)%n</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(<a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>)%m</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        tr = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(<a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>)%Thr</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        ts = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(<a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>)%Ths</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="keywordflow">if</span>( h &lt; 0.0_rkind) <span class="keywordflow">then</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          curvature = -(a**2*(-(a*h))**(-2 + n)*(1 + (-(a*h))**n)**(-1 - m)*m*(-1 + n)*n* &amp;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;              (-tr + ts)) - a**2*(-(a*h))**(-2 + 2*n)*(1 + (-(a*h))**n)**(-2 - m)*(-1 - m)* &amp;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            m*n**2*(-tr + ts)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          curvature = 0.0_rkind</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        </div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a957329345fdf54666f10d5a560c219db"><div class="ttname"><a href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">re_constitutive::this_layer</a></div><div class="ttdeci">integer(kind=ikind), private this_layer</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00024">re_constitutive.f90:24</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_ade7567448cbab0c91885d4d3f48e03a2_icgraph.png" border="0" usemap="#namespacere__constitutive_ade7567448cbab0c91885d4d3f48e03a2_icgraph" alt=""/></div>
<map name="namespacere__constitutive_ade7567448cbab0c91885d4d3f48e03a2_icgraph" id="namespacere__constitutive_ade7567448cbab0c91885d4d3f48e03a2_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c" title="re_constitutive::init\l_zones" alt="" coords="257,74,389,115"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="437,81,601,108"/>
<area shape="rect" id="node4" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="651,5,778,32"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="651,56,778,83"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="649,107,780,133"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="649,157,780,184"/>
<area shape="rect" id="node5" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="828,74,975,115"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1023,81,1073,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeb4dd7b9faf9bb8efaa4b60cfb5fc722"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private re_constitutive::setmatflux </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l02023">2023</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, and <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>.</p>
<div class="fragment"><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        </div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i, j, vecino, id, k, l, nd, ndvec</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        </div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        id = maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge) + 100</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">do</span> i=1, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;          <span class="keywordflow">do</span> j=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%neighbours,2)</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            vecino = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%neighbours(i,j)</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            <span class="keywordflow">if</span> (vecino /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(i,1) /= <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(vecino,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                <span class="keywordflow">do</span> k=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                  nd = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(i, k)</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                  <span class="keywordflow">do</span> l=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                    ndvec = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(vecino, l)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                    <span class="keywordflow">if</span> (nd == ndvec) <span class="keywordflow">then</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                      <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(nd) = -id</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="keywordflow">                  end do</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        </div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      </div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33a509607909bb5e6b33c6d2ba2247e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::sinkterm </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return value </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01045">1045</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      </div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>                :: val</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      val = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%sinkterm</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;     </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    </div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a33a509607909bb5e6b33c6d2ba2247e2_icgraph.png" border="0" usemap="#namespacere__constitutive_a33a509607909bb5e6b33c6d2ba2247e2_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a33a509607909bb5e6b33c6d2ba2247e2_icgraph" id="namespacere__constitutive_a33a509607909bb5e6b33c6d2ba2247e2_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="219,81,383,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="433,5,559,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="433,56,559,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="431,107,561,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="431,157,561,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="609,74,756,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="804,81,855,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6bfdd98c01994ec23b252bfb214199bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine re_constitutive::tabvalues </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Kfnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dKdhfnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Cfnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thetafnc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>creates a table of values of constitutive functions for the Richards equation to be linearly approximated </p>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01249">1249</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00021">dkdhtab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">dkdhtab_all</a>, <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">ktab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">ktab_all</a>, <a class="el" href="globals_8f90_source.html#l00055">globals::maxpress</a>, <a class="el" href="printtools_8f90_source.html#l00010">printtools::progressbar()</a>, <a class="el" href="re__globals_8f90_source.html#l00033">re_globals::vgmatrix</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">warecatab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">warecatab_all</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">watcontab</a>, <a class="el" href="re__constitutive_8f90_source.html#l00022">watcontab_all</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_cgraph.png" border="0" usemap="#namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_cgraph" id="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a4902efda05309f68b332f0ff35b701ac" title="re_constitutive::domainswitch" alt="" coords="224,5,419,32"/>
<area shape="rect" id="node3" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068" title="if default output is stdout, then this procedure prints nice progress bar " alt="" coords="246,56,397,83"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="250,107,393,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_icgraph.png" border="0" usemap="#namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_icgraph" id="namespacere__constitutive_a6bfdd98c01994ec23b252bfb214199bd_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="224,81,388,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="438,5,565,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="438,56,565,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="436,107,567,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="436,157,567,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="615,74,761,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="809,81,860,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a331b5dac127bd2b449ffdecf9e3714"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::vangen </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Van Genuchten relation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta = f(pressure) \]" src="form_4.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta_e = \frac{1}{(1+(\alpha*h)^n)^m} \]" src="form_5.png"/>
</p>
<p> water content is considered as absolute value not the relative one <br />
 see </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta_e = \frac{\theta - \theta_r}{\theta_s-\theta_r} \]" src="form_6.png"/>
</p>
<p>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting water content </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00062">62</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00338">vangen_elast()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01570">zone_error_val()</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: a,n,m, theta_e</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        error stop</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        error stop</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          error stop</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        h = x(1)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%n</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%m</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (h &gt;=0.0_rkind) <span class="keywordflow">then</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          theta = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          theta_e = 1/(1+(a*(abs(h)))**n)**m</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          theta = theta_e*(<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths-<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr)+<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a5a331b5dac127bd2b449ffdecf9e3714_icgraph.png" border="0" usemap="#namespacere__constitutive_a5a331b5dac127bd2b449ffdecf9e3714_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a5a331b5dac127bd2b449ffdecf9e3714_icgraph" id="namespacere__constitutive_a5a331b5dac127bd2b449ffdecf9e3714_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="852,82,1016,109"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029" title="so&#45;called retention water capacity, it is a derivative to retention curve function &#160;E(h) = C(h) + {(h..." alt="" coords="211,75,368,116"/>
<area shape="rect" id="node11" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a" title="re_constitutive::zone\l_error_val" alt="" coords="436,134,579,175"/>
<area shape="rect" id="node13" href="namespacere__constitutive.html#a21d8dd738d02ef5a1501b79f7b80f50b" title="re_constitutive::vangen_tab" alt="" coords="416,202,599,229"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="1066,6,1193,33"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="1066,57,1193,84"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="1064,108,1195,134"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="1064,158,1195,185"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="1243,75,1389,116"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1437,82,1488,109"/>
<area shape="rect" id="node10" href="namespacere__constitutive.html#aa39d302eed50bc490b34dd310caf7ed8" title="re_constitutive::vangen\l_elast_tab" alt="" coords="647,75,804,116"/>
<area shape="rect" id="node12" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c" title="re_constitutive::init\l_zones" alt="" coords="659,140,791,182"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a36b172485f285a7c37b92d738eb21029"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::vangen_elast </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>so-called retention water capacity, it is a derivative to retention curve function  E(h) = C(h) + {(h)}{}S_s ] where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ C(h) = \left\{ \begin{array}{l l}\frac{m n \alpha (-h \alpha )^{-1+n}}{\left(1+(-h \alpha )^n\right)^{1+m}}(\theta_s - \theta_r) , &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ 0, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_8.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta(h) = \left\{ \begin{array}{l l} \frac{\theta_s -\theta_r}{(1+(-\alpha h)^n_{vg})^m_{vg}} + \theta_r, &amp; \quad \mbox{$\forall$ $h \in (-\infty, 0 )$}\\ \theta_S, &amp; \quad \mbox{$\forall$ $h \in \langle 0, + \infty )$}\\ \end{array} \right. \]" src="form_9.png"/>
</p>
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting system elasticity </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00338">338</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00062">vangen()</a>, and <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01570">zone_error_val()</a>.</p>
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc </div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>,  <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: e</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: c, a, m, n, tr, ts </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc      </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      </div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        error stop</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        error stop</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          error stop</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast&quot;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          error stop</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        h = x(1)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (h &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        a = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%alpha</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        n = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%n</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        m = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%m</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        tr = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Thr</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        ts = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        c = a*m*n*(-tr + ts)*(-(a*h))**(-1 + n)*(1 + (-(a*h))**n)**(-1 - m)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        e = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ss</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      e = c + <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(pde_loc, layer, x=(/h/))/<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths*<a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer<span class="comment">)%Ss</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span></div><span class="comment"><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a5a331b5dac127bd2b449ffdecf9e3714"><div class="ttname"><a href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">re_constitutive::vangen</a></div><div class="ttdeci">real(kind=rkind) function, public vangen(pde_loc, layer, quadpnt, x)</div><div class="ttdoc">Van Genuchten relation   water content is considered as absolute value not the relative one   see ...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00062">re_constitutive.f90:62</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_cgraph.png" border="0" usemap="#namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_cgraph" id="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714" title="Van Genuchten relation &#160;&#160;water content is considered as absolute value not the relative one &#160;&#160;see ..." alt="" coords="211,13,368,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_icgraph.png" border="0" usemap="#namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_icgraph" id="namespacere__constitutive_a36b172485f285a7c37b92d738eb21029_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="607,81,771,108"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#aa39d302eed50bc490b34dd310caf7ed8" title="re_constitutive::vangen\l_elast_tab" alt="" coords="401,74,559,115"/>
<area shape="rect" id="node10" href="namespacere__constitutive.html#a6c717771e468878eec01e1aa2a27ba7a" title="re_constitutive::zone\l_error_val" alt="" coords="211,135,353,177"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="821,5,947,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="821,56,947,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="819,107,949,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="819,157,949,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="997,74,1144,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1192,81,1243,108"/>
<area shape="rect" id="node11" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c" title="re_constitutive::init\l_zones" alt="" coords="414,139,546,181"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa39d302eed50bc490b34dd310caf7ed8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::vangen_elast_tab </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting system elasticity </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00471">471</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00039">intoverflow()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00032">intwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00027">tabmsg</a>, <a class="el" href="re__constitutive_8f90_source.html#l00026">tabwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00338">vangen_elast()</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">warecatab</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: e</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: pos</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: res, <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc     </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;         </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast_tab&quot;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        error stop</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast_tab&quot;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        error stop</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_elast_tab&quot;</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          error stop</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        h = x(1)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">if</span> (h&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">if</span> ( h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length &lt; 0.1*huge(1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          pos = int(-h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <span class="keywordflow">if</span> (pos &lt;= ubound(<a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a>,2)-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> = -h - (pos - 1)*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            e = (<a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a>(layer,pos+1)-<a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a>(layer,pos))/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length<span class="comment">*<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> + <a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a>(layer,pos)</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">          </span><span class="keywordflow">else</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) e = <a class="code" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a>(pde_loc, layer, quadpnt)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) e = <a class="code" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a>(pde_loc, layer, x=x)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(trim(<a class="code" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a>))</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;              <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .true.</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;         </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">intoverflow</a>()</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .true.</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) e = <a class="code" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a>(pde_loc, layer, quadpnt_loc)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) e = <a class="code" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a>(pde_loc, layer, x=x)   </div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordflow">        end if</span> </div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        e = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ss     </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aaab88fb88c11ce508ad8240a96275a6b"><div class="ttname"><a href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">re_constitutive::intoverflow</a></div><div class="ttdeci">subroutine, private intoverflow()</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00039">re_constitutive.f90:39</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a97cae19740749808642dcd2fb326ddb1"><div class="ttname"><a href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">re_constitutive::warecatab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public warecatab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a732d67fdcdd4cdc0fb573d3c9e96ba85"><div class="ttname"><a href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">re_constitutive::tabwarning</a></div><div class="ttdeci">logical, private tabwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00026">re_constitutive.f90:26</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a44ecaf75690494449561f9c55f1a142d"><div class="ttname"><a href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">re_constitutive::tabmsg</a></div><div class="ttdeci">character(len=4096), private tabmsg</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00027">re_constitutive.f90:27</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a36b172485f285a7c37b92d738eb21029"><div class="ttname"><a href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">re_constitutive::vangen_elast</a></div><div class="ttdeci">real(kind=rkind) function, public vangen_elast(pde_loc, layer, quadpnt, x)</div><div class="ttdoc">so-called retention water capacity, it is a derivative to retention curve function  E(h) = C(h) + {(h...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00338">re_constitutive.f90:338</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aa375bb88f1a33731026e0fd7b7c195c6"><div class="ttname"><a href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">re_constitutive::intwarning</a></div><div class="ttdeci">logical, private intwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00032">re_constitutive.f90:32</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_cgraph.png" border="0" usemap="#namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_cgraph" alt=""/></div>
<map name="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_cgraph" id="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b" title="re_constitutive::intoverflow" alt="" coords="211,157,389,184"/>
<area shape="rect" id="node8" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="643,208,785,235"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029" title="so&#45;called retention water capacity, it is a derivative to retention curve function &#160;E(h) = C(h) + {(h..." alt="" coords="221,259,379,301"/>
<area shape="rect" id="node3" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="447,107,585,133"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="645,5,783,32"/>
<area shape="rect" id="node5" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="645,56,783,83"/>
<area shape="rect" id="node6" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="649,107,779,133"/>
<area shape="rect" id="node7" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="645,157,783,184"/>
<area shape="rect" id="node10" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714" title="Van Genuchten relation &#160;&#160;water content is considered as absolute value not the relative one &#160;&#160;see ..." alt="" coords="437,267,595,293"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_icgraph.png" border="0" usemap="#namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_icgraph" alt=""/></div>
<map name="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_icgraph" id="namespacere__constitutive_aa39d302eed50bc490b34dd310caf7ed8_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="211,81,375,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="425,5,551,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="425,56,551,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="423,107,553,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="423,157,553,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="601,74,748,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="796,81,847,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21d8dd738d02ef5a1501b79f7b80f50b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public re_constitutive::vangen_tab </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>pressure head</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting water content </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00251">251</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="re__constitutive_8f90_source.html#l00039">intoverflow()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00032">intwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00027">tabmsg</a>, <a class="el" href="re__constitutive_8f90_source.html#l00026">tabwarning</a>, <a class="el" href="re__constitutive_8f90_source.html#l00062">vangen()</a>, <a class="el" href="re__globals_8f90_source.html#l00055">re_globals::vgset</a>, <a class="el" href="re__constitutive_8f90_source.html#l00021">watcontab</a>, and <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__pointers_8f90_source.html#l00179">re_pointers::allrepointers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__globals.html">re_globals</a></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: x</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: h</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: theta</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: pos</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: res, <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc      </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt) .and. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: the function can be called either with integ point or x value definition, not both of them&quot;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_tab&quot;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        error stop</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(quadpnt) .and. .not. <span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        print *, <span class="stringliteral">&quot;ERROR: you have not specified either integ point or x value&quot;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_tab&quot;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        error stop</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          print *, <span class="stringliteral">&quot;exited from re_constitutive::vangen_tab&quot;</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          error stop</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        h = x(1)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (h&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> ( h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length &lt; 0.1*huge(1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          pos = int(-h/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length)+1</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordflow">if</span> (pos &lt;= ubound(<a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a>,2)-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> = -h - (pos - 1)*<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            theta = (<a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a>(layer,pos+1)-<a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a>(layer,pos))/<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%fnc_discr_length<span class="comment">*<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> + <a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a>(layer,pos)</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">          </span><span class="keywordflow">else</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) theta = <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(pde_loc, layer, quadpnt)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) theta = <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(pde_loc, layer, x=x)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">write_log</a>(trim(<a class="code" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a>))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;              <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .true.</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="keywordflow">if</span> (.not. <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">intoverflow</a>()</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .true.</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        </div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) theta = <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(pde_loc, layer, quadpnt)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) theta = <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(pde_loc, layer, x=x)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        theta = <a class="code" href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">vgset</a>(layer)%Ths        </div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="ttc" id="namespacere__globals_html_a8282c0352c56a66d819c88b9a4a84c34"><div class="ttname"><a href="namespacere__globals.html#a8282c0352c56a66d819c88b9a4a84c34">re_globals::vgset</a></div><div class="ttdeci">type(soilpar), dimension(:), pointer, public vgset</div><div class="ttdoc">depending on current domain, this pointer is pointed to current parameters as if (domain == matrix) v...</div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00055">re_globals.f90:55</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aaab88fb88c11ce508ad8240a96275a6b"><div class="ttname"><a href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b">re_constitutive::intoverflow</a></div><div class="ttdeci">subroutine, private intoverflow()</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00039">re_constitutive.f90:39</a></div></div>
<div class="ttc" id="namespacere__globals_html"><div class="ttname"><a href="namespacere__globals.html">re_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00001">re_globals.f90:1</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a5a331b5dac127bd2b449ffdecf9e3714"><div class="ttname"><a href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">re_constitutive::vangen</a></div><div class="ttdeci">real(kind=rkind) function, public vangen(pde_loc, layer, quadpnt, x)</div><div class="ttdoc">Van Genuchten relation   water content is considered as absolute value not the relative one   see ...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00062">re_constitutive.f90:62</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a732d67fdcdd4cdc0fb573d3c9e96ba85"><div class="ttname"><a href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">re_constitutive::tabwarning</a></div><div class="ttdeci">logical, private tabwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00026">re_constitutive.f90:26</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a44ecaf75690494449561f9c55f1a142d"><div class="ttname"><a href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">re_constitutive::tabmsg</a></div><div class="ttdeci">character(len=4096), private tabmsg</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00027">re_constitutive.f90:27</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a3d4ff1bd9e37d274bb888db1d630ddbb"><div class="ttname"><a href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">re_constitutive::watcontab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public watcontab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacecore__tools_html_abe09f9b4dc2abc5384a24020c5031e95"><div class="ttname"><a href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95">core_tools::write_log</a></div><div class="ttdeci">subroutine, public write_log(text, real1, int1, text2, real2, int2, text3, real3, int3, hidden)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00041">core_tools.f90:41</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aa375bb88f1a33731026e0fd7b7c195c6"><div class="ttname"><a href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">re_constitutive::intwarning</a></div><div class="ttdeci">logical, private intwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00032">re_constitutive.f90:32</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_cgraph.png" border="0" usemap="#namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_cgraph" id="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#aaab88fb88c11ce508ad8240a96275a6b" title="re_constitutive::intoverflow" alt="" coords="236,157,415,184"/>
<area shape="rect" id="node8" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="648,208,791,235"/>
<area shape="rect" id="node9" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714" title="Van Genuchten relation &#160;&#160;water content is considered as absolute value not the relative one &#160;&#160;see ..." alt="" coords="247,259,404,285"/>
<area shape="rect" id="node3" href="namespacepostpro.html#a21af39d8fdc38e6b736346450f99fece" title="postpro::make_print" alt="" coords="463,107,600,133"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="650,5,789,32"/>
<area shape="rect" id="node5" href="namespacepostpro.html#a075d651e98dee329985f2b054ba54415" title="postpro::print_gmsh" alt="" coords="651,56,788,83"/>
<area shape="rect" id="node6" href="namespacepostpro.html#ac9d752e3b26cac769ba607b84791ba2a" title="postpro::print_pure" alt="" coords="654,107,785,133"/>
<area shape="rect" id="node7" href="namespacepostpro.html#a30f6a138dc9108e16310e8c9ec415a8a" title="postpro::print_scilab" alt="" coords="650,157,789,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_icgraph.png" border="0" usemap="#namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_icgraph" id="namespacere__constitutive_a21d8dd738d02ef5a1501b79f7b80f50b_icgraph">
<area shape="rect" id="node2" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="236,81,400,108"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="450,5,577,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="450,56,577,83"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="448,107,579,133"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="448,157,579,184"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="627,74,773,115"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="821,81,872,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6c717771e468878eec01e1aa2a27ba7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, private re_constitutive::zone_error_val </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>htest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>taylor_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>starting point</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">htest</td><td>point to be evaluated</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">taylor_max</td><td>maximal error of taylor series</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error value of first order taylor approximation starting at point h and evaluating at point htest </dd></dl>

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l01570">1570</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>References <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>, <a class="el" href="re__constitutive_8f90_source.html#l00024">this_layer</a>, <a class="el" href="re__constitutive_8f90_source.html#l00062">vangen()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00338">vangen_elast()</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01394">init_zones()</a>.</p>
<div class="fragment"><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: h</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: htest</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: taylor_max</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: err_val</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        err_val=abs(<a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(1), <a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>, x=(/h/)) + <a class="code" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">vangen_elast</a>(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(1), <a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>, x=(/htest/))*(htest-h)- &amp;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                <a class="code" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">vangen</a>(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(1), <a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a>, x=(/htest/))) - taylor_max</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="ttc" id="namespacere__constitutive_html_a5a331b5dac127bd2b449ffdecf9e3714"><div class="ttname"><a href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714">re_constitutive::vangen</a></div><div class="ttdeci">real(kind=rkind) function, public vangen(pde_loc, layer, quadpnt, x)</div><div class="ttdoc">Van Genuchten relation   water content is considered as absolute value not the relative one   see ...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00062">re_constitutive.f90:62</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a957329345fdf54666f10d5a560c219db"><div class="ttname"><a href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">re_constitutive::this_layer</a></div><div class="ttdeci">integer(kind=ikind), private this_layer</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00024">re_constitutive.f90:24</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a36b172485f285a7c37b92d738eb21029"><div class="ttname"><a href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029">re_constitutive::vangen_elast</a></div><div class="ttdeci">real(kind=rkind) function, public vangen_elast(pde_loc, layer, quadpnt, x)</div><div class="ttdoc">so-called retention water capacity, it is a derivative to retention curve function  E(h) = C(h) + {(h...</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00338">re_constitutive.f90:338</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_cgraph.png" border="0" usemap="#namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_cgraph" alt=""/></div>
<map name="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_cgraph" id="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_cgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a5a331b5dac127bd2b449ffdecf9e3714" title="Van Genuchten relation &#160;&#160;water content is considered as absolute value not the relative one &#160;&#160;see ..." alt="" coords="401,13,559,39"/>
<area shape="rect" id="node3" href="namespacere__constitutive.html#a36b172485f285a7c37b92d738eb21029" title="so&#45;called retention water capacity, it is a derivative to retention curve function &#160;E(h) = C(h) + {(h..." alt="" coords="196,35,353,76"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_icgraph.png" border="0" usemap="#namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_icgraph" alt=""/></div>
<map name="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_icgraph" id="namespacere__constitutive_a6c717771e468878eec01e1aa2a27ba7a_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c" title="re_constitutive::init\l_zones" alt="" coords="196,74,328,115"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="376,81,540,108"/>
<area shape="rect" id="node4" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="590,5,717,32"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="590,56,717,83"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="588,107,719,133"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="588,157,719,184"/>
<area shape="rect" id="node5" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="767,74,913,115"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="961,81,1012,108"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a208992652d12a3b477dff42e9df5be7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:), pointer, public re_constitutive::dkdhtab</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00021">21</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>

</div>
</div>
<a class="anchor" id="aef95ec1b86499eb41011942a9cf53ce8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:,:), allocatable, target, public re_constitutive::dkdhtab_all</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00022">22</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>

</div>
</div>
<a class="anchor" id="aa375bb88f1a33731026e0fd7b7c195c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private re_constitutive::intwarning = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00032">32</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">private</span> :: <a class="code" href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">intwarning</a> = .false.</div><div class="ttc" id="namespacere__constitutive_html_aa375bb88f1a33731026e0fd7b7c195c6"><div class="ttname"><a href="namespacere__constitutive.html#aa375bb88f1a33731026e0fd7b7c195c6">re_constitutive::intwarning</a></div><div class="ttdeci">logical, private intwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00032">re_constitutive.f90:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a26f9eee4bd880098c0ac3bf055da68db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:), pointer, public re_constitutive::ktab</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00021">21</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">public</span> :: <a class="code" href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">ktab</a>, <a class="code" href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">dkdhtab</a>, <a class="code" href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">warecatab</a>, <a class="code" href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">watcontab</a></div><div class="ttc" id="namespacere__constitutive_html_a208992652d12a3b477dff42e9df5be7f"><div class="ttname"><a href="namespacere__constitutive.html#a208992652d12a3b477dff42e9df5be7f">re_constitutive::dkdhtab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public dkdhtab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a97cae19740749808642dcd2fb326ddb1"><div class="ttname"><a href="namespacere__constitutive.html#a97cae19740749808642dcd2fb326ddb1">re_constitutive::warecatab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public warecatab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a3d4ff1bd9e37d274bb888db1d630ddbb"><div class="ttname"><a href="namespacere__constitutive.html#a3d4ff1bd9e37d274bb888db1d630ddbb">re_constitutive::watcontab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public watcontab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a26f9eee4bd880098c0ac3bf055da68db"><div class="ttname"><a href="namespacere__constitutive.html#a26f9eee4bd880098c0ac3bf055da68db">re_constitutive::ktab</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:), pointer, public ktab</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00021">re_constitutive.f90:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe17d121c5500a37fef85872e51138ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:,:), allocatable, target, public re_constitutive::ktab_all</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00022">22</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">target</span>, <span class="keywordtype">public</span> :: <a class="code" href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">ktab_all</a>, <a class="code" href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">dkdhtab_all</a>, <a class="code" href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">warecatab_all</a>, <a class="code" href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">watcontab_all</a></div><div class="ttc" id="namespacere__constitutive_html_a3249b973baf1fa0d41eb4cd2784a384b"><div class="ttname"><a href="namespacere__constitutive.html#a3249b973baf1fa0d41eb4cd2784a384b">re_constitutive::watcontab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public watcontab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_a5b2162aa59a163afc487ea11d76326d5"><div class="ttname"><a href="namespacere__constitutive.html#a5b2162aa59a163afc487ea11d76326d5">re_constitutive::warecatab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public warecatab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_afe17d121c5500a37fef85872e51138ff"><div class="ttname"><a href="namespacere__constitutive.html#afe17d121c5500a37fef85872e51138ff">re_constitutive::ktab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public ktab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_aef95ec1b86499eb41011942a9cf53ce8"><div class="ttname"><a href="namespacere__constitutive.html#aef95ec1b86499eb41011942a9cf53ce8">re_constitutive::dkdhtab_all</a></div><div class="ttdeci">real(kind=rkind), dimension(:,:,:), allocatable, target, public dkdhtab_all</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00022">re_constitutive.f90:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44ecaf75690494449561f9c55f1a142d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=4096), private re_constitutive::tabmsg = &quot;DRUtES requested values of the constitutive functions out of the range of your precalculated table, the function will be evaluated directly, it will slow down your computation, is everything ok? If yes, increase the length of interval for precaculating the constitutive functions in your config files&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00027">27</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">character(len=4096)</span>, <span class="keywordtype">private</span> :: <a class="code" href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">tabmsg</a> = <span class="stringliteral">&quot;DRUtES requested values of the constitutive functions out of the range of &amp;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                            your precalculated table, the function will be evaluated directly, it will &amp; </span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                            slow down your computation, is everything ok? If yes, increase the &amp;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                            length of interval for precaculating the constitutive functions in your config files&quot;</span>   </div><div class="ttc" id="namespacere__constitutive_html_a44ecaf75690494449561f9c55f1a142d"><div class="ttname"><a href="namespacere__constitutive.html#a44ecaf75690494449561f9c55f1a142d">re_constitutive::tabmsg</a></div><div class="ttdeci">character(len=4096), private tabmsg</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00027">re_constitutive.f90:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a732d67fdcdd4cdc0fb573d3c9e96ba85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private re_constitutive::tabwarning = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00026">26</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01068">dmualem_dh_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00687">mualem_tab()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">private</span> :: <a class="code" href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">tabwarning</a> = .false.</div><div class="ttc" id="namespacere__constitutive_html_a732d67fdcdd4cdc0fb573d3c9e96ba85"><div class="ttname"><a href="namespacere__constitutive.html#a732d67fdcdd4cdc0fb573d3c9e96ba85">re_constitutive::tabwarning</a></div><div class="ttdeci">logical, private tabwarning</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00026">re_constitutive.f90:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a957329345fdf54666f10d5a560c219db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind=ikind), private re_constitutive::this_layer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00024">24</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01394">init_zones()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01595">secondder_retc()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01570">zone_error_val()</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">private</span> :: <a class="code" href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">this_layer</a></div><div class="ttc" id="namespacere__constitutive_html_a957329345fdf54666f10d5a560c219db"><div class="ttname"><a href="namespacere__constitutive.html#a957329345fdf54666f10d5a560c219db">re_constitutive::this_layer</a></div><div class="ttdeci">integer(kind=ikind), private this_layer</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00024">re_constitutive.f90:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6e1df1932a050970ae8b9c032047ad7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structre__globals_1_1soilpar.html">soilpar</a>), private re_constitutive::van_gen_coeff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00023">23</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">type</span>(<a class="code" href="structre__globals_1_1soilpar.html">soilpar</a>), <span class="keywordtype">private</span> :: <a class="code" href="namespacere__constitutive.html#ac6e1df1932a050970ae8b9c032047ad7">van_gen_coeff</a></div><div class="ttc" id="structre__globals_1_1soilpar_html"><div class="ttname"><a href="structre__globals_1_1soilpar.html">re_globals::soilpar</a></div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00013">re_globals.f90:13</a></div></div>
<div class="ttc" id="namespacere__constitutive_html_ac6e1df1932a050970ae8b9c032047ad7"><div class="ttname"><a href="namespacere__constitutive.html#ac6e1df1932a050970ae8b9c032047ad7">re_constitutive::van_gen_coeff</a></div><div class="ttdeci">type(soilpar), private van_gen_coeff</div><div class="ttdef"><b>Definition:</b> <a href="re__constitutive_8f90_source.html#l00023">re_constitutive.f90:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97cae19740749808642dcd2fb326ddb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:), pointer, public re_constitutive::warecatab</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00021">21</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00471">vangen_elast_tab()</a>.</p>

</div>
</div>
<a class="anchor" id="a5b2162aa59a163afc487ea11d76326d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:,:), allocatable, target, public re_constitutive::warecatab_all</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00022">22</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>

</div>
</div>
<a class="anchor" id="a3d4ff1bd9e37d274bb888db1d630ddbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:), pointer, public re_constitutive::watcontab</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00021">21</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l00251">vangen_tab()</a>.</p>

</div>
</div>
<a class="anchor" id="a3249b973baf1fa0d41eb4cd2784a384b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind), dimension(:,:,:), allocatable, target, public re_constitutive::watcontab_all</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="re__constitutive_8f90_source.html#l00022">22</a> of file <a class="el" href="re__constitutive_8f90_source.html">re_constitutive.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01367">domainswitch()</a>, and <a class="el" href="re__constitutive_8f90_source.html#l01249">tabvalues()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacere__constitutive.html">re_constitutive</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
