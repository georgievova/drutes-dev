<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DRUtES: solvers Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRUtES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacesolvers.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">solvers Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>resice soustav  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsolvers_1_1vrstvy.html">vrstvy</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aea926a2b4b690d018a06ab48856ab0e7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#aea926a2b4b690d018a06ab48856ab0e7">jacobi</a> (a, b, x, maxit1, reps1, it, repsfin, l1, l2, countop, ilev1)</td></tr>
<tr class="memdesc:aea926a2b4b690d018a06ab48856ab0e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jacobiova metoda.  <a href="#aea926a2b4b690d018a06ab48856ab0e7">More...</a><br /></td></tr>
<tr class="separator:aea926a2b4b690d018a06ab48856ab0e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b9cf3689487a408b5ce257094b70c0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#ae3b9cf3689487a408b5ce257094b70c0">gs</a> (a, b, x, maxit, reps, it, repsfin, l1, l2, countop, ilev)</td></tr>
<tr class="memdesc:ae3b9cf3689487a408b5ce257094b70c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gauss-Seidelova metoda.  <a href="#ae3b9cf3689487a408b5ce257094b70c0">More...</a><br /></td></tr>
<tr class="separator:ae3b9cf3689487a408b5ce257094b70c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb8d3f54b1edc529946756f819b93cc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a> (A, LU, info, pivtype, ilev, perm1, perm2)</td></tr>
<tr class="memdesc:a1fb8d3f54b1edc529946756f819b93cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">nedestruktivni LDU rozklad  <a href="#a1fb8d3f54b1edc529946756f819b93cc">More...</a><br /></td></tr>
<tr class="separator:a1fb8d3f54b1edc529946756f819b93cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2d15a8b8a8951c08409b22918b2080"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a6c2d15a8b8a8951c08409b22918b2080">ldud</a> (A, info, pivtype, ilev, perm1, perm2)</td></tr>
<tr class="memdesc:a6c2d15a8b8a8951c08409b22918b2080"><td class="mdescLeft">&#160;</td><td class="mdescRight">destruktivni LDU rozklad  <a href="#a6c2d15a8b8a8951c08409b22918b2080">More...</a><br /></td></tr>
<tr class="separator:a6c2d15a8b8a8951c08409b22918b2080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b05287bb232863276b29eda2694ab3a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a7b05287bb232863276b29eda2694ab3a">split</a> (LDU, L, D, U, p1, p2)</td></tr>
<tr class="memdesc:a7b05287bb232863276b29eda2694ab3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">rozdeli matici s LDU rozkladem na jednotlive komponenty  <a href="#a7b05287bb232863276b29eda2694ab3a">More...</a><br /></td></tr>
<tr class="separator:a7b05287bb232863276b29eda2694ab3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c7314bf0d113f515e03150556b35bc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#ab4c7314bf0d113f515e03150556b35bc">lduback</a> (LDU, b, x, p1, p2, oc1, ilevel, errcode)</td></tr>
<tr class="memdesc:ab4c7314bf0d113f515e03150556b35bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zpetny chod po LDU dekompozici. Predpoklada se, ze matice je ctvercova.  <a href="#ab4c7314bf0d113f515e03150556b35bc">More...</a><br /></td></tr>
<tr class="separator:ab4c7314bf0d113f515e03150556b35bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1a15b562e2ee1cf1273637ca9edaaa4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#af1a15b562e2ee1cf1273637ca9edaaa4">sd</a> (A, b, x, itmax1, reps1, ilev1, itfin1, repsfin1, ll1, ll2, cond1, opcnt1, errcode1)</td></tr>
<tr class="memdesc:af1a15b562e2ee1cf1273637ca9edaaa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">metoda nejvetsiho spadu ( Steepest descent) podrobnosti viz <a class="el" href="sd.html">"Metoda nejvetsiho spadu"</a>  <a href="#af1a15b562e2ee1cf1273637ca9edaaa4">More...</a><br /></td></tr>
<tr class="separator:af1a15b562e2ee1cf1273637ca9edaaa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa902fa11b606f38dab65e0083f33aa2c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#aa902fa11b606f38dab65e0083f33aa2c">sdnormal</a></td></tr>
<tr class="separator:aa902fa11b606f38dab65e0083f33aa2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f42c7320ceede904a3ea977a89693cf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a3f42c7320ceede904a3ea977a89693cf">cg</a> (A, b, x, itmax1, reps1, ilev1, itfin1, repsfin1, ll1, ll2, cond1, opcnt1, errcode1)</td></tr>
<tr class="memdesc:a3f42c7320ceede904a3ea977a89693cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">metoda sdruzenych gradientu <a class="el" href="cg.html">Metoda sdruzenych gradientu</a>  <a href="#a3f42c7320ceede904a3ea977a89693cf">More...</a><br /></td></tr>
<tr class="separator:a3f42c7320ceede904a3ea977a89693cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b33a4dc733829b9eb0161a9c08fec72"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a4b33a4dc733829b9eb0161a9c08fec72">cgnormal</a> (A, b, x, itmax1, reps1, ilev1, itfin1, repsfin1, ll1, ll2, cond1, opcnt1, errcode1)</td></tr>
<tr class="memdesc:a4b33a4dc733829b9eb0161a9c08fec72"><td class="mdescLeft">&#160;</td><td class="mdescRight">metoda sdruzenych gradientu pro normalni rovnice <a class="el" href="cgn.html">Metoda sdruzenych gradientu pro normalni rovnice</a>  <a href="#a4b33a4dc733829b9eb0161a9c08fec72">More...</a><br /></td></tr>
<tr class="separator:a4b33a4dc733829b9eb0161a9c08fec72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0a289ad14e4761a2c621b2914fd0aa"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a8c0a289ad14e4761a2c621b2914fd0aa">pcg</a> (A, Minv, b, x, itmax1, reps1, ilev1, itfin1, repsfin1, ll1, ll2, cond1, opcnt1, errcode1)</td></tr>
<tr class="memdesc:a8c0a289ad14e4761a2c621b2914fd0aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">metoda sdruzenych gradientu <a class="el" href="pcg.html">Metoda predpodminenych sdruzenych gradientu</a>  <a href="#a8c0a289ad14e4761a2c621b2914fd0aa">More...</a><br /></td></tr>
<tr class="separator:a8c0a289ad14e4761a2c621b2914fd0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b54ed5ca5359186cbbe617324c6b86e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a2b54ed5ca5359186cbbe617324c6b86e">pcgnormal</a></td></tr>
<tr class="separator:a2b54ed5ca5359186cbbe617324c6b86e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1058e241b99a7efd5929528e145765"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a> (x, a, b, n)</td></tr>
<tr class="separator:a2d1058e241b99a7efd5929528e145765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02123ec53b1506ac8bf72231f8a96839"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839">esteig</a> (l1, l2, n, alfa, beta)</td></tr>
<tr class="separator:a02123ec53b1506ac8bf72231f8a96839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0819046193527583492f485e4fac7c77"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a0819046193527583492f485e4fac7c77">inivrstvy</a> (levelset, A)</td></tr>
<tr class="memdesc:a0819046193527583492f485e4fac7c77"><td class="mdescLeft">&#160;</td><td class="mdescRight">inicializuje vrstvy  <a href="#a0819046193527583492f485e4fac7c77">More...</a><br /></td></tr>
<tr class="separator:a0819046193527583492f485e4fac7c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725799257b3a87e003abbace5a9b7b90"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a725799257b3a87e003abbace5a9b7b90">firstpoint</a> (levelset, point)</td></tr>
<tr class="memdesc:a725799257b3a87e003abbace5a9b7b90"><td class="mdescLeft">&#160;</td><td class="mdescRight">vlozi prvni vrchol, v tomto pripade nepotrebuje matici  <a href="#a725799257b3a87e003abbace5a9b7b90">More...</a><br /></td></tr>
<tr class="separator:a725799257b3a87e003abbace5a9b7b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123077149170b16937efcfe052ff5283"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a123077149170b16937efcfe052ff5283">addlevel</a> (A, mapa, levelset)</td></tr>
<tr class="memdesc:a123077149170b16937efcfe052ff5283"><td class="mdescLeft">&#160;</td><td class="mdescRight">prida vrstvu, predpoklada se, ze aspon jedna tam uz je  <a href="#a123077149170b16937efcfe052ff5283">More...</a><br /></td></tr>
<tr class="separator:a123077149170b16937efcfe052ff5283"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>resice soustav </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a123077149170b16937efcfe052ff5283"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::addlevel </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>mapa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsolvers_1_1vrstvy.html">vrstvy</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>levelset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prida vrstvu, predpoklada se, ze aspon jedna tam uz je </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice definujici graf</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mapa</td><td>mapa povolujici jdnotlive vrcholy</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">levelset</td><td>uktualni sada vrstev </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l02050">2050</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>,<span class="keywordtype">dimension(:)</span>,<span class="keywordtype">intent(inout)</span> :: mapa</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structsolvers_1_1vrstvy.html">vrstvy</a>), <span class="keywordtype">intent(inout)</span> :: levelset</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="keywordflow">if</span> (levelset%nlev == 0) stop <span class="stringliteral">&quot;Chybna pouziti addlevel&quot;</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="comment">! posledni vrstva je v od levelset%levstart(nlev) do</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="comment">! levelset%lesvstart(nlev+1)-1</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div><div class="ttc" id="structsolvers_1_1vrstvy_html"><div class="ttname"><a href="structsolvers_1_1vrstvy.html">solvers::vrstvy</a></div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00038">solvers.f90:38</a></div></div>
<div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f42c7320ceede904a3ea977a89693cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::cg </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in), optional&#160;</td>
          <td class="paramname"><em>itmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in), optional&#160;</td>
          <td class="paramname"><em>reps1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>itfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>repsfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>cond1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>opcnt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>errcode1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>metoda sdruzenych gradientu <a class="el" href="cg.html">Metoda sdruzenych gradientu</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy<br />
 musi poskytovat getn, getm, mul (nasobeni vektorem)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>vektor prave strany</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>aproximace reseni, postupne menena</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itmax1</td><td>maximalni povoleny pocet iteraci, default = n ( Rozmer matice)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps1</td><td>pozadovana relativni zmena rezidua, default = 1e-6</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev1</td><td>informacni podrobnost<br />
<ul>
<li>0 ... pracuj tise</li>
<li>1 ... minimalni informace</li>
<li>10 ... maximalni ukecanost</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">itfin1</td><td>skutecne provedeny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin1</td><td>skutecne dosazena relativni zmena residua</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll1</td><td>odhad nejvetsiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll2</td><td>odhad nejmensiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cond1</td><td>odhad cisla podminenosti : cond1 = ll1/ll2</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">opcnt1</td><td>celkovy pocet provedenych operaci a cas behu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">errcode1</td><td>kod pripadne chyby<ul>
<li>0 ... OK</li>
<li>1 ... matice neni ctvercova</li>
<li>2 ... nesouhlasi b</li>
<li>3 ... nesouhasi x</li>
<li>4 ... ani jeden z vektoru nesouhlasi</li>
<li>5 ... vycerpan povoleny pocet iteraci</li>
<li>6 ... prestalo klesat residuum i energie </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01245">1245</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="solvers_8f90_source.html#l01952">esteig()</a>.</p>

<p>Referenced by <a class="el" href="solver__interfaces_8f90_source.html#l00075">solver_interfaces::cg_face()</a>.</p>
<div class="fragment"><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in out)</span> :: x</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: itmax1</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reps1</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev1</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: itfin1</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: repsfin1</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll1</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll2</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: cond1</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: opcnt1</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: errcode1</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: itmax, cnt, n</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordtype">integer</span> :: ilev,rcount, rcount1, errcode</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: reps, repsfin, r0, r1, r2,r3,l1,l2,t1,t2</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: wrk, en, enmin, res2min</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: res,p,ap,&amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        alfa, beta</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: opcnt</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        errcode = 0</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        n = a%getn()</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        rcount = 0</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        rcount1 = 0</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        l1 = 1</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        l2 = 1</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode1)) errcode1 = 0</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev1)) then</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        ilev = ilev1</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        else</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            ilev = 0</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itmax1)) then</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        itmax = itmax1</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        else</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            itmax = a%getn()</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,&amp;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <span class="stringliteral">&quot;nastavuji default hodnotu pro itmax na&quot;</span>,itmax</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keyword">allocate</span>(alfa(0:itmax), beta(0:itmax))</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= a%getm()) then</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                errcode1 = 1</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            return</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            else</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                stop <span class="stringliteral">&quot;CG: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= ubound(b,1)) then</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                errcode1 = 2</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG : nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            else</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                stop <span class="stringliteral">&quot;CG: Nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">if</span> (a%getm() /= ubound(x,1)) then</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="keywordflow">if</span> (errcode1==0) then</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    errcode1 = 3</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: nesouhlasi delka reseni&quot;</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                else</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                    errcode1 = 4</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: nesouhlasi delky obou vektoru&quot;</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            else</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                stop <span class="stringliteral">&quot;CG: Nesouhlasi delka vektoru neznamych&quot;</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <span class="keywordflow">if</span> (errcode1&gt;0) return</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(reps1) ) then</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        reps = reps1</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        else</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            reps = 1.0e-6</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,<span class="stringliteral">&quot;nastavuji reps na defaultni hodnotu &quot;</span>&amp;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            , reps</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <span class="comment">! ted uz je snad vyrizeno vsechno ze vstupu</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="comment">! jdu pocitat</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        cnt = 0</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="comment">!! Step 1</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        res = b - a%mul(x,opcnt)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        r0 = r2</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        p = res</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        opcnt%ad  = n-1</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        opcnt%mul = n</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="comment">!! Step 2</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        do</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="comment">!! Step 3</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            ap =a%mul(p,opcnt)</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            r1 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(p,ap)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            wrk = r2/r1</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;alfa=&quot;</span>,wrk</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            alfa(cnt) = wrk</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="comment">! tenhle usek je jen kvuli vypoctu energie</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            en = -<a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(x,b+res) <span class="comment">! je to vychozi energie</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <span class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            <span class="comment">!! Step 4</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            x = x + wrk*p</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            <span class="comment">!! Step 5</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            res = res - wrk*ap</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="comment">!! Step 6</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            r3 = r2</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            wrk = r2/r3</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;beta=&quot;</span>,wrk</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            beta(cnt) = wrk</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <span class="comment">!! Step 7</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            p = res + wrk*p</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            opcnt%ad  = opcnt%ad  + 4*n-2 + 2*n-1</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            opcnt%mul = opcnt%mul + 4*n   + n</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            opcnt%div = opcnt%div + 1</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            <span class="comment">!! odhadnout vlastni cisla</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839">esteig</a>(l1,l2,cnt,alfa,beta)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            print *, <span class="stringliteral">&quot;odhad vl. cisel:&quot;</span>,l1,l2</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            <span class="comment">!! hotovo</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            cnt = cnt + 1</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keywordflow">if</span> (cnt==1) then</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                enmin = en</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                res2min = r2</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                <span class="keywordflow">if</span> (r0==0.0_rkind) then</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                    repsfin=0</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    exit</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <span class="keywordflow">if</span> (en &lt; enmin) then</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                rcount = 0</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            enmin = en</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            else</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                rcount = rcount+1</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <span class="keywordflow">if</span> (r2 &lt; res2min) then</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                res2min = r2</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            rcount1 = 0</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            else</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                rcount1 = rcount1+1</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0)  print *, cnt,sqrt(r2), reps, en, enmin</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="keywordflow">if</span> (cnt == itmax) then</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                errcode = 5</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                exit</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            repsfin = sqrt(r2/r0)</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">if</span> (repsfin &lt; reps) exit</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="keywordflow">if</span> ((rcount1&gt;5) .and. (rcount &gt; 5)) then</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                errcode = 6</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                exit</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        opcnt%time = t2-t1</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="comment">! vyridit konec</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(opcnt1)) opcnt1 = opcnt</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) errcode1 = errcode</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itfin1)) itfin1 = cnt</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(repsfin1)) repsfin1 = repsfin</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll1)) ll1 = l1</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll2)) ll2 = l2</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(cond1)) cond1 = l1/l2</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="ttc" id="namespacesolvers_html_a02123ec53b1506ac8bf72231f8a96839"><div class="ttname"><a href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839">solvers::esteig</a></div><div class="ttdeci">subroutine, private esteig(l1, l2, n, alfa, beta)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l01952">solvers.f90:1952</a></div></div>
<div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacepmatools_html_a3bdd52fc0cd0cc30635baeb6f71ec145"><div class="ttname"><a href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">pmatools::dot_product</a></div><div class="ttdeci">real(kind=rkind) function dot_product(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="pmatools_8f90_source.html#l00460">pmatools.f90:460</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_cgraph.png" border="0" usemap="#namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_cgraph" alt=""/></div>
<map name="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_cgraph" id="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_cgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839" title="solvers::esteig" alt="" coords="140,5,247,32"/>
<area shape="rect" id="node3" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765" title="solvers::vycdet" alt="" coords="295,5,405,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_icgraph.png" border="0" usemap="#namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_icgraph" alt=""/></div>
<map name="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_icgraph" id="namespacesolvers_a3f42c7320ceede904a3ea977a89693cf_icgraph">
<area shape="rect" id="node2" href="namespacesolver__interfaces.html#aeddca7240bf222b090a3b7ae08905998" title="solver_interfaces::\lcg_face" alt="" coords="140,5,269,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b33a4dc733829b9eb0161a9c08fec72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::cgnormal </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in), optional&#160;</td>
          <td class="paramname"><em>itmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in), optional&#160;</td>
          <td class="paramname"><em>reps1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>itfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>repsfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>cond1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>opcnt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>errcode1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>metoda sdruzenych gradientu pro normalni rovnice <a class="el" href="cgn.html">Metoda sdruzenych gradientu pro normalni rovnice</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy<br />
 musi poskytovat getn, getm, mul (nasobeni vektorem)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>vektor prave strany</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>aproximace reseni, postupne menena</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itmax1</td><td>maximalni povoleny pocet iteraci, default = n ( Rozmer matice)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps1</td><td>pozadovana relativni zmena rezidua, default = 1e-6</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev1</td><td>informacni podrobnost<br />
<ul>
<li>0 ... pracuj tise</li>
<li>1 ... minimalni informace</li>
<li>10 ... maximalni ukecanost</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">itfin1</td><td>skutecne provedeny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin1</td><td>skutecne dosazena relativni zmena residua</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll1</td><td>odhad nejvetsiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll2</td><td>odhad nejmensiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cond1</td><td>odhad cisla podminenosti : cond1 = ll1/ll2</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">opcnt1</td><td>celkovy pocet provedenych operaci a cas behu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">errcode1</td><td>kod pripadnr chyby<ul>
<li>0 ... OK</li>
<li>1 ... matice neni ctvercova</li>
<li>2 ... nesouhlasi b</li>
<li>3 ... nesouhasi x</li>
<li>4 ... ani jeden z vektoru nesouhlasi</li>
<li>5 ... vycerpan povoleny pocet iteraci</li>
<li>6 ... prestalo klesat residuum i energie </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01476">1476</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>Referenced by <a class="el" href="solver__interfaces_8f90_source.html#l00135">solver_interfaces::cg_normal_face()</a>.</p>
<div class="fragment"><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in out)</span> :: x</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: itmax1</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reps1</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev1</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: itfin1</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: repsfin1</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll1</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll2</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: cond1</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: opcnt1</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: errcode1</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: itmax, cnt, n</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keywordtype">integer</span> :: ilev,rcount, rcount1, errcode</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: reps, repsfin, r0, r1, r2,r3,l1,l2,t1,t2</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: wrk, en, enmin, res2min</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: res,p,ap,&amp;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        alfa, beta,&amp;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        res1, b1</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: opcnt</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode1)) errcode1 = 0</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        errcode = 0</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        n = a%getn()</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        rcount = 0</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        rcount1 = 0</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        l1 = 1</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        l2 = 1</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev1)) then</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        ilev = ilev1</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        else</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            ilev = 0</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itmax1)) then</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        itmax = itmax1</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        else</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            itmax = a%getn()</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,&amp;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="stringliteral">&quot;nastavuji default hodnotu pro itmax na&quot;</span>,itmax</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keyword">allocate</span>(alfa(0:itmax), beta(0:itmax))</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= ubound(b,1)) then</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                errcode1 = 2</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CGnormal : nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            else</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                stop <span class="stringliteral">&quot;CGnormal: Nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <span class="keywordflow">if</span> (a%getm() /= ubound(x,1)) then</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                <span class="keywordflow">if</span> (errcode1==0) then</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    errcode1 = 3</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CGnormal: nesouhlasi delka reseni&quot;</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                else</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    errcode1 = 4</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CGnormal: nesouhlasi delky obou vektoru&quot;</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            else</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                stop <span class="stringliteral">&quot;CGnormal: Nesouhlasi delka vektoru neznamych&quot;</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            <span class="keywordflow">if</span> (errcode1&gt;0) return</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(reps1) ) then</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        reps = reps1</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        else</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            reps = 1.0e-6</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,<span class="stringliteral">&quot;nastavuji reps na defaultni hodnotu &quot;</span>&amp;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            , reps</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="comment">! ted uz je snad vyrizeno vsechno ze vstupu</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="comment">! jdu pocitat</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        cnt = 0</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">!! Step 1</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        b1 = a%mult(b)</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        res = b - a%mul(x,opcnt)</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        res = a%mult(res,opcnt)</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        r0 = r2</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        p = res</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        opcnt%ad  = n-1</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        opcnt%mul = n</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="comment">!! Step 2</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        do</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="comment">!! Step 3</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            ap =a%mul(p,opcnt)</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            r1 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(ap,ap)</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            wrk = r2/r1</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;alfa=&quot;</span>,wrk</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            alfa(cnt) = wrk</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <span class="comment">! tenhle usek je jen kvuli vypoctu energie</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            en = -<a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(x,b1+res) <span class="comment">! je to vychozi energie</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <span class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <span class="comment">!! Step 4</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            x = x + wrk*p</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="comment">!! Step 5</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            res = res - wrk*a%mult(ap,opcnt)</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="comment">!! Step 6</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            r3 = r2</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            wrk = r2/r3</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;beta=&quot;</span>,wrk</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            beta(cnt) = wrk</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="comment">!! Step 7</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            p = res + wrk*p</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            opcnt%ad  = opcnt%ad  + 4*n-2 + 2*n-1</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            opcnt%mul = opcnt%mul + 4*n   + n</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            opcnt%div = opcnt%div + 1</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="comment">!! odhadnout vlastni cisla</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">!             call esteig(l1,l2,cnt,alfa,beta)</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">!             print *, &quot;odhad vl. cisel:&quot;,l1,l2</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="comment">!! hotovo</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            cnt = cnt + 1</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="keywordflow">if</span> (cnt==1) then</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                enmin = en</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                res2min = r2</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                <span class="keywordflow">if</span> (r0==0.0_rkind) then</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    repsfin=0</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    exit</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <span class="keywordflow">if</span> (en &lt; enmin) then</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                rcount = 0</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            enmin = en</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            else</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                rcount = rcount+1</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">if</span> (r2 &lt; res2min) then</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                res2min = r2</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            rcount1 = 0</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            else</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                rcount1 = rcount1+1</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0)  print *, cnt,sqrt(r2), reps, en, enmin</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keywordflow">if</span> (cnt == itmax) then</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                errcode = 5</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                exit</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            repsfin = sqrt(r2/r0)</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <span class="keywordflow">if</span> (repsfin &lt; reps) exit</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            <span class="keywordflow">if</span> ((rcount1&gt;5) .and. (rcount &gt; 5)) then</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                errcode = 6</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                exit</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        opcnt%time = t2-t1</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="comment">! vyridit konec</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(opcnt1)) opcnt1 = opcnt</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) errcode1 = errcode</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itfin1)) itfin1 = cnt</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(repsfin1)) repsfin1 = repsfin</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll1)) ll1 = l1  <span class="comment">! tohle zatim nepocita</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll2)) ll2 = l2</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(cond1)) cond1 = l1/l2</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacepmatools_html_a3bdd52fc0cd0cc30635baeb6f71ec145"><div class="ttname"><a href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">pmatools::dot_product</a></div><div class="ttdeci">real(kind=rkind) function dot_product(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="pmatools_8f90_source.html#l00460">pmatools.f90:460</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a4b33a4dc733829b9eb0161a9c08fec72_icgraph.png" border="0" usemap="#namespacesolvers_a4b33a4dc733829b9eb0161a9c08fec72_icgraph" alt=""/></div>
<map name="namespacesolvers_a4b33a4dc733829b9eb0161a9c08fec72_icgraph" id="namespacesolvers_a4b33a4dc733829b9eb0161a9c08fec72_icgraph">
<area shape="rect" id="node2" href="namespacesolver__interfaces.html#a50cb3e402cf79fcadbc703f40dbda99e" title="solver_interfaces::\lcg_normal_face" alt="" coords="179,5,308,47"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="356,5,503,47"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="551,13,601,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a02123ec53b1506ac8bf72231f8a96839"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private solvers::esteig </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(inout)&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(inout)&#160;</td>
          <td class="paramname"><em>l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(0:), intent(in)&#160;</td>
          <td class="paramname"><em>alfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(0:), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01952">1952</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="solvers_8f90_source.html#l01922">vycdet()</a>.</p>

<p>Referenced by <a class="el" href="solvers_8f90_source.html#l01245">cg()</a>, and <a class="el" href="solvers_8f90_source.html#l01704">pcg()</a>.</p>
<div class="fragment"><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in out)</span> :: l1</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in out)</span> :: l2</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: n</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(0:)</span>, <span class="keywordtype">intent(in)</span> :: alfa</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(0:)</span>, <span class="keywordtype">intent(in)</span> :: beta</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: x1,x2,x3,y1,y2,y3,d1,d2</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">if</span> (n==0) then</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            l1 = 1/alfa(0)</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        l2 = l1</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        else</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            <span class="comment">!odhadneme nejmensi</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            x1 = 0</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            y1 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x1,alfa,beta,n)</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            x2 = l2</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            y2 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x2,alfa,beta,n)</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <span class="keywordflow">if</span> (y1*y2&gt;0) print *, <span class="stringliteral">&quot;podivne&quot;</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            d1 =x2-x1</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            d2 = 2*d1</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (d1 &lt; d2)</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                d2 = d1</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                x3 = (x1+x2)/2</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                y3 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x3,alfa,beta,n)</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                <span class="keywordflow">if</span> (y3*y1 &gt; 0) then</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                    x1 = x3</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                y1 = y3</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                else</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                    x2 = x3</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                    y2 = y3</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                d1 = x2 - x1</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            l2 = x3</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="comment">!odhadneme nejvetsi</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            x1 = l1</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            y1 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x1,alfa,beta,n)</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            d1 = 0.00000000001</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            x2 = x1+d1</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            y2 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x2,alfa,beta,n)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (y1*y2&gt;0)</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                x1 = x2</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                y1 = y2</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                d1 = d1+d1</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                x2 = x1+d1</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                y2 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x2,alfa,beta,n)</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            d1 =x2-x1</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            d2 = 2*d1</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (d1 &lt; d2)</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                d2 = d1</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                x3 = (x1+x2)/2</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                y3 = <a class="code" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">vycdet</a>(x3,alfa,beta,n)</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                <span class="keywordflow">if</span> (y3*y1 &gt; 0) then</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    x1 = x3</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                y1 = y3</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                else</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                    x2 = x3</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                    y2 = y3</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                d1 = x2 - x1</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            l1 = x3</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacesolvers_html_a2d1058e241b99a7efd5929528e145765"><div class="ttname"><a href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765">solvers::vycdet</a></div><div class="ttdeci">real(kind=rkind) function, private vycdet(x, a, b, n)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l01922">solvers.f90:1922</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_cgraph.png" border="0" usemap="#namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_cgraph" alt=""/></div>
<map name="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_cgraph" id="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_cgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765" title="solvers::vycdet" alt="" coords="160,5,271,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_icgraph.png" border="0" usemap="#namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_icgraph" alt=""/></div>
<map name="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_icgraph" id="namespacesolvers_a02123ec53b1506ac8bf72231f8a96839_icgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a3f42c7320ceede904a3ea977a89693cf" title="metoda sdruzenych gradientu Metoda sdruzenych gradientu " alt="" coords="163,13,250,39"/>
<area shape="rect" id="node4" href="namespacesolvers.html#a8c0a289ad14e4761a2c621b2914fd0aa" title="metoda sdruzenych gradientu Metoda predpodminenych sdruzenych gradientu " alt="" coords="160,63,253,90"/>
<area shape="rect" id="node3" href="namespacesolver__interfaces.html#aeddca7240bf222b090a3b7ae08905998" title="solver_interfaces::\lcg_face" alt="" coords="301,5,431,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a725799257b3a87e003abbace5a9b7b90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::firstpoint </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsolvers_1_1vrstvy.html">vrstvy</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>levelset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind)&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>vlozi prvni vrchol, v tomto pripade nepotrebuje matici </p>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l02039">2039</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structsolvers_1_1vrstvy.html">vrstvy</a>), <span class="keywordtype">intent(in out)</span> :: levelset</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: point</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        levelset%nlev = 1</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        levelset%levstart(1) = 1</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        levelset%levstart(2) = 2</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        levelset%levlist(1) = point</div><div class="ttc" id="structsolvers_1_1vrstvy_html"><div class="ttname"><a href="structsolvers_1_1vrstvy.html">solvers::vrstvy</a></div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00038">solvers.f90:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae3b9cf3689487a408b5ce257094b70c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::gs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>maxit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>reps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out)&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>repsfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>countop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gauss-Seidelova metoda. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>prava strana</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>pocitane reseni soustavy</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>maximalni povoleny pocet iteraci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps</td><td>pozadovane relativni residuum</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">it</td><td>skutecny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin</td><td>skutecne relativni residuum</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l1</td><td>odhad rychlosti konvergence pomoci mocninne metody</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l2</td><td>odhad rychlosti konvergence pomoci odmocniny</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">countop</td><td>pocitadlo operaci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev</td><td>podrobnost informaci </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00190">190</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="typy_8f90_source.html#l00161">typy::norm2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: x</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: maxit</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: reps</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span> :: it</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: repsfin</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: l1</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: l2</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: countop</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: r0,r1,r2, wrk</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: r,diag</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i,j,k</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: countop1</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: t1, t2</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">allocate</span>(r(1:a%getn()))</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">allocate</span>(diag(1:a%getn()))</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        r=b-a%mul(x,countop1)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        r0 = <a class="code" href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19">norm2</a>(r)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        countop1%ad = countop1%ad + a%getn()</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">do</span> i=1,a%getn()</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            diag(i) = a%get(i,i)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        it = 0</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        r1 = r0</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        r2 = r0</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        do</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">!!!!!!!! predelet -</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> ( it &gt; maxit ) exit</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            repsfin = r1/r0</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">if</span> (r1 /= 0) then</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                l1 = r1/r2</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                l2 = repsfin**(1.0_rkind/it)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> ( ilev &gt; 0 )  print<span class="stringliteral">&quot;(i16,4ES18.10)&quot;</span>, it, r0,r1,l1,l2</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">if</span> ( repsfin &lt; reps) exit</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            r2 = r1</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            r1 = 0</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">do</span> i=1, a%getn()</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                wrk =b(i) - a%mulrow(x,i,countop1)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                r1 = r1 + wrk*wrk</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                x(i) =x(i) + wrk/diag(i)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            r1 = sqrt(r1)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            countop1%ad  = countop1%ad  + a%getn()*2</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            countop1%div = countop1%div + a%getn()</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            it = it + 1</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">deallocate</span>(r,diag)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(countop)) then</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            countop%ad  = countop%ad  + countop1%ad</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            countop%mul = countop%mul + countop1%mul</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            countop%div = countop%div + countop1%div</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            countop%time = t2-t1</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">        end </span>if</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html_ad5f707f5192c4a743f7da534989ceb19"><div class="ttname"><a href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19">typy::norm2</a></div><div class="ttdeci">real(kind=rkind) function, public norm2(v)</div><div class="ttdoc">spocte L2 normu vektoru </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00161">typy.f90:161</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_ae3b9cf3689487a408b5ce257094b70c0_cgraph.png" border="0" usemap="#namespacesolvers_ae3b9cf3689487a408b5ce257094b70c0_cgraph" alt=""/></div>
<map name="namespacesolvers_ae3b9cf3689487a408b5ce257094b70c0_cgraph" id="namespacesolvers_ae3b9cf3689487a408b5ce257094b70c0_cgraph">
<area shape="rect" id="node2" href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19" title="spocte L2 normu vektoru " alt="" coords="140,5,231,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0819046193527583492f485e4fac7c77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::inivrstvy </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsolvers_1_1vrstvy.html">vrstvy</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>levelset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inicializuje vrstvy </p>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l02023">2023</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structsolvers_1_1vrstvy.html">vrstvy</a>), <span class="keywordtype">intent(in out)</span> :: levelset</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: n</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        n = a%getn()</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <span class="comment">! jen pridelim pamet, neinicializuji</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="keyword">allocate</span>(levelset%levlist(1:n))</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keyword">allocate</span>(levelset%levstart(1:n+1))</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="comment">! pocet urovni je nula</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        levelset%nlev = 0</div><div class="ttc" id="structsolvers_1_1vrstvy_html"><div class="ttname"><a href="structsolvers_1_1vrstvy.html">solvers::vrstvy</a></div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00038">solvers.f90:38</a></div></div>
<div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea926a2b4b690d018a06ab48856ab0e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::jacobi </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in), optional&#160;</td>
          <td class="paramname"><em>maxit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in), optional&#160;</td>
          <td class="paramname"><em>reps1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>repsfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>countop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Jacobiova metoda. </p>
<p>podrobnejsi popis viz <a class="el" href="Jacobi.html">Jacobiova metoda</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>prava strana</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>pocitane reseni soustavy</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit1</td><td>maximalni povoleny pocet iteraci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps1</td><td>pozadovane relativni residuum</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">it</td><td>skutecny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin</td><td>skutecne relativni residuum</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l1</td><td>odhad rychlosti konvergence pomoci mocninne metody</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l2</td><td>odhad rychlosti konvergence pomoci odmocniny</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">countop</td><td>pocitadlo operaci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev1</td><td>podrobnost informaci </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00078">78</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="typy_8f90_source.html#l00161">typy::norm2()</a>, and <a class="el" href="typy_8f90_source.html#l00035">typy::r4</a>.</p>

<p>Referenced by <a class="el" href="solver__interfaces_8f90_source.html#l00194">solver_interfaces::jacobi_face()</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a>, r4x=&gt;<a class="code" href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">r4</a></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: x</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>,<span class="keywordtype">optional</span> :: maxit1</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reps1</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: it</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: repsfin</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: l1</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: l2</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: countop</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev1</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: maxit,it1, ilev</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: reps</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: r0,r1,r2, repsfin1</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: ll1,ll2</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: r,diag</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i,n</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: countop1</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: t1, t2</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">!print *,&quot;jacobi zacina&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">!! vyresime nepovinne parametry</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        n = a%getn()</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(maxit1)) then</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        maxit = maxit1</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        else</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            maxit = n</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(reps1)) then</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        reps = reps1</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        else</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            reps = 1.0e-6</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev1)) then</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        ilev = ilev1</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        else</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            ilev = 0</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">!print *, &quot;nepovinne vyseny&quot;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">allocate</span>(r(1:a%getn()))</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">allocate</span>(diag(1:a%getn()))</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        r=b-a%mul(x,countop1)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        r0 = <a class="code" href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19">norm2</a>(r)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        countop1%ad = countop1%ad + a%getn()</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">do</span> i=1,a%getn()</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            diag(i) = a%get(i,i)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        it1 = 0</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">!print *,&quot;pripraveno&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        do</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> ( it1 &gt; maxit ) exit</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            r1 = <a class="code" href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19">norm2</a>(r)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            repsfin1 = r1/r0</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (r1 /= 0) then</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                ll1 = r1/r2</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                ll2 = repsfin1**(1.0_rkind/it1)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">if</span> ( ilev &gt; 0 )  print<span class="stringliteral">&quot;(i16,4ES18.10)&quot;</span>, it1, r0,r1,ll1,ll2</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span> ( repsfin1 &lt; reps) exit</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">do</span> i=1, a%getn()</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                x(i) = x(i) + r(i)/diag(i)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            r=b-a%mul(x,countop1)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            countop1%ad  = countop1%ad  + 2*a%getn()</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            countop1%div = countop1%div +   a%getn()</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            it1 = it1 + 1</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            r2  = r1</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keyword">deallocate</span>(r,diag)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">!print *,&quot;jacobi konci&quot;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">! vyresime navratove hodnoty</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(countop)) then</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            countop%ad  = countop%ad  + countop1%ad</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            countop%mul = countop%mul + countop1%mul</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            countop%div = countop%div + countop1%div</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            countop%time = t2-t1</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(it)) it = it1</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(repsfin)) repsfin = repsfin1</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(l1)) l1 = ll1</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(l2)) l2 = ll2</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html_ad5f707f5192c4a743f7da534989ceb19"><div class="ttname"><a href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19">typy::norm2</a></div><div class="ttdeci">real(kind=rkind) function, public norm2(v)</div><div class="ttdoc">spocte L2 normu vektoru </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00161">typy.f90:161</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacetypy_html_ac852c2bd4923127662b9ae950f7bd1c0"><div class="ttname"><a href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">typy::r4</a></div><div class="ttdeci">integer, parameter r4</div><div class="ttdoc">4byte real </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00035">typy.f90:35</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_cgraph.png" border="0" usemap="#namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_cgraph" alt=""/></div>
<map name="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_cgraph" id="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_cgraph">
<area shape="rect" id="node2" href="namespacetypy.html#ad5f707f5192c4a743f7da534989ceb19" title="spocte L2 normu vektoru " alt="" coords="160,5,251,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_icgraph.png" border="0" usemap="#namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_icgraph" alt=""/></div>
<map name="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_icgraph" id="namespacesolvers_aea926a2b4b690d018a06ab48856ab0e7_icgraph">
<area shape="rect" id="node2" href="namespacesolver__interfaces.html#a4ba16c58b7f46a46823245234f5667fb" title="solver_interfaces::\ljacobi_face" alt="" coords="160,5,289,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fb8d3f54b1edc529946756f819b93cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::ldu </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>LU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>pivtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(inout), optional, allocatable&#160;</td>
          <td class="paramname"><em>perm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(inout), optional, allocatable&#160;</td>
          <td class="paramname"><em>perm2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>nedestruktivni LDU rozklad </p>
<p>pro volbu pivota plati nasledujici pravidla<br />
 0 ... zadna<br />
 1 ... uplny vyber hlavniho prvku (nutne obe permutace )<br />
 2 ... sloupcovy vyber hlavniho prvku(nutno perm1)<br />
 3 ... radkovy vyber hlavniho prvku(nutno perm2)<br />
 4 ... diagonalni vyber hlavniho prvku(nutno aspon jedna = obe shodne)<br />
 5 ... diagonalni vyber hlavniho prvku pro minimal degree<br />
 (nutno aspon jedna = obe shodne) <br />
 6 ... rid se predepsanou permutaci<br />
 Pro situace 1 az 6 musi byt pritomny permutacni vektory<br />
 Pokud nejsou pozadavky splneny - zvoli se nejpodobnejsi volba<br />
 pro podrobnost informaci plati<br />
 0 ... tichy chod<br />
 1 ... super podrobne<br />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>rozkladana matice</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lu</td><td>rozlozena matice</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>pocty operaci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pivtype</td><td>typ pivotaze</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev</td><td>podrobnost informaci</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">perm1</td><td>permutace pro i</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">perm2</td><td>permutace pro j </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00291">291</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="solvers_8f90_source.html#l00377">ldud()</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(inout)</span> :: lu</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: info</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: pivtype</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, &amp;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: perm1</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>,&amp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: perm2</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordtype">integer</span> :: pt1,il1</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>,<span class="keywordtype">dimension(:)</span>,<span class="keywordtype">allocatable</span> :: p1,p2</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: inf1</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(pivtype)) then</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        pt1 = pivtype</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        else</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            pt1 = 0</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev)) then</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        il1 = ilev</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        else</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            il1 = 0</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keyword">allocate</span>(p1(1:a%getn()))</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">allocate</span>(p2(1:a%getm()))</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">select case</span>(pt1)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordflow">case</span> (0)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                print *, <span class="stringliteral">&quot;nula&quot;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">case</span> (1)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">case</span> (2)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keywordflow">case</span> (3)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">case</span> (4)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keywordflow">case</span> (5)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordflow">case</span> (6)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">present</span>(perm1)) then</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    else</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keyword">                    end </span>if</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">                case default</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    print *,<span class="stringliteral">&quot;chybna volba&quot;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword">                end </span>select</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keyword">call </span>lu%copy(a)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        print *,<span class="stringliteral">&quot;zkopirovano&quot;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesolvers.html#a6c2d15a8b8a8951c08409b22918b2080">ldud</a>(lu,inf1,pt1,il1,p1,p2)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(perm1) ) perm1 = p1</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(perm2) ) perm2 = p2</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(info) )  info  = inf1</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (il1 &gt; 0) print *,<span class="stringliteral">&quot;LDU konci&quot;</span></div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacesolvers_html_a6c2d15a8b8a8951c08409b22918b2080"><div class="ttname"><a href="namespacesolvers.html#a6c2d15a8b8a8951c08409b22918b2080">solvers::ldud</a></div><div class="ttdeci">subroutine, public ldud(A, info, pivtype, ilev, perm1, perm2)</div><div class="ttdoc">destruktivni LDU rozklad </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00377">solvers.f90:377</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a1fb8d3f54b1edc529946756f819b93cc_cgraph.png" border="0" usemap="#namespacesolvers_a1fb8d3f54b1edc529946756f819b93cc_cgraph" alt=""/></div>
<map name="namespacesolvers_a1fb8d3f54b1edc529946756f819b93cc_cgraph" id="namespacesolvers_a1fb8d3f54b1edc529946756f819b93cc_cgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a6c2d15a8b8a8951c08409b22918b2080" title="destruktivni LDU rozklad " alt="" coords="143,31,239,57"/>
<area shape="rect" id="node3" href="solvers_8f90.html#a6725199f29e190b60497398939897fbe" title="vlozi informaci o stupni do seznamu " alt="" coords="287,5,369,32"/>
<area shape="rect" id="node4" href="solvers_8f90.html#a4773d97418706c50f6832edd10604b92" title="vybere pivota a zaznemena to v permutacich " alt="" coords="293,56,363,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab4c7314bf0d113f515e03150556b35bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::lduback </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>LDU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>oc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>errcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zpetny chod po LDU dekompozici. Predpoklada se, ze matice je ctvercova. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ldu</td><td>rozlozena matice</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>prava strana</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilevel</td><td>info level, nepovinny parametr, default = 0<ul>
<li>0 ... pracuj tise</li>
<li>1 ... vse reportuj</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">errcode</td><td>chybovy status, nepovinny. Pokud neni pritomen,tak chyba zpusobi konec programu<ul>
<li>0 ... vse OK</li>
<li>1 ... chyba - blize neurcena</li>
<li>2 ... lisi se delka b a pocet radku matice</li>
<li>3 ... lisi se delka x a pocet sloupcu matice</li>
<li>4 ... matice je singularni a soustava je konzistentni</li>
<li>5 ... matice je singularni a soustava nekonzistentni </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00856">856</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>Referenced by <a class="el" href="solver__interfaces_8f90_source.html#l00012">solver_interfaces::ldu_face()</a>.</p>
<div class="fragment"><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: <a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>  :: b</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: x</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: p1</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: p2</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: oc1</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilevel</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: errcode</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: oc</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: perm1, perm2</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: iperm1, iperm2</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: n,m,i,j, ip, ip2</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(1:LDU%getn())</span> :: diag</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: v</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: ii</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: nelem</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(1:LDU%getn())</span> :: mask</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">integer</span> :: ilv</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(ilevel)) then</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        ilv = ilevel</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        else</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            ilv = 0</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        n = <a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getn()</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        m = <a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getm()</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">! vyresit optionaly</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(p1)) then</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keyword">allocate</span>(perm1(1:n))</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        perm1 = p1</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        else</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keyword">allocate</span>(perm1(1:n))</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordflow">do</span> i=1,n</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                perm1(i) = i</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(p2)) then</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keyword">allocate</span>(perm2(1:m))</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        perm2 = p2</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        else</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keyword">allocate</span>(perm2(1:m))</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">do</span> i=1,m</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                perm2(i) = i</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">! konstrukce inverznich permutaci</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keyword">allocate</span>(iperm1(1:n),iperm2(1:m))</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">do</span> i=1,n</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            iperm1(perm1(i))=i</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">do</span> i=1,m</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            iperm2(perm2(i))=i</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">if</span> (ubound(b,1) /= n) then</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode) ) then</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            else</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                errcode = 2</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                stop <span class="stringliteral">&quot;LDUback: Pocet radku matice a prave strany se lisi&quot;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /= n) then</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode) ) then</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            else</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                errcode = 3</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                stop <span class="stringliteral">&quot;LDUback: Pocet sloupcu matice a neznamych se lisi&quot;</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="comment">! 1. L y = b</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        x = b</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> ( ilv==1) then</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            print *, <span class="stringliteral">&quot;LDUback: zacatek&quot;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            print *, <span class="stringliteral">&quot;ridici permutace&quot;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            print *, perm1</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            print *, perm2</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            print *, <span class="stringliteral">&quot;Prava strana&quot;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            print *,x</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        diag(perm2(1))=<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%get(perm1(1),perm2(1))</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        mask = .false.</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        mask(perm2(1)) = .true.</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">do</span> i = 2,n</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            ip = perm1(i)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            ip2 = perm2(i)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            diag(ip2)= <a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%get(ip,ip2)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getrow(ip,v,ii,nelem,mask)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">if</span> (ilv==1) then</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                print *, <span class="stringliteral">&quot;i=&quot;</span>,i, ip, nelem, mask</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                print *, ii(1:nelem)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                print *, v(1:nelem)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="keywordflow">do</span> j=1,nelem</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">if</span> ((ii(j)) == ip) then</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    <span class="comment">! jsem na diagonale</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                diag(ip2) = v(j)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                else</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    <span class="keywordflow">if</span> (ilv == 1) then</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        print *, j, x(ip), v(j), x(ii(j)), ii(j)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keyword">                    end </span>if</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    x(ip) = x(ip) - v(j)*x(ii(j))</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <span class="keywordflow">if</span> (ilv == 1) then</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        print *, j, x(ip), v(j), x(ii(j)), ii(j)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keyword">                    end </span>if</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (ilv == 1) then</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                print *,perm1</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                print *, perm2</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                print *,ip,mask</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                print *,ii</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                print *,x</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            mask(ip2) = .true.</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> (ilv == 1) then</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            print *, <span class="stringliteral">&quot;po primem chodu -------------------------------------&quot;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            print *,x</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="comment">! 2. D z = y</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        x = x/diag  <span class="comment">! tady zalezi na poradi, potreba prezkoumat</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> (ilv==1) then</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            print *, <span class="stringliteral">&quot;po deleni diagonalou --------------------------------&quot;</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            print *,x</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            print *, diag</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">! 3. U x = z</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        mask = .false.</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        mask(perm2(n)) = .true.</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">do</span> i=n-1,1,-1</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            ip = perm1(i)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            ip2 =perm2(i)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getrow(ip,v,ii,nelem,mask)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">do</span> j=1,nelem</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                <span class="keywordflow">if</span> (ii(j) == ip2) then</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="comment">! jsem na diagonale</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                diag(ip) = v(j)</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                else</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    x(ip) = x(ip) - v(j)*x(ii(j))</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">if</span> (ilv==1) then</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                print *,perm1</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                print *,ip,mask</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                print *,ii</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                print *,x</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            mask(ip2) = .true.</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacesolvers_html_a1fb8d3f54b1edc529946756f819b93cc"><div class="ttname"><a href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">solvers::ldu</a></div><div class="ttdeci">subroutine, public ldu(A, LU, info, pivtype, ilev, perm1, perm2)</div><div class="ttdoc">nedestruktivni LDU rozklad </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00291">solvers.f90:291</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_ab4c7314bf0d113f515e03150556b35bc_icgraph.png" border="0" usemap="#namespacesolvers_ab4c7314bf0d113f515e03150556b35bc_icgraph" alt=""/></div>
<map name="namespacesolvers_ab4c7314bf0d113f515e03150556b35bc_icgraph" id="namespacesolvers_ab4c7314bf0d113f515e03150556b35bc_icgraph">
<area shape="rect" id="node2" href="namespacesolver__interfaces.html#affcc4b462663ec74c63d7318e182ff71" title="solver_interfaces::\lldu_face" alt="" coords="171,5,300,47"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="348,5,495,47"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="543,13,593,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6c2d15a8b8a8951c08409b22918b2080"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::ldud </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>pivtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(inout), optional, allocatable&#160;</td>
          <td class="paramname"><em>perm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(inout), optional, allocatable&#160;</td>
          <td class="paramname"><em>perm2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>destruktivni LDU rozklad </p>
<p>nahradi vstupni matici jejim LDU rozkladem<br />
 A = L*D*U<br />
 L ... dolni trojuhelnikova matice s jednickami na diagonale<br />
 D ... diagonalni matice<br />
 U ... horni trojuhelnikova matice s jednickami na diagonale<br />
 pro volbu pivota plati nasledujici pravidla<br />
 0 ... zadna<br />
 1 ... uplny vyber hlavniho prvku (nutne obe permutace )<br />
 2 ... sloupcovy vyber hlavniho prvku(nutno perm1)<br />
 3 ... radkovy vyber hlavniho prvku(nutno perm2)<br />
 4 ... diagonalni vyber hlavniho prvku(nutno aspon jedna = obe shodne)<br />
 5 ... diagonalni vyber hlavniho prvku pro minimal degree<br />
 (nutno aspon jedna = obe shodne) <br />
 6 ... rid se predepsanou permutaci<br />
 Pro situace 1 az 6 musi byt pritomny permutacni vektory<br />
 Pokud nejsou pozadavky splneny - zvoli se nejpodobnejsi volba<br />
 pro podrobnost informaci plati<br />
 0 ... tichy chod<br />
 1 ... super podrobne<br />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>rozkladana matice, pote s rozkladem</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>pocty operaci</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pivtype</td><td>typ pivotaze</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev</td><td>podrobnost informaci</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">perm1</td><td>permutace pro i</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">perm2</td><td>permutace pro j </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00377">377</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="solvers_8f90_source.html#l00641">adddegree()</a>, and <a class="el" href="solvers_8f90_source.html#l00704">findpivot()</a>.</p>

<p>Referenced by <a class="el" href="solvers_8f90_source.html#l00291">ldu()</a>, and <a class="el" href="solver__interfaces_8f90_source.html#l00012">solver_interfaces::ldu_face()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_cgraph.png" border="0" usemap="#namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_cgraph" alt=""/></div>
<map name="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_cgraph" id="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_cgraph">
<area shape="rect" id="node2" href="solvers_8f90.html#a6725199f29e190b60497398939897fbe" title="vlozi informaci o stupni do seznamu " alt="" coords="149,5,232,32"/>
<area shape="rect" id="node3" href="solvers_8f90.html#a4773d97418706c50f6832edd10604b92" title="vybere pivota a zaznemena to v permutacich " alt="" coords="155,56,226,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_icgraph.png" border="0" usemap="#namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_icgraph" alt=""/></div>
<map name="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_icgraph" id="namespacesolvers_a6c2d15a8b8a8951c08409b22918b2080_icgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc" title="nedestruktivni LDU rozklad " alt="" coords="169,5,259,32"/>
<area shape="rect" id="node3" href="namespacesolver__interfaces.html#affcc4b462663ec74c63d7318e182ff71" title="solver_interfaces::\lldu_face" alt="" coords="149,57,279,98"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="327,57,473,98"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="521,64,572,91"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c0a289ad14e4761a2c621b2914fd0aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::pcg </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Minv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in), optional&#160;</td>
          <td class="paramname"><em>itmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in), optional&#160;</td>
          <td class="paramname"><em>reps1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>itfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>repsfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>cond1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>opcnt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>errcode1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>metoda sdruzenych gradientu <a class="el" href="pcg.html">Metoda predpodminenych sdruzenych gradientu</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy<br />
 musi poskytovat getn, getm, mul (nasobeni vektorem)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minv</td><td>matice predpodmineni - ve skutecnosti operator<br />
 musi poskytovat mul (nasobeni vektorem)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>vektor prave strany</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>aproximace reseni, postupne menena</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itmax1</td><td>maximalni povoleny pocet iteraci, default = n ( Rozmer matice)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps1</td><td>pozadovana relativni zmena rezidua, default = 1e-6</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev1</td><td>informacni podrobnost<br />
<ul>
<li>0 ... pracuj tise</li>
<li>1 ... minimalni informace</li>
<li>10 ... maximalni ukecanost</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">itfin1</td><td>skutecne provedeny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin1</td><td>skutecne dosazena relativni zmena residua</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll1</td><td>odhad nejvetsiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll2</td><td>odhad nejmensiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cond1</td><td>odhad cisla podminenosti : cond1 = ll1/ll2</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">opcnt1</td><td>celkovy pocet provedenych operaci a cas behu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">errcode1</td><td>kod pripadnr chyby<ul>
<li>0 ... OK</li>
<li>1 ... matice neni ctvercova</li>
<li>2 ... nesouhlasi b</li>
<li>3 ... nesouhasi x</li>
<li>4 ... ani jeden z vektoru nesouhlasi</li>
<li>5 ... vycerpan povoleny pocet iteraci</li>
<li>6 ... prestalo klesat residuum i energie </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01704">1704</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="solvers_8f90_source.html#l01952">esteig()</a>, and <a class="el" href="typy_8f90_source.html#l00035">typy::r4</a>.</p>
<div class="fragment"><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a>, r4type=&gt;<a class="code" href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">r4</a></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: minv</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in out)</span> :: x</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: itmax1</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reps1</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev1</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: itfin1</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: repsfin1</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll1</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll2</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: cond1</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: opcnt1</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: errcode1</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: itmax, cnt, n</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordtype">integer</span> :: ilev,rcount, rcount1, errcode</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: reps, repsfin, r0, r1, r2,r3,<a class="code" href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">r4</a>,l1,l2,t1,t2</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: wrk, en, enmin, res2min</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: res,p,ap,&amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        alfa, beta, z</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: opcnt</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        errcode = 0</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode1)) errcode1 = 0</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        n = a%getn()</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        rcount = 0</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        rcount1 = 0</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        l1 = 1</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        l2 = 1</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev1)) then</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        ilev = ilev1</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        else</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            ilev = 0</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itmax1)) then</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        itmax = itmax1</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        else</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            itmax = a%getn()</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,&amp;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            <span class="stringliteral">&quot;nastavuji default hodnotu pro itmax na&quot;</span>,itmax</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keyword">allocate</span>(alfa(0:itmax), beta(0:itmax))</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= a%getm()) then</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                errcode1 = 1</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            return</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            else</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                stop <span class="stringliteral">&quot;CG: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= ubound(b,1)) then</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                errcode1 = 2</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG : nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            else</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                stop <span class="stringliteral">&quot;CG: Nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordflow">if</span> (a%getm() /= ubound(x,1)) then</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                <span class="keywordflow">if</span> (errcode1==0) then</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                    errcode1 = 3</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: nesouhlasi delka reseni&quot;</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                else</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    errcode1 = 4</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;CG: nesouhlasi delky obou vektoru&quot;</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            else</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                stop <span class="stringliteral">&quot;CG: Nesouhlasi delka vektoru neznamych&quot;</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="keywordflow">if</span> (errcode1&gt;0) return</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(reps1) ) then</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        reps = reps1</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        else</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            reps = 1.0e-6</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,<span class="stringliteral">&quot;nastavuji reps na defaultni hodnotu &quot;</span>&amp;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            , reps</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="comment">! ted uz je snad vyrizeno vsechno ze vstupu</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="comment">! jdu pocitat</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        cnt = 0</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="comment">!! Step 1</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        res = b - a%mul(x,opcnt)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        z = minv%mul(res)</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">r4</a> = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,z)</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        r0 = r2</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        p = z</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        opcnt%ad  = n-1</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        opcnt%mul = n</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <span class="comment">!! Step 2</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        do</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="comment">!! Step 3</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            ap =a%mul(p,opcnt)</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            r1 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(p,ap)</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="comment">!!! tady zkontrolovat nulu</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <span class="keywordflow">if</span> ( r1 == 0.0) then</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <span class="comment">! nasypat vysledky</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <span class="comment">! zatim stopka</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                repsfin = 0</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                exit</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            wrk = r2/r1</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;alfa=&quot;</span>,wrk</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            alfa(cnt) = wrk</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="comment">! tenhle usek je jen kvuli vypoctu energie</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            en = -<a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(x,b+res) <span class="comment">! je to vychozi energie</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <span class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            <span class="comment">!! Step 4</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            x = x + wrk*p</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            <span class="comment">!! Step 5</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            res = res - wrk*ap</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            z = minv%mul(res)</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <span class="comment">!! Step 6</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            r3 = r2</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            <a class="code" href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">r4</a> = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,z)</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;            wrk = r2/r3</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;beta=&quot;</span>,wrk</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            beta(cnt) = wrk</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="comment">!! Step 7</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            p = res + wrk*p</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            opcnt%ad  = opcnt%ad  + 4*n-2 + 2*n-1</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            opcnt%mul = opcnt%mul + 4*n   + n</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            opcnt%div = opcnt%div + 1</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="comment">!! odhadnout vlastni cisla</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839">esteig</a>(l1,l2,cnt,alfa,beta)</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            print *, <span class="stringliteral">&quot;odhad vl. cisel:&quot;</span>,l1,l2</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="comment">!! hotovo</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            cnt = cnt + 1</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            <span class="keywordflow">if</span> (cnt==1) then</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                enmin = en</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                res2min = r2</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                <span class="keywordflow">if</span> (r0==0.0_rkind) then</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                    repsfin=0</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                    exit</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="keywordflow">if</span> (en &lt; enmin) then</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                rcount = 0</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            enmin = en</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            else</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                rcount = rcount+1</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <span class="keywordflow">if</span> (r2 &lt; res2min) then</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                res2min = r2</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            rcount1 = 0</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            else</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                rcount1 = rcount1+1</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0)  print *, cnt,sqrt(r2), reps, en, enmin</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keywordflow">if</span> (cnt == itmax) then</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                errcode = 5</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                exit</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            repsfin = sqrt(r2/r0)</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="keywordflow">if</span> (repsfin &lt; reps) exit</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keywordflow">if</span> ((rcount1&gt;5) .and. (rcount &gt; 5)) then</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                errcode = 6</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                exit</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        opcnt%time = t2-t1</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="comment">! vyridit konec</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(opcnt1)) opcnt1 = opcnt</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) errcode1 = errcode</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itfin1)) itfin1 = cnt</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(repsfin1)) repsfin1 = repsfin</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll1)) ll1 = l1</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll2)) ll2 = l2</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(cond1)) cond1 = l1/l2</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="ttc" id="namespacesolvers_html_a02123ec53b1506ac8bf72231f8a96839"><div class="ttname"><a href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839">solvers::esteig</a></div><div class="ttdeci">subroutine, private esteig(l1, l2, n, alfa, beta)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l01952">solvers.f90:1952</a></div></div>
<div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacetypy_html_ac852c2bd4923127662b9ae950f7bd1c0"><div class="ttname"><a href="namespacetypy.html#ac852c2bd4923127662b9ae950f7bd1c0">typy::r4</a></div><div class="ttdeci">integer, parameter r4</div><div class="ttdoc">4byte real </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00035">typy.f90:35</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacepmatools_html_a3bdd52fc0cd0cc30635baeb6f71ec145"><div class="ttname"><a href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">pmatools::dot_product</a></div><div class="ttdeci">real(kind=rkind) function dot_product(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="pmatools_8f90_source.html#l00460">pmatools.f90:460</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a8c0a289ad14e4761a2c621b2914fd0aa_cgraph.png" border="0" usemap="#namespacesolvers_a8c0a289ad14e4761a2c621b2914fd0aa_cgraph" alt=""/></div>
<map name="namespacesolvers_a8c0a289ad14e4761a2c621b2914fd0aa_cgraph" id="namespacesolvers_a8c0a289ad14e4761a2c621b2914fd0aa_cgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839" title="solvers::esteig" alt="" coords="147,5,253,32"/>
<area shape="rect" id="node3" href="namespacesolvers.html#a2d1058e241b99a7efd5929528e145765" title="solvers::vycdet" alt="" coords="301,5,412,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2b54ed5ca5359186cbbe617324c6b86e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::pcgnormal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01919">1919</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

</div>
</div>
<a class="anchor" id="af1a15b562e2ee1cf1273637ca9edaaa4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::sd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in), optional&#160;</td>
          <td class="paramname"><em>itmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in), optional&#160;</td>
          <td class="paramname"><em>reps1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ilev1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(out), optional&#160;</td>
          <td class="paramname"><em>itfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>repsfin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>ll2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out), optional&#160;</td>
          <td class="paramname"><em>cond1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtypy_1_1tcount.html">tcount</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>opcnt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>errcode1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>metoda nejvetsiho spadu ( Steepest descent) podrobnosti viz <a class="el" href="sd.html">"Metoda nejvetsiho spadu"</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>matice soustavy<br />
 musi poskytovat getn, getm, mul (nasobeni vektorem)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>vektor prave strany</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>aproximace reseni, postupne menena</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itmax1</td><td>maximalni povoleny pocet iteraci, default = n ( Rozmer matice)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps1</td><td>pozadovana relativni zmena rezidua, default = 1e-6</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilev1</td><td>informacni podrobnost<br />
<ul>
<li>0 ... pracuj tise</li>
<li>1 ... minimalni informace</li>
<li>10 ... maximalni ukecanost</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">itfin1</td><td>skutecne provedeny pocet iteraci</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">repsfin1</td><td>skutecne dosazena relativni zmena residua</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll1</td><td>odhad nejvetsiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ll2</td><td>odhad nejmensiho vlastniho cisla</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cond1</td><td>odhad cisla podminenosti : cond1 = ll1/ll2</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">opcnt1</td><td>celkovy pocet provedenych operaci a cas behu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">errcode1</td><td>kod pripadne chyby<ul>
<li>0 ... OK</li>
<li>1 ... matice neni ctvercova</li>
<li>2 ... nesouhlasi b</li>
<li>3 ... nesouhasi x</li>
<li>4 ... ani jeden z vektoru nesouhlasi</li>
<li>5 ... vypocet ukoncen pred dosazenim pozadovane presnosti na itmax</li>
<li>6 ... -||-, ale pro ukonceni poklesu energiie i residua </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01037">1037</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>References <a class="el" href="typy_8f90_source.html#l00112">typy::update_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in out)</span> :: x</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: itmax1</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: reps1</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: ilev1</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: itfin1</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: repsfin1</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll1</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: ll2</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: cond1</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: opcnt1</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: errcode1</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: itmax, cnt, n</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordtype">integer</span> :: ilev,rcount, rcount1, errcode</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: reps, repsfin, r0, r1, r2,l1,l2,t1,t2</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: wrk, en, enmin, res2min</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: res</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structtypy_1_1tcount.html">tcount</a>) :: opcnt</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keyword">call </span>cpu_time(t1)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        errcode = 0</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        n = a%getn()</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        rcount = 0</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        rcount1 = 0</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        l1 = 1</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        l2 = 1</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ilev1)) then</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        ilev = ilev1</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        else</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            ilev = 0</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">present</span>(errcode1)) errcode1 = 0</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itmax1)) then</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        itmax = itmax1</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        else</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            itmax = a%getn()</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,&amp;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="stringliteral">&quot;nastavuji default hodnotu pro itmax na&quot;</span>,itmax</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= a%getm()) then</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                errcode1 = 1</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;SD: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            return</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            else</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                stop <span class="stringliteral">&quot;SD: Matice neni ctvercova&quot;</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">if</span> (a%getn() /= ubound(b,1)) then</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                errcode1 = 2</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;SD : nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            else</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                stop <span class="stringliteral">&quot;SD: Nesouhlasi delka prave strany&quot;</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (a%getm() /= ubound(x,1)) then</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">if</span> (errcode1==0) then</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    errcode1 = 3</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;SD: nesouhlasi delka reseni&quot;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                else</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    errcode1 = 4</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;SD: nesouhlasi delky obou vektoru&quot;</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            else</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                stop <span class="stringliteral">&quot;SD: Nesouhlasi delka vektoru neznamych&quot;</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) then</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="keywordflow">if</span> (errcode1&gt;0) return</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(reps1) ) then</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        reps = reps1</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        else</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            reps = 1.0e-6</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <span class="keywordflow">if</span> (ilev==10) print *,<span class="stringliteral">&quot;nastavuji reps na defaultni hodnotu &quot;</span>&amp;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            , reps</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">! ted uz je snad vyrizeno vsechno ze vstupu</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="comment">! jdu pocitat</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        cnt = 0</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">if</span> (ilev &gt;0) print *,<span class="stringliteral">&quot;SD zacina&quot;</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        do</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            res = b - a%mul(x,opcnt)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            r1 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,a%mul(res,opcnt))</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            r2 = <a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(res,res)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            wrk = r2/r1</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="comment">! tenhle usek je jen kvuli vypoctu energie</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            en = -<a class="code" href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">dot_product</a>(x,b+res) <span class="comment">! je to vychozi energie</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            x = x + wrk * res</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            opcnt%ad = opcnt%ad + 4*n-2 +2*n-1</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            opcnt%mul = opcnt%mul + 3*n + n</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            opcnt%div = opcnt%div + 1</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            cnt = cnt + 1</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="keywordflow">if</span> (cnt==1) then</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                enmin = en</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                r0 = r2</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                res2min = r2</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="keywordflow">if</span> (r0==0.0_rkind) then</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    repsfin=0</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    exit</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keyword">                end </span>if</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <span class="keywordflow">if</span> (en &lt; enmin) then</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                rcount = 0</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            enmin = en</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            else</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                rcount = rcount+1</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keywordflow">if</span> (r2 &lt; res2min) then</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                res2min = r2</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            rcount1 = 0</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            else</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                rcount1 = rcount1+1</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="keywordflow">if</span> (ilev&gt;0)  print *, cnt,sqrt(r2), reps, en, enmin</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            <span class="keywordflow">if</span> (cnt == itmax) then</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                errcode = 5</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                exit</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            repsfin = sqrt(r2/r0)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="keywordflow">if</span> (repsfin &lt; reps) exit</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordflow">if</span> ((rcount1&gt;5) .and. (rcount &gt; 5)) then</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                errcode = 6</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                exit</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="keyword">            end </span>if</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keyword">call </span>cpu_time(t2)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        opcnt%time = t2-t1</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">! vyridit konec</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(opcnt1)) <span class="keyword">call </span><a class="code" href="namespacetypy.html#ada3e985608fcf32a049964e60e2428f1">update_info</a>(opcnt1,opcnt)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errcode1)) errcode1 = errcode</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(itfin1)) itfin1 = cnt</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(repsfin1)) repsfin1 = repsfin</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll1)) ll1 = l1  <span class="comment">! tohle zatim nepocita</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(ll2)) ll2 = l2</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(cond1)) cond1 = l1/l2</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">if</span> (ilev&gt;0) print *,<span class="stringliteral">&quot;SD konci&quot;</span></div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="structtypy_1_1tcount_html"><div class="ttname"><a href="structtypy_1_1tcount.html">typy::tcount</a></div><div class="ttdoc">pocitadlo operaci </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00056">typy.f90:56</a></div></div>
<div class="ttc" id="namespacetypy_html_ada3e985608fcf32a049964e60e2428f1"><div class="ttname"><a href="namespacetypy.html#ada3e985608fcf32a049964e60e2428f1">typy::update_info</a></div><div class="ttdeci">subroutine, public update_info(info1, info2)</div><div class="ttdoc">pricte info2 k info1 </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00112">typy.f90:112</a></div></div>
<div class="ttc" id="namespacepmatools_html_a3bdd52fc0cd0cc30635baeb6f71ec145"><div class="ttname"><a href="namespacepmatools.html#a3bdd52fc0cd0cc30635baeb6f71ec145">pmatools::dot_product</a></div><div class="ttdeci">real(kind=rkind) function dot_product(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="pmatools_8f90_source.html#l00460">pmatools.f90:460</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_af1a15b562e2ee1cf1273637ca9edaaa4_cgraph.png" border="0" usemap="#namespacesolvers_af1a15b562e2ee1cf1273637ca9edaaa4_cgraph" alt=""/></div>
<map name="namespacesolvers_af1a15b562e2ee1cf1273637ca9edaaa4_cgraph" id="namespacesolvers_af1a15b562e2ee1cf1273637ca9edaaa4_cgraph">
<area shape="rect" id="node2" href="namespacetypy.html#ada3e985608fcf32a049964e60e2428f1" title="pricte info2 k info1 " alt="" coords="140,5,263,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa902fa11b606f38dab65e0083f33aa2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::sdnormal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01212">1212</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a7b05287bb232863276b29eda2694ab3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public solvers::split </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(in)&#160;</td>
          <td class="paramname"><em>LDU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(out)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(out)&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmtx_1_1matrix.html">matrix</a>), intent(out)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rozdeli matici s LDU rozkladem na jednotlive komponenty </p>
<p>pokud jsou dodany permutace, tak plati</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ldu</td><td>LDU dekompozice</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l</td><td>L cast rozkladu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d</td><td>D cast rozkladu</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u</td><td>U cast rozkladu</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p1</td><td>Leva permutace</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p2</td><td>Prava permutace </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l00812">812</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacemtx.html">mtx</a></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(in)</span> :: <a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(out)</span> :: l</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(out)</span> :: d</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordtype">class</span>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>), <span class="keywordtype">intent(out)</span> :: u</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordtype">integer(Kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: p1</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordtype">integer(Kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: p2</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: n,m,i,j,i1,j1</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="comment">!print *,&quot;split zacina&quot;</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keyword">call </span>l%clone(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keyword">call </span>d%clone(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keyword">call </span>u%clone(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        n=<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getn()</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        m=<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%getm()</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">do</span> i=1,min(n,m)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keyword">call </span>l%set(1.0_rkind,p1(i),p2(i))</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keyword">call </span>u%set(1.0_rkind,p1(i),p2(i))</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keyword">call </span>d%set(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%get(p1(i),p2(i)),p2(i),p1(i))</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">do</span> j=i+1,m</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                i1 = p1(i)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                j1 = p2(j)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keyword">call </span>u%set(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%get(i1,j1),i1,j1)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">do</span> j=i+1,n</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                i1 = p1(j)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                j1 = p2(i)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keyword">call </span>l%set(<a class="code" href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">ldu</a>%get(i1,j1),i1,j1)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword">            end </span>do</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keyword">        end </span>do</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacesolvers_html_a1fb8d3f54b1edc529946756f819b93cc"><div class="ttname"><a href="namespacesolvers.html#a1fb8d3f54b1edc529946756f819b93cc">solvers::ldu</a></div><div class="ttdeci">subroutine, public ldu(A, LU, info, pivtype, ilev, perm1, perm2)</div><div class="ttdoc">nedestruktivni LDU rozklad </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8f90_source.html#l00291">solvers.f90:291</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacemtx_html"><div class="ttname"><a href="namespacemtx.html">mtx</a></div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00019">mtx.f90:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2d1058e241b99a7efd5929528e145765"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, private solvers::vycdet </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(0:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(0:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solvers_8f90_source.html#l01922">1922</a> of file <a class="el" href="solvers_8f90_source.html">solvers.f90</a>.</p>

<p>Referenced by <a class="el" href="solvers_8f90_source.html#l01952">esteig()</a>.</p>
<div class="fragment"><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: x</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(0:)</span>, <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(0:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: n</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordtype">real(kind=rkind)</span> :: y, f1,f2,f3</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="keywordtype">integer(kind=ikind)</span> :: i</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        f1 = 1/a(0)-x</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="keywordflow">if</span> (n==0) then</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            y = f1</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            return</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        f2 = f1*(1/a(1)+b(0)/a(0)-x)-b(0)/a(0)/a(0)</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">if</span> (n==1) then</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            y = f2</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            return</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="keyword">        end </span>if</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="keywordflow">do</span> i=2,n</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            f3 = (1/a(i)+b(i-1)/a(i-1)-x)*f2-b(i-1)/a(i-1)/a(i-1)*f1</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            f1 = f2</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            f2 = f3</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="keyword">        end </span>do</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        y = f3</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolvers_a2d1058e241b99a7efd5929528e145765_icgraph.png" border="0" usemap="#namespacesolvers_a2d1058e241b99a7efd5929528e145765_icgraph" alt=""/></div>
<map name="namespacesolvers_a2d1058e241b99a7efd5929528e145765_icgraph" id="namespacesolvers_a2d1058e241b99a7efd5929528e145765_icgraph">
<area shape="rect" id="node2" href="namespacesolvers.html#a02123ec53b1506ac8bf72231f8a96839" title="solvers::esteig" alt="" coords="164,38,271,65"/>
<area shape="rect" id="node3" href="namespacesolvers.html#a3f42c7320ceede904a3ea977a89693cf" title="metoda sdruzenych gradientu Metoda sdruzenych gradientu " alt="" coords="322,13,409,39"/>
<area shape="rect" id="node5" href="namespacesolvers.html#a8c0a289ad14e4761a2c621b2914fd0aa" title="metoda sdruzenych gradientu Metoda predpodminenych sdruzenych gradientu " alt="" coords="319,63,412,90"/>
<area shape="rect" id="node4" href="namespacesolver__interfaces.html#aeddca7240bf222b090a3b7ae08905998" title="solver_interfaces::\lcg_face" alt="" coords="460,5,589,47"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesolvers.html">solvers</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
