<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DRUtES: dual_coup Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRUtES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacedual__coup.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">dual_coup Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains variants of coupling terms of the dual permeability model. Boundary gets assigned mualem parameters in case(2) and (3). Case(1) The exchange term is calculated based on arithmetic mean of <img class="formulaInl" alt="$Ka=\frac{Ka(hm)+Ka(hf)}{2}$" src="form_15.png"/>. <br />
 Case(2) The exchange term is calculated based on geometric mean of <img class="formulaInl" alt="$Ka=\sqrt{Ka(hm)*Ka(hf)}$" src="form_16.png"/>. <br />
 Case(3) The exchange boundary term is constant.<br />
 Case (4) and (5) don't require further parameters. <br />
 Case(4) The exchange term is the minimum of <img class="formulaInl" alt="$Ka=min(Km(hm),Kf(hf),Km(hf),Kf(hf))$" src="form_17.png"/> <br />
 Case(5) The exchange term is the minimum of <img class="formulaInl" alt="$Ka=min(Km(hm*weight_m+hf*weight_f),Kf(hm*weight_m+hf*weight_f))$" src="form_18.png"/>.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a45c1c65b71e8f97db4a84a2a775b90e5"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedual__coup.html#a45c1c65b71e8f97db4a84a2a775b90e5">dual_coupling</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a45c1c65b71e8f97db4a84a2a775b90e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coupling defined for case(1), case (2) and case (3) Case(1) The exchange term is calculated based on arithmetic mean of <img class="formulaInl" alt="$Ka=\frac{Ka(hm)+Ka(hf)}{2}$" src="form_15.png"/>. <br />
 Case(2) The exchange term is calculated based on geometric mean of <img class="formulaInl" alt="$Ka=\sqrt{Ka(hm)*Ka(hf)}$" src="form_16.png"/>. <br />
 Case(3) The exchange boundary term is constant.<br />
  <a href="#a45c1c65b71e8f97db4a84a2a775b90e5">More...</a><br /></td></tr>
<tr class="separator:a45c1c65b71e8f97db4a84a2a775b90e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a392d4e7e0705fd62f272c62ab400ae68"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedual__coup.html#a392d4e7e0705fd62f272c62ab400ae68">dual_coupling_neg</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a392d4e7e0705fd62f272c62ab400ae68"><td class="mdescLeft">&#160;</td><td class="mdescRight">neg coupling defined for case(1), case (2) and case (3) for coupled matrix, i.e. matrix part in fracture and fracture part in matrix.  <a href="#a392d4e7e0705fd62f272c62ab400ae68">More...</a><br /></td></tr>
<tr class="separator:a392d4e7e0705fd62f272c62ab400ae68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff2a1e14fda6be9ae0ac50bc2cc8f76"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedual__coup.html#a6ff2a1e14fda6be9ae0ac50bc2cc8f76">dual_coup_min</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a6ff2a1e14fda6be9ae0ac50bc2cc8f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following coupling schemes use the minimum value of case(4) <img class="formulaInl" alt="$Ka=min(Km(hm),Kf(hf),Km(hf),Kf(hf))$" src="form_17.png"/> and case(5) <img class="formulaInl" alt="$Ka=min(Km(hm*weight_m+hf*weight_f),Kf(hm*weight_m+hf*weight_f))$" src="form_18.png"/>. <br />
 This has the advantage that no extra parameters need to be defined describing the hydraulic properties at the boundary<br />
 This reduces the number of parameters to be estimated by 3: Kas, a, n <br />
 This also assures that the exchange term is always smaller than or equal the fracture and matrix conductivity.  <a href="#a6ff2a1e14fda6be9ae0ac50bc2cc8f76">More...</a><br /></td></tr>
<tr class="separator:a6ff2a1e14fda6be9ae0ac50bc2cc8f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61aa217a5b2540a81820d9c213f50056"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedual__coup.html#a61aa217a5b2540a81820d9c213f50056">dual_coup_min_neg</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a61aa217a5b2540a81820d9c213f50056"><td class="mdescLeft">&#160;</td><td class="mdescRight">neg coupling defined for case(4) and case (5) for coupled matrix, i.e. matrix part in fracture and fracture part in matrix.  <a href="#a61aa217a5b2540a81820d9c213f50056">More...</a><br /></td></tr>
<tr class="separator:a61aa217a5b2540a81820d9c213f50056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77fbe6b94667bab7c4a93936da557f24"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedual__coup.html#a77fbe6b94667bab7c4a93936da557f24">dual_coupling_k</a> (pde_loc, layer, quadpnt, x)</td></tr>
<tr class="memdesc:a77fbe6b94667bab7c4a93936da557f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">coupling conductivity function for tab values  <a href="#a77fbe6b94667bab7c4a93936da557f24">More...</a><br /></td></tr>
<tr class="separator:a77fbe6b94667bab7c4a93936da557f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains variants of coupling terms of the dual permeability model. Boundary gets assigned mualem parameters in case(2) and (3). Case(1) The exchange term is calculated based on arithmetic mean of <img class="formulaInl" alt="$Ka=\frac{Ka(hm)+Ka(hf)}{2}$" src="form_15.png"/>. <br />
 Case(2) The exchange term is calculated based on geometric mean of <img class="formulaInl" alt="$Ka=\sqrt{Ka(hm)*Ka(hf)}$" src="form_16.png"/>. <br />
 Case(3) The exchange boundary term is constant.<br />
 Case (4) and (5) don't require further parameters. <br />
 Case(4) The exchange term is the minimum of <img class="formulaInl" alt="$Ka=min(Km(hm),Kf(hf),Km(hf),Kf(hf))$" src="form_17.png"/> <br />
 Case(5) The exchange term is the minimum of <img class="formulaInl" alt="$Ka=min(Km(hm*weight_m+hf*weight_f),Kf(hm*weight_m+hf*weight_f))$" src="form_18.png"/>. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a6ff2a1e14fda6be9ae0ac50bc2cc8f76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public dual_coup::dual_coup_min </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The following coupling schemes use the minimum value of case(4) <img class="formulaInl" alt="$Ka=min(Km(hm),Kf(hf),Km(hf),Kf(hf))$" src="form_17.png"/> and case(5) <img class="formulaInl" alt="$Ka=min(Km(hm*weight_m+hf*weight_f),Kf(hm*weight_m+hf*weight_f))$" src="form_18.png"/>. <br />
 This has the advantage that no extra parameters need to be defined describing the hydraulic properties at the boundary<br />
 This reduces the number of parameters to be estimated by 3: Kas, a, n <br />
 This also assures that the exchange term is always smaller than or equal the fracture and matrix conductivity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID </td></tr>
  </table>
  </dd>
</dl>
<p>vg and ex parameters, later from conf file </p>

<p>Definition at line <a class="el" href="_re__dual__coupling_8f90_source.html#l00141">141</a> of file <a class="el" href="_re__dual__coupling_8f90_source.html">Re_dual_coupling.f90</a>.</p>

<p>References <a class="el" href="_re__dual__globals_8f90_source.html#l00045">dual_globals::coup_model</a>, <a class="el" href="_re__dual__tot_h_8f90_source.html#l00122">dual_por::dual_mualem()</a>, <a class="el" href="_re__dual__globals_8f90_source.html#l00071">dual_globals::exchange</a>, <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>, <a class="el" href="_re__dual__globals_8f90_source.html#l00070">dual_globals::vgfracture</a>, and <a class="el" href="_re__dual__globals_8f90_source.html#l00068">dual_globals::vgmatrix</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__coupling_8f90_source.html#l00221">dual_coup_min_neg()</a>, <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, and <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedual__globals.html">dual_globals</a></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>::beta,a,gam_par</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>::weightf,weightm,ks,ksm,ksf</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordtype">real</span>(kind=<a class="code" href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">rkind</a>)                            :: ka_ff,ka_mf,ka_mm,ka_fm,ka,ex_term,ka_m,ka_f</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordtype">real</span>(kind=<a class="code" href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">rkind</a>)                            :: hm,hf</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc     </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      ksm=<a class="code" href="namespacere__globals.html#ac218648bc51273025654afb2c7dbdc78">vgmatrix</a>(layer)%KS_local(1)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      ksf=<a class="code" href="namespacedual__globals.html#a4e09add4a27badb061002e921c28cff0">vgfracture</a>(layer)%KS_local(1) </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        quadpnt_loc%column=1</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        hm = <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(1)%getval(quadpnt_loc)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        hf = <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(2)%getval(quadpnt_loc)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (ubound(x,1) /=2) <span class="keywordflow">then</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              print *, <span class="stringliteral">&quot;ERROR: exchange term requires two variables h&quot;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              error stop</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=2) <span class="keywordflow">then</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;              print *, <span class="stringliteral">&quot;ERROR: exchange term requires two variables h&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              print *, <span class="stringliteral">&quot;exited from RE_dual::dual_coupling&quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              error stop</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordflow">           end if</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;           hm = x(1)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           hf = x(2)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     <span class="keywordflow">select case</span>(<a class="code" href="namespacedual__globals.html#a84403212967c8c21860b5369ee56c6a0">coup_model</a>)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;           <span class="keywordflow">case</span>(4)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                 <span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hm],scalar=ka_mm)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                 <span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hf],scalar=ka_mf)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                 <span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hm],scalar=ka_fm)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                 <span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hf],scalar=ka_ff)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                 ka_ff=ka_ff*ksf</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                 ka_mf=ka_mf*ksm</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                 ka_mm=ka_mm*ksm</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                 ka_fm=ka_fm*ksf</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                 ka=minval((/ka_ff,ka_mf,ka_mm,ka_fm/))</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;       <span class="keywordflow">case</span>(5)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;         weightm=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%weightm</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         weightf=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%weightf</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;         <span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hm*weightm+hf*weightf],scalar<span class="comment">=ka_m)</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">         </span><span class="keyword">call </span>dual_mualem(pde_loc, layer, x=[hm*weightm+hf*weightf],scalar<span class="comment">=ka_f)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">         ka_m=ka_m*ksm</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">         ka_f=ka_f*ksf</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">                 ka=minval((/ka_f,ka_m/))</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span><span class="keywordflow">    end select</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    </div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     beta=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%beta</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     a=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%a</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;     gam_par=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%gam_par</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     <span class="keywordflow">if</span>(abs(hm-hf)&gt;max(hm,hf)*epsilon(hm)) <span class="keywordflow">then</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       ex_term=beta/a**2*gam_par*ka</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;       ex_term=0.0_rkind</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="ttc" id="namespacedual__globals_html_a4e09add4a27badb061002e921c28cff0"><div class="ttname"><a href="namespacedual__globals.html#a4e09add4a27badb061002e921c28cff0">dual_globals::vgfracture</a></div><div class="ttdeci">type(soilpar), dimension(:), allocatable, public vgfracture</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00070">Re_dual_globals.f90:70</a></div></div>
<div class="ttc" id="namespacere__globals_html_ac218648bc51273025654afb2c7dbdc78"><div class="ttname"><a href="namespacere__globals.html#ac218648bc51273025654afb2c7dbdc78">re_globals::vgmatrix</a></div><div class="ttdeci">type(soilpar), dimension(:), allocatable, target, public vgmatrix</div><div class="ttdoc">soil and layer parameters </div><div class="ttdef"><b>Definition:</b> <a href="re__globals_8f90_source.html#l00033">re_globals.f90:33</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacetypy_html_a2169287dfed38b596625c595cf3b5677"><div class="ttname"><a href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">typy::rkind</a></div><div class="ttdeci">integer, parameter, public rkind</div><div class="ttdoc">real number specification </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00026">typy.f90:26</a></div></div>
<div class="ttc" id="namespacedual__globals_html_a84403212967c8c21860b5369ee56c6a0"><div class="ttname"><a href="namespacedual__globals.html#a84403212967c8c21860b5369ee56c6a0">dual_globals::coup_model</a></div><div class="ttdeci">integer(kind=ikind), public coup_model</div><div class="ttdoc">coupling model type </div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00045">Re_dual_globals.f90:45</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacere__dual__reader_html"><div class="ttname"><a href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="ttdoc">This module contains subroutines that read input information from config files and additional input f...</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__reader_8f90_source.html#l00002">Re_dual_reader.f90:2</a></div></div>
<div class="ttc" id="namespacedual__globals_html_a5407ebae154d8d337e3e527b1ee73129"><div class="ttname"><a href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">dual_globals::exchange</a></div><div class="ttdeci">type(expar), dimension(:), allocatable, public exchange</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00071">Re_dual_globals.f90:71</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedual__globals_html"><div class="ttname"><a href="namespacedual__globals.html">dual_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00001">Re_dual_globals.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_cgraph.png" border="0" usemap="#namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_cgraph" alt=""/></div>
<map name="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_cgraph" id="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_cgraph">
<area shape="rect" id="node2" href="namespacedual__por.html#aae8823c30cb66137867252e7604745de" title="defines dispersion functiona according to van Genuchten Mualem model (1980) " alt="" coords="229,5,385,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_icgraph.png" border="0" usemap="#namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_icgraph" alt=""/></div>
<map name="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_icgraph" id="namespacedual__coup_a6ff2a1e14fda6be9ae0ac50bc2cc8f76_icgraph">
<area shape="rect" id="node2" href="namespacedual__coup.html#a61aa217a5b2540a81820d9c213f50056" title="neg coupling defined for case(4) and case (5) for coupled matrix, i.e. matrix part in fracture and fr..." alt="" coords="229,37,377,79"/>
<area shape="rect" id="node3" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="425,5,561,47"/>
<area shape="rect" id="node6" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="425,71,561,112"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="609,39,756,80"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="804,46,855,73"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a61aa217a5b2540a81820d9c213f50056"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public dual_coup::dual_coup_min_neg </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>neg coupling defined for case(4) and case (5) for coupled matrix, i.e. matrix part in fracture and fracture part in matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vg and ex parameters </dd></dl>

<p>Definition at line <a class="el" href="_re__dual__coupling_8f90_source.html#l00221">221</a> of file <a class="el" href="_re__dual__coupling_8f90_source.html">Re_dual_coupling.f90</a>.</p>

<p>References <a class="el" href="_re__dual__coupling_8f90_source.html#l00141">dual_coup_min()</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, and <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedual__globals.html">dual_globals</a></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>   ::ex_term</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          </div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        ex_term=-dual_coup_min(pde_loc, layer, quadpnt)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        ex_term=-dual_coup_min(pde_loc, layer, x=x)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     </div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacere__dual__reader_html"><div class="ttname"><a href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="ttdoc">This module contains subroutines that read input information from config files and additional input f...</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__reader_8f90_source.html#l00002">Re_dual_reader.f90:2</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedual__globals_html"><div class="ttname"><a href="namespacedual__globals.html">dual_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00001">Re_dual_globals.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_cgraph.png" border="0" usemap="#namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_cgraph" alt=""/></div>
<map name="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_cgraph" id="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_cgraph">
<area shape="rect" id="node2" href="namespacedual__coup.html#a6ff2a1e14fda6be9ae0ac50bc2cc8f76" title="The following coupling schemes use the minimum value of case(4) &#160;and case(5) . &#160;&#160;This has the advanta..." alt="" coords="201,13,377,39"/>
<area shape="rect" id="node3" href="namespacedual__por.html#aae8823c30cb66137867252e7604745de" title="defines dispersion functiona according to van Genuchten Mualem model (1980) " alt="" coords="425,13,581,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_icgraph.png" border="0" usemap="#namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_icgraph" alt=""/></div>
<map name="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_icgraph" id="namespacedual__coup_a61aa217a5b2540a81820d9c213f50056_icgraph">
<area shape="rect" id="node2" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="201,5,337,47"/>
<area shape="rect" id="node5" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="201,71,337,112"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="385,39,532,80"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="580,46,631,73"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45c1c65b71e8f97db4a84a2a775b90e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public dual_coup::dual_coupling </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coupling defined for case(1), case (2) and case (3) Case(1) The exchange term is calculated based on arithmetic mean of <img class="formulaInl" alt="$Ka=\frac{Ka(hm)+Ka(hf)}{2}$" src="form_15.png"/>. <br />
 Case(2) The exchange term is calculated based on geometric mean of <img class="formulaInl" alt="$Ka=\sqrt{Ka(hm)*Ka(hf)}$" src="form_16.png"/>. <br />
 Case(3) The exchange boundary term is constant.<br />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID </td></tr>
  </table>
  </dd>
</dl>
<p>vg and ex parameters, later from conf file </p>

<p>Definition at line <a class="el" href="_re__dual__coupling_8f90_source.html#l00029">29</a> of file <a class="el" href="_re__dual__coupling_8f90_source.html">Re_dual_coupling.f90</a>.</p>

<p>References <a class="el" href="_re__dual__globals_8f90_source.html#l00045">dual_globals::coup_model</a>, <a class="el" href="_re__dual__globals_8f90_source.html#l00071">dual_globals::exchange</a>, <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>, and <a class="el" href="_re__dual__globals_8f90_source.html#l00069">dual_globals::vgexchange</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__coupling_8f90_source.html#l00109">dual_coupling_neg()</a>, <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, and <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedual__globals.html">dual_globals</a></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>::beta,a,gam_par</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>::n,m,alpha,ks</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">real</span>(kind=<a class="code" href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">rkind</a>)                            :: ka_f,ka_m,ka,ex_term</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordtype">real</span>(kind=<a class="code" href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">rkind</a>)                            :: hm,hf,one</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc     </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;       </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        hm = <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(1)%getval(quadpnt_loc)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        hf = <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(2)%getval(quadpnt_loc)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">if</span> (ubound(x,1) /=2) <span class="keywordflow">then</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;              print *, <span class="stringliteral">&quot;ERROR: exchange term requires two variables h&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;              print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;              error stop</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (ubound(x,1) /=2) <span class="keywordflow">then</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;              print *, <span class="stringliteral">&quot;ERROR: exchange term requires two variables h&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;              print *, <span class="stringliteral">&quot;exited from RE_dual::dual_coupling&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;              error stop</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordflow">           end if</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;           hm = x(1)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;           hf = x(2)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;     alpha=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%alpha</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;     n=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%n</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;     m=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%m</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;     ks=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%KS_local(1)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;     one=1.0_rkind   </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;     <span class="keywordflow">if</span>(hf&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       ka_f=(one-abs(alpha*hf)**(n*m)*(one+abs(alpha*hf)**n)**(-m))**2/(one<span class="comment">+abs(alpha*hf)**n)**(m/2)</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">     </span><span class="keywordflow">else</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       ka_f=1.0_rkind</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;     <span class="keywordflow">if</span>(hm&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       ka_m=(one-abs(alpha*hm)**(n*m)*(one+abs(alpha*hm)**n)**(-m))**2/(one<span class="comment">+abs(alpha*hm)**n)**(m/2)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">     </span><span class="keywordflow">else</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       ka_m=1.0_rkind</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordflow">     end if</span>  </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;     <span class="keywordflow">select case</span>(<a class="code" href="namespacedual__globals.html#a84403212967c8c21860b5369ee56c6a0">coup_model</a>)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;           <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         ka=0.5*(ka_f+ka_m)*ks</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         ka=(ka_f*ka_m)**0.5_rkind*ks</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <span class="keywordflow">case</span>(3)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         ka=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%KS_local(1)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;     beta=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%beta</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     a=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%a</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;     gam_par=<a class="code" href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">exchange</a>(layer)%gam_par</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;     <span class="keywordflow">if</span>(abs(hm-hf)&gt;max(hm,hf)*epsilon(hm)) <span class="keywordflow">then</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       ex_term=beta/a**2*gam_par*ka</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       ex_term=0.0_rkind</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacetypy_html_a2169287dfed38b596625c595cf3b5677"><div class="ttname"><a href="namespacetypy.html#a2169287dfed38b596625c595cf3b5677">typy::rkind</a></div><div class="ttdeci">integer, parameter, public rkind</div><div class="ttdoc">real number specification </div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00026">typy.f90:26</a></div></div>
<div class="ttc" id="namespacedual__globals_html_a84403212967c8c21860b5369ee56c6a0"><div class="ttname"><a href="namespacedual__globals.html#a84403212967c8c21860b5369ee56c6a0">dual_globals::coup_model</a></div><div class="ttdeci">integer(kind=ikind), public coup_model</div><div class="ttdoc">coupling model type </div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00045">Re_dual_globals.f90:45</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacere__dual__reader_html"><div class="ttname"><a href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="ttdoc">This module contains subroutines that read input information from config files and additional input f...</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__reader_8f90_source.html#l00002">Re_dual_reader.f90:2</a></div></div>
<div class="ttc" id="namespacedual__globals_html_a5407ebae154d8d337e3e527b1ee73129"><div class="ttname"><a href="namespacedual__globals.html#a5407ebae154d8d337e3e527b1ee73129">dual_globals::exchange</a></div><div class="ttdeci">type(expar), dimension(:), allocatable, public exchange</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00071">Re_dual_globals.f90:71</a></div></div>
<div class="ttc" id="namespacedual__globals_html_ae684f40b743ae05201c926981ec8cecb"><div class="ttname"><a href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">dual_globals::vgexchange</a></div><div class="ttdeci">type(exch_k), dimension(:), allocatable, public vgexchange</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00069">Re_dual_globals.f90:69</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedual__globals_html"><div class="ttname"><a href="namespacedual__globals.html">dual_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00001">Re_dual_globals.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a45c1c65b71e8f97db4a84a2a775b90e5_icgraph.png" border="0" usemap="#namespacedual__coup_a45c1c65b71e8f97db4a84a2a775b90e5_icgraph" alt=""/></div>
<map name="namespacedual__coup_a45c1c65b71e8f97db4a84a2a775b90e5_icgraph" id="namespacedual__coup_a45c1c65b71e8f97db4a84a2a775b90e5_icgraph">
<area shape="rect" id="node2" href="namespacedual__coup.html#a392d4e7e0705fd62f272c62ab400ae68" title="neg coupling defined for case(1), case (2) and case (3) for coupled matrix, i.e. matrix part in fract..." alt="" coords="221,45,417,71"/>
<area shape="rect" id="node3" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="465,5,601,47"/>
<area shape="rect" id="node6" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="465,71,601,112"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="649,39,796,80"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="844,46,895,73"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a77fbe6b94667bab7c4a93936da557f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public dual_coup::dual_coupling_k </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>coupling conductivity function for tab values </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_re__dual__coupling_8f90_source.html#l00251">251</a> of file <a class="el" href="_re__dual__coupling_8f90_source.html">Re_dual_coupling.f90</a>.</p>

<p>References <a class="el" href="_re__dual__globals_8f90_source.html#l00069">dual_globals::vgexchange</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__tab_8f90_source.html#l00280">dual_tab::dual_coupling_tab()</a>, <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, and <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacedual__globals.html">dual_globals</a></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>::ka_c</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>::n,m,alpha</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>:: one,h</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>) :: quadpnt_loc</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        quadpnt_loc=quadpnt</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        quadpnt_loc%preproc=.true.</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        h = pde_loc%getval(quadpnt_loc)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         <span class="keywordflow">if</span> (ubound(x,1) /=1) <span class="keywordflow">then</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;           print *, <span class="stringliteral">&quot;ERROR: van Genuchten function is a function of a single variable h&quot;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;           print *, <span class="stringliteral">&quot;       your input data has:&quot;</span>, ubound(x,1), <span class="stringliteral">&quot;variables&quot;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;           print *, <span class="stringliteral">&quot;exited from RE_dual::dual_coupling_K&quot;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;           error stop</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">         end if</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;           h = x(1)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">     end if</span>  </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    alpha=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%alpha</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    n=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%n</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    m=<a class="code" href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">vgexchange</a>(layer)%m</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    one=1.0_rkind </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span>(h&lt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      ka_c=(one-(alpha*abs(h))**(n*m)*(one+(alpha*abs(h))**n)**(-m))**2/(one+(alpha*abs(h))**n)**(m/2)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      ka_c=1.0_rkind</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordflow">    end if</span></div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacere__dual__reader_html"><div class="ttname"><a href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="ttdoc">This module contains subroutines that read input information from config files and additional input f...</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__reader_8f90_source.html#l00002">Re_dual_reader.f90:2</a></div></div>
<div class="ttc" id="namespacedual__globals_html_ae684f40b743ae05201c926981ec8cecb"><div class="ttname"><a href="namespacedual__globals.html#ae684f40b743ae05201c926981ec8cecb">dual_globals::vgexchange</a></div><div class="ttdeci">type(exch_k), dimension(:), allocatable, public vgexchange</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00069">Re_dual_globals.f90:69</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedual__globals_html"><div class="ttname"><a href="namespacedual__globals.html">dual_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00001">Re_dual_globals.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a77fbe6b94667bab7c4a93936da557f24_icgraph.png" border="0" usemap="#namespacedual__coup_a77fbe6b94667bab7c4a93936da557f24_icgraph" alt=""/></div>
<map name="namespacedual__coup_a77fbe6b94667bab7c4a93936da557f24_icgraph" id="namespacedual__coup_a77fbe6b94667bab7c4a93936da557f24_icgraph">
<area shape="rect" id="node2" href="namespacedual__tab.html#afffe9ba95899c3c5bb0c1d53929c5ed3" title="Tabular versions of coupling term for case(1) and case(2) " alt="" coords="236,58,419,85"/>
<area shape="rect" id="node3" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="673,96,809,137"/>
<area shape="rect" id="node6" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="673,5,809,47"/>
<area shape="rect" id="node7" href="namespacedual__tab.html#afde4065ace745063aac1c62ea6d318f8" title="dual_tab::dual_coupling\l_neg_tab" alt="" coords="467,51,625,92"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="857,51,1004,92"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1052,58,1103,85"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a392d4e7e0705fd62f272c62ab400ae68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public dual_coup::dual_coupling_neg </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>neg coupling defined for case(1), case (2) and case (3) for coupled matrix, i.e. matrix part in fracture and fracture part in matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>value of the nonlinear function</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quadpnt</td><td>Gauss quadrature point structure (element number and rank of Gauss quadrature point)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>material ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vg and ex parameters, later from conf file </dd></dl>

<p>Definition at line <a class="el" href="_re__dual__coupling_8f90_source.html#l00109">109</a> of file <a class="el" href="_re__dual__coupling_8f90_source.html">Re_dual_coupling.f90</a>.</p>

<p>References <a class="el" href="_re__dual__coupling_8f90_source.html#l00029">dual_coupling()</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__pointers_8f90_source.html#l00084">re_dual_pointers::re_fracture()</a>, and <a class="el" href="_re__dual__pointers_8f90_source.html#l00008">re_dual_pointers::re_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedual__globals.html">dual_globals</a></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in)</span> :: pde_loc</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>    :: x</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: quadpnt</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: layer</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>   ::ex_term</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(quadpnt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        ex_term=-dual_coupling(pde_loc, layer, quadpnt)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(x)) <span class="keywordflow">then</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        ex_term=-dual_coupling(pde_loc, layer, x=x)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     </div><div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacere__dual__reader_html"><div class="ttname"><a href="namespacere__dual__reader.html">re_dual_reader</a></div><div class="ttdoc">This module contains subroutines that read input information from config files and additional input f...</div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__reader_8f90_source.html#l00002">Re_dual_reader.f90:2</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedual__globals_html"><div class="ttname"><a href="namespacedual__globals.html">dual_globals</a></div><div class="ttdef"><b>Definition:</b> <a href="_re__dual__globals_8f90_source.html#l00001">Re_dual_globals.f90:1</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_cgraph.png" border="0" usemap="#namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_cgraph" alt=""/></div>
<map name="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_cgraph" id="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_cgraph">
<area shape="rect" id="node2" href="namespacedual__coup.html#a45c1c65b71e8f97db4a84a2a775b90e5" title="Coupling defined for case(1), case (2) and case (3) Case(1) The exchange term is calculated based on ..." alt="" coords="249,5,417,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_icgraph.png" border="0" usemap="#namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_icgraph" alt=""/></div>
<map name="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_icgraph" id="namespacedual__coup_a392d4e7e0705fd62f272c62ab400ae68_icgraph">
<area shape="rect" id="node2" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="249,5,385,47"/>
<area shape="rect" id="node5" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="249,71,385,112"/>
<area shape="rect" id="node3" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="433,39,580,80"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="628,46,679,73"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedual__coup.html">dual_coup</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
