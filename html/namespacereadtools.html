<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DRUtES: readtools Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRUtES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacereadtools.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">readtools Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacereadtools_1_1fileread.html">fileread</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac12ae881ea7a5ba805dbaa99ea315575"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#ac12ae881ea7a5ba805dbaa99ea315575">read_int</a> (i, fileid, errmsg, ranges, minimal, maximal, noexit)</td></tr>
<tr class="separator:ac12ae881ea7a5ba805dbaa99ea315575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e211935d2b6e1861f565eac28cdf9d"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a42e211935d2b6e1861f565eac28cdf9d">read_int_std</a> (i, fileid, errmsg, ranges, noexit)</td></tr>
<tr class="separator:a42e211935d2b6e1861f565eac28cdf9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988d0a7b5d8e2f02f0c7249f640c5984"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a988d0a7b5d8e2f02f0c7249f640c5984">read_int_array</a> (r, fileid, ranges, errmsg, checklen, noexit)</td></tr>
<tr class="separator:a988d0a7b5d8e2f02f0c7249f640c5984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf69cd43a457ddd1b29072139f19772"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a8cf69cd43a457ddd1b29072139f19772">read_real</a> (r, fileid, ranges, errmsg, noexit)</td></tr>
<tr class="separator:a8cf69cd43a457ddd1b29072139f19772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d67f6775ad72824c723f1b5d4f20b9c"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a5d67f6775ad72824c723f1b5d4f20b9c">read_real_array</a> (r, fileid, ranges, errmsg, checklen, noexit)</td></tr>
<tr class="separator:a5d67f6775ad72824c723f1b5d4f20b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61d10db1818ad3ee4ef1672b63b2909"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#ad61d10db1818ad3ee4ef1672b63b2909">read_char</a> (ch, fileid, errmsg, options, noexit)</td></tr>
<tr class="separator:ad61d10db1818ad3ee4ef1672b63b2909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e66cd8958ea07c3fb41f4dc80556c7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a13e66cd8958ea07c3fb41f4dc80556c7">read_logical</a> (l, fileid, errmsg, noexit)</td></tr>
<tr class="separator:a13e66cd8958ea07c3fb41f4dc80556c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9481f44f055c2f4bc518a4b91db43b5c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a> (iunit, message)</td></tr>
<tr class="separator:a9481f44f055c2f4bc518a4b91db43b5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8bc95060d3f5e8bfb8d4e4519c3568a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a> (Unit)</td></tr>
<tr class="separator:ab8bc95060d3f5e8bfb8d4e4519c3568a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718f41934d7cc35a0c4f8d4107a69029"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a718f41934d7cc35a0c4f8d4107a69029">set_tensor</a> (values, angle, tensor)</td></tr>
<tr class="memdesc:a718f41934d7cc35a0c4f8d4107a69029"><td class="mdescLeft">&#160;</td><td class="mdescRight">this procedure set up an anisothropy tensor, the local anisothrophy values are supllied in values array, angle is the angle between the local and global system, tensor is the resulting secodn order tensor  <a href="#a718f41934d7cc35a0c4f8d4107a69029">More...</a><br /></td></tr>
<tr class="separator:a718f41934d7cc35a0c4f8d4107a69029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35dde6b411a1476727771fcb8f5d1bc9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacereadtools.html#a35dde6b411a1476727771fcb8f5d1bc9">readbcvals</a> (unitW, struct, dimen, dirname)</td></tr>
<tr class="separator:a35dde6b411a1476727771fcb8f5d1bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ab8bc95060d3f5e8bfb8d4e4519c3568a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public readtools::comment </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Unit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00526">526</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>Referenced by <a class="el" href="_a_d_e__reader_8f90_source.html#l00007">ade_reader::ade_read()</a>, <a class="el" href="boussread_8f90_source.html#l00006">boussread::boussreader()</a>, <a class="el" href="geom__tools_8f90_source.html#l01020">geom_tools::map1d2d()</a>, <a class="el" href="geom__tools_8f90_source.html#l01122">geom_tools::map1d2dj()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00314">re_dual_reader::re_dual_readf()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00264">re_dual_reader::re_dual_readm()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00007">re_dual_reader::re_dual_var()</a>, <a class="el" href="read__inputs_8f90_source.html#l00272">read_inputs::read_1dmesh_int()</a>, <a class="el" href="read__inputs_8f90_source.html#l00347">read_inputs::read_2dmesh_int()</a>, <a class="el" href="read__inputs_8f90_source.html#l00396">read_inputs::read_2dmesh_t3d()</a>, <a class="el" href="readtools_8f90_source.html#l00369">read_char()</a>, <a class="el" href="decomposer_8f90_source.html#l00660">decomposer::read_coarse_mesh()</a>, <a class="el" href="readtools_8f90_source.html#l00022">read_int()</a>, <a class="el" href="readtools_8f90_source.html#l00109">read_int_array()</a>, <a class="el" href="readtools_8f90_source.html#l00062">read_int_std()</a>, <a class="el" href="readtools_8f90_source.html#l00418">read_logical()</a>, <a class="el" href="readtools_8f90_source.html#l00219">read_real()</a>, <a class="el" href="readtools_8f90_source.html#l00259">read_real_array()</a>, <a class="el" href="readtools_8f90_source.html#l00603">readbcvals()</a>, <a class="el" href="objfnc_8f90_source.html#l00036">objfnc::reader()</a>, and <a class="el" href="re__reader_8f90_source.html#l00009">re_reader::res_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: unit</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="comment">!character(len=1), intent(in), optional :: mark</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordtype">character(len=1)</span> :: symbol</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordtype">character(len=1)</span> :: string</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordtype">integer</span> :: i_err</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="comment">!if (present(mark)) then</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">!   symbol = mark</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">!else</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        symbol = <span class="stringliteral">&quot;#&quot;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">! end if</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keyword">read</span>(unit=unit,fmt = *, iostat = i_err ) string</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (i_err &lt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span> (string == symbol) <span class="keywordflow">then</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          backspace unit</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          </div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a_icgraph.png" border="0" usemap="#namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a_icgraph" alt=""/></div>
<map name="namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a_icgraph" id="namespacereadtools_ab8bc95060d3f5e8bfb8d4e4519c3568a_icgraph">
<area shape="rect" id="node2" href="namespaceade__reader.html#ab579f926de43ae5ba712d144494109fb" title="ade_reader::ade_read" alt="" coords="446,563,593,589"/>
<area shape="rect" id="node6" href="namespaceboussread.html#af206b475e8ec2d4ed9f54c22e829a40e" title="boussread::boussreader" alt="" coords="439,680,600,707"/>
<area shape="rect" id="node8" href="namespacegeom__tools.html#a414b4c651eccb3bab087a28455f38ba7" title="geom_tools::map1d2d" alt="" coords="215,107,366,133"/>
<area shape="rect" id="node9" href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845" title="geom_tools::map1d2dj" alt="" coords="443,400,596,427"/>
<area shape="rect" id="node19" href="namespacere__dual__reader.html#a23cf85f4d1be812361380db52c0e7e33" title="re_dual_reader::re\l_dual_readf" alt="" coords="456,325,583,366"/>
<area shape="rect" id="node20" href="namespacere__dual__reader.html#a4f07052339a41711165f3d85d2b7eefc" title="re_dual_reader::re\l_dual_readm" alt="" coords="456,259,583,301"/>
<area shape="rect" id="node21" href="namespacere__dual__reader.html#a3ddb497789d4da4dea2afc55f283cf4b" title="re_dual_reader::re\l_dual_var" alt="" coords="690,189,817,230"/>
<area shape="rect" id="node22" href="namespaceread__inputs.html#adaa82a67c86871d224f9ad95b8b93b3f" title="read_inputs::read_1dmesh_int" alt="" coords="193,5,389,32"/>
<area shape="rect" id="node24" href="namespaceread__inputs.html#a16c9c0b91377d9e1ab81e838c6244ada" title="read_inputs::read_2dmesh_int" alt="" coords="193,56,389,83"/>
<area shape="rect" id="node25" href="namespaceread__inputs.html#a013c60909c14ff644c9ed8e1c0b49279" title="loads mesh data files from external mesh generator and allocate required mesh structures ..." alt="" coords="191,157,391,184"/>
<area shape="rect" id="node26" href="namespacereadtools.html#ad61d10db1818ad3ee4ef1672b63b2909" title="readtools::read_char" alt="" coords="221,512,361,539"/>
<area shape="rect" id="node27" href="namespacedecomposer.html#a9ce50809a5a28381c14ba27ff5284722" title="decomposer::read_coarse_mesh" alt="" coords="648,884,859,911"/>
<area shape="rect" id="node29" href="namespacereadtools.html#ac12ae881ea7a5ba805dbaa99ea315575" title="readtools::read_int" alt="" coords="226,613,355,640"/>
<area shape="rect" id="node30" href="namespacereadtools.html#a988d0a7b5d8e2f02f0c7249f640c5984" title="readtools::read_int\l_array" alt="" coords="226,665,355,706"/>
<area shape="rect" id="node31" href="namespacereadtools.html#a42e211935d2b6e1861f565eac28cdf9d" title="readtools::read_int_std" alt="" coords="213,731,368,757"/>
<area shape="rect" id="node32" href="namespacereadtools.html#a13e66cd8958ea07c3fb41f4dc80556c7" title="readtools::read_logical" alt="" coords="215,781,367,808"/>
<area shape="rect" id="node33" href="namespacereadtools.html#a8cf69cd43a457ddd1b29072139f19772" title="readtools::read_real" alt="" coords="223,832,359,859"/>
<area shape="rect" id="node34" href="namespacereadtools.html#a5d67f6775ad72824c723f1b5d4f20b9c" title="readtools::read_real\l_array" alt="" coords="223,883,359,925"/>
<area shape="rect" id="node35" href="namespacereadtools.html#a35dde6b411a1476727771fcb8f5d1bc9" title="readtools::readbcvals" alt="" coords="217,461,364,488"/>
<area shape="rect" id="node38" href="namespacere__reader.html#abee07a4923b280459f7a1b135cc70346" title="opens and reads water.conf/matrix.conf, input data for the Richards equation in single mode..." alt="" coords="452,461,587,488"/>
<area shape="rect" id="node40" href="namespaceobjfnc.html#ac0a20b2f9874813942bd7dc35e3b4842" title="objfnc::reader" alt="" coords="703,1012,804,1039"/>
<area shape="rect" id="node3" href="namespaceade__pointers.html#adcdbd3c086467f4845b54788e253d694" title="ade_pointers::ade" alt="" coords="919,629,1044,656"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="1116,495,1263,537"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1323,715,1373,741"/>
<area shape="rect" id="node7" href="namespacebousspointers.html#aa29fe327913d573ed19bbd1a6b11f0b5" title="bousspointers::boussi" alt="" coords="907,680,1056,707"/>
<area shape="rect" id="node10" href="namespacedual__por.html#a56d450c18eee19012cb05d2b1dd008e1" title="assigns initial condition " alt="" coords="678,356,829,383"/>
<area shape="rect" id="node13" href="namespacere__constitutive.html#a7a0c1ec8d57856234ae33b61eab450f2" title="re_constitutive::re\l_initcond" alt="" coords="690,407,817,449"/>
<area shape="rect" id="node16" href="namespacere__total.html#a5d572dd5f6da46314cdd0d5039c2db7c" title="re_total::retot_initcond" alt="" coords="678,524,829,551"/>
<area shape="rect" id="node11" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="913,310,1049,351"/>
<area shape="rect" id="node12" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="913,245,1049,286"/>
<area shape="rect" id="node14" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="918,376,1045,403"/>
<area shape="rect" id="node15" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="916,427,1047,453"/>
<area shape="rect" id="node17" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="918,477,1045,504"/>
<area shape="rect" id="node18" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="916,528,1047,555"/>
<area shape="rect" id="node23" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="458,95,581,137"/>
<area shape="rect" id="node28" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="1104,780,1275,807"/>
<area shape="rect" id="node36" href="namespaceheat__reader.html#a9546371591bb68c6f89b2c9ef80cd42b" title="heat_reader::heat_read" alt="" coords="442,512,597,539"/>
<area shape="rect" id="node37" href="namespaceheat__pointers.html#a722171d0f13e6c6c18092dfdbca69220" title="heat_pointers::heat" alt="" coords="687,576,820,603"/>
<area shape="rect" id="node39" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="671,473,835,500"/>
<area shape="rect" id="node41" href="namespaceobjfnc.html#aa9a5392e2af633f2f53554a6f6f93026" title="objfnc::get_objval" alt="" coords="1127,903,1251,929"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9481f44f055c2f4bc518a4b91db43b5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public readtools::file_error </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00461">461</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>

<p>Referenced by <a class="el" href="_a_d_e__reader_8f90_source.html#l00007">ade_reader::ade_read()</a>, <a class="el" href="decomposer_8f90_source.html#l00013">decomposer::init_decomp()</a>, <a class="el" href="geom__tools_8f90_source.html#l01020">geom_tools::map1d2d()</a>, <a class="el" href="geom__tools_8f90_source.html#l01122">geom_tools::map1d2dj()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00007">re_dual_reader::re_dual_var()</a>, <a class="el" href="read__inputs_8f90_source.html#l00272">read_inputs::read_1dmesh_int()</a>, <a class="el" href="read__inputs_8f90_source.html#l00347">read_inputs::read_2dmesh_int()</a>, <a class="el" href="readtools_8f90_source.html#l00369">read_char()</a>, <a class="el" href="read__inputs_8f90_source.html#l00011">read_inputs::read_global()</a>, <a class="el" href="readtools_8f90_source.html#l00022">read_int()</a>, <a class="el" href="readtools_8f90_source.html#l00109">read_int_array()</a>, <a class="el" href="readtools_8f90_source.html#l00062">read_int_std()</a>, <a class="el" href="readtools_8f90_source.html#l00418">read_logical()</a>, <a class="el" href="readtools_8f90_source.html#l00219">read_real()</a>, <a class="el" href="readtools_8f90_source.html#l00259">read_real_array()</a>, <a class="el" href="readtools_8f90_source.html#l00603">readbcvals()</a>, <a class="el" href="objfnc_8f90_source.html#l00036">objfnc::reader()</a>, <a class="el" href="re__reader_8f90_source.html#l00009">re_reader::res_read()</a>, and <a class="el" href="simegen_8f90_source.html#l00009">simegen::simegen1d()</a>.</p>
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: iunit</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: message</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">character(len=512)</span> :: filename</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordtype">character(len=256)</span> :: iaction, numero</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordtype">integer</span> :: line, i, i_err, i3, i4, i5, fileid, err_read</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordtype">integer(4)</span> :: i1, i2</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordtype">character(len=4096)</span> :: string </div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      string = <span class="stringliteral">&quot;last value&quot;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      i1=-100</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      i2=-100</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keyword">inquire</span>(unit=iunit, name=filename, action=iaction) </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      line = 1</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      backspace(unit=iunit, iostat = i_err)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keyword">read</span>(unit=iunit, fmt=*, iostat = err_read) string</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        i1 = ftell(iunit)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        backspace(unit=iunit, iostat=i_err)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        line = line + 1</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        i2 = ftell(iunit)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> (i1 == i2) <span class="keywordflow">then</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">if</span> (line &lt;= 2) <span class="keywordflow">then</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        print *, <span class="stringliteral">&quot;-------------------------------------------------------------------&quot;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        print *, <span class="stringliteral">&quot;WARNING: the line number was identified incorrectly, &quot;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        print *, <span class="stringliteral">&quot;likely it is a compiler error in ftell function, &quot;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        print *, <span class="stringliteral">&quot;find the input error on your own. :(&quot;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      print *, <span class="stringliteral">&quot;-------------------------------------------------------------------&quot;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      print *, <span class="stringliteral">&quot;  &quot;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      print *, <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;!!ERROR!!&quot;</span> //achar(27)//<span class="stringliteral">&#39;[0m&#39;</span>, <span class="comment">&amp;</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">                  </span><span class="stringliteral">&quot;  in reading from file: &quot;</span>, trim(filename), <span class="stringliteral">&quot; near line: &quot;</span><span class="comment">, line-1, &amp;</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">                      </span><span class="stringliteral">&quot; opened with status: &quot;</span>, trim(iaction),  <span class="stringliteral">&quot; -&gt; exiting DRUtES&quot;</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      print *, <span class="stringliteral">&quot;  &quot;</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      </div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">!       if (i_err == 0) then </span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">if</span> (err_read == 0) <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot;the value you have typed is: &quot;</span><span class="comment">, trim(string)</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">        </span><span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot;--------------------------------&quot;</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">!       end if</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(message)) <span class="keywordflow">then</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, trim(message) //achar<span class="comment">(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      error stop</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c_icgraph.png" border="0" usemap="#namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c_icgraph" alt=""/></div>
<map name="namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c_icgraph" id="namespacereadtools_a9481f44f055c2f4bc518a4b91db43b5c_icgraph">
<area shape="rect" id="node2" href="namespaceade__reader.html#ab579f926de43ae5ba712d144494109fb" title="ade_reader::ade_read" alt="" coords="414,5,561,32"/>
<area shape="rect" id="node6" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="1029,555,1200,581"/>
<area shape="rect" id="node7" href="namespacegeom__tools.html#a414b4c651eccb3bab087a28455f38ba7" title="geom_tools::map1d2d" alt="" coords="189,796,339,823"/>
<area shape="rect" id="node8" href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845" title="geom_tools::map1d2dj" alt="" coords="411,391,564,417"/>
<area shape="rect" id="node18" href="namespacere__dual__reader.html#a3ddb497789d4da4dea2afc55f283cf4b" title="re_dual_reader::re\l_dual_var" alt="" coords="652,318,779,359"/>
<area shape="rect" id="node19" href="namespaceread__inputs.html#adaa82a67c86871d224f9ad95b8b93b3f" title="read_inputs::read_1dmesh_int" alt="" coords="389,609,585,636"/>
<area shape="rect" id="node21" href="namespaceread__inputs.html#a16c9c0b91377d9e1ab81e838c6244ada" title="read_inputs::read_2dmesh_int" alt="" coords="389,677,585,704"/>
<area shape="rect" id="node22" href="namespacereadtools.html#ad61d10db1818ad3ee4ef1672b63b2909" title="readtools::read_char" alt="" coords="194,847,334,873"/>
<area shape="rect" id="node23" href="namespaceread__inputs.html#a9b0f9c757631596bdead541938506c2c" title="read_inputs::read_global" alt="" coords="406,551,569,577"/>
<area shape="rect" id="node24" href="namespacereadtools.html#ac12ae881ea7a5ba805dbaa99ea315575" title="readtools::read_int" alt="" coords="199,897,329,924"/>
<area shape="rect" id="node25" href="namespacereadtools.html#a988d0a7b5d8e2f02f0c7249f640c5984" title="readtools::read_int\l_array" alt="" coords="199,949,329,990"/>
<area shape="rect" id="node26" href="namespacereadtools.html#a42e211935d2b6e1861f565eac28cdf9d" title="readtools::read_int_std" alt="" coords="187,1015,341,1041"/>
<area shape="rect" id="node27" href="namespacereadtools.html#a13e66cd8958ea07c3fb41f4dc80556c7" title="readtools::read_logical" alt="" coords="188,1065,340,1092"/>
<area shape="rect" id="node28" href="namespacereadtools.html#a8cf69cd43a457ddd1b29072139f19772" title="readtools::read_real" alt="" coords="196,1116,332,1143"/>
<area shape="rect" id="node29" href="namespacereadtools.html#a5d67f6775ad72824c723f1b5d4f20b9c" title="readtools::read_real\l_array" alt="" coords="196,1167,332,1209"/>
<area shape="rect" id="node30" href="namespacereadtools.html#a35dde6b411a1476727771fcb8f5d1bc9" title="readtools::readbcvals" alt="" coords="191,157,337,184"/>
<area shape="rect" id="node35" href="namespacere__reader.html#abee07a4923b280459f7a1b135cc70346" title="opens and reads water.conf/matrix.conf, input data for the Richards equation in single mode..." alt="" coords="420,441,555,468"/>
<area shape="rect" id="node39" href="namespaceobjfnc.html#ac0a20b2f9874813942bd7dc35e3b4842" title="objfnc::reader" alt="" coords="863,724,964,751"/>
<area shape="rect" id="node41" href="namespacesimegen.html#aa20a1b7ef75f108fb29cd787f0cf5d3b" title="simegen::simegen1d" alt="" coords="193,644,335,671"/>
<area shape="rect" id="node3" href="namespaceade__pointers.html#adcdbd3c086467f4845b54788e253d694" title="ade_pointers::ade" alt="" coords="851,7,976,33"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="1041,311,1188,353"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1248,581,1299,608"/>
<area shape="rect" id="node9" href="namespacedual__por.html#a56d450c18eee19012cb05d2b1dd008e1" title="assigns initial condition " alt="" coords="640,267,791,293"/>
<area shape="rect" id="node12" href="namespacere__constitutive.html#a7a0c1ec8d57856234ae33b61eab450f2" title="re_constitutive::re\l_initcond" alt="" coords="652,383,779,425"/>
<area shape="rect" id="node15" href="namespacere__total.html#a5d572dd5f6da46314cdd0d5039c2db7c" title="re_total::retot_initcond" alt="" coords="640,500,791,527"/>
<area shape="rect" id="node10" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="845,217,981,258"/>
<area shape="rect" id="node11" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="845,282,981,323"/>
<area shape="rect" id="node13" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="850,399,977,425"/>
<area shape="rect" id="node14" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="848,348,979,375"/>
<area shape="rect" id="node16" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="850,449,977,476"/>
<area shape="rect" id="node17" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="848,500,979,527"/>
<area shape="rect" id="node20" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="654,602,777,643"/>
<area shape="rect" id="node31" href="namespaceboussread.html#af206b475e8ec2d4ed9f54c22e829a40e" title="boussread::boussreader" alt="" coords="407,107,568,133"/>
<area shape="rect" id="node33" href="namespaceheat__reader.html#a9546371591bb68c6f89b2c9ef80cd42b" title="heat_reader::heat_read" alt="" coords="410,56,565,83"/>
<area shape="rect" id="node37" href="namespacere__dual__reader.html#a4f07052339a41711165f3d85d2b7eefc" title="re_dual_reader::re\l_dual_readm" alt="" coords="424,209,551,250"/>
<area shape="rect" id="node38" href="namespacere__dual__reader.html#a23cf85f4d1be812361380db52c0e7e33" title="re_dual_reader::re\l_dual_readf" alt="" coords="652,150,779,191"/>
<area shape="rect" id="node32" href="namespacebousspointers.html#aa29fe327913d573ed19bbd1a6b11f0b5" title="bousspointers::boussi" alt="" coords="641,99,790,125"/>
<area shape="rect" id="node34" href="namespaceheat__pointers.html#a722171d0f13e6c6c18092dfdbca69220" title="heat_pointers::heat" alt="" coords="649,48,782,75"/>
<area shape="rect" id="node36" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="633,449,797,476"/>
<area shape="rect" id="node40" href="namespaceobjfnc.html#aa9a5392e2af633f2f53554a6f6f93026" title="objfnc::get_objval" alt="" coords="1053,701,1177,728"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad61d10db1818ad3ee4ef1672b63b2909"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_char </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(out)&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00369">369</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, and <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(out)</span> :: ch</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: options</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordtype">integer</span> :: ierr, i</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordtype">logical</span> :: ok</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=<span class="stringliteral">&quot;(a)&quot;</span>, iostat=ierr) ch</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      </div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(options)) <span class="keywordflow">then</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        ok = .false.</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(options, 1)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordflow">if</span> (adjustl(trim(ch)) == adjustl(trim(options(i)))) <span class="keywordflow">then</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            ok = .true.</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        ok = .true.     </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0 .or. .not.(ok) .and. (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit)) <span class="keywordflow">then</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">if</span> (.not. ok) <span class="keywordflow">then</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          print *, <span class="stringliteral">&quot;the value in your input file was: &quot;</span>, trim(ch)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          print *, <span class="stringliteral">&quot;however the allowed options for this field are:&quot;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="keywordflow">do</span> i=1, ubound(options,1)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            print *, <span class="stringliteral">&quot;-  &quot;</span>, adjustl(trim(options(i)))</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909_cgraph.png" border="0" usemap="#namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909_cgraph" alt=""/></div>
<map name="namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909_cgraph" id="namespacereadtools_ad61d10db1818ad3ee4ef1672b63b2909_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="193,5,331,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="195,56,329,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac12ae881ea7a5ba805dbaa99ea315575"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_int </td>
          <td>(</td>
          <td class="paramtype">integer(kind=ikind), intent(out)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>minimal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>maximal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00022">22</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(out)</span> :: i</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>,  <span class="keywordtype">optional</span> :: ranges</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: minimal, maximal</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="comment">!local vars</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">integer</span> :: ierr</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) i</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, errmsg)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(ranges)) <span class="keywordflow">then</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">if</span> (i&lt;ranges(1) .or. i&gt; ranges(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;incorrect ranges of input parameter(s)&quot;</span><span class="comment"> //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575_cgraph.png" border="0" usemap="#namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575_cgraph" alt=""/></div>
<map name="namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575_cgraph" id="namespacereadtools_ac12ae881ea7a5ba805dbaa99ea315575_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="183,5,320,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="185,56,318,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a988d0a7b5d8e2f02f0c7249f640c5984"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_int_array </td>
          <td>(</td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), optional&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>checklen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">checklen</td><td>checks if the array length is equal to the length of line in file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00109">109</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: r</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: ranges</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: checklen</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">!logical vars</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">integer</span> :: ierr, ierr2</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, i1, i2, arraybound, current_pos, chpos</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: tmpdata</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      arraybound=1</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keyword">allocate</span>(tmpdata(arraybound))</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(checklen)) <span class="keywordflow">then</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> (checklen) <span class="keywordflow">then</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          current_pos = ftell(fileid)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keywordflow">do</span> </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1<span class="comment">)</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">            i1=ftell(fileid)</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">            backspace fileid</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">            </span><span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            i2 = ftell(fileid)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            backspace fileid</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;           </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              arraybound = arraybound - 1</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;              <span class="keywordflow">do</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                chpos = ftell(fileid)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">if</span> (chpos == current_pos) <span class="keywordflow">then</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                  backspace(unit=fileid, iostat=ierr2)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;              <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (i1 == i2) <span class="keywordflow">then</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              arraybound = arraybound + 1</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              <span class="keywordflow">if</span> (ubound(tmpdata,1) &lt; arraybound) <span class="keywordflow">then</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keyword">allocate</span>(tmpdata(2*arraybound))</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">              end if</span>    </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">else</span> </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;              arraybound = arraybound - 1</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              <span class="keywordflow">do</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                chpos = ftell(fileid)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">if</span> (chpos == current_pos) <span class="keywordflow">then</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                  backspace(unit=fileid, iostat=ierr2)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="keywordflow">if</span> (arraybound /= ubound(r,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;the line in your input file has &amp;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="stringliteral"></span><span class="stringliteral">               incorrect number of values, check your inputs&quot;</span> //achar(27<span class="comment">)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, errmsg)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">         end if</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) r</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(ranges)) <span class="keywordflow">then</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(r,1)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <span class="keywordflow">if</span> (r(i) &lt; ranges(1) .or. r(i) &gt; ranges(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;incorrect ranges of input parameter(s)&quot;</span><span class="comment"> //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, errmsg)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984_cgraph.png" border="0" usemap="#namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984_cgraph" alt=""/></div>
<map name="namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984_cgraph" id="namespacereadtools_a988d0a7b5d8e2f02f0c7249f640c5984_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="183,5,320,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="185,56,318,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42e211935d2b6e1861f565eac28cdf9d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_int_std </td>
          <td>(</td>
          <td class="paramtype">integer(kind=lowikind), intent(out)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00062">62</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">integer(kind=lowikind)</span>, <span class="keywordtype">intent(out)</span> :: i</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>,  <span class="keywordtype">optional</span> :: ranges</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">!local vars</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordtype">integer</span> :: ierr</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) i</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       <span class="keywordflow">if</span> (<span class="keyword">present</span>(ranges)) <span class="keywordflow">then</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">if</span> (i&lt;ranges(1) .or. i&gt; ranges(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;incorrect ranges of input parameter(s)&quot;</span><span class="comment"> //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d_cgraph.png" border="0" usemap="#namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d_cgraph" alt=""/></div>
<map name="namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d_cgraph" id="namespacereadtools_a42e211935d2b6e1861f565eac28cdf9d_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="208,5,345,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="210,56,343,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a13e66cd8958ea07c3fb41f4dc80556c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine readtools::read_logical </td>
          <td>(</td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00418">418</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(out)</span> :: l</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordtype">integer</span> :: ierr</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordtype">character(len=1)</span> :: ch</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      </div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) ch</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (ierr == 0) <span class="keywordflow">then</span> </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">select case</span>(ch)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&quot;y&quot;</span>)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            l = .true.</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&quot;n&quot;</span>)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            l = .false.</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">          case default</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            ierr = -1</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;You have defined incorrect value for logical parameter)&quot;</span><span class="comment"> &amp;</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">             //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keywordflow">         end select</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">       end if</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0 .and. (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit)) <span class="keywordflow">then</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7_cgraph.png" border="0" usemap="#namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7_cgraph" alt=""/></div>
<map name="namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7_cgraph" id="namespacereadtools_a13e66cd8958ea07c3fb41f4dc80556c7_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="205,5,343,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="207,56,341,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8cf69cd43a457ddd1b29072139f19772"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_real </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), optional&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00219">219</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: r</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: ranges</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">!logical vars</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">integer</span> :: ierr</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) r</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(ranges)) <span class="keywordflow">then</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (r &lt; ranges(1) .or. r &gt; ranges(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;incorrect ranges of input parameter(s)&quot;</span><span class="comment"> //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          ierr = -1</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a8cf69cd43a457ddd1b29072139f19772_cgraph.png" border="0" usemap="#namespacereadtools_a8cf69cd43a457ddd1b29072139f19772_cgraph" alt=""/></div>
<map name="namespacereadtools_a8cf69cd43a457ddd1b29072139f19772_cgraph" id="namespacereadtools_a8cf69cd43a457ddd1b29072139f19772_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="189,5,327,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="191,56,325,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5d67f6775ad72824c723f1b5d4f20b9c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private readtools::read_real_array </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), optional&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>checklen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>noexit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">checklen</td><td>checks if the array length is equal to the length of line in file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00259">259</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, and <a class="el" href="globals_8f90_source.html#l00031">globals::terminal</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: r</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: fileid</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: ranges</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: errmsg</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: checklen</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: noexit</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">!logical vars</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordtype">integer</span> :: ierr, ierr2</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, i1, i2, arraybound, current_pos, chpos</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: tmpdata</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      arraybound=1</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keyword">allocate</span>(tmpdata(arraybound))</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(checklen)) <span class="keywordflow">then</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (checklen) <span class="keywordflow">then</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          current_pos = ftell(fileid)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <span class="keywordflow">do</span> </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound-1<span class="comment">)</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">            i1=ftell(fileid)</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">            backspace fileid</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">            </span><span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) tmpdata(1:arraybound)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            i2 = ftell(fileid)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            backspace fileid</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;           </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;              arraybound = arraybound - 1</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;              <span class="keywordflow">do</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                chpos = ftell(fileid)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (chpos == current_pos) <span class="keywordflow">then</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                  backspace(unit=fileid, iostat=ierr2)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;              <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">if</span> (i1 == i2) <span class="keywordflow">then</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              arraybound = arraybound + 1</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              <span class="keywordflow">if</span> (ubound(tmpdata,1) &lt; arraybound) <span class="keywordflow">then</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keyword">allocate</span>(tmpdata(2*arraybound))</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">              end if</span>    </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">else</span> </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;              arraybound = arraybound - 1</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;              <span class="keywordflow">do</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                chpos = ftell(fileid)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">if</span> (chpos == current_pos) <span class="keywordflow">then</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                  backspace(unit=fileid, iostat=ierr2)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;              <span class="keyword">deallocate</span>(tmpdata)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="keywordflow">if</span> (arraybound /= ubound(r,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;the line in your input file has &amp;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="stringliteral"></span><span class="stringliteral">               incorrect number of values, check your inputs&quot;</span> //achar(27<span class="comment">)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, errmsg)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">         end if</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) r</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(noexit) .or. .not. noexit) <span class="keywordflow">then</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(errmsg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid,errmsg)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(ranges)) <span class="keywordflow">then</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(r,1)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          <span class="keywordflow">if</span> (r(i) &lt; ranges(1) .or. r(i) &gt; ranges(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keyword">write</span>(unit=<a class="code" href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">terminal</a>, fmt=*) <span class="stringliteral">&quot; &quot;</span> //achar(27)//<span class="stringliteral">&#39;[91m&#39;</span>, <span class="stringliteral">&quot;incorrect ranges of input parameter(s)&quot;</span><span class="comment"> //achar(27)//</span><span class="stringliteral">&#39;[0m&#39;</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, errmsg)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_aee7d7e51108301fe95e24ec0d8e3a437"><div class="ttname"><a href="namespaceglobals.html#aee7d7e51108301fe95e24ec0d8e3a437">globals::terminal</a></div><div class="ttdeci">integer, public terminal</div><div class="ttdoc">terminal ID, the print_level sets its value </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00031">globals.f90:31</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c_cgraph.png" border="0" usemap="#namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c_cgraph" alt=""/></div>
<map name="namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c_cgraph" id="namespacereadtools_a5d67f6775ad72824c723f1b5d4f20b9c_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="189,5,327,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="191,56,325,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a35dde6b411a1476727771fcb8f5d1bc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public readtools::readbcvals </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>unitW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpde__objs_1_1boundary__vals.html">boundary_vals</a>), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>struct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>dimen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>dirname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirname</td><td>directory name, where data with boundary condition are stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00603">603</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">comment()</a>, <a class="el" href="globals_8f90_source.html#l00047">globals::end_time</a>, <a class="el" href="readtools_8f90_source.html#l00461">file_error()</a>, <a class="el" href="core__tools_8f90_source.html#l00177">core_tools::find_unit()</a>, <a class="el" href="globals_8f90_source.html#l00082">globals::measured_pts</a>, and <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>.</p>

<p>Referenced by <a class="el" href="_a_d_e__reader_8f90_source.html#l00007">ade_reader::ade_read()</a>, <a class="el" href="boussread_8f90_source.html#l00006">boussread::boussreader()</a>, <a class="el" href="heat__reader_8f90_source.html#l00007">heat_reader::heat_read()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00314">re_dual_reader::re_dual_readf()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00264">re_dual_reader::re_dual_readm()</a>, and <a class="el" href="re__reader_8f90_source.html#l00009">re_reader::res_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: unitw</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structpde__objs_1_1boundary__vals.html">boundary_vals</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(out)</span> :: struct</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: dimen</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: dirname</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, j, n</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordtype">character(len=3)</span> :: ch</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordtype">character(len=1)</span> :: y_file, y_cond</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordtype">integer</span> :: ierr, fileid</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: counter, counter2</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordtype">character(len=256)</span> :: filename</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: tmp</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordtype">character(len=1024)</span> :: msg</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: tester</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(struct)) <span class="keywordflow">then</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keyword">allocate</span>(struct(101:101+dimen-1))</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        print *, <span class="stringliteral">&quot;W: strange bc struct already allocated with bounds:&quot;</span>, lbound(struct<span class="comment">,1), </span><span class="stringliteral">&quot;:&quot;</span><span class="comment">, ubound(struct,1)</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span><span class="keywordflow">      end if</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">if</span> (maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge) /= ubound(struct,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keyword">inquire</span>(unit=unitw, name=filename)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> (maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge)-100 - dimen == ubound(<a class="code" href="namespaceglobals.html#ac2391ac68800c102dcd71b053b7f47e6">measured_pts</a>,1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;          <span class="keyword">write</span>(unit=msg, fmt=<span class="stringliteral">&quot;(a)&quot;</span>) <span class="stringliteral">&quot;There is an inconsistent boundary description, it seems like you have forgot &amp; </span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral"></span><span class="stringliteral">               to include the points with measurement into boundary definition&quot;</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge) &lt; 100) <span class="keywordflow">then</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keyword">write</span>(unit=msg, fmt=*) <span class="stringliteral">&quot;Your mesh does not define any boundaries, you are completely wrong!!&quot;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">else</span>                    <span class="comment">!a,I3,a,I3,a,I3,a,I3,a,I3,a</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          <span class="keyword">write</span>(unit=msg, fmt=<span class="stringliteral">&quot;(a,I3,a,I3,a,I3,a,a,a,I3,a)&quot;</span>)  <span class="stringliteral">&quot;There is an inconsistent boundary description, &amp;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral"></span><span class="stringliteral">                                                                  the mesh configuration defines &quot;</span>&amp; </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;          , maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge)-100 - ubound(<a class="code" href="namespaceglobals.html#ac2391ac68800c102dcd71b053b7f47e6">measured_pts</a>,1) , <span class="stringliteral">&quot; boundary(ies), your measurement points define an extra&quot;</span><span class="comment">, &amp;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">          ubound(<a class="code" href="namespaceglobals.html#ac2391ac68800c102dcd71b053b7f47e6">measured_pts</a>,1), </span><span class="stringliteral">&quot; boundary(ies), thus in total you need:&quot;</span>, &amp;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          maxval(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge)-100, <span class="stringliteral">&quot; boundary(ies), however the input model file: &quot;</span><span class="comment">, &amp;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">          trim(filename), </span><span class="stringliteral">&quot; defines &quot;</span>, dimen, <span class="stringliteral">&quot; boundary(ies).&quot;</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(unitw, trim(msg))</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">do</span> i = lbound(struct,1), ubound(struct,1)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(unitw)</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keyword">read</span>(unit=unitw, fmt=*, iostat=ierr) struct(i)%ID, struct(i)%code<span class="comment">, y_file, struct(i)%value, struct(i)%layer</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">        </span><span class="keywordflow">select case</span>(y_file)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&quot;y&quot;</span>)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            struct(i)%file = .true.</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <span class="keywordflow">case</span>(<span class="stringliteral">&quot;n&quot;</span>)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            struct(i)%file = .false.</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">          case default</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(unitw, &amp;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="stringliteral">&quot;set [y/n] value for file in boundary condition description, see file info bellow&quot;</span><span class="comment">)</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"></span><span class="keywordflow">        end select</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        struct(i)%icond4neumann = .false.</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <span class="keyword">inquire</span>(unit=unitw, name=filename)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          <span class="keyword">write</span>(unit=msg, fmt=*) <span class="stringliteral">&quot;HINT: check number of boundary records in file: &quot;</span><span class="comment">, trim(filename)</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">          </span><span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(unitw, trim(msg))</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">if</span> (struct(i)%file) <span class="keywordflow">then</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">find_unit</a>(fileid)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          <span class="keyword">write</span>(unit=filename, fmt=<span class="stringliteral">&quot;(a, I3, a)&quot;</span>) trim(dirname), i, <span class="stringliteral">&quot;.bc&quot;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="keyword">open</span>(unit=fileid, file=trim(filename), action=<span class="stringliteral">&quot;read&quot;</span>, status=<span class="stringliteral">&quot;old&quot;</span><span class="comment">,  iostat=ierr)</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">          </span><span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keyword">write</span>(unit=msg, fmt=*) <span class="stringliteral">&quot;ERROR: if using unsteady boundary value data, you must supply the file with data!&quot;</span><span class="comment">, &amp;</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">            </span><span class="stringliteral">&quot;ERROR: file required:&quot;</span>, trim(filename)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(unitw, msg)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          counter = 0</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="keywordflow">do</span> </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            counter = counter + 1</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keyword">read</span>(unit=fileid, fmt=*, iostat=ierr) tmp</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;              <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          counter = counter - 1</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          <span class="keyword">open</span>(unit=fileid, file=trim(filename), action=<span class="stringliteral">&quot;read&quot;</span>, status=<span class="stringliteral">&quot;old&quot;</span><span class="comment">,  iostat=ierr)</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">   </span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">          </span><span class="keyword">allocate</span>(struct(i)%series(counter,2))</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          <span class="keywordflow">do</span> j=1, counter</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keyword">write</span>(msg, *) <span class="stringliteral">&quot;Incorrect data in file:  &quot;</span>, trim(filename), <span class="stringliteral">&quot;    at line:&quot;</span><span class="comment">, j</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">            </span><span class="keyword">call </span><a class="code" href="interfacereadtools_1_1fileread.html">fileread</a>(struct(i)%series(j,:), fileid, checklen=.true.<span class="comment">, errmsg=msg)</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span><span class="keywordflow">          end do</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          struct(i)%series_pos = 1</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;       </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          <span class="keywordflow">if</span> (struct(i)%series(counter,1) &lt; <a class="code" href="namespaceglobals.html#aae1a93edf28eef71d60b8617914ffc78">end_time</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, &amp;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <span class="stringliteral">&quot;ERROR: end time in unsteady boundary data must be equal or higher than the simulation end time&quot;</span><span class="comment"> )</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"></span><span class="keywordflow">          end if</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespaceglobals_html_aae1a93edf28eef71d60b8617914ffc78"><div class="ttname"><a href="namespaceglobals.html#aae1a93edf28eef71d60b8617914ffc78">globals::end_time</a></div><div class="ttdeci">real(kind=rkind), public end_time</div><div class="ttdoc">simulation end time </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00047">globals.f90:47</a></div></div>
<div class="ttc" id="structpde__objs_1_1boundary__vals_html"><div class="ttname"><a href="structpde__objs_1_1boundary__vals.html">pde_objs::boundary_vals</a></div><div class="ttdoc">data structure to carry boundary value problem setup, allocation starts at 100 </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00041">pde_objs.f90:41</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html_ac2391ac68800c102dcd71b053b7f47e6"><div class="ttname"><a href="namespaceglobals.html#ac2391ac68800c102dcd71b053b7f47e6">globals::measured_pts</a></div><div class="ttdeci">type(measured), dimension(:), allocatable, public measured_pts</div><div class="ttdoc">the number of points with observation data </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00082">globals.f90:82</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="interfacereadtools_1_1fileread_html"><div class="ttname"><a href="interfacereadtools_1_1fileread.html">readtools::fileread</a></div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00009">readtools.f90:9</a></div></div>
<div class="ttc" id="namespacecore__tools_html_a01c1527fcc56448471e2b349571e51ee"><div class="ttname"><a href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">core_tools::find_unit</a></div><div class="ttdeci">subroutine, public find_unit(iunit, start_id)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00177">core_tools.f90:177</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_cgraph.png" border="0" usemap="#namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_cgraph" alt=""/></div>
<map name="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_cgraph" id="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="201,5,338,32"/>
<area shape="rect" id="node3" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="203,56,336,83"/>
<area shape="rect" id="node4" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="200,107,339,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_icgraph.png" border="0" usemap="#namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_icgraph" alt=""/></div>
<map name="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_icgraph" id="namespacereadtools_a35dde6b411a1476727771fcb8f5d1bc9_icgraph">
<area shape="rect" id="node2" href="namespaceade__reader.html#ab579f926de43ae5ba712d144494109fb" title="ade_reader::ade_read" alt="" coords="207,5,354,32"/>
<area shape="rect" id="node6" href="namespaceboussread.html#af206b475e8ec2d4ed9f54c22e829a40e" title="boussread::boussreader" alt="" coords="200,56,361,83"/>
<area shape="rect" id="node8" href="namespaceheat__reader.html#a9546371591bb68c6f89b2c9ef80cd42b" title="heat_reader::heat_read" alt="" coords="203,107,358,133"/>
<area shape="rect" id="node10" href="namespacere__dual__reader.html#a23cf85f4d1be812361380db52c0e7e33" title="re_dual_reader::re\l_dual_readf" alt="" coords="217,158,344,199"/>
<area shape="rect" id="node12" href="namespacere__dual__reader.html#a4f07052339a41711165f3d85d2b7eefc" title="re_dual_reader::re\l_dual_readm" alt="" coords="217,223,344,265"/>
<area shape="rect" id="node14" href="namespacere__reader.html#abee07a4923b280459f7a1b135cc70346" title="opens and reads water.conf/matrix.conf, input data for the Richards equation in single mode..." alt="" coords="213,299,348,325"/>
<area shape="rect" id="node3" href="namespaceade__pointers.html#adcdbd3c086467f4845b54788e253d694" title="ade_pointers::ade" alt="" coords="624,5,749,32"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="800,201,947,242"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="995,208,1045,235"/>
<area shape="rect" id="node7" href="namespacebousspointers.html#aa29fe327913d573ed19bbd1a6b11f0b5" title="bousspointers::boussi" alt="" coords="417,56,566,83"/>
<area shape="rect" id="node9" href="namespaceheat__pointers.html#a722171d0f13e6c6c18092dfdbca69220" title="heat_pointers::heat" alt="" coords="425,107,558,133"/>
<area shape="rect" id="node11" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="423,158,559,199"/>
<area shape="rect" id="node13" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="423,223,559,265"/>
<area shape="rect" id="node15" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="409,309,573,336"/>
<area shape="rect" id="node16" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="623,259,750,285"/>
<area shape="rect" id="node17" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="621,309,752,336"/>
<area shape="rect" id="node18" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="623,360,750,387"/>
<area shape="rect" id="node19" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="621,411,752,437"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a718f41934d7cc35a0c4f8d4107a69029"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public readtools::set_tensor </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>tensor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this procedure set up an anisothropy tensor, the local anisothrophy values are supllied in values array, angle is the angle between the local and global system, tensor is the resulting secodn order tensor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">values</td><td>local anisothoropy values with respect to local x, local y and local z</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle between the local and global system of coordinates</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tensor</td><td>resulting second order tensor with respect to the global system of coordinates </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="readtools_8f90_source.html#l00558">558</a> of file <a class="el" href="readtools_8f90_source.html">readtools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>.</p>

<p>Referenced by <a class="el" href="_a_d_e__reader_8f90_source.html#l00007">ade_reader::ade_read()</a>, <a class="el" href="heat__reader_8f90_source.html#l00007">heat_reader::heat_read()</a>, <a class="el" href="_re__dual__reader_8f90_source.html#l00007">re_dual_reader::re_dual_var()</a>, and <a class="el" href="re__reader_8f90_source.html#l00009">re_reader::res_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: values</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: <a class="code" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span> :: tensor</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: t</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i,j</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keyword">allocate</span>(t(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen, <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen))</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          tensor(1,1) = values(1)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          t(1,1) = cos(4.0_dprec*atan(1.0_dprec)/180.0_rkind*<a class="code" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a>(1))</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          t(1,2) = cos(4.0_dprec*atan(1.0_dprec)/180.0_rkind*(90-<a class="code" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a>(1<span class="comment">)))</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">          t(2,1) = cos(4.0_dprec*atan(1.0_dprec)/180.0_rkind*(90+<a class="code" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a>(1)))</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">          t(2,2) = cos(4.0_dprec*atan(1.0_dprec)/180.0_rkind*(<a class="code" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a>(1)))</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">        </span><span class="keywordflow">case</span>(3)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          print *, <span class="stringliteral">&quot;tensors not implemented in 3D&quot;</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          error stop</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordflow">      end select</span>            </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      tensor = 0</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">do</span> i=1, ubound(tensor,1)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        tensor(i,i) = values(i)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      tensor = matmul(matmul(t, tensor), <a class="code" href="namespacemtx.html#af8b9fdca71b8f8022bd3952fc809df30">transpose</a>(t))</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keyword">deallocate</span>(t)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="ttc" id="namespacegeom__tools_html_ac7d40a2d1dba95e3a69c11bb9fa21b2f"><div class="ttname"><a href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">geom_tools::angle</a></div><div class="ttdeci">real(kind=rkind) function, public angle(A, B, C)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00569">geom_tools.f90:569</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespacemtx_html_af8b9fdca71b8f8022bd3952fc809df30"><div class="ttname"><a href="namespacemtx.html#af8b9fdca71b8f8022bd3952fc809df30">mtx::transpose</a></div><div class="ttdeci">subroutine transpose(A, B)</div><div class="ttdoc">v A vrati transpozici matice B </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00879">mtx.f90:879</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029_icgraph.png" border="0" usemap="#namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029_icgraph" alt=""/></div>
<map name="namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029_icgraph" id="namespacereadtools_a718f41934d7cc35a0c4f8d4107a69029_icgraph">
<area shape="rect" id="node2" href="namespaceade__reader.html#ab579f926de43ae5ba712d144494109fb" title="ade_reader::ade_read" alt="" coords="201,5,348,32"/>
<area shape="rect" id="node6" href="namespaceheat__reader.html#a9546371591bb68c6f89b2c9ef80cd42b" title="heat_reader::heat_read" alt="" coords="197,56,352,83"/>
<area shape="rect" id="node8" href="namespacere__dual__reader.html#a3ddb497789d4da4dea2afc55f283cf4b" title="re_dual_reader::re\l_dual_var" alt="" coords="211,107,338,149"/>
<area shape="rect" id="node10" href="namespacere__reader.html#abee07a4923b280459f7a1b135cc70346" title="opens and reads water.conf/matrix.conf, input data for the Richards equation in single mode..." alt="" coords="207,191,342,217"/>
<area shape="rect" id="node3" href="namespaceade__pointers.html#adcdbd3c086467f4845b54788e253d694" title="ade_pointers::ade" alt="" coords="419,5,545,32"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="791,150,937,191"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="985,157,1036,184"/>
<area shape="rect" id="node7" href="namespaceheat__pointers.html#a722171d0f13e6c6c18092dfdbca69220" title="heat_pointers::heat" alt="" coords="415,56,549,83"/>
<area shape="rect" id="node9" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="414,107,550,149"/>
<area shape="rect" id="node11" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="400,208,564,235"/>
<area shape="rect" id="node12" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="614,157,741,184"/>
<area shape="rect" id="node13" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="612,208,743,235"/>
<area shape="rect" id="node14" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="614,259,741,285"/>
<area shape="rect" id="node15" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="612,309,743,336"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacereadtools.html">readtools</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
