<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DRUtES: geom_tools Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRUtES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacegeom__tools.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">geom_tools Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa7bb57f436fc77331aea42f34fde56a5"><td class="memItemLeft" align="right" valign="top">integer(kind=ikind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#aa7bb57f436fc77331aea42f34fde56a5">get_layer</a> (quadpnt)</td></tr>
<tr class="separator:aa7bb57f436fc77331aea42f34fde56a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2336f6e1e7d512a9d81acb21c71456"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a4c2336f6e1e7d512a9d81acb21c71456">getcoor</a> (quadpnt, array)</td></tr>
<tr class="separator:a4c2336f6e1e7d512a9d81acb21c71456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d14dfd00b3162fe5cc76004ddd815c2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a2d14dfd00b3162fe5cc76004ddd815c2">interpolate</a> (vals, points)</td></tr>
<tr class="memdesc:a2d14dfd00b3162fe5cc76004ddd815c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the solution values on gaussian nodes positions  <a href="#a2d14dfd00b3162fe5cc76004ddd815c2">More...</a><br /></td></tr>
<tr class="separator:a2d14dfd00b3162fe5cc76004ddd815c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e93d0ec91a9f2fcc7573e6347a9f9ef"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef">plane_derivative</a> (a, b, c, xder, yder)</td></tr>
<tr class="memdesc:a1e93d0ec91a9f2fcc7573e6347a9f9ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">specify the x and y derivates of a plane defined by three points  <a href="#a1e93d0ec91a9f2fcc7573e6347a9f9ef">More...</a><br /></td></tr>
<tr class="separator:a1e93d0ec91a9f2fcc7573e6347a9f9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e9334704d756a28f729ba3a950a9ea"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a55e9334704d756a28f729ba3a950a9ea">init_transform</a> (aT, bT, cT, <a class="el" href="structmtx_1_1matrix.html">matrix</a>)</td></tr>
<tr class="memdesc:a55e9334704d756a28f729ba3a950a9ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">procedure to create transformation matrix </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{c} e \\ f \end{array} \right) + \left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array}\right) \left( \begin{array}{c} x \\ y \end{array} \right) = \left( \begin{array}{c} x^T \\ y^T \end{array} \right) \]" src="form_45.png"/>
</p>
<p> where (e,f) is the vector of move and the matrix </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array}\right) \]" src="form_46.png"/>
</p>
<p> is the matrix of rotation each line represents the element id, the first column in row represents numbers e,f,a,b the second column reprerents numbers f,c,d  <a href="#a55e9334704d756a28f729ba3a950a9ea">More...</a><br /></td></tr>
<tr class="separator:a55e9334704d756a28f729ba3a950a9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1237d1dc8b45bd650de0daff46162d6b"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a1237d1dc8b45bd650de0daff46162d6b">get_nz</a> (el_id, order1, order2)</td></tr>
<tr class="memdesc:a1237d1dc8b45bd650de0daff46162d6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that provides z coordinate of boundary normal vector, the boundary is defined by two points: bod1, bod2  <a href="#a1237d1dc8b45bd650de0daff46162d6b">More...</a><br /></td></tr>
<tr class="separator:a1237d1dc8b45bd650de0daff46162d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0cfc5aedee571cb83174e83f5d30606"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#ad0cfc5aedee571cb83174e83f5d30606">inside</a> (domain, bod)</td></tr>
<tr class="separator:ad0cfc5aedee571cb83174e83f5d30606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52bdc7b016cad84e97b0fd88231c997e"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e">shoot</a> (bod, k, domain, inter, valid)</td></tr>
<tr class="separator:a52bdc7b016cad84e97b0fd88231c997e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e7826748ab86ab44154a7637fcc080"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#af5e7826748ab86ab44154a7637fcc080">triarea</a> (a, b, c)</td></tr>
<tr class="separator:af5e7826748ab86ab44154a7637fcc080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ddf015e5cea9e21d182b93603f5139"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a> (A, B)</td></tr>
<tr class="separator:a91ddf015e5cea9e21d182b93603f5139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d40a2d1dba95e3a69c11bb9fa21b2f"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f">angle</a> (A, B, C)</td></tr>
<tr class="separator:ac7d40a2d1dba95e3a69c11bb9fa21b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a648dcde3507b3b3b66eecaea12b43603"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603">inline</a> (A, B, bod)</td></tr>
<tr class="memdesc:a648dcde3507b3b3b66eecaea12b43603"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to determine whether the third point is on line formed by the first two points  <a href="#a648dcde3507b3b3b66eecaea12b43603">More...</a><br /></td></tr>
<tr class="separator:a648dcde3507b3b3b66eecaea12b43603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fde1713e8d912a2be95dfa7f6789bab"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a2fde1713e8d912a2be95dfa7f6789bab">solve_bisect</a> (xmin, xmax, f, reps, ierr, solution)</td></tr>
<tr class="memdesc:a2fde1713e8d912a2be95dfa7f6789bab"><td class="mdescLeft">&#160;</td><td class="mdescRight">bisecton method searching for a root of function f on defined intervals xmin and xmax  <a href="#a2fde1713e8d912a2be95dfa7f6789bab">More...</a><br /></td></tr>
<tr class="separator:a2fde1713e8d912a2be95dfa7f6789bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addda2c9ac04812dd1ae188c3780594f4"><td class="memItemLeft" align="right" valign="top">logical function, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a> (a, b, c)</td></tr>
<tr class="memdesc:addda2c9ac04812dd1ae188c3780594f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to determine if the point C lies above or below the line defined by points A and B result is logical value nad, if true point lies above if false it lies below if the line is vertical, then if true the point lies on the left hand side from the line, if false the point lies on the right hand side from the line.  <a href="#addda2c9ac04812dd1ae188c3780594f4">More...</a><br /></td></tr>
<tr class="separator:addda2c9ac04812dd1ae188c3780594f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a7f232fec395ff22f8985cffeebd146"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a9a7f232fec395ff22f8985cffeebd146">getnormal</a> (bcpoints, thirdpt, nvect)</td></tr>
<tr class="memdesc:a9a7f232fec395ff22f8985cffeebd146"><td class="mdescLeft">&#160;</td><td class="mdescRight">this function returns outer normal boundary vector bcpoints - nodes ids at the element boundary, integer, dimension(2) thirdpt - coordinates of a point at at element, which lies out of the boundary. It is important in order to obtain proper positive direction of the normal vector  <a href="#a9a7f232fec395ff22f8985cffeebd146">More...</a><br /></td></tr>
<tr class="separator:a9a7f232fec395ff22f8985cffeebd146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7e5ddeeee2bd0f031e5c2713571e5d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#abb7e5ddeeee2bd0f031e5c2713571e5d">najdi_bod</a> (a, b, c, bod)</td></tr>
<tr class="memdesc:abb7e5ddeeee2bd0f031e5c2713571e5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">subroutine seeking for the point which is on line identified by points a and b, and line between this point and c is rectangular to the line &lt;a,b&gt;  <a href="#abb7e5ddeeee2bd0f031e5c2713571e5d">More...</a><br /></td></tr>
<tr class="separator:abb7e5ddeeee2bd0f031e5c2713571e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50afc0353d5731dc64cb3731f11b8361"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a50afc0353d5731dc64cb3731f11b8361">max_height</a> (a, b, c, height)</td></tr>
<tr class="memdesc:a50afc0353d5731dc64cb3731f11b8361"><td class="mdescLeft">&#160;</td><td class="mdescRight">subroutine searching for the maximum height on triangle element  <a href="#a50afc0353d5731dc64cb3731f11b8361">More...</a><br /></td></tr>
<tr class="separator:a50afc0353d5731dc64cb3731f11b8361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5eea8089dba9b61e9512793819eca93"><td class="memItemLeft" align="right" valign="top">real(kind=rkind) function, dimension(2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#ac5eea8089dba9b61e9512793819eca93">gravity_center</a> (a, b, c)</td></tr>
<tr class="separator:ac5eea8089dba9b61e9512793819eca93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28a5bc6f02c538f8998441d9a251a8d0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a28a5bc6f02c538f8998441d9a251a8d0">find_neighbours</a> (el, nd)</td></tr>
<tr class="separator:a28a5bc6f02c538f8998441d9a251a8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a414b4c651eccb3bab087a28455f38ba7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a414b4c651eccb3bab087a28455f38ba7">map1d2d</a> (filename)</td></tr>
<tr class="separator:a414b4c651eccb3bab087a28455f38ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a6548d90c258b44ecc6d58dd159b845"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegeom__tools.html#a5a6548d90c258b44ecc6d58dd159b845">map1d2dj</a> (pde_loc, filename)</td></tr>
<tr class="separator:a5a6548d90c258b44ecc6d58dd159b845"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="addda2c9ac04812dd1ae188c3780594f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function, private geom_tools::aboveline </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>function to determine if the point C lies above or below the line defined by points A and B result is logical value nad, if true point lies above if false it lies below if the line is vertical, then if true the point lies on the left hand side from the line, if false the point lies on the right hand side from the line. </p>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00681">681</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>Referenced by <a class="el" href="geom__tools_8f90_source.html#l00332">get_nz()</a>, and <a class="el" href="geom__tools_8f90_source.html#l00741">getnormal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals2d.html">globals2d</a></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b,c</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordtype">logical</span> :: nad</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: xa1, yb1, q1, xa2, yb2, q2, x_int, y_int</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">!first define the coefficient of the line equation defined by A and B</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span> (abs(b(1)-a(1)) &gt; 100*epsilon(xa1) .and. abs(b(2)-a(2)) &gt; 100*epsilon(xa1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      xa1 = (b(2) - a(2))/(b(1) - a(1))</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      yb1 = -1.0_rkind</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      q1 = -xa1*a(1) - yb1*a(2)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      xa2 = yb1</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      yb2 = -xa1</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      q2 = -xa2*c(1) - yb2*c(2) </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      x_int = (-q1 + yb1*q2/yb2)/(xa1 - yb1*xa2/yb2)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      y_int = (-q2 - xa2*x_int)/yb2</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">if</span> (y_int &gt;= c(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        nad = .false.</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        nad = .true.</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (abs(b(1)-a(1)) &lt; 100*epsilon(xa1)) <span class="keywordflow">then</span> <span class="comment">! vertical line</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">if</span> (c(1) &gt;= b(1)) <span class="keywordflow">then</span> </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          nad = .false.</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">else</span> </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          nad = .true.</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">if</span> (abs(b(2)-a(2)) &lt; 100*epsilon(xa1)) <span class="keywordflow">then</span> <span class="comment">! horizontal line</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span> (c(2) &gt;= b(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          nad = .true.</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          nad = .false.</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      </div><div class="ttc" id="namespaceglobals2d_html"><div class="ttname"><a href="namespaceglobals2d.html">globals2d</a></div><div class="ttdoc">contains global variables related to 2D problem </div><div class="ttdef"><b>Definition:</b> <a href="globals2_d_8f90_source.html#l00018">globals2D.f90:18</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_addda2c9ac04812dd1ae188c3780594f4_icgraph.png" border="0" usemap="#namespacegeom__tools_addda2c9ac04812dd1ae188c3780594f4_icgraph" alt=""/></div>
<map name="namespacegeom__tools_addda2c9ac04812dd1ae188c3780594f4_icgraph" id="namespacegeom__tools_addda2c9ac04812dd1ae188c3780594f4_icgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a1237d1dc8b45bd650de0daff46162d6b" title="function that provides z coordinate of boundary normal vector, the boundary is defined by two points:..." alt="" coords="215,15,351,42"/>
<area shape="rect" id="node6" href="namespacegeom__tools.html#a9a7f232fec395ff22f8985cffeebd146" title="this function returns outer normal boundary vector bcpoints &#45; nodes ids at the element boundary..." alt="" coords="205,67,360,94"/>
<area shape="rect" id="node3" href="namespacefeminittools.html#a36826eda9dbcdb639506e838d6ec2e3e" title="evaluates an array that contains length of the element edge, if the element edge is boundary edge..." alt="" coords="415,5,555,47"/>
<area shape="rect" id="node4" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="1012,13,1148,39"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1201,42,1252,69"/>
<area shape="rect" id="node7" href="namespacere__total.html#aba9ffc0b12bd41e731c2b7bfd4a22f88" title="re_total::retot_seepage" alt="" coords="408,71,563,98"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#ad0da880edec99cec0e70b76e0819172d" title="re_pointers::re_totheadbc" alt="" coords="611,71,780,98"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="830,67,957,94"/>
<area shape="rect" id="node11" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="828,118,959,145"/>
<area shape="rect" id="node10" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="1007,64,1153,105"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac7d40a2d1dba95e3a69c11bb9fa21b2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public geom_tools::angle </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00569">569</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00552">dist()</a>.</p>

<p>Referenced by <a class="el" href="feminittools_8f90_source.html#l00595">feminittools::search_bnd_nodes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a, b, c</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: gamma</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: la, lb, lc</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    lc = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,b)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    lb = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,c)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    la = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(b,c)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (la &gt; 10*epsilon(la) .and. lb &gt; 10*epsilon(la)) <span class="keywordflow">then</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      gamma = acos(min((lc**2-la**2-lb**2)/(-2.0_rkind*la*lb),1.0_rkind))</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      gamma = acos(1.0_dprec)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_cgraph.png" border="0" usemap="#namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_cgraph" alt=""/></div>
<map name="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_cgraph" id="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="181,5,300,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_icgraph.png" border="0" usemap="#namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_icgraph" alt=""/></div>
<map name="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_icgraph" id="namespacegeom__tools_ac7d40a2d1dba95e3a69c11bb9fa21b2f_icgraph">
<area shape="rect" id="node2" href="namespacefeminittools.html#a419a077d1fcd5cada245669a697e1800" title="this procedure identifies boundary nodes on 2D mesh only. The method searches for all surrounding nod..." alt="" coords="181,5,317,47"/>
<area shape="rect" id="node3" href="namespacefeminittools.html#a01c57c36680035f551a4f63b6b849a8a" title="feminittools::set_boundary" alt="" coords="365,13,540,39"/>
<area shape="rect" id="node4" href="namespacefeminittools.html#a36826eda9dbcdb639506e838d6ec2e3e" title="evaluates an array that contains length of the element edge, if the element edge is boundary edge..." alt="" coords="588,5,728,47"/>
<area shape="rect" id="node5" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="776,13,912,39"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="960,13,1011,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91ddf015e5cea9e21d182b93603f5139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public geom_tools::dist </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00552">552</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>.</p>

<p>Referenced by <a class="el" href="geom__tools_8f90_source.html#l00569">angle()</a>, <a class="el" href="geom__tools_8f90_source.html#l00072">getcoor()</a>, <a class="el" href="drutes__init_8f90_source.html#l00479">drutes_init::init_measured()</a>, <a class="el" href="geom__tools_8f90_source.html#l00590">inline()</a>, <a class="el" href="geom__tools_8f90_source.html#l00372">inside()</a>, <a class="el" href="geom__tools_8f90_source.html#l00841">max_height()</a>, and <a class="el" href="feminittools_8f90_source.html#l00520">feminittools::surface_integ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: l</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        l = abs(a(1) - b(1))</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        l = sqrt((a(1)-b(1))*(a(1)-b(1)) + (a(2)-b(2))*(a(2)-b(2)))</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  </div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a91ddf015e5cea9e21d182b93603f5139_icgraph.png" border="0" usemap="#namespacegeom__tools_a91ddf015e5cea9e21d182b93603f5139_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a91ddf015e5cea9e21d182b93603f5139_icgraph" id="namespacegeom__tools_a91ddf015e5cea9e21d182b93603f5139_icgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#ac7d40a2d1dba95e3a69c11bb9fa21b2f" title="geom_tools::angle" alt="" coords="190,17,318,43"/>
<area shape="rect" id="node5" href="namespacefeminittools.html#a36826eda9dbcdb639506e838d6ec2e3e" title="evaluates an array that contains length of the element edge, if the element edge is boundary edge..." alt="" coords="875,64,1015,105"/>
<area shape="rect" id="node8" href="namespacegeom__tools.html#a4c2336f6e1e7d512a9d81acb21c71456" title="geom_tools::getcoor" alt="" coords="184,325,324,351"/>
<area shape="rect" id="node25" href="namespacedrutes__init.html#a3531f097f8fa7bd5d2d88a4772195708" title="drutes_init::init_measured" alt="" coords="1100,535,1271,562"/>
<area shape="rect" id="node26" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603" title="function to determine whether the third point is on line formed by the first two points ..." alt="" coords="191,637,317,663"/>
<area shape="rect" id="node27" href="namespacegeom__tools.html#ad0cfc5aedee571cb83174e83f5d30606" title="geom_tools::inside" alt="" coords="635,637,765,663"/>
<area shape="rect" id="node35" href="namespacegeom__tools.html#a50afc0353d5731dc64cb3731f11b8361" title="subroutine searching for the maximum height on triangle element " alt="" coords="172,687,336,714"/>
<area shape="rect" id="node3" href="namespacefeminittools.html#a419a077d1fcd5cada245669a697e1800" title="this procedure identifies boundary nodes on 2D mesh only. The method searches for all surrounding nod..." alt="" coords="405,5,541,47"/>
<area shape="rect" id="node4" href="namespacefeminittools.html#a01c57c36680035f551a4f63b6b849a8a" title="feminittools::set_boundary" alt="" coords="613,17,787,43"/>
<area shape="rect" id="node6" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="1117,183,1253,210"/>
<area shape="rect" id="node7" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1319,561,1369,587"/>
<area shape="rect" id="node9" href="namespaceboussfnc.html#a071d2eeb5f983e31d4495bb68a137e76" title="boussfnc::bouss_elast" alt="" coords="397,223,550,250"/>
<area shape="rect" id="node12" href="namespaceboussfnc.html#a1eb4dcb6eb00362b392c983cf5cefb45" title="boussfnc::bouss_cond" alt="" coords="397,274,550,301"/>
<area shape="rect" id="node13" href="namespaceboussfnc.html#a523c691f2d5d7b1448f21c108d496392" title="boussfnc::bouss_adv" alt="" coords="400,122,547,149"/>
<area shape="rect" id="node14" href="namespaceboussfnc.html#afa3ac635ca94f53b4d31b74e208d1ee8" title="boussfnc::darcy4bouss" alt="" coords="395,173,552,199"/>
<area shape="rect" id="node15" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8" title="convection term for the Richards equation for axisymmetric problems the vertical convection is equal ..." alt="" coords="611,236,789,277"/>
<area shape="rect" id="node18" href="namespacere__total.html#a52ce5b4dd78109c258014d2f601c5d06" title="specific function for Richards equation in H&#45;form (total hydraulic head form), replaces pde_objs::get..." alt="" coords="629,302,771,329"/>
<area shape="rect" id="node20" href="namespacere__total.html#a50dadbca5603f1a3c8ba55b4321af666" title="re_total::retot_dirichlet_bc" alt="" coords="387,426,559,453"/>
<area shape="rect" id="node24" href="namespacedual__por.html#ae77ab5b0b843109d82c589c9ac537062" title="specific function for Richards equation in H&#45;form (total hydraulic head form), replaces pde_objs::get..." alt="" coords="384,477,563,503"/>
<area shape="rect" id="node10" href="namespacebousspointers.html#aa29fe327913d573ed19bbd1a6b11f0b5" title="bousspointers::boussi" alt="" coords="625,185,775,211"/>
<area shape="rect" id="node11" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="1112,345,1259,387"/>
<area shape="rect" id="node16" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="881,302,1008,329"/>
<area shape="rect" id="node17" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="881,247,1008,274"/>
<area shape="rect" id="node19" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="879,353,1010,379"/>
<area shape="rect" id="node21" href="namespacere__pointers.html#ad0da880edec99cec0e70b76e0819172d" title="re_pointers::re_totheadbc" alt="" coords="615,353,785,379"/>
<area shape="rect" id="node22" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="632,469,768,511"/>
<area shape="rect" id="node23" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="632,404,768,445"/>
<area shape="rect" id="node32" href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e" title="geom_tools::shoot" alt="" coords="409,687,538,714"/>
<area shape="rect" id="node33" href="namespacesimegen.html#aed5580e640bf5adfe4427f5b879b517d" title="simegen::simegen2d" alt="" coords="629,738,771,765"/>
<area shape="rect" id="node28" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="1100,586,1271,613"/>
<area shape="rect" id="node29" href="namespacedrutes__init.html#ad427e6d36ddcd56e4e4c44eb4dee50c5" title="drutes_init::init_observe" alt="" coords="1105,637,1265,663"/>
<area shape="rect" id="node30" href="namespaceread__inputs.html#a29f942f0f7f893e5e5cf1c53fc3ef61f" title="read_inputs::read_2dmesh_gmsh" alt="" coords="837,687,1052,714"/>
<area shape="rect" id="node31" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="1124,688,1247,729"/>
<area shape="rect" id="node34" href="namespaceread__inputs.html#a16c9c0b91377d9e1ab81e838c6244ada" title="read_inputs::read_2dmesh_int" alt="" coords="847,738,1043,765"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a28a5bc6f02c538f8998441d9a251a8d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::find_neighbours </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1element.html">element</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1node.html">node</a>), intent(in)&#160;</td>
          <td class="paramname"><em>nd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00939">939</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, and <a class="el" href="printtools_8f90_source.html#l00010">printtools::progressbar()</a>.</p>

<p>Referenced by <a class="el" href="decomposer_8f90_source.html#l00718">decomposer::make_quadmesh()</a>, <a class="el" href="decomposer_8f90_source.html#l00660">decomposer::read_coarse_mesh()</a>, and <a class="el" href="feminittools_8f90_source.html#l00520">feminittools::surface_integ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceprinttools.html">printtools</a></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1element.html">element</a>), <span class="keywordtype">intent(in out)</span> :: el</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1node.html">node</a>), <span class="keywordtype">intent(in)</span> :: nd</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i,j,k,l,m,upward,downward,pos, n, o</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      el%neighbours = 0_ikind</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      </div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;          <span class="keywordflow">do</span> i=1, el%kolik - 1</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            el%neighbours(i,1) = i-1</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            el%neighbours(i,2) = i+1</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordflow">           end do</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;           el%neighbours(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik,1) = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik - 1</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;           el%neighbours(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik,2) = 0</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            !set neighbours</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordflow">do</span> i=1, el%kolik</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;              pos = 0</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;              j = i</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              k = i</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;              <span class="keyword">call </span><a class="code" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068">progressbar</a>(int(100*i/el%kolik))</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;              okoli: <span class="keywordflow">do</span> </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        j = min(j+1, el%kolik+1)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        k = max(k-1, 0_ikind)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        <span class="keywordflow">if</span> (j &lt;= el%kolik) <span class="keywordflow">then</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                          upward = 0</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                          moje1: <span class="keywordflow">do</span> l=1,ubound(el%data,2)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                    nasel1: <span class="keywordflow">do</span> m=1,ubound(el%data,2)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                            <span class="keywordflow">if</span> (el%data(i,l) == el%data(j,m) .and. i/=j) <span class="keywordflow">then</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                              upward = upward + 1</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                              <span class="keywordflow">if</span> (upward == 2) <span class="keywordflow">then</span> </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                                pos = pos + 1</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                                el%neighbours(i,pos) = j</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                                <span class="keywordflow">EXIT</span> nasel1</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordflow">                                              end if</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">                                            end if</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">                                  end do</span> nasel1</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keywordflow">                          end do</span> moje1</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        <span class="keywordflow">if</span> (k &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                          downward = 0</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                          moje2: <span class="keywordflow">do</span> l=1,ubound(el%data,2)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                  nasel2: <span class="keywordflow">do</span> m=1,ubound(el%data,2)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                            <span class="keywordflow">if</span> (el%data(i,l) == el%data(k,m) .and. i /= k) <span class="keywordflow">then</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                              downward = downward + 1</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                              <span class="keywordflow">if</span> (downward == 2) <span class="keywordflow">then</span> </div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                                pos = pos + 1</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                                el%neighbours(i,pos) = k</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                                <span class="keywordflow">EXIT</span> nasel2</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordflow">                                              end if</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">                                            end if</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordflow">                                  end do</span> nasel2 </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordflow">                          end do</span> moje2</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                        <span class="keywordflow">if</span> (pos == ubound(el%data,2) .or. (j == el%kolik+1 .and. k == 0_ikind<span class="comment">)) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                          <span class="keywordflow">EXIT</span> okoli</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordflow">              end do</span> okoli</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordflow">        end select</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="structglobal__objs_1_1node_html"><div class="ttname"><a href="structglobal__objs_1_1node.html">global_objs::node</a></div><div class="ttdoc">mesh array type for node kolik = number of nodes id = id number of node, equal to position data = x...</div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00188">global_objs.f90:188</a></div></div>
<div class="ttc" id="namespaceprinttools_html"><div class="ttname"><a href="namespaceprinttools.html">printtools</a></div><div class="ttdef"><b>Definition:</b> <a href="printtools_8f90_source.html#l00001">printtools.f90:1</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="structglobal__objs_1_1element_html"><div class="ttname"><a href="structglobal__objs_1_1element.html">global_objs::element</a></div><div class="ttdoc">mesh array type for elements </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00206">global_objs.f90:206</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceprinttools_html_ac71e43f1627ed0239558720411181068"><div class="ttname"><a href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068">printtools::progressbar</a></div><div class="ttdeci">subroutine, public progressbar(j)</div><div class="ttdoc">if default output is stdout, then this procedure prints nice progress bar </div><div class="ttdef"><b>Definition:</b> <a href="printtools_8f90_source.html#l00010">printtools.f90:10</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_cgraph.png" border="0" usemap="#namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_cgraph" id="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_cgraph">
<area shape="rect" id="node2" href="namespaceprinttools.html#ac71e43f1627ed0239558720411181068" title="if default output is stdout, then this procedure prints nice progress bar " alt="" coords="241,5,392,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_icgraph.png" border="0" usemap="#namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_icgraph" id="namespacegeom__tools_a28a5bc6f02c538f8998441d9a251a8d0_icgraph">
<area shape="rect" id="node2" href="namespacedecomposer.html#a58c48dfbf6d81b7645cb64e5d88e3022" title="subroutine that creates mesh of quadrangles – coarse mesh (clusters) " alt="" coords="247,5,447,32"/>
<area shape="rect" id="node5" href="namespacedecomposer.html#a9ce50809a5a28381c14ba27ff5284722" title="decomposer::read_coarse_mesh" alt="" coords="241,56,452,83"/>
<area shape="rect" id="node6" href="namespacefeminittools.html#a36826eda9dbcdb639506e838d6ec2e3e" title="evaluates an array that contains length of the element edge, if the element edge is boundary edge..." alt="" coords="277,107,417,149"/>
<area shape="rect" id="node3" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="500,56,671,83"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="719,81,769,108"/>
<area shape="rect" id="node7" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="517,111,653,137"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa7bb57f436fc77331aea42f34fde56a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind=ikind) function, public geom_tools::get_layer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>quadpnt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00040">40</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, and <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>.</p>

<p>Referenced by <a class="el" href="re__total_8f90_source.html#l00014">re_total::getval_retot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span> :: quadpnt</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: layer</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: el</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">select case</span>(quadpnt%type_pnt)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">case</span>(<span class="stringliteral">&quot;ndpt&quot;</span>)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        el = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%element(quadpnt%order)%data(1)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        layer=<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el,1)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">case</span>(<span class="stringliteral">&quot;obpt&quot;</span>, <span class="stringliteral">&quot;gqnd&quot;</span>)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        el = quadpnt%element</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> (.not. (el &gt;= 1 .and. el&lt;=<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik)) <span class="keywordflow">then</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          print *, <span class="stringliteral">&quot;error in quadpnt data&quot;</span>, el, quadpnt%type_pnt</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          print *, <span class="stringliteral">&quot;called from geom_tools::get_layer&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          print *, <span class="stringliteral">&quot;contact Michal -&gt; michalkuraz@gmail.com&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          error stop</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        layer = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%material(el,1)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordflow">      case default</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          print *, <span class="stringliteral">&quot;err or in quadpnt data&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          print *, <span class="stringliteral">&quot;called from geom_tools::get_layer&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          print *, <span class="stringliteral">&quot;contact Michal -&gt; michalkuraz@gmail.com&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          error stop</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  </div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_aa7bb57f436fc77331aea42f34fde56a5_icgraph.png" border="0" usemap="#namespacegeom__tools_aa7bb57f436fc77331aea42f34fde56a5_icgraph" alt=""/></div>
<map name="namespacegeom__tools_aa7bb57f436fc77331aea42f34fde56a5_icgraph" id="namespacegeom__tools_aa7bb57f436fc77331aea42f34fde56a5_icgraph">
<area shape="rect" id="node2" href="namespacere__total.html#a52ce5b4dd78109c258014d2f601c5d06" title="specific function for Richards equation in H&#45;form (total hydraulic head form), replaces pde_objs::get..." alt="" coords="204,31,345,57"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="395,5,522,32"/>
<area shape="rect" id="node6" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="393,56,524,83"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="572,23,719,65"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="767,31,817,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1237d1dc8b45bd650de0daff46162d6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public geom_tools::get_nz </td>
          <td>(</td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>el_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=ikind), intent(in)&#160;</td>
          <td class="paramname"><em>order2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function that provides z coordinate of boundary normal vector, the boundary is defined by two points: bod1, bod2 </p>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00332">332</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00681">aboveline()</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, and <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>.</p>

<p>Referenced by <a class="el" href="feminittools_8f90_source.html#l00520">feminittools::surface_integ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">intent(in)</span> :: el_id, order1, order2</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: bod1, bod2</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: zcoord</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: tg</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: order3</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    bod1 = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id,order1),:)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    bod2 = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id,order2),:)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (abs(bod1(1)-bod2(1)) &gt; epsilon(tg)) <span class="keywordflow">then</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      tg = (abs(bod2(2)-bod1(2))/abs(bod1(1)-bod2(1)))</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      zcoord = 1/sqrt(1+tg*tg)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      zcoord = 0</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">select case</span>(order1+order2)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">case</span>(3)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        order3=3</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">case</span>(4)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        order3=2</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">case</span>(5)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        order3=1</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (.not. <a class="code" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a>(bod1, bod2, <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el_id, order3),:))) <span class="keywordflow">then</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      zcoord = -zcoord</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_addda2c9ac04812dd1ae188c3780594f4"><div class="ttname"><a href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">geom_tools::aboveline</a></div><div class="ttdeci">logical function, private aboveline(a, b, c)</div><div class="ttdoc">function to determine if the point C lies above or below the line defined by points A and B result is...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00681">geom_tools.f90:681</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_cgraph.png" border="0" usemap="#namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_cgraph" id="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4" title="function to determine if the point C lies above or below the line defined by points A and B result is..." alt="" coords="189,5,341,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_icgraph.png" border="0" usemap="#namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_icgraph" id="namespacegeom__tools_a1237d1dc8b45bd650de0daff46162d6b_icgraph">
<area shape="rect" id="node2" href="namespacefeminittools.html#a36826eda9dbcdb639506e838d6ec2e3e" title="evaluates an array that contains length of the element edge, if the element edge is boundary edge..." alt="" coords="189,5,329,47"/>
<area shape="rect" id="node3" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="377,13,513,39"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="561,13,612,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c2336f6e1e7d512a9d81acb21c71456"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::getcoor </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), intent(in)&#160;</td>
          <td class="paramname"><em>quadpnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00072">72</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00552">dist()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="globals_8f90_source.html#l00116">globals::gauss_points</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="globals_8f90_source.html#l00080">globals::observation_array</a>.</p>

<p>Referenced by <a class="el" href="boussfnc_8f90_source.html#l00155">boussfnc::bouss_adv()</a>, <a class="el" href="boussfnc_8f90_source.html#l00079">boussfnc::bouss_cond()</a>, <a class="el" href="boussfnc_8f90_source.html#l00014">boussfnc::bouss_elast()</a>, <a class="el" href="re__constitutive_8f90_source.html#l00963">re_constitutive::convection_rerot()</a>, <a class="el" href="boussfnc_8f90_source.html#l00286">boussfnc::darcy4bouss()</a>, <a class="el" href="re__total_8f90_source.html#l00014">re_total::getval_retot()</a>, <a class="el" href="_re__dual__tot_h_8f90_source.html#l00020">dual_por::getval_retot_dual()</a>, and <a class="el" href="re__total_8f90_source.html#l00130">re_total::retot_dirichlet_bc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structglobal__objs_1_1integpnt__str.html">integpnt_str</a>), <span class="keywordtype">intent(in)</span> :: quadpnt</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: array</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(3)</span> :: nd</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: el, i</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: dist1, dist2, r1, r2, k1, k2, q1, q2</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: r,k,q,d</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3,2)</span> :: triagpnt</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2,2)</span> :: midpnt</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(2)</span> :: vert </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;     </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">select case</span>(quadpnt%type_pnt)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">case</span>(<span class="stringliteral">&quot;gqnd&quot;</span>)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">select case</span> (<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            el = quadpnt%element</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            nd(1:2) = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el,1:2)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            dist1 = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(nd(2),1) - <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(nd(1),1)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            array(1) = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(nd(1),1) + dist1*<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(quadpnt%order,1)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;           <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">! triag scheme    </span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!          triag(3)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">!          |\ </span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!          | \ </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!          |  \</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">!          |   \</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">!          |    \</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!          |     \</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">!          |      \</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">!          |       \</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">! midpnt(1)|...x    \</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">!          |   .     \</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!      d(1)|   .      \</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!          |   . d(2)  \</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">! triag(1) -------------\ triag(2)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">!              midpnt(2)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            vert = .false.</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            el = quadpnt%element</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">do</span> i=1,3</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              triagpnt(i,:) = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(el,i),:)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            d(1) = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(triagpnt(1,:), triagpnt(3,:))</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            d(2) = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(triagpnt(1,:), triagpnt(2,:))</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">!z distance on unit triangle</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            r(1) = <a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(quadpnt%order,2)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">!x distance on unit triangle</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            r(2) = <a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(quadpnt%order,1)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            midpnt(1,:) = triagpnt(1,:) + (triagpnt(3,:) - triagpnt(1,:)) * r(1)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            midpnt(2,:) = triagpnt(1,:) + (triagpnt(2,:) - triagpnt(1,:)) * r(2)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">if</span> (abs(midpnt(2,1)-triagpnt(1,1)) &gt; 100*epsilon(k1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;              k(1) = (midpnt(2,2) - triagpnt(1,2))/(midpnt(2,1)-triagpnt(1,1))</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;              vert(1) = .true.</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">if</span> (abs(midpnt(1,1)-triagpnt(1,1)) &gt; 100*epsilon(k1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              k(2) = (midpnt(1,2) - triagpnt(1,2))/(midpnt(1,1)-triagpnt(1,1))</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;              vert(2) = .true.</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">where</span> (.not.(vert))</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;              q(:) = midpnt(:,2) - k(:)*midpnt(:,1)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">            end where</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">!           print *, &quot;----beg-------&quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">!           print *, midpnt(1,:)</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">!           print *, midpnt(2,:)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!           print *, k</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">!           print *, vert</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">!           print *, &quot;-----end-----&quot;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">if</span> (.not. vert(1) .and. .not. vert(2)) <span class="keywordflow">then</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              array(1) = (q(1)- q(2))/(k(2)-k(1))</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              <span class="keywordflow">if</span> (abs(k(1) - k(2)) &lt;= epsilon(k1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                print *, <span class="stringliteral">&quot;there must be a bug, both lines have equal tangent, or your mesh is really bad&quot;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                print *, <span class="stringliteral">&quot;interrupted from geom_tools::getcoor&quot;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                error stop</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              array(2) = k(1)*array(1) + q(1)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              <span class="keywordflow">if</span> (vert(1) .and. .not. (vert(2))) <span class="keywordflow">then</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                array(1) = midpnt(1,1)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                array(2) = midpnt(2,2) + k(2)*(midpnt(1,1)-midpnt(2,1))</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (.not.vert(1) .and. (vert(2))) <span class="keywordflow">then</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                array(1) = midpnt(2,1)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                array(2) = midpnt(1,2) + k(1)*(midpnt(2,1) - midpnt(1,1))</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( vert(1) .and. vert(2) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                print *, <span class="stringliteral">&quot;there must be a bug, both lines are vertical&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                print *, <span class="stringliteral">&quot;interrupted from geom_tools::getcoor&quot;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                error stop</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">            end if</span>   </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordflow">        end select</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">case</span>(<span class="stringliteral">&quot;obpt&quot;</span>)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        array = <a class="code" href="namespaceglobals.html#a4dd71ee8c2e6e8e237f73545278811b7">observation_array</a>(quadpnt%order)%xyz</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">case</span>(<span class="stringliteral">&quot;ndpt&quot;</span>)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        array = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(quadpnt%order,:)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">    end select</span></div><div class="ttc" id="namespaceglobals_html_aabb888860f571ef59f1687fda09a6de8"><div class="ttname"><a href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">globals::gauss_points</a></div><div class="ttdeci">type(integnodes), public gauss_points</div><div class="ttdoc">points for gauss quadrature on line   component point is node&amp;#39;s coordinate   component weight is gaus...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00116">globals.f90:116</a></div></div>
<div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespaceglobals_html_a4dd71ee8c2e6e8e237f73545278811b7"><div class="ttname"><a href="namespaceglobals.html#a4dd71ee8c2e6e8e237f73545278811b7">globals::observation_array</a></div><div class="ttdeci">type(observation), dimension(:), allocatable, public observation_array</div><div class="ttdoc">the number of observation points each row defines each point, the row is labeled in [observation] str...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00080">globals.f90:80</a></div></div>
<div class="ttc" id="structglobal__objs_1_1integpnt__str_html"><div class="ttname"><a href="structglobal__objs_1_1integpnt__str.html">global_objs::integpnt_str</a></div><div class="ttdoc">structure that specifies the point </div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00007">global_objs.f90:7</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_cgraph.png" border="0" usemap="#namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_cgraph" id="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="193,5,312,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_icgraph.png" border="0" usemap="#namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_icgraph" id="namespacegeom__tools_a4c2336f6e1e7d512a9d81acb21c71456_icgraph">
<area shape="rect" id="node2" href="namespaceboussfnc.html#a523c691f2d5d7b1448f21c108d496392" title="boussfnc::bouss_adv" alt="" coords="209,5,356,32"/>
<area shape="rect" id="node6" href="namespaceboussfnc.html#a1eb4dcb6eb00362b392c983cf5cefb45" title="boussfnc::bouss_cond" alt="" coords="206,56,359,83"/>
<area shape="rect" id="node7" href="namespaceboussfnc.html#a071d2eeb5f983e31d4495bb68a137e76" title="boussfnc::bouss_elast" alt="" coords="206,107,359,133"/>
<area shape="rect" id="node8" href="namespacere__constitutive.html#a060c1f794f98499dd22932984f0b97e8" title="convection term for the Richards equation for axisymmetric problems the vertical convection is equal ..." alt="" coords="420,171,599,213"/>
<area shape="rect" id="node11" href="namespaceboussfnc.html#afa3ac635ca94f53b4d31b74e208d1ee8" title="boussfnc::darcy4bouss" alt="" coords="204,157,361,184"/>
<area shape="rect" id="node12" href="namespacere__total.html#a52ce5b4dd78109c258014d2f601c5d06" title="specific function for Richards equation in H&#45;form (total hydraulic head form), replaces pde_objs::get..." alt="" coords="439,237,580,264"/>
<area shape="rect" id="node14" href="namespacedual__por.html#ae77ab5b0b843109d82c589c9ac537062" title="specific function for Richards equation in H&#45;form (total hydraulic head form), replaces pde_objs::get..." alt="" coords="193,360,372,387"/>
<area shape="rect" id="node17" href="namespacere__total.html#a50dadbca5603f1a3c8ba55b4321af666" title="re_total::retot_dirichlet_bc" alt="" coords="197,309,369,336"/>
<area shape="rect" id="node3" href="namespacebousspointers.html#aa29fe327913d573ed19bbd1a6b11f0b5" title="bousspointers::boussi" alt="" coords="435,107,584,133"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="825,255,972,297"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1020,263,1071,289"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="649,237,775,264"/>
<area shape="rect" id="node10" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="649,183,775,209"/>
<area shape="rect" id="node13" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="647,288,777,315"/>
<area shape="rect" id="node15" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="441,339,577,381"/>
<area shape="rect" id="node16" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="441,405,577,446"/>
<area shape="rect" id="node18" href="namespacere__pointers.html#ad0da880edec99cec0e70b76e0819172d" title="re_pointers::re_totheadbc" alt="" coords="425,288,594,315"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a7f232fec395ff22f8985cffeebd146"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::getnormal </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>bcpoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>thirdpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>nvect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this function returns outer normal boundary vector bcpoints - nodes ids at the element boundary, integer, dimension(2) thirdpt - coordinates of a point at at element, which lies out of the boundary. It is important in order to obtain proper positive direction of the normal vector </p>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00741">741</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00681">aboveline()</a>, and <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>.</p>

<p>Referenced by <a class="el" href="re__total_8f90_source.html#l00236">re_total::retot_seepage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span> :: bcpoints</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: thirdpt</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(out)</span> :: nvect</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: k</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen == 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      print *, <span class="stringliteral">&quot;RUNTIME ERROR, function geomtools::getnormal is called for 1D problem&quot;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      print *, <span class="stringliteral">&quot;if (desporate) contact Michal -&gt; michalkuraz@gmail.com&quot;</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      error stop</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">    end if</span>    </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(nvect)) <span class="keyword">allocate</span>(nvect(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen))</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span> (abs(bcpoints(1,1)-bcpoints(2,1)) &gt; 100*epsilon(bcpoints(1,1)) .and. &amp;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      abs(bcpoints(1,2)-bcpoints(2,2)) &gt; 100*epsilon(bcpoints(1,1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;     </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      k = (bcpoints(1,2)-bcpoints(2,2))/(bcpoints(1,1)-bcpoints(2,1))</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;     </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a>(bcpoints(1,:), bcpoints(2,:), thirdpt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        nvect(2) = -1</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        nvect(2) = 1</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">! change x for y</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a>((/bcpoints(1,2), bcpoints(1,1)/), (/bcpoints(2,2), bcpoints(2,1)/), (/thirdpt(2), thirdpt(1)/))) <span class="keywordflow">then</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        nvect(1) =  -abs(1.0_rkind/k)</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        nvect(1) = abs(1.0_rkind/k)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      nvect = nvect/(sqrt(nvect(1)*nvect(1)+nvect(2)*nvect(2)))</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">!vertical line</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (abs(bcpoints(1,1)-bcpoints(2,1)) &lt; 100*epsilon(bcpoints(1,1)) .and. &amp;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;       abs(bcpoints(1,2)-bcpoints(2,2)) &gt; 100*epsilon(bcpoints(1,1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;       </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a>(bcpoints(1,:), bcpoints(2,:), thirdpt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;         nvect(1) = 1</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         nvect(1) = -1</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">       end if</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;       </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;       nvect(2) = 0</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;       </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;     <span class="comment">!horizontal line</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (abs(bcpoints(1,1)-bcpoints(2,1)) &gt; 100*epsilon(bcpoints(1,1)) .and. &amp;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;       abs(bcpoints(1,2)-bcpoints(2,2)) &lt; 100*epsilon(bcpoints(1,1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;       </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">aboveline</a>(bcpoints(1,:), bcpoints(2,:), thirdpt)) <span class="keywordflow">then</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;         nvect(2) = -1</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;         nvect(2) = 1</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">       end if</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;       </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;       nvect(1) = 0</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;       print *, <span class="stringliteral">&quot;runtime error, exited from geomtools::getnormal seems like your boundary is defined by a single point&quot;</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;       print *, <span class="stringliteral">&quot;check your mesh, if your mesh is ok, then contact Michal -&gt; michalkuraz@gmail.com&quot;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;       error stop</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">     end if</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  </div><div class="ttc" id="namespacegeom__tools_html_addda2c9ac04812dd1ae188c3780594f4"><div class="ttname"><a href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4">geom_tools::aboveline</a></div><div class="ttdeci">logical function, private aboveline(a, b, c)</div><div class="ttdoc">function to determine if the point C lies above or below the line defined by points A and B result is...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00681">geom_tools.f90:681</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_cgraph.png" border="0" usemap="#namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_cgraph" id="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#addda2c9ac04812dd1ae188c3780594f4" title="function to determine if the point C lies above or below the line defined by points A and B result is..." alt="" coords="208,5,360,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_icgraph.png" border="0" usemap="#namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_icgraph" id="namespacegeom__tools_a9a7f232fec395ff22f8985cffeebd146_icgraph">
<area shape="rect" id="node2" href="namespacere__total.html#aba9ffc0b12bd41e731c2b7bfd4a22f88" title="re_total::retot_seepage" alt="" coords="208,31,363,57"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#ad0da880edec99cec0e70b76e0819172d" title="re_pointers::re_totheadbc" alt="" coords="411,31,580,57"/>
<area shape="rect" id="node4" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="630,5,757,32"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="628,56,759,83"/>
<area shape="rect" id="node5" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="807,23,953,65"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1001,31,1052,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac5eea8089dba9b61e9512793819eca93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, dimension(2) geom_tools::gravity_center </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00871">871</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="linalg_8f90_source.html#l00136">linalg::gem()</a>.</p>

<p>Referenced by <a class="el" href="decomposer_8f90_source.html#l00013">decomposer::init_decomp()</a>, and <a class="el" href="read__inputs_8f90_source.html#l00442">read_inputs::read_2dmesh_gmsh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacelinalg.html">linalg</a></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b,c</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: gc</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2,2)</span> :: line_pars, <a class="code" href="structmtx_1_1matrix.html">matrix</a></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: point, <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: i</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">logical</span> :: vertical</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    point = (b+c)/2.0_rkind</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (abs(a(1)-point(1)) &gt; 1000*epsilon(a(1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>(1) = a(2)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>(2) = point(2)</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(:,2) = 1.0_rkind</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(1,1) = a(1)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(2,1) = point(1)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelinalg.html#a59ec4fd454fde0117c42b153537f53fd">gem</a>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>, <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>, line_pars(1,:))</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      vertical = .false.</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      gc(1) = (a(1)+point(1))/2.0_rkind</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      vertical = .true.</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      i = 2</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    point = (a + c)/2.0_rkind</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   </div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (abs(b(1)-point(1)) &gt; 1000*epsilon(a(1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>(1) = b(2)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>(2) = point(2)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(:,2) = 1</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(1,1) = b(1)</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(2,1) = point(1)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelinalg.html#a59ec4fd454fde0117c42b153537f53fd">gem</a>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>, <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>, line_pars(2,:))</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      gc(1) = (b(1)+point(1))/2.0_rkind</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      vertical = .true.</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      i = 1</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (.not.(vertical)) <span class="keywordflow">then</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a> = -line_pars(:,2)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(:,1) = line_pars(:,1)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <a class="code" href="structmtx_1_1matrix.html">matrix</a>(:,2) = -1.0_rkind</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelinalg.html#a59ec4fd454fde0117c42b153537f53fd">gem</a>(<a class="code" href="structmtx_1_1matrix.html">matrix</a>, <a class="code" href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">bside</a>, gc)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      gc(2) = line_pars(i,1)*gc(1) + line_pars(i,2)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    </div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="ttc" id="namespaceglobals_html_a343ddd5ea0dc6a9653f63a2512d68061"><div class="ttname"><a href="namespaceglobals.html#a343ddd5ea0dc6a9653f63a2512d68061">globals::bside</a></div><div class="ttdeci">real(kind=rkind), dimension(:), allocatable, public bside</div><div class="ttdoc">local matrix vector </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00110">globals.f90:110</a></div></div>
<div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacelinalg_html"><div class="ttname"><a href="namespacelinalg.html">linalg</a></div><div class="ttdoc">obsahuje: </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8f90_source.html#l00012">linalg.f90:12</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacelinalg_html_a59ec4fd454fde0117c42b153537f53fd"><div class="ttname"><a href="namespacelinalg.html#a59ec4fd454fde0117c42b153537f53fd">linalg::gem</a></div><div class="ttdeci">subroutine, public gem(a, b, x)</div><div class="ttdoc">Gaussova eliminace. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8f90_source.html#l00136">linalg.f90:136</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_cgraph.png" border="0" usemap="#namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_cgraph" alt=""/></div>
<map name="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_cgraph" id="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_cgraph">
<area shape="rect" id="node2" href="namespacelinalg.html#a59ec4fd454fde0117c42b153537f53fd" title="Gaussova eliminace. " alt="" coords="189,13,275,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_icgraph.png" border="0" usemap="#namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_icgraph" alt=""/></div>
<map name="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_icgraph" id="namespacegeom__tools_ac5eea8089dba9b61e9512793819eca93_icgraph">
<area shape="rect" id="node2" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="452,5,623,32"/>
<area shape="rect" id="node4" href="namespaceread__inputs.html#a29f942f0f7f893e5e5cf1c53fc3ef61f" title="read_inputs::read_2dmesh_gmsh" alt="" coords="189,60,404,87"/>
<area shape="rect" id="node3" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="671,35,721,61"/>
<area shape="rect" id="node5" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="476,57,599,98"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a55e9334704d756a28f729ba3a950a9ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::init_transform </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>aT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>bT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>procedure to create transformation matrix </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{c} e \\ f \end{array} \right) + \left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array}\right) \left( \begin{array}{c} x \\ y \end{array} \right) = \left( \begin{array}{c} x^T \\ y^T \end{array} \right) \]" src="form_45.png"/>
</p>
<p> where (e,f) is the vector of move and the matrix </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{cc} a &amp; b \\ c &amp; d \end{array}\right) \]" src="form_46.png"/>
</p>
<p> is the matrix of rotation each line represents the element id, the first column in row represents numbers e,f,a,b the second column reprerents numbers f,c,d </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">at</td><td>nodes of triangle</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">matrix</td><td>to store the transformation matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00279">279</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: at</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: bt</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: ct</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span> :: <a class="code" href="structmtx_1_1matrix.html">matrix</a></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: a,b,c,d,e,f</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: i</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">!shape of the unit triangle</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">! [0,1]</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">! |\</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">! |  \</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">! |     \</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">! |       \</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">! |         \</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">! |           \</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">! |               \ </span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">! |----7|---8|---9|--\ </span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">! |     |    |    |   \</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">! |----4|---5|---6|---  \</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">! |     |    |    |       \</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">! |----1|---2|---3|-----   -\       </span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">! |     |    |    |           \ </span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">! |     |    |    |             \</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">! -----------------------------------------</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">! [0,0]                          [1,0]</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    e = at(1)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    f = at(2)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    a = bt(1) - e</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    c = bt(2) - f</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    b = ct(1) - e </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    d = ct(2) - f </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(1,1) = e</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(1,2) = f</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(2,1) = a</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(2,2) = c</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(3,1) = b</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="structmtx_1_1matrix.html">matrix</a>(3,2) = d</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="ttc" id="structmtx_1_1matrix_html"><div class="ttname"><a href="structmtx_1_1matrix.html">mtx::matrix</a></div><div class="ttdoc">obecna matice </div><div class="ttdef"><b>Definition:</b> <a href="mtx_8f90_source.html#l00025">mtx.f90:25</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a648dcde3507b3b3b66eecaea12b43603"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public geom_tools::inline </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>bod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function to determine whether the third point is on line formed by the first two points </p>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00590">590</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00552">dist()</a>.</p>

<p>Referenced by <a class="el" href="geom__tools_8f90_source.html#l00372">inside()</a>, <a class="el" href="geom__tools_8f90_source.html#l00473">shoot()</a>, and <a class="el" href="simegen_8f90_source.html#l00127">simegen::simegen2d()</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: bod, a,b</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: precision</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">logical</span> :: true</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    precision = 1000*epsilon(precision)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (abs(<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,b) - <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,bod) - <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(b,bod)) &lt; precision) <span class="keywordflow">then</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      true = .true.</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      true = .false.</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    </div><div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_cgraph.png" border="0" usemap="#namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_cgraph" id="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="180,5,299,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_icgraph.png" border="0" usemap="#namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_icgraph" id="namespacegeom__tools_a648dcde3507b3b3b66eecaea12b43603_icgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#ad0cfc5aedee571cb83174e83f5d30606" title="geom_tools::inside" alt="" coords="403,56,534,83"/>
<area shape="rect" id="node8" href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e" title="geom_tools::shoot" alt="" coords="187,107,316,133"/>
<area shape="rect" id="node9" href="namespacesimegen.html#aed5580e640bf5adfe4427f5b879b517d" title="simegen::simegen2d" alt="" coords="180,157,323,184"/>
<area shape="rect" id="node3" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="877,5,1048,32"/>
<area shape="rect" id="node5" href="namespacedrutes__init.html#ad427e6d36ddcd56e4e4c44eb4dee50c5" title="drutes_init::init_observe" alt="" coords="642,56,802,83"/>
<area shape="rect" id="node6" href="namespaceread__inputs.html#a29f942f0f7f893e5e5cf1c53fc3ef61f" title="read_inputs::read_2dmesh_gmsh" alt="" coords="615,107,829,133"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1096,56,1147,83"/>
<area shape="rect" id="node7" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="901,107,1024,149"/>
<area shape="rect" id="node10" href="namespaceread__inputs.html#a16c9c0b91377d9e1ab81e838c6244ada" title="read_inputs::read_2dmesh_int" alt="" coords="371,157,567,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad0cfc5aedee571cb83174e83f5d30606"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public geom_tools::inside </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>bod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00372">372</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00552">dist()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="geom__tools_8f90_source.html#l00590">inline()</a>, and <a class="el" href="geom__tools_8f90_source.html#l00473">shoot()</a>.</p>

<p>Referenced by <a class="el" href="decomposer_8f90_source.html#l00013">decomposer::init_decomp()</a>, <a class="el" href="drutes__init_8f90_source.html#l00405">drutes_init::init_observe()</a>, and <a class="el" href="read__inputs_8f90_source.html#l00442">read_inputs::read_2dmesh_gmsh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: bod</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: a,b</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: inter</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span>  :: domain</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: zasah, i, l, p, j, k</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: checked</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: valid</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">logical</span> :: true</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: smer</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> ((domain(1,1) &lt;= bod(1) .and. domain(2,1) &gt;= bod(1)) .or. &amp;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            (domain(1,1) &gt;= bod(1) .and. domain(2,1) &lt;= bod(1)) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          true = .true.</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          true = .false.</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">allocate</span>(smer(ubound(domain,1)+1))</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keyword">allocate</span>(inter(ubound(smer,1),ubound(domain,1),2))</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keyword">allocate</span>(valid(ubound(domain,1)))</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keyword">allocate</span>(checked(ubound(smer,1)))</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        checked = 0</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(domain,1)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="keywordflow">if</span> (i &lt; ubound(domain,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            l = i</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            p = i+1</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            l = i</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            p = 1</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          a = domain(l,:)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          b = domain(p,:)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603">inline</a>(domain(l,:), domain(p,:), bod)) <span class="keywordflow">then</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            true = .true.</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <span class="keywordflow">do</span> j=1, ubound(smer,1)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            smer(j) = rand() + 0.25</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e">shoot</a>(bod, smer(j), domain,  inter(j,:,:), valid)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            zasah = 0</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">do</span> k=1, ubound(domain,1)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;              <span class="keywordflow">if</span> (valid(k)) <span class="keywordflow">then</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,inter(j,k,:)) &gt; 10*epsilon(smer(1)) .and. <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(b,inter(j,k,:)) &gt; 10*epsilon(smer(1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                  zasah = zasah + 1</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                  print *, inter(j,k,:), a, b, <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,inter(j,k,:)) , <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(b,inter(j,k,:))</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                  checked(j) = -1</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">if</span> (checked(j) /= -1) <span class="keywordflow">then</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;              <span class="keywordflow">if</span> (modulo(zasah,2) /= 0 .and. zasah /= ubound(domain,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                checked(j) = 1</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                  </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        j=0</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(checked,1) </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="keywordflow">if</span> (checked(i) == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            true = .false.</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          j = j + checked(i)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> (j == -ubound(checked,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          print *, <span class="stringliteral">&quot;bug in geom_tools::inside, contact developer with a full bug report&quot;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          error stop</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        true = .true.</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">      case default</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        error stop <span class="stringliteral">&quot;generated from geom_tools::inside&quot;</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a52bdc7b016cad84e97b0fd88231c997e"><div class="ttname"><a href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e">geom_tools::shoot</a></div><div class="ttdeci">subroutine, private shoot(bod, k, domain, inter, valid)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00473">geom_tools.f90:473</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a648dcde3507b3b3b66eecaea12b43603"><div class="ttname"><a href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603">geom_tools::inline</a></div><div class="ttdeci">logical function, public inline(A, B, bod)</div><div class="ttdoc">function to determine whether the third point is on line formed by the first two points ...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00590">geom_tools.f90:590</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_cgraph.png" border="0" usemap="#namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_cgraph" alt=""/></div>
<map name="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_cgraph" id="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="536,5,655,32"/>
<area shape="rect" id="node3" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603" title="function to determine whether the third point is on line formed by the first two points ..." alt="" coords="361,31,488,57"/>
<area shape="rect" id="node4" href="namespacegeom__tools.html#a52bdc7b016cad84e97b0fd88231c997e" title="geom_tools::shoot" alt="" coords="184,81,313,108"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_icgraph.png" border="0" usemap="#namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_icgraph" alt=""/></div>
<map name="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_icgraph" id="namespacegeom__tools_ad0cfc5aedee571cb83174e83f5d30606_icgraph">
<area shape="rect" id="node2" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="447,5,617,32"/>
<area shape="rect" id="node4" href="namespacedrutes__init.html#ad427e6d36ddcd56e4e4c44eb4dee50c5" title="drutes_init::init_observe" alt="" coords="211,56,371,83"/>
<area shape="rect" id="node5" href="namespaceread__inputs.html#a29f942f0f7f893e5e5cf1c53fc3ef61f" title="read_inputs::read_2dmesh_gmsh" alt="" coords="184,111,399,137"/>
<area shape="rect" id="node3" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="665,56,716,83"/>
<area shape="rect" id="node6" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="471,107,593,149"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2d14dfd00b3162fe5cc76004ddd815c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::interpolate </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the solution values on gaussian nodes positions </p>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00187">187</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00116">globals::gauss_points</a>, and <a class="el" href="geom__tools_8f90_source.html#l00216">plane_derivative()</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobals2d.html">globals2d</a></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: vals</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: points</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: i </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: xder, yder</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">select case</span>(<a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">case</span>(1)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%weight,1)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          points(i) = (vals(2) - vals(1))*<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(i,1) + vals(1) </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">case</span>(2)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef">plane_derivative</a>((/0.0_rkind, 0.0_rkind, vals(1)/), (/1.0_rkind, 0.0_rkind, vals(2)/), (/0.0_rkind, &amp;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                         1.0_rkind, vals(3)/), xder, yder)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">do</span> i=1, ubound(<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%weight,1)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          points(i) = vals(1) + xder*<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(i,1) + yder*<a class="code" href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">gauss_points</a>%point(i,2)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordflow">    end select</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="ttc" id="namespaceglobals_html_aabb888860f571ef59f1687fda09a6de8"><div class="ttname"><a href="namespaceglobals.html#aabb888860f571ef59f1687fda09a6de8">globals::gauss_points</a></div><div class="ttdeci">type(integnodes), public gauss_points</div><div class="ttdoc">points for gauss quadrature on line   component point is node&amp;#39;s coordinate   component weight is gaus...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00116">globals.f90:116</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_a1e93d0ec91a9f2fcc7573e6347a9f9ef"><div class="ttname"><a href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef">geom_tools::plane_derivative</a></div><div class="ttdeci">subroutine, public plane_derivative(a, b, c, xder, yder)</div><div class="ttdoc">specify the x and y derivates of a plane defined by three points </div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00216">geom_tools.f90:216</a></div></div>
<div class="ttc" id="namespaceglobals2d_html"><div class="ttname"><a href="namespaceglobals2d.html">globals2d</a></div><div class="ttdoc">contains global variables related to 2D problem </div><div class="ttdef"><b>Definition:</b> <a href="globals2_d_8f90_source.html#l00018">globals2D.f90:18</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a2d14dfd00b3162fe5cc76004ddd815c2_cgraph.png" border="0" usemap="#namespacegeom__tools_a2d14dfd00b3162fe5cc76004ddd815c2_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a2d14dfd00b3162fe5cc76004ddd815c2_cgraph" id="namespacegeom__tools_a2d14dfd00b3162fe5cc76004ddd815c2_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a1e93d0ec91a9f2fcc7573e6347a9f9ef" title="specify the x and y derivates of a plane defined by three points " alt="" coords="211,5,401,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a414b4c651eccb3bab087a28455f38ba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::map1d2d </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l01020">1020</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">readtools::comment()</a>, <a class="el" href="core__tools_8f90_source.html#l00030">core_tools::cut()</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="readtools_8f90_source.html#l00461">readtools::file_error()</a>, <a class="el" href="core__tools_8f90_source.html#l00177">core_tools::find_unit()</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>.</p>
<div class="fragment"><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacereadtools.html">readtools</a></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordtype">integer</span> :: fileid, ierr</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, counter, k, l, m, proc, j, ii</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: input</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: tmp, <span class="keywordtype">value</span>, grad</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordtype">logical</span> :: val_defined</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">find_unit</a>(fileid)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      </div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keyword">open</span>(unit=fileid, file=<a class="code" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">cut</a>(filename), action=<span class="stringliteral">&quot;read&quot;</span>, iostat=ierr)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      </div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        print *, <span class="stringliteral">&quot;unable to open file with the vertical distribution of the initial condition, exiting....&quot;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        print *, <span class="stringliteral">&quot;called from map1d2d::drutes_init&quot;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        error stop</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      counter = 0</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      </div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">read</span>(fileid, fmt=*, iostat=ierr) tmp</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          counter = counter + 1</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keyword">allocate</span>(input(counter, ubound(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>,1)+1))</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keyword">open</span>(unit=fileid, file=<a class="code" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">cut</a>(filename), action=<span class="stringliteral">&quot;read&quot;</span>)</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">do</span> i=1, counter</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacereadtools_1_1fileread.html">fileread</a>(input(i,:), fileid)</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">do</span> i=1, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">do</span> j=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          k = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(i,j)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          l = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(k)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          <span class="keywordflow">do</span> proc=1, ubound(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>,1)</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            m = <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc)%permut(k)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              <span class="keywordflow">if</span> (l&gt;100) <span class="keywordflow">then</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keyword">call </span><a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc)%bc(l)%value_fnc(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc), i, j, <span class="keywordtype">value</span>)</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                val_defined=.true.</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                print *, <span class="stringliteral">&quot;runtime error, exited from map1d2d::drutes_init&quot;</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                error stop</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keywordflow">              end if</span>             </div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;              val_defined=.false.</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;              <span class="keywordflow">do</span> ii=1, ubound(input,1)-1</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,2) &gt;= input(ii,1) .and. <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,2)<span class="comment"> &lt;= input(ii+1,1)) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                  grad = (input(ii+1,proc+1) - input(ii,proc+1))/(input(ii<span class="comment">+1,1) - input(ii,1))</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">                  </span><span class="keywordtype">value</span> =  input(ii,proc+1) + grad*(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,2) - input<span class="comment">(ii,1))</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">                  val_defined=.true.</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">                  </span><span class="keywordflow">if</span> (isnan(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                    <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, <span class="stringliteral">&quot;bad input file with initial conditions&quot;</span><span class="comment">)</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment"></span><span class="keywordflow">                  end if</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;              <span class="keywordflow">if</span> (.not. val_defined) <span class="keywordflow">then</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,2) &lt; minval(input(:,1))) <span class="keywordflow">then</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                  <span class="keywordtype">value</span> = input(minloc(input(:,1),1), proc)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                  val_defined=.true.</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,2) &lt; maxval(input(:,1))) <span class="keywordflow">then</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                  <span class="keywordtype">value</span> = input(maxloc(input(:,1),1), proc)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                  val_defined=.true.</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="keywordflow">if</span> (.not. val_defined) <span class="keywordflow">then</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, <span class="stringliteral">&quot;Have you covered the entire vertical profile with data for the initial condition?&quot;</span><span class="comment">)</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment"></span><span class="keywordflow">                end if</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc)%solution(k) =  <span class="keywordtype">value</span> </div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keywordflow">          end do</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="namespacereadtools_html"><div class="ttname"><a href="namespacereadtools.html">readtools</a></div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00001">readtools.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacecore__tools_html_aca00f87d69884142f2350a340fe3642e"><div class="ttname"><a href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">core_tools::cut</a></div><div class="ttdeci">character(len=:) function, allocatable, public cut(ch)</div><div class="ttdoc">dummy functions, the pointer procedure is set to this function in case if not being considered ...</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00030">core_tools.f90:30</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="interfacereadtools_1_1fileread_html"><div class="ttname"><a href="interfacereadtools_1_1fileread.html">readtools::fileread</a></div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00009">readtools.f90:9</a></div></div>
<div class="ttc" id="namespacecore__tools_html_a01c1527fcc56448471e2b349571e51ee"><div class="ttname"><a href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">core_tools::find_unit</a></div><div class="ttdeci">subroutine, public find_unit(iunit, start_id)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00177">core_tools.f90:177</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a414b4c651eccb3bab087a28455f38ba7_cgraph.png" border="0" usemap="#namespacegeom__tools_a414b4c651eccb3bab087a28455f38ba7_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a414b4c651eccb3bab087a28455f38ba7_cgraph" id="namespacegeom__tools_a414b4c651eccb3bab087a28455f38ba7_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="205,5,342,32"/>
<area shape="rect" id="node3" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e" title="dummy functions, the pointer procedure is set to this function in case if not being considered ..." alt="" coords="219,56,327,83"/>
<area shape="rect" id="node4" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="207,107,340,133"/>
<area shape="rect" id="node5" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="204,157,343,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a6548d90c258b44ecc6d58dd159b845"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::map1d2dj </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structpde__objs_1_1pde__str.html">pde_str</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>pde_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l01122">1122</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="readtools_8f90_source.html#l00526">readtools::comment()</a>, <a class="el" href="core__tools_8f90_source.html#l00030">core_tools::cut()</a>, <a class="el" href="globals_8f90_source.html#l00039">globals::drutes_config</a>, <a class="el" href="globals_8f90_source.html#l00106">globals::elements</a>, <a class="el" href="readtools_8f90_source.html#l00461">readtools::file_error()</a>, <a class="el" href="core__tools_8f90_source.html#l00177">core_tools::find_unit()</a>, <a class="el" href="globals_8f90_source.html#l00105">globals::nodes</a>, and <a class="el" href="pde__objs_8f90_source.html#l00297">pde_objs::pde</a>.</p>

<p>Referenced by <a class="el" href="_re__dual__tot_h_8f90_source.html#l00049">dual_por::dual_inicond()</a>, <a class="el" href="re__constitutive_8f90_source.html#l01976">re_constitutive::re_initcond()</a>, and <a class="el" href="re__total_8f90_source.html#l00672">re_total::retot_initcond()</a>.</p>
<div class="fragment"><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobal__objs.html">global_objs</a></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceglobals.html">globals</a></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacepde__objs.html">pde_objs</a></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacecore__tools.html">core_tools</a></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacereadtools.html">readtools</a></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacedebug__tools.html">debug_tools</a></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordtype">class</span>(<a class="code" href="structpde__objs_1_1pde__str.html">pde_str</a>), <span class="keywordtype">intent(in out)</span> :: pde_loc</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordtype">integer</span> :: fileid, ierr</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordtype">integer(kind=ikind)</span> :: i, counter, k, l, m, proc, j, ii, d</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: input</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordtype">real(kind=rkind)</span> :: tmp, <span class="keywordtype">value</span>, grad</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordtype">logical</span> :: val_defined</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      </div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      </div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      d = <a class="code" href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">drutes_config</a>%dimen</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">find_unit</a>(fileid)</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keyword">open</span>(unit=fileid, file=<a class="code" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">cut</a>(filename), action=<span class="stringliteral">&quot;read&quot;</span>, iostat=ierr)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      </div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        print *, <span class="stringliteral">&quot;unable to open file with the vertical distribution of the initial condition, exiting....&quot;</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        print *, <span class="stringliteral">&quot;called from map1d2dJ::drutes_init&quot;</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        error stop</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      </div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      counter = 0</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      </div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">comment</a>(fileid)</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keyword">read</span>(fileid, fmt=*, iostat=ierr) tmp</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span> (ierr /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          counter = counter + 1</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keyword">allocate</span>(input(counter, 3))</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      </div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keyword">open</span>(unit=fileid, file=<a class="code" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">cut</a>(filename), action=<span class="stringliteral">&quot;read&quot;</span>)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">do</span> i=1, counter</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keyword">call </span><a class="code" href="interfacereadtools_1_1fileread.html">fileread</a>(input(i,:), fileid)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">do</span> i=1, <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%kolik</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">do</span> j=1, ubound(<a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data,2)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          k = <a class="code" href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">elements</a>%data(i,j)</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          l = <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%edge(k)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            m = pde_loc%permut(k)</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;              <span class="keywordflow">if</span> (l&gt;100) <span class="keywordflow">then</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                <span class="keywordflow">do</span> ii=1, ubound(input,1)-1</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    </div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) &gt;= input(ii,2) .and. <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d<span class="comment">) &lt;= input(ii+1,2)) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    grad = (input(ii+1,3) - input(ii,3))/(input(ii+1,2) <span class="comment">- input(ii,2))</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">                    </span><span class="keywordtype">value</span> =  input(ii,3) + grad*(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) - input<span class="comment">(ii,2))</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">                    val_defined=.true.</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">                    </span><span class="keywordflow">if</span> (isnan(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                      <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, <span class="stringliteral">&quot;bad input file with initial conditions&quot;</span><span class="comment">)</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment"></span><span class="keywordflow">                    end if</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="keywordflow">                   end if</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="keywordflow">                 end do</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                 <span class="keywordflow">if</span>(.not. val_defined) <span class="keywordflow">then</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                   <span class="keyword">call </span><a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc)%bc(l)%value_fnc(<a class="code" href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde</a>(proc), i, j, <span class="keywordtype">value</span><span class="comment">)</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">                   val_defined=.true.</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"></span><span class="keywordflow">                 end if</span> </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                print *, <span class="stringliteral">&quot;runtime error, exited from map1d2dJ::drutes_init&quot;</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                error stop</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="keywordflow">              end if</span>             </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;              val_defined=.false.</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;              <span class="keywordflow">do</span> ii=1, ubound(input,1)-1</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) &gt;= input(ii,2) .and. <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d)<span class="comment"> &lt;= input(ii+1,2)) </span><span class="keywordflow">then</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                  </div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                  grad = (input(ii+1,3) - input(ii,3))/(input(ii+1,2) - input<span class="comment">(ii,2))</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">                  </span><span class="keywordtype">value</span> =  input(ii,3) + grad*(<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) - input(ii<span class="comment">,2))</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">                  val_defined=.true.</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">                  </span><span class="keywordflow">if</span> (isnan(<span class="keywordtype">value</span>)) <span class="keywordflow">then</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, <span class="stringliteral">&quot;bad input file with initial conditions&quot;</span><span class="comment">)</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment"></span><span class="keywordflow">                  end if</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                  <span class="keywordflow">EXIT</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordflow">              end do</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;              <span class="keywordflow">if</span> (.not. val_defined) <span class="keywordflow">then</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) &lt; minval(input(:,2))) <span class="keywordflow">then</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                  <span class="keywordtype">value</span> = input(minloc(input(:,2),1),3)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                  val_defined=.true.</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) &gt; maxval(input(:,2))) <span class="keywordflow">then</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                  <span class="keywordtype">value</span> = input(maxloc(input(:,2),1), 3)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                  val_defined=.true.</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                <span class="keywordflow">if</span> (.not. val_defined) <span class="keywordflow">then</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                  print *, <a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) ; stop</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">file_error</a>(fileid, <span class="stringliteral">&quot;Have you covered the entire vertical profile with data for the initial condition?&quot;</span><span class="comment">)</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"></span><span class="keywordflow">                end if</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keywordflow">              end if</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            pde_loc%solution(k) =  <span class="keywordtype">value</span>+<a class="code" href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">nodes</a>%data(k,d) </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        </div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keyword">close</span>(fileid)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      </div><div class="ttc" id="namespacereadtools_html_a9481f44f055c2f4bc518a4b91db43b5c"><div class="ttname"><a href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c">readtools::file_error</a></div><div class="ttdeci">subroutine, public file_error(iunit, message)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00461">readtools.f90:461</a></div></div>
<div class="ttc" id="namespaceglobals_html_a3e4ae1cd4085ab497e8b6f1890326d4f"><div class="ttname"><a href="namespaceglobals.html#a3e4ae1cd4085ab497e8b6f1890326d4f">globals::nodes</a></div><div class="ttdeci">type(node), public nodes</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00105">globals.f90:105</a></div></div>
<div class="ttc" id="structpde__objs_1_1pde__str_html"><div class="ttname"><a href="structpde__objs_1_1pde__str.html">pde_objs::pde_str</a></div><div class="ttdoc">type definition for common quasilinear partial diferential equation in a format  </div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00068">pde_objs.f90:68</a></div></div>
<div class="ttc" id="namespacereadtools_html"><div class="ttname"><a href="namespacereadtools.html">readtools</a></div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00001">readtools.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html_a120091f0ef12f971ed2c64514ea3ef2a"><div class="ttname"><a href="namespaceglobals.html#a120091f0ef12f971ed2c64514ea3ef2a">globals::elements</a></div><div class="ttdeci">type(element), public elements</div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00106">globals.f90:106</a></div></div>
<div class="ttc" id="namespacecore__tools_html_aca00f87d69884142f2350a340fe3642e"><div class="ttname"><a href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e">core_tools::cut</a></div><div class="ttdeci">character(len=:) function, allocatable, public cut(ch)</div><div class="ttdoc">dummy functions, the pointer procedure is set to this function in case if not being considered ...</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00030">core_tools.f90:30</a></div></div>
<div class="ttc" id="namespacepde__objs_html_ac7f502a66d87d5e3abad1d8c94022aca"><div class="ttname"><a href="namespacepde__objs.html#ac7f502a66d87d5e3abad1d8c94022aca">pde_objs::pde</a></div><div class="ttdeci">type(pde_str), dimension(:), allocatable, public pde</div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00297">pde_objs.f90:297</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacecore__tools_html"><div class="ttname"><a href="namespacecore__tools.html">core_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00017">core_tools.f90:17</a></div></div>
<div class="ttc" id="namespacereadtools_html_ab8bc95060d3f5e8bfb8d4e4519c3568a"><div class="ttname"><a href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a">readtools::comment</a></div><div class="ttdeci">subroutine, public comment(Unit)</div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00526">readtools.f90:526</a></div></div>
<div class="ttc" id="namespaceglobals_html_a76491724ea1ced217a173cbc1d4443c7"><div class="ttname"><a href="namespaceglobals.html#a76491724ea1ced217a173cbc1d4443c7">globals::drutes_config</a></div><div class="ttdeci">type(configuration), public drutes_config</div><div class="ttdoc">program configuration </div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00039">globals.f90:39</a></div></div>
<div class="ttc" id="namespacepde__objs_html"><div class="ttname"><a href="namespacepde__objs.html">pde_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="pde__objs_8f90_source.html#l00001">pde_objs.f90:1</a></div></div>
<div class="ttc" id="namespaceglobals_html"><div class="ttname"><a href="namespaceglobals.html">globals</a></div><div class="ttdef"><b>Definition:</b> <a href="globals_8f90_source.html#l00016">globals.f90:16</a></div></div>
<div class="ttc" id="namespaceglobal__objs_html"><div class="ttname"><a href="namespaceglobal__objs.html">global_objs</a></div><div class="ttdef"><b>Definition:</b> <a href="global__objs_8f90_source.html#l00001">global_objs.f90:1</a></div></div>
<div class="ttc" id="interfacereadtools_1_1fileread_html"><div class="ttname"><a href="interfacereadtools_1_1fileread.html">readtools::fileread</a></div><div class="ttdef"><b>Definition:</b> <a href="readtools_8f90_source.html#l00009">readtools.f90:9</a></div></div>
<div class="ttc" id="namespacecore__tools_html_a01c1527fcc56448471e2b349571e51ee"><div class="ttname"><a href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee">core_tools::find_unit</a></div><div class="ttdeci">subroutine, public find_unit(iunit, start_id)</div><div class="ttdef"><b>Definition:</b> <a href="core__tools_8f90_source.html#l00177">core_tools.f90:177</a></div></div>
<div class="ttc" id="namespacedebug__tools_html"><div class="ttname"><a href="namespacedebug__tools.html">debug_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="debug__tools_8f90_source.html#l00001">debug_tools.f90:1</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_cgraph.png" border="0" usemap="#namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_cgraph" id="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_cgraph">
<area shape="rect" id="node2" href="namespacereadtools.html#ab8bc95060d3f5e8bfb8d4e4519c3568a" title="readtools::comment" alt="" coords="207,5,345,32"/>
<area shape="rect" id="node3" href="namespacecore__tools.html#aca00f87d69884142f2350a340fe3642e" title="dummy functions, the pointer procedure is set to this function in case if not being considered ..." alt="" coords="222,56,330,83"/>
<area shape="rect" id="node4" href="namespacereadtools.html#a9481f44f055c2f4bc518a4b91db43b5c" title="readtools::file_error" alt="" coords="209,107,343,133"/>
<area shape="rect" id="node5" href="namespacecore__tools.html#a01c1527fcc56448471e2b349571e51ee" title="core_tools::find_unit" alt="" coords="207,157,345,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_icgraph.png" border="0" usemap="#namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_icgraph" id="namespacegeom__tools_a5a6548d90c258b44ecc6d58dd159b845_icgraph">
<area shape="rect" id="node2" href="namespacedual__por.html#a56d450c18eee19012cb05d2b1dd008e1" title="assigns initial condition " alt="" coords="207,78,357,105"/>
<area shape="rect" id="node7" href="namespacere__constitutive.html#a7a0c1ec8d57856234ae33b61eab450f2" title="re_constitutive::re\l_initcond" alt="" coords="219,151,345,192"/>
<area shape="rect" id="node10" href="namespacere__total.html#a5d572dd5f6da46314cdd0d5039c2db7c" title="re_total::retot_initcond" alt="" coords="207,238,357,265"/>
<area shape="rect" id="node3" href="namespacere__dual__pointers.html#a7c3a2d7fee47e270402505ab315ca55d" title="Links to releveant subroutines for fracture domain. " alt="" coords="405,5,541,47"/>
<area shape="rect" id="node6" href="namespacere__dual__pointers.html#aa76c31f626d7323a2032a80d6cac5ff6" title="Links to releveant subroutines for matrix domain. " alt="" coords="405,71,541,112"/>
<area shape="rect" id="node4" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="589,155,736,196"/>
<area shape="rect" id="node5" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="784,162,835,189"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="410,137,537,163"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="408,187,539,214"/>
<area shape="rect" id="node11" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="410,238,537,265"/>
<area shape="rect" id="node12" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="408,289,539,315"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a50afc0353d5731dc64cb3731f11b8361"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::max_height </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>height</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subroutine searching for the maximum height on triangle element </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>input element edges</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>input element edges</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>input element edges</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">height</td><td>the maximal element height </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00841">841</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00552">dist()</a>, and <a class="el" href="geom__tools_8f90_source.html#l00812">najdi_bod()</a>.</p>
<div class="fragment"><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b,c</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: height</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: bod</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: ha,hb,hc</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: la, lb, lc</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacegeom__tools.html#abb7e5ddeeee2bd0f031e5c2713571e5d">najdi_bod</a>(a,b,c, bod)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    hc = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(c,bod)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    lc = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,b)</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    la = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(c,b)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    lb = <a class="code" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">dist</a>(a,c)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    ha = la/lc*hc</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    hb = lb/lc*hc</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    height = max(ha,hb,hc)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">!     height = (ha + hb + hc)/3</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  </div><div class="ttc" id="namespacegeom__tools_html_a91ddf015e5cea9e21d182b93603f5139"><div class="ttname"><a href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139">geom_tools::dist</a></div><div class="ttdeci">real(kind=rkind) function, public dist(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00552">geom_tools.f90:552</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
<div class="ttc" id="namespacegeom__tools_html_abb7e5ddeeee2bd0f031e5c2713571e5d"><div class="ttname"><a href="namespacegeom__tools.html#abb7e5ddeeee2bd0f031e5c2713571e5d">geom_tools::najdi_bod</a></div><div class="ttdeci">subroutine, public najdi_bod(a, b, c, bod)</div><div class="ttdoc">subroutine seeking for the point which is on line identified by points a and b, and line between this...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00812">geom_tools.f90:812</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a50afc0353d5731dc64cb3731f11b8361_cgraph.png" border="0" usemap="#namespacegeom__tools_a50afc0353d5731dc64cb3731f11b8361_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a50afc0353d5731dc64cb3731f11b8361_cgraph" id="namespacegeom__tools_a50afc0353d5731dc64cb3731f11b8361_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="234,5,353,32"/>
<area shape="rect" id="node3" href="namespacegeom__tools.html#abb7e5ddeeee2bd0f031e5c2713571e5d" title="subroutine seeking for the point which is on line identified by points a and b, and line between this..." alt="" coords="217,56,369,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abb7e5ddeeee2bd0f031e5c2713571e5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::najdi_bod </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>bod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subroutine seeking for the point which is on line identified by points a and b, and line between this point and c is rectangular to the line &lt;a,b&gt; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>element points</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>element points</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>element points</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bod</td><td>the rectangular pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00812">812</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>Referenced by <a class="el" href="geom__tools_8f90_source.html#l00841">max_height()</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b,c</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: bod</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: k, q, q2</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (abs(b(1) - a(1)) &gt; 100*epsilon(a(1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      k = (b(2)-a(2))/(b(1)-a(1))</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      q = a(2) - k*a(1)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      q2 = -c(1) - k*c(2)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      bod(2) = (-k*q2+q)/(k*k+1)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      bod(1) = -k*bod(2)-q2</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      bod(1) = a(1)</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      bod(2) = c(2)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      </div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_abb7e5ddeeee2bd0f031e5c2713571e5d_icgraph.png" border="0" usemap="#namespacegeom__tools_abb7e5ddeeee2bd0f031e5c2713571e5d_icgraph" alt=""/></div>
<map name="namespacegeom__tools_abb7e5ddeeee2bd0f031e5c2713571e5d_icgraph" id="namespacegeom__tools_abb7e5ddeeee2bd0f031e5c2713571e5d_icgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a50afc0353d5731dc64cb3731f11b8361" title="subroutine searching for the maximum height on triangle element " alt="" coords="205,5,369,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1e93d0ec91a9f2fcc7573e6347a9f9ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::plane_derivative </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>xder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>yder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>specify the x and y derivates of a plane defined by three points </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>1st point of the plane</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>2nd point of the plane</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>3rd point of the plane</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xder</td><td>resulting x derivate</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">yder</td><td>resulting y derivate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00216">216</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l00859">re_constitutive::derkz()</a>, <a class="el" href="feminittools_8f90_source.html#l00012">feminittools::feminit()</a>, <a class="el" href="feminittools_8f90_source.html#l00146">feminittools::init_integ()</a>, <a class="el" href="geom__tools_8f90_source.html#l00187">interpolate()</a>, and <a class="el" href="decomposer_8f90_source.html#l00181">decomposer::set_subdomains()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: b</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: xder</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(out)</span> :: yder</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!-------local variables--------------</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span> :: u</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span> :: v</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(3)</span> :: n</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: i</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: reps</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    reps = epsilon(reps)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">!check if the plane is not horizontal</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (abs(a(3) - b(3)) &lt; reps*(abs(a(3))-abs(b(3)))  .and.  &amp;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        abs(a(3) - c(3)) &lt; reps*(abs(a(3))-abs(c(3)))  .and.  &amp;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        abs(b(3) - c(3)) &lt; reps*(abs(b(3))-abs(c(3)))) <span class="keywordflow">then</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      xder = 0.0_rkind</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      yder = 0.0_rkind</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!creates the plane vectors </span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">do</span> i=1,3</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      u(i) = a(i) - b(i)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      v(i) = a(i) - c(i)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">! the normal plane vector is defined as</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    n(1) = u(2)*v(3) - v(2)*u(3)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    n(2) = u(3)*v(1) - v(3)*u(1)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    n(3) = u(1)*v(2) - v(1)*u(2)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! finally the derivate is as follows, the horizontality has been already checked</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">! the verticality check</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (abs(n(3)) &lt; 1e2*reps) <span class="keywordflow">then</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      print *, <span class="stringliteral">&quot;the mesh is wrong, base function can&#39;t be vertical&quot;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      print *, abs(n(3))</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      error stop</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">    end if</span> </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    xder = -n(1)/n(3)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    yder = -n(2)/n(3)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    </div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a1e93d0ec91a9f2fcc7573e6347a9f9ef_icgraph.png" border="0" usemap="#namespacegeom__tools_a1e93d0ec91a9f2fcc7573e6347a9f9ef_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a1e93d0ec91a9f2fcc7573e6347a9f9ef_icgraph" id="namespacegeom__tools_a1e93d0ec91a9f2fcc7573e6347a9f9ef_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a36094a3f7331f94d2c895ef3e442d39d" title="re_constitutive::derkz" alt="" coords="269,5,415,32"/>
<area shape="rect" id="node3" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="497,77,633,104"/>
<area shape="rect" id="node5" href="namespacefeminittools.html#a7ef75bcab723e61e7d20b4082e3a506e" title="set ups integration nodes and weights " alt="" coords="285,107,399,149"/>
<area shape="rect" id="node6" href="namespacegeom__tools.html#a2d14dfd00b3162fe5cc76004ddd815c2" title="returns the solution values on gaussian nodes positions " alt="" coords="263,173,421,200"/>
<area shape="rect" id="node7" href="namespacedecomposer.html#abbcc7a95b77ad1dbec2b528470df7daf" title="the subdomains are combined based on the gradients of the solution and the Picard iterations ..." alt="" coords="244,224,440,251"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="884,107,935,133"/>
<area shape="rect" id="node8" href="namespaceschwarz__dd.html#a5e1abf918f5afac4e96fa81e0cfa5f7a" title="solves the problem using Picard method with Schwarz multiplicative domain decomposition reflecting th..." alt="" coords="490,129,639,170"/>
<area shape="rect" id="node10" href="namespaceschwarz__dd__time__test.html#a28474cc01fb4558d0a875080f5a52724" title="solves the problem using Picard method with Schwarz multiplicative domain decomposition reflecting th..." alt="" coords="488,194,641,235"/>
<area shape="rect" id="node11" href="namespaceschwarz__dd2subcyc.html#a1172bd9a4c93b3862894cf530bff7fea" title="solves the problem using Picard method with Schwarz multiplicative domain decomposition reflecting th..." alt="" coords="490,259,639,301"/>
<area shape="rect" id="node12" href="namespacesubcycling.html#a676c0ac81f3576e037f6f49c0001ce78" title="solves the problem using Picard method with Schwarz multiplicative domain decomposition reflecting th..." alt="" coords="497,325,632,366"/>
<area shape="rect" id="node9" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="689,129,836,170"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a52bdc7b016cad84e97b0fd88231c997e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private geom_tools::shoot </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>bod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>inter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>valid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00473">473</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="geom__tools_8f90_source.html#l00590">inline()</a>.</p>

<p>Referenced by <a class="el" href="geom__tools_8f90_source.html#l00372">inside()</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: bod</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">intent(in)</span> :: k</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span> :: domain</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(out)</span> :: inter</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: valid</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: q, qq, kk</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(2)</span> :: a,b</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">integer(kind=ikind)</span> :: l,p, i</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    q = bod(2) - k*bod(1)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">do</span> i=1, ubound(domain,1)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">if</span> (i &lt; ubound(domain,1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        l = i</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        p = i+1</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        l = i</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        p = 1</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">      end if</span> </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      a = domain(l,:)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      b = domain(p,:)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> (abs(a(1)-b(1)) &gt; 10*epsilon(a(1))) <span class="keywordflow">then</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        kk = (b(2) - a(2))/(b(1)-a(1))</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        qq = b(2) - b(1)*kk</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span> (abs(k-kk) &gt; 10*epsilon(k)) <span class="keywordflow">then</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          inter(i,1) = (qq-q)/(k-kk)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          inter(i,2) = k*inter(i,1) + q</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="keywordflow">if</span> (abs(q-qq) &gt; 10*epsilon(q)) <span class="keywordflow">then</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            inter(i,:) = (/huge(k), huge(k)/)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">if</span> (a(1) &gt; b(1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;              inter(i,:) = a</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              inter(i,:) = b</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordflow">          end if</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        inter(i,1) = a(1)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        inter(i,2) = k*inter(i,1) + q</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603">inline</a>(a,b, inter(i,:)) .and. inter(i,1) &gt; bod(1)) <span class="keywordflow">then</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        valid(i) = .true.</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        valid(i) = .false.</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">      end if</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        </div><div class="ttc" id="namespacegeom__tools_html_a648dcde3507b3b3b66eecaea12b43603"><div class="ttname"><a href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603">geom_tools::inline</a></div><div class="ttdeci">logical function, public inline(A, B, bod)</div><div class="ttdoc">function to determine whether the third point is on line formed by the first two points ...</div><div class="ttdef"><b>Definition:</b> <a href="geom__tools_8f90_source.html#l00590">geom_tools.f90:590</a></div></div>
<div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_cgraph.png" border="0" usemap="#namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_cgraph" id="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_cgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#a648dcde3507b3b3b66eecaea12b43603" title="function to determine whether the third point is on line formed by the first two points ..." alt="" coords="183,5,309,32"/>
<area shape="rect" id="node3" href="namespacegeom__tools.html#a91ddf015e5cea9e21d182b93603f5139" title="geom_tools::dist" alt="" coords="357,5,476,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_icgraph.png" border="0" usemap="#namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_icgraph" id="namespacegeom__tools_a52bdc7b016cad84e97b0fd88231c997e_icgraph">
<area shape="rect" id="node2" href="namespacegeom__tools.html#ad0cfc5aedee571cb83174e83f5d30606" title="geom_tools::inside" alt="" coords="183,56,313,83"/>
<area shape="rect" id="node3" href="namespacedecomposer.html#a98718ed1ed87442f86951d651992261d" title="decomposer::init_decomp" alt="" coords="624,5,795,32"/>
<area shape="rect" id="node5" href="namespacedrutes__init.html#ad427e6d36ddcd56e4e4c44eb4dee50c5" title="drutes_init::init_observe" alt="" coords="389,56,549,83"/>
<area shape="rect" id="node6" href="namespaceread__inputs.html#a29f942f0f7f893e5e5cf1c53fc3ef61f" title="read_inputs::read_2dmesh_gmsh" alt="" coords="361,111,576,137"/>
<area shape="rect" id="node4" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="843,56,893,83"/>
<area shape="rect" id="node7" href="namespacedrutes__init.html#ac0d99b874b2dbf6a5726f534d3ee0943" title="routine to open all files to read and write " alt="" coords="648,107,771,149"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2fde1713e8d912a2be95dfa7f6789bab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public geom_tools::solve_bisect </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(in)&#160;</td>
          <td class="paramname"><em>reps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), intent(out)&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>bisecton method searching for a root of function f on defined intervals xmin and xmax </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xmin</td><td>a interval where the root is searched</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmax</td><td>a interval where the root is searched</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reps</td><td>accuracy</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>error code output</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">solution</td><td>the result </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00612">612</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>References <a class="el" href="core__tools_8f90_source.html#l00041">core_tools::write_log()</a>.</p>

<p>Referenced by <a class="el" href="re__constitutive_8f90_source.html#l01394">re_constitutive::init_zones()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_cgraph.png" border="0" usemap="#namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_cgraph" alt=""/></div>
<map name="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_cgraph" id="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_cgraph">
<area shape="rect" id="node2" href="namespacecore__tools.html#abe09f9b4dc2abc5384a24020c5031e95" title="core_tools::write_log" alt="" coords="224,5,367,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_icgraph.png" border="0" usemap="#namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_icgraph" alt=""/></div>
<map name="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_icgraph" id="namespacegeom__tools_a2fde1713e8d912a2be95dfa7f6789bab_icgraph">
<area shape="rect" id="node2" href="namespacere__constitutive.html#a3c7de19cd5e93ba8f0f4bb821e87790c" title="re_constitutive::init\l_zones" alt="" coords="224,74,356,115"/>
<area shape="rect" id="node3" href="namespacere__pointers.html#a5f39d856da70973c02dcc8ed10844884" title="re_pointers::allrepointers" alt="" coords="404,81,568,108"/>
<area shape="rect" id="node4" href="namespacere__pointers.html#a2ae8b49e9d185cc91057283c869cb633" title="re_pointers::reroth" alt="" coords="618,5,745,32"/>
<area shape="rect" id="node7" href="namespacere__pointers.html#a4f4fd0e928850ecdd8a81e8d55a70143" title="re_pointers::re_rot" alt="" coords="618,56,745,83"/>
<area shape="rect" id="node8" href="namespacere__pointers.html#adc1e1c0ad055044eb884aeb7b9f2814c" title="re_pointers::re_std" alt="" coords="616,107,747,133"/>
<area shape="rect" id="node9" href="namespacere__pointers.html#ab30747cb46458aeac12088c565317b00" title="re_pointers::restdh" alt="" coords="616,157,747,184"/>
<area shape="rect" id="node5" href="namespacemanage__pointers.html#a8275d1f0bd8032fa68b910b70058a4cf" title="set pointers for the entire problem, except the file read pointers " alt="" coords="795,74,941,115"/>
<area shape="rect" id="node6" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="989,81,1040,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af5e7826748ab86ab44154a7637fcc080"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=rkind) function, public geom_tools::triarea </td>
          <td>(</td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>triangle points</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>triangle points</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>triangle points</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>result </dd></dl>

<p>Definition at line <a class="el" href="geom__tools_8f90_source.html#l00533">533</a> of file <a class="el" href="geom__tools_8f90_source.html">geom_tools.f90</a>.</p>

<p>Referenced by <a class="el" href="feminittools_8f90_source.html#l00012">feminittools::feminit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetypy.html">typy</a></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">real(kind=rkind)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a,b,c</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: area</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">real(kind=rkind)</span> :: la,lb,lc</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    lc = sqrt((a(1) - b(1))**2 + (a(2) - b(2))**2)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    lb = sqrt((a(1) - c(1))**2 + (a(2) - c(2))**2)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    la = sqrt((b(1) - c(1))**2 + (b(2) - c(2))**2)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    </div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    area = 0.25*sqrt((la+lb+lc)*(lb + lc - la)*(lc + la - lb)*(la + lb - lc))</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  </div><div class="ttc" id="namespacetypy_html"><div class="ttname"><a href="namespacetypy.html">typy</a></div><div class="ttdef"><b>Definition:</b> <a href="typy_8f90_source.html#l00017">typy.f90:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegeom__tools_af5e7826748ab86ab44154a7637fcc080_icgraph.png" border="0" usemap="#namespacegeom__tools_af5e7826748ab86ab44154a7637fcc080_icgraph" alt=""/></div>
<map name="namespacegeom__tools_af5e7826748ab86ab44154a7637fcc080_icgraph" id="namespacegeom__tools_af5e7826748ab86ab44154a7637fcc080_icgraph">
<area shape="rect" id="node2" href="namespacefeminittools.html#a9988b1795b71ef099fd33d9219744a83" title="feminittools::feminit" alt="" coords="187,5,323,32"/>
<area shape="rect" id="node3" href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="371,5,421,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegeom__tools.html">geom_tools</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
